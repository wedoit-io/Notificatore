var ClientMessagesSet={ITA:{SWF_HD_FILESTATUS:"Stato",SWF_HD_FILESIZE:"Dim.",SWF_FS_READY:"Pronto",SWF_FS_UPLOADING:"In corso ...",SWF_FS_SEND:"Inviato",SWF_FS_STOPPED:"Fermato",SWF_TT_SELECTFILES:"Seleziona i file",SWF_TP_SELECTFILES:"Seleziona i file da inviare",SWF_TT_REMOVEALL:"Rimuovi tutti",SWF_TP_REMOVEALL:"Rimuovi tutti i file",SWF_TT_SENDALL:"Invia tutti",SWF_TP_SENDALL:"Invia tutti i file",SWF_TT_ABORTALL:"Ferma tutti",SWF_TP_ABORTALL:"Ferma tutti i file",SWF_TT_REMOVETHIS:"Rimuovi questo",SWF_TP_REMOVETHIS:"Rimuovi questo file",SWF_TT_SENDTHIS:"Invia questo",SWF_TP_SENDTHIS:"Invia questo file",SWF_TT_ABORTTHIS:"Annulla questo",SWF_TP_ABORTTHIS:"Annulla l'invio di questo file",SWF_MG_UPLOADING:"Caricamento del file |1 in corso ...!",SWF_ER_QUEUEEXCEEDED:"Troppi file nella coda",SWF_ER_FILESIZEEXCEEDED:"File troppo grande",SWF_ER_ZEROBYTEFILE:"File vuoto",SWF_ER_INVALIDFILETYPE:"File di tipo non valido",SWF_ER_UNHANDLED:"Errore sconosciuto",SWF_ER_FILENOTSEND:"Il file non &egrave; stato caricato.",SWF_ER_FILENOTQUEUED:"Il seguente file non &egrave, stato accettato:",SWF_ER_FILESNOTQUEUED:"I seguenti file non sono stati accettati:",SWF_ER_HTTPERROR:"Errore HTTP",SWF_ER_UPLOADFAILED:"Caricamento fallito",SWF_ER_IO_ERROR:"Errore Server (IO)",SWF_ER_SECURITY_ERROR:"Errore di sicurezza",SWF_ER_UPLOADEXCEEDED:"Superato il numero massimo di file inviabili",SWF_ER_VALIDATIONFAILED:"File non valido",SWF_ER_FILECANCELLED:"Caricamento annullato",SWF_ER_UPLOADSTOPPED:"Caricamento fermato",TIP_TITLE_QBETIP:"Criteri di ricerca",TIP_TITLE_PanelInizio:"Inizio",TIP_TITLE_PanelPaginaPrec:"Pagina precedente",TIP_TITLE_PanelPaginaSucc:"Pagina successiva",TIP_TITLE_PanelFine:"Fine",TIP_TITLE_TooltipCerca:"Cerca",TIP_TITLE_TooltipTrova:"Trova",TIP_TITLE_TooltipFormList:"Cambio layout",TIP_TITLE_TooltipCancel:"Annulla",TIP_TITLE_TooltipRefresh:"Aggiorna",TIP_TITLE_TooltipDelete:"Elimina",TIP_TITLE_TooltipInsert:"Inserisci",TIP_TITLE_TooltipDuplicate:"Duplica",TIP_TITLE_TooltipUpdate:"Salva",TIP_TITLE_Print:"Stampa",TIP_TITLE_TooltipExport:"Esporta",TIP_TITLE_ComandoAllegati:"Allegati",TIP_TITLE_ComandoGruppi:"Raggruppa",TIP_TITLE_TooltipRowSel:"Selezione record",TIP_TITLE_TooltipSelectAll:"Seleziona tutti",TIP_TITLE_TooltipDeseleziona:"Deseleziona tutti",TIP_TITLE_TooltipUnlock:"Sblocca",TIP_TITLE_TooltipLock:"Blocca",TIP_TITLE_MostraRiquadro:"Mostra",TIP_TITLE_NascondiRiquadro:"Nascondi",TIP_TITLE_ChiudiForm:"Chiudi",TIP_TITLE_ModalConfirm:"Conferma",TIP_TITLE_ChiudiAppl:"Chiudi",TIP_TITLE_MostraMenu:"Mostra menu",TIP_TITLE_NascondiMenu:"Nascondi menu",TIP_TITLE_BookInizio:"Inizio",TIP_TITLE_BookPaginaPrec:"Pagina precedente",TIP_TITLE_BookPaginaSucc:"Pagina successiva",TIP_TITLE_BookFine:"Fine",TIP_TITLE_CreatePDF:"Stampa",TIP_TITLE_CaricaDoc:"Carica",TIP_TITLE_CancellaDoc:"Cancella",TIP_TITLE_VisualizzaDocumento:"Visualizza",TIP_TITLE_SelectPopupCmd:"Nascondi Multiselezione",WEP_CAL_DayNames:new Array("lu","ma","me","gi","ve","sa","do"),WEP_CAL_MonthNames:new Array("gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"),WEP_CAL_CloseButtonCaption:"Chiudi",DDM_STATUS_Moving:"Muovi da |1 a |2",DDM_STATUS_Resizing:"Ridimensiona da |1 a |2",DLG_DELAY_Abort:"Sei sicuro di voler annullare l''operazione?",MSG_POPUP_MsgBoxCaption:"Messaggio",MSG_POPUP_MsgConfirmCaption:"Conferma",MSG_POPUP_MsgInputCaption:"Inserisci",MSG_POPUP_MsgErrorCaption:"Errore",MSG_POPUP_OkButton:"OK",MSG_POPUP_CancelButton:"Annulla",MSG_POPUP_YesButton:"Ok",MSG_POPUP_NoButton:"Annulla",PAN_MSG_ConfirmDeleteRS:"Confermi la cancellazione della riga selezionata del pannello |1?",PAN_MSG_ConfirmDeleteNR:"Nessuna riga selezionata. Confermi comunque la cancellazione nel pannello |1?",PAN_MSG_ConfirmDeleteRR:"Confermi la cancellazione delle |2 righe selezionate del pannello |1?",PAN_MSG_ConfirmDeleteAR:"Confermi la cancellazione di tutte le righe del pannello |1?",PAN_MSG_ConfirmDeleteBLOB:"Confermi la cancellazione del documento contenuto nel campo |1?",PAN_MSG_ConfirmDuplicateNR:"Nessuna riga selezionata. Confermi comunque la duplicazione nel pannello |1?",PAN_MSG_ConfirmExportNR:"Nessuna riga selezionata. Confermi comunque l'esportazione nel pannello |1?",PAN_STBAR_SelRow:"Selez. 1 riga su |1",PAN_STBAR_SelRows:"Selez. |2 righe su |1",WEP_POPUP_Blocked:"Il documento richiesto \350 stato bloccato dal browser",WEP_SRV_NOTFOUND:"Impossibile contattare il server dell'applicazione.\n\nPremi OK per riprovare.\n\nSe il problema persiste, contatta l'assistenza tecnica.",WEP_OWA_CANOFF:"Impossibile contattare il server dell'applicazione.\n\nPassare alla modalit\340 offline?",WEP_OWA_CANON:"Il server dell'applicazione \350 nuovamente disponibile.\n\nPassare alla modalit\340 online?",WEP_OWA_NOON:"Non sono stato in grado di tornare in modalit\340 online.\n\nL'applicazione rimane offline.",WEP_OWA_OFFLINE:"L'applicazione \350 in modalit\340 offline",MOB_SEARCH_HINT:"Cerca",MOB_TOOLBAR_TOLIST:"Torna alla lista",MOB_TOOLBAR_LIST:"Lista",MOB_SWIPE_TEXT:"Elimina",MOB_MORE_TEXT:"Mostra altre righe",MOB_PULL_TEXT:"Tira in gi\371 per aggiornare",MOB_PULL_RELEASE:"Rilascia per aggiornare",MOB_PULL_REFRESH:"Aggiornamento in corso...",IDV_WELCOME_MSG:"Cosa posso fare per te?",IDV_ERROR_SILENCE:"Non sento la tua voce, per favore controlla il volume del microfono",IDV_ERROR_NOMICRO:"Il tuo dispositivo non ha il microfono",IDV_ERROR_DENIED:"Hai negato il permesso di usare il microfono",IDV_ERROR_BLOCKED:"Il microfono \350 bloccato, <a href='chrome://settings/contentExceptions#media-stream'>clicca qui per cambiare</a>",IDE_LINK_MSG:"Inserisci il link"},ENG:{SWF_HD_FILESTATUS:"Status",SWF_HD_FILESIZE:"Size",SWF_FS_READY:"Ready",SWF_FS_UPLOADING:"Uploading ...",SWF_FS_SEND:"Sent",SWF_FS_STOPPED:"Stopped",SWF_TT_SELECTFILES:"Select files",SWF_TP_SELECTFILES:"Select the files to be sent",SWF_TT_REMOVEALL:"Remove all",SWF_TP_REMOVEALL:"Remove all files",SWF_TT_SENDALL:"Send all",SWF_TP_SENDALL:"Send all files",SWF_TT_ABORTALL:"Stop all",SWF_TP_ABORTALL:"Stop all files",SWF_TT_REMOVETHIS:"Remove this",SWF_TP_REMOVETHIS:"Remove this file",SWF_TT_SENDTHIS:"Send this",SWF_TP_SENDTHIS:"Send this file",SWF_TT_ABORTTHIS:"Stop this",SWF_TP_ABORTTHIS:"Stop sending this file",SWF_MG_UPLOADING:"Uploading |1 file ...!",SWF_ER_QUEUEEXCEEDED:"Too many files in the queue",SWF_ER_FILESIZEEXCEEDED:"File too big",SWF_ER_ZEROBYTEFILE:"Empty file",SWF_ER_INVALIDFILETYPE:"Invalid file type",SWF_ER_UNHANDLED:"Unknown error",SWF_ER_FILENOTSEND:"The file has not been uploaded.",SWF_ER_FILENOTQUEUED:"The following file has not been accepted:",SWF_ER_FILESNOTQUEUED:"The following files have not been accepted:",SWF_ER_HTTPERROR:"HTTP error",SWF_ER_UPLOADFAILED:"Upload failed",SWF_ER_IO_ERROR:"Server error (IO)",SWF_ER_SECURITY_ERROR:"Security error",SWF_ER_UPLOADEXCEEDED:"Exceeded the maximum number of files that can be sent",SWF_ER_VALIDATIONFAILED:"Invalid file",SWF_ER_FILECANCELLED:"Upload cancelled",SWF_ER_UPLOADSTOPPED:"Upload stopped",TIP_TITLE_QBETIP:"Search criteria",TIP_TITLE_PanelInizio:"Top",TIP_TITLE_PanelPaginaPrec:"Previous page",TIP_TITLE_PanelPaginaSucc:"Next page",TIP_TITLE_PanelFine:"Bottom",TIP_TITLE_TooltipCerca:"Search",TIP_TITLE_TooltipTrova:"Find",TIP_TITLE_TooltipFormList:"Change layout",TIP_TITLE_TooltipCancel:"Cancel",TIP_TITLE_TooltipRefresh:"Refresh",TIP_TITLE_TooltipDelete:"Delete",TIP_TITLE_TooltipInsert:"Insert",TIP_TITLE_TooltipDuplicate:"Duplicate",TIP_TITLE_TooltipUpdate:"Save",TIP_TITLE_Print:"Print",TIP_TITLE_TooltipExport:"Export",TIP_TITLE_ComandoAllegati:"Attachments",TIP_TITLE_ComandoGruppi:"Group",TIP_TITLE_TooltipRowSel:"Select records",TIP_TITLE_TooltipSelectAll:"Select all",TIP_TITLE_TooltipDeseleziona:"Deselect all",TIP_TITLE_TooltipUnlock:"Unlock",TIP_TITLE_TooltipLock:"Lock",TIP_TITLE_MostraRiquadro:"Expand",TIP_TITLE_NascondiRiquadro:"Collapse",TIP_TITLE_ChiudiForm:"Close",TIP_TITLE_ModalConfirm:"Confirm",TIP_TITLE_ChiudiAppl:"Close",TIP_TITLE_MostraMenu:"Show menu",TIP_TITLE_NascondiMenu:"Hide menu",TIP_TITLE_BookInizio:"Top",TIP_TITLE_BookPaginaPrec:"Previous page",TIP_TITLE_BookPaginaSucc:"Next page",TIP_TITLE_BookFine:"Bottom",TIP_TITLE_CreatePDF:"Print",TIP_TITLE_CaricaDoc:"Upload",TIP_TITLE_CancellaDoc:"Delete",TIP_TITLE_VisualizzaDocumento:"View",TIP_TITLE_SelectPopupCmd:"Hide multiple selection",WEP_CAL_DayNames:new Array("mo","tu","we","th","fr","sa","su"),WEP_CAL_MonthNames:new Array("january","february","march","april","may","june","july","august","september","october","november","december"),WEP_CAL_CloseButtonCaption:"Close",DDM_STATUS_Moving:"Moving from |1 to |2",DDM_STATUS_Resizing:"Resizing from |1 to |2",DLG_DELAY_Abort:"Are you sure you want to cancel the operation?",MSG_POPUP_MsgBoxCaption:"Message",MSG_POPUP_MsgConfirmCaption:"Confirm",MSG_POPUP_MsgInputCaption:"Input",MSG_POPUP_MsgErrorCaption:"Error",MSG_POPUP_OkButton:"OK",MSG_POPUP_CancelButton:"Cancel",MSG_POPUP_YesButton:"Ok",MSG_POPUP_NoButton:"Cancel",PAN_MSG_ConfirmDeleteRS:"Are you sure you want to delete the selected row in the |1 panel?",PAN_MSG_ConfirmDeleteNR:"No rows selected. Do you really want to delete the |1 panel?",PAN_MSG_ConfirmDeleteRR:"Are you sure you want to delete the |2 selected rows in the |1 panel?",PAN_MSG_ConfirmDeleteAR:"Are you sure you want to delete all the rows in the |1 panel?",PAN_MSG_ConfirmDeleteBLOB:"Are you sure you want to delete the document contained in the |1 field?",PAN_MSG_ConfirmDuplicateNR:"No rows selected. Confirm however the duplication in the panel |1?",PAN_MSG_ConfirmExportNR:"No rows selected. Confirm however the exportation in the panel |1?",PAN_STBAR_SelRow:"Sel. 1 row out of |1",PAN_STBAR_SelRows:"Sel. |2 rows out of |1",WEP_POPUP_Blocked:"The requested document has been locked by the browser",WEP_SRV_NOTFOUND:"Cannot connect to the application server.\n\nPress OK to try again.\n\nIf the problem persists, contact technical support.",WEP_OWA_CANOFF:"Cannot connect to the application server.\n\nDo you want to switch to offline mode?",WEP_OWA_CANON:"The application server is now available again.\n\nDo you want to switch to online mode?",WEP_OWA_NOON:"Could not switch to online mode.\n\nThe application will remain offline.",WEP_OWA_OFFLINE:"The application is in offline mode",MOB_SEARCH_HINT:"Search",MOB_TOOLBAR_TOLIST:"Return to list",MOB_TOOLBAR_LIST:"List",MOB_SWIPE_TEXT:"Delete",MOB_MORE_TEXT:"Show more rows",MOB_PULL_TEXT:"Pull down to refresh",MOB_PULL_RELEASE:"Release to refresh",MOB_PULL_REFRESH:"Refreshing...",IDV_WELCOME_MSG:"What can I do for you?",IDV_ERROR_SILENCE:"No speech was detected; you may need to adjust your microphone volume",IDV_ERROR_NOMICRO:"No microphone was found",IDV_ERROR_DENIED:"Permission to use the microphone was denied by the user",IDV_ERROR_BLOCKED:"The microphone is blocked, <a href='chrome://settings/contentExceptions#media-stream'>click here to change</a>",IDE_LINK_MSG:"Enter the link"}};var ClientMessages=ClientMessagesSet[window.RD3_AppLanguage]||ClientMessagesSet.ENG;function ClientParams(){this.GFXDef=new HashTable();this.EnableGFX=true;this.UseWebKitGFX=true;this.GFXDef.add("menu","fold:250");this.GFXDef.add("sidebar","scroll:250");this.GFXDef.add("start","fade:250");this.GFXDef.add("form","scroll-v:250!");this.GFXDef.add("frame","fold:250!");this.GFXDef.add("tree","fold:250");this.GFXDef.add("modal","zoom:250!");this.GFXDef.add("list","scroll-h:250!");this.GFXDef.add("tab","scroll-h:250!");this.GFXDef.add("popup","scroll:250");this.GFXDef.add("graph","fade:250");this.GFXDef.add("book","scroll:250!");this.GFXDef.add("message","fold:250");this.GFXDef.add("lastmessage","fade:250");this.GFXDef.add("qbetip","fade:250");this.GFXDef.add("redirect","fade:250!");this.GFXDef.add("preview","scroll:250!");this.GFXDef.add("docked","scroll:250!");this.GFXDef.add("popupres","fold:250!");this.GFXDef.add("tooltip","fade:250");this.GFXDef.add("taskbar","fold:250");this.GFXDef.add("combo","scroll:250");this.GFXDef.add("group","fold:250");this.GFXDef.add("zone","scroll:250!");this.GFXDef.add("unpinned","scroll:250!");this.SoundDef=new HashTable();this.EnableSound=true;this.SoundDef.add("close","close.mp3");this.SoundDef.add("open","open.mp3");this.SoundDef.add("delete","delete.mp3");this.SoundDef.add("update","update.mp3");this.SoundDef.add("login","login.mp3");this.SoundDef.add("logoff","logoff.mp3");this.SoundDef.add("command","command.mp3");this.SoundDef.add("info","info.mp3");this.SoundDef.add("warning","warning.mp3");this.SoundDef.add("error","error.mp3");this.HilightTreeNodes=true;this.ShowAjaxIndicator=true;this.DragSensibility=RD3_Glb.IsMobile()?-1:6;this.MinSize=4;this.ResizeLimit=RD3_Glb.IsTouch()?12:4;this.ChgResMM=1;this.ChgResIN=0.04;this.MoveBorders="";this.MaxOpenRequests=2;this.DelayDlgTime=RD3_Glb.IsMobile()?1500:5000;this.DelayDlgShowTime=1500;this.SuperActiveDelay=200;this.DelayTimes=new HashTable();this.DelayTimes.add("panscr",50);this.PopupDlgMinW=240;this.PopupInputMinW=400;this.PopupProgressSpeed=2;this.MaxMessagesBoxHeight="54px";this.MinMessagesBoxHeight=22;this.StandardPadding=RD3_Glb.IsMobile()?0:2;this.RowSelWidth=20;this.ActivatorWidth=(RD3_Glb.IsTouch()||RD3_Glb.IsMobile())?26:17;this.BlobButtonWidth=(RD3_Glb.IsTouch()||RD3_Glb.IsMobile())?28:22;this.TabWidth=100;this.TabWidthThin=40;this.HLDBorderWidth=2;this.FKActField=2;this.FKEnterQBE=3;this.FKFindData=3;this.FKFormList=4;this.FKRefresh=6;this.FKCancel=6;this.FKInsert=7;this.FKDelete=8;this.FKUpdate=9;this.FKLocked=11;this.FKActRow=12;this.FKSelAll=14;this.FKSelNone=15;this.FKSelTog=16;this.FKDuplicate=19;this.FKCloseForm=26;this.FKPrint=36;this.DefaultButton=true;this.ComboPopupMinHeight=14;this.ComboPopupMaxHeight=210;this.ComboActivatorSize=(RD3_Glb.IsTouch()||RD3_Glb.IsMobile())?24:15;this.ComboImageSize=RD3_Glb.IsMobile()?30:16;this.ComboNameSeparator="; ";this.TaskMenuAccellCode=220;this.KeyPressEventType=RD3_Glb.EVENT_ACTIVE;this.DelayTimes.add("keypress",350);this.SideMenuResizable=true;this.SideMenuMinWidth=120;this.DockedMinResize=100;this.FrameMinimumSize=50;this.FrameBorderTop=1;this.FrameBorderLeft=1;this.TouchMoveLimit=24;this.TouchHLDelay=300;this.RedirectWhenBlocked=RD3_Glb.IsTouch()?!window.navigator.standalone:true;this.AlertWhenBlocked=true;this.OWAOfflineCheck=60;this.MobileScrollbarOnTouchUp=true;this.MobileRetina=true;this.VoiceAutoCommitDelay=2000;this.AutoDefaultFormatting=false;this.EditorToolbarIE7Color="rgb(230, 235, 240)";this.EditorHilightIE7Color="rgb(205, 213, 221)";this.EditorPressIE7Color="rgb(187, 195, 202)"}ClientParams.prototype.GetColorHL1=function(){if(RD3_Glb.IsQuadro()){return RD3_DesktopManager.WebEntryPoint.AccentColor}else{if(RD3_Glb.IsMobile7()){return"rgb(200, 200, 200)"}else{return"rgb(5, 140, 245)"}}};ClientParams.prototype.GetColorHL2=function(){if(RD3_Glb.IsQuadro()){return RD3_DesktopManager.WebEntryPoint.AccentColor}else{if(RD3_Glb.IsMobile7()){return"rgb(200, 200, 200)"}else{return"rgb(1, 95, 230)"}}};ClientParams.prototype.GetColorMenu1=function(){if(RD3_Glb.IsQuadro()){return"#777777"}else{return"#e8eaed"}};ClientParams.prototype.GetColorMenu2=function(){if(RD3_Glb.IsQuadro()){return"#363636"}else{return"#c0c4cc"}};ClientParams.prototype.ZoneUnpinnedSize=function(a){if(RD3_Glb.IsMobile()){if(a){return 72}else{return 50}}else{return 25}};function DDManager(){this.IsDragging=false;this.InDetection=false;this.DragObj=null;this.DragElem=null;this.CloneElem=null;this.LastDropObj=null;this.XPos=0;this.YPos=0;this.DropList=null;this.TrasfElem=null;this.TrasfObj=null;this.TrasfXMode=0;this.TrasfYMode=0;this.IsResizing=false;this.OrigLeft=0;this.OrigTop=0;this.OrigWidth=0;this.OrigHeight=0;this.TrueOrigLeft=0;this.TrueOrigTop=0;this.TrueOrigWidth=0;this.TrueOrigHeight=0;this.ResElem=null;this.HLDropElem=null;this.HLDragElem=null;this.ScrollTimerID=0;this.LButtonDown=false;this.OpenCombo=null;this.iOpenPopup=new Array();this.MD_XPos=0;this.MD_YPos=0;this.MD_Time=0;this.MD_Button=0;this.MD_Target=null;this.MD_Clicked=false;this.Init()}DDManager.prototype.Init=function(){var d=new Function("ev","return RD3_DDManager.OnMouseDown(ev)");var i=new Function("ev","return RD3_DDManager.OnMouseUp(ev)");var c=new Function("ev","return RD3_DDManager.OnMouseMove(ev)");var b=new Function("ev","return RD3_DDManager.OnMouse(ev, 'over')");var a=new Function("ev","return RD3_DDManager.OnMouse(ev, '')");var e=new Function("ev","return false");var h=new Function("ev","return RD3_DDManager.OnSelectStart(ev)");var f=new Function("ev","return RD3_DDManager.OnAllClicks(ev)");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){document.addEventListener("touchmove",c,false);document.addEventListener("touchstart",d,false);document.addEventListener("touchend",i,false);document.addEventListener("mouseover",b,false);document.addEventListener("mouseout",a,false);if(RD3_Glb.IsAndroid()){document.addEventListener("click",f,true)}}else{if(document.addEventListener){document.addEventListener("mousemove",c,false);document.addEventListener("mousedown",d,false);document.addEventListener("mouseup",i,false);document.addEventListener("mouseover",b,false);document.addEventListener("mouseout",a,false);var g=new Function("ev","return RD3_DDManager.OnGeneralDrag(ev)");document.addEventListener("dragover",g,false);if(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsTouch()){document.addEventListener("click",f,true)}}else{document.attachEvent("onmousemove",c);document.attachEvent("onmousedown",d);document.attachEvent("onmouseup",i);document.attachEvent("onmouseover",b);document.attachEvent("onmouseout",a);document.attachEvent("ondragstart",e)}}document.body.onselectstart=h;this.ResElem=document.createElement("div");this.ResElem.setAttribute("id","resize-object");this.HLDragElem=document.createElement("div");this.HLDragElem.setAttribute("id","drag-object");this.HLDragElem.style.display="none";document.body.appendChild(this.HLDragElem);this.HLDropElem=document.createElement("div");this.HLDropElem.setAttribute("id","drop-target");this.HLDropElem.style.display="none";document.body.appendChild(this.HLDropElem)};DDManager.prototype.OnMouseDown=function(w){if(RD3_Glb.IsTouch()&&this.OpenCombo){return}var j=(window.event)?window.event.clientX:w.clientX;var i=(window.event)?window.event.clientY:w.clientY;this.OnMouse(w,"down");if(this.OpenCombo){this.OpenCombo.OnMouseDown(w)}if(RD3_DesktopManager.WebEntryPoint.UseZones()){for(var g=2;g<=5;g++){RD3_DesktopManager.WebEntryPoint.GetScreenZone(g).OnMouseDown(w)}}var m=((window.event)?window.event.button:w.button);this.LButtonDown=(m==(RD3_Glb.IsIE(11,false)?1:0));var s=(window.event)?window.event.srcElement:w.explicitOriginalTarget;var f=RD3_DesktopManager.WebEntryPoint.HilightedCell;var c=(s&&s.className&&s.className.indexOf&&s.className.indexOf("cke")>=0?true:false);if(f&&f.ControlType==101&&f.ParentField&&!c&&!RD3_ServerParams.UseIDEditor){var b=f.ParentField.Identifier+(f.InList?":lcke":":fcke");f.ParentField.OnFCKSelectionChange(CKEDITOR.instances[b])}if((RD3_Glb.IsChrome()||RD3_Glb.IsFirefox())&&f&&f.ControlType==101&&f.ParentField&&RD3_ServerParams.UseIDEditor&&f.IntCtrl.ImgAdded){f.IntCtrl.OnLoseFocus();f.IntCtrl.ImgAdded=false}var r=(s&&s.tagName=="IMG");var n=r&&RD3_Glb.IsIE(10,true);if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){if(w.targetTouches.length!=1){return false}if(RD3_Glb.CanScroll(w.target)){return}var k=RD3_Glb.ElementFromPoint(w.targetTouches[0].clientX,w.targetTouches[0].clientY);if(k&&((k.tagName=="INPUT"&&k.type!="button")||k.tagName=="TEXTAREA"||RD3_Glb.isInsideEditor(k))){k.focus();return false}if(k&&k.tagName=="CANVAS"){return false}w.preventDefault();j=w.targetTouches[0].clientX;i=w.targetTouches[0].clientY;this.TouchOrgX=j;this.TouchOrgY=i;m=0;this.LButtonDown=true;s=RD3_Glb.ElementFromPoint(j,i);w.clientX=j;w.clientY=i;w.button=0;w.target=s;r=true;this.OnMouseMove(w);this.SetMouseOver(s);this.TouchEvent=w;this.TouchTimer=window.setTimeout("RD3_DDManager.OnTouchRight()",750);this.TouchMove=false;this.HandleTouchEvent(s,"down",w)}if(this.IsDragging){this.Reset()}if(this.TrasfObj!=null&&(this.TrasfXMode!=0||this.TrasfYMode!=0)){this.IsResizing=true;document.body.appendChild(this.ResElem);this.OrigLeft=RD3_Glb.GetScreenLeft(this.TrasfElem)-2;this.OrigTop=RD3_Glb.GetScreenTop(this.TrasfElem)-2;this.OrigWidth=this.TrasfElem.clientWidth;this.OrigHeight=this.TrasfElem.clientHeight;this.TrueOrigLeft=this.OrigLeft;this.TrueOrigTop=this.OrigTop;this.TrueOrigWidth=this.OrigWidth;this.TrueOrigHeight=this.OrigHeight;this.ResElem.style.left=this.OrigLeft+"px";this.ResElem.style.top=this.OrigTop+"px";this.ResElem.style.width=this.OrigWidth+"px";this.ResElem.style.height=this.OrigHeight+"px";this.ResElem.style.cursor=this.TrasfElem.style.cursor;this.XPos=j;this.YPos=i;r=true}if(!this.IsResizing){var l=(window.event)?window.event.srcElement:w.target;var p=RD3_Glb.GetRD3ObjectId(l);var t=this.GetDraggableObject(p);var o=false;if(t&&!this.IsOnScrollBar(l,j,i)){this.DragObj=t;this.XPos=j;this.YPos=i;this.InDetection=true;if(RD3_Glb.IsMobile()){o=true}}if(this.TrasfObj!=null){this.XPos=j;this.YPos=i;this.InDetection=true}if(this.InDetection){r=true}if(o){this.OnMouseMove(w)}if(this.InDetection){try{if(s.tagName!="INPUT"&&s.tagName!="TEXTAREA"){RD3_KBManager.IDRO_GetFocus(w)}}catch(u){}}}var h=false;var v=new Date();if(v-this.MD_Time<400&&Math.abs(j-this.MD_XPos)<4&&Math.abs(i-this.MD_YPos)<4){h=true}if(!h){this.MD_XPos=j;this.MD_YPos=i;this.MD_Time=v;this.MD_Button=m;this.MD_Target=s;this.MD_Clicked=false}if((r&&!RD3_Glb.IsIE())||n){var a=s;var z=(window.event)?window.event:w;while(a){if(RD3_Glb.HasClass(a,"frame-container")){break}a=a.parentNode}if(a){var q=this.GetObject(a.id);if(q&&q instanceof WebFrame){q.OnMouseDown(z)}}RD3_KBManager.SurrogateChangeEvent();if(!RD3_Glb.IsMobile()&&this.InDetection&&s&&(s.tagName=="INPUT"||s.tagName=="TEXTAREA")){try{s.focus()}catch(u){}}RD3_Glb.StopEvent(z);return false}};DDManager.prototype.OnMouseUp=function(K){if(RD3_Glb.IsTouch()&&this.OpenCombo){return}var u=(window.event)?window.event.srcElement:K.target;var l=(window.event)?window.event.clientX:K.clientX;var k=(window.event)?window.event.clientY:K.clientY;var n=false;if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){if(this.TouchTimer){window.clearTimeout(this.TouchTimer);this.TouchTimer=0}if(K.targetTouches.length!=0&&K.changedTouches.length!=1){return false}if(RD3_Glb.CanScroll(K.target)){return}if(RD3_Glb.IsAndroid()){var E=K&&K.target?K.target:null;if(E&&((E.tagName=="INPUT"&&E.type!="button")||E.tagName=="TEXTAREA"||RD3_Glb.isInsideEditor(E))){return false}}if(K&&K.target&&K.target.tagName=="CANVAS"){return false}K.preventDefault();l=K.changedTouches[0].clientX;k=K.changedTouches[0].clientY;u=RD3_Glb.ElementFromPoint(l,k);K.clientX=l;K.clientY=k;K.button=0;K.target=u;if(!this.TouchMove){this.HandleTouchEvent(u,"up",K)}this.ResetMouseOver()}var C=RD3_KBManager.ActiveObject;if(C&&C instanceof PCell){C=C.ParentField}if(C&&C.SendtextSelChange&&C.UseTextSel){var z=C.StartSel;var g=C.EndSel;C.SendtextSelChange(RD3_KBManager.ActiveElement);if(z==C.StartSel&&g==C.EndSel&&z!=-1){if(RD3_KBManager.SelTextTimer){window.clearTimeout(RD3_KBManager.SelTextTimer);RD3_KBManager.SelTextSrc=null;RD3_KBManager.SelTextObj=null}var f=RD3_Glb.IsIE()?500:50;RD3_KBManager.SelTextTimer=window.setTimeout(new Function("ev","if (RD3_KBManager.SelTextObj && RD3_KBManager.SelTextObj.SendtextSelChange){RD3_KBManager.SelTextObj.SendtextSelChange(RD3_KBManager.SelTextSrc);}"),f);RD3_KBManager.SelTextSrc=RD3_KBManager.ActiveElement;RD3_KBManager.SelTextObj=C}}if(this.IsDragging){var L=null;if(this.DragObj){L=this.GetDroppableObject(l,k)}if(L&&L.OnDrop){n=L.OnDrop(this.DragObj,(window.event)?window.event:K)}if(!n){n=(RD3_DesktopManager.WebEntryPoint.OnDrop(L,this.DragObj,(window.event)?window.event:K))}}if(this.IsResizing||(this.IsDragging&&!n&&this.TrasfObj)){if(RD3_Glb.IsIE()&&this.DragElem&&this.CloneElem){var B=this.DragElem.getElementsByTagName("input");var m=this.CloneElem.getElementsByTagName("input");if(B.length==m.length){for(var F=0;F<m.length;F++){if(m[F].type=="radio"){B[F].checked=m[F].checked}}}}var u,s;if(this.IsResizing){u=this.ResElem;s=this.TrasfElem}else{u=this.CloneElem;s=this.DragElem}var e=(this.TrasfObj&&this.TrasfObj.CanMoveX)?this.TrasfObj.CanMoveX():true;var b=(this.TrasfObj&&this.TrasfObj.CanMoveY)?this.TrasfObj.CanMoveY():true;var D=s.style.width;var M=D.indexOf("px")==-1?parseFloat(s.style.width)/s.clientWidth:1;if(this.IsResizing&&RD3_Glb.IsChrome()){var A=this.DragElem;while(A){if(A.origScrollLeft!=undefined){this.TrueOrigLeft-=(A.scrollLeft-A.origScrollLeft)}if(A.origScrollTop!=undefined){this.TrueOrigTop-=(A.scrollTop-A.origScrollTop)}A=A.parentNode}}var r=e?(u.offsetLeft-this.TrueOrigLeft)*M:0;var q=b?(u.offsetTop-this.TrueOrigTop)*M:0;var t=(u.clientWidth-this.TrueOrigWidth)*M;var I=(u.clientHeight-this.TrueOrigHeight)*M;var l=parseFloat(s.style.left)+r;var k=parseFloat(s.style.top)+q;var p=parseFloat(s.style.width)+t;var G=parseFloat(s.style.height)+I;if(s.style.borderLeftWidth){p+=s.style.borderLeftWidth.indexOf("pt")!=-1?(parseFloat(s.style.borderLeftWidth)*72)/96:parseFloat(s.style.borderLeftWidth)}if(s.style.borderRightWidth){p+=s.style.borderRightWidth.indexOf("pt")!=-1?(parseFloat(s.style.borderRightWidth)*72)/96:parseFloat(s.style.borderRightWidth)}if(s.style.borderTopWidth){G+=s.style.borderTopWidth.indexOf("pt")!=-1?(parseFloat(s.style.borderTopWidth)*72)/96:parseFloat(s.style.borderTopWidth)}if(s.style.borderBottomWidth){G+=s.style.borderBottomWidth.indexOf("pt")!=-1?(parseFloat(s.style.borderBottomWidth)*72)/96:parseFloat(s.style.borderBottomWidth)}if(this.TrasfObj.AdaptCoords){var c=new Rect(l,k,p,G);this.TrasfObj.AdaptCoords(c);l=c.x;k=c.y;p=c.w;G=c.h}this.TrasfObj.OnTransform(l,k,p,G,(window.event)?window.event:K)}var H=false;if(n&&this.DragObj&&this.DragObj.WantDropRestore){H=this.DragObj.WantDropRestore()}if(this.TrasfObj!=null&&this.TrasfXMode==0&&this.TrasfYMode==0&&this.TrasfObj.CanCancelMove){H=!this.TrasfObj.CanCancelMove()}this.Reset(H);this.LButtonDown=false;l=(window.event)?window.event.clientX:K.clientX;k=(window.event)?window.event.clientY:K.clientY;var v=((window.event)?window.event.button:K.button);var J=new Date();if(Math.abs(l-this.MD_XPos)<4&&Math.abs(k-this.MD_YPos)<4&&v==this.MD_Button){var j=false;if(this.MD_Clicked&&J-this.MD_Time<400){j=true}if(j&&!RD3_Glb.IsIE()&&this.MD_Target&&this.MD_Target.className=="panel-field-caption-list"){RD3_KBManager.IDRO_DoubleClick(K)}this.MD_Clicked=!j}};DDManager.prototype.OnMouseMove=function(E){if(RD3_Glb.IsTouch()&&this.OpenCombo){return}var n=(window.event)?window.event.clientX:E.clientX;var m=(window.event)?window.event.clientY:E.clientY;var s=(window.event)?window.event.srcElement:E.target;if(RD3_Glb.IsIE()&&!s&&E&&E.srcElement){s=E.srcElement}if(s&&s.ownerDocument!=document&&RD3_DesktopManager.WebEntryPoint.WelcomeBox.contentWindow&&s.ownerDocument==RD3_DesktopManager.WebEntryPoint.WelcomeBox.contentWindow.document){n+=RD3_Glb.GetScreenLeft(RD3_DesktopManager.WebEntryPoint.WelcomeBox);m+=RD3_Glb.GetScreenTop(RD3_DesktopManager.WebEntryPoint.WelcomeBox)}if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){if(E.targetTouches.length!=1){return false}if(RD3_Glb.CanScroll(E.target)){return}E.preventDefault();n=E.targetTouches[0].clientX;m=E.targetTouches[0].clientY;s=RD3_Glb.ElementFromPoint(n,m);if(s==null){return}if(Math.abs(n-this.TouchOrgX)>RD3_ClientParams.TouchMoveLimit||Math.abs(m-this.TouchOrgY)>RD3_ClientParams.TouchMoveLimit){this.TouchMove=true;this.ResetMouseOver();this.HandleTouchEvent(s,"move",E)}}if(this.ScrollTimerID!=0){window.clearInterval(this.ScrollTimerID);this.ScrollTimerID=0}if(this.InDetection){if(Math.abs(n-this.XPos)>RD3_ClientParams.DragSensibility||Math.abs(m-this.YPos)>RD3_ClientParams.DragSensibility){if(this.TouchTimer){window.clearTimeout(this.TouchTimer);this.TouchTimer=0}this.StartDrag(E)}RD3_DesktopManager.WebEntryPoint.CmdObj.ClosePopup()}if(this.IsDragging){var c=(this.TrasfObj&&this.TrasfObj.CanMoveX)?this.TrasfObj.CanMoveX():true;var b=(this.TrasfObj&&this.TrasfObj.CanMoveY)?this.TrasfObj.CanMoveY():true;var q=c?n-this.XPos:0;var p=b?m-this.YPos:0;this.CloneElem.style.left=(q+this.OrigLeft)+"px";this.CloneElem.style.top=(p+this.OrigTop)+"px";this.CloneElem.style.display="block";var F=null;if(this.DragObj){F=this.GetDroppableObject(n,m)}if(F&&F.DropElement){s=F.DropElement()}if(F){this.CloneElem.style.cursor="pointer"}else{this.CloneElem.style.cursor="not-allowed"}this.HLDropObj(F);this.UpdateStatusBar();this.CheckScrollbar(n,m)}if(this.IsResizing){var q=n-this.XPos;var p=m-this.YPos;var z=(this.TrasfXMode==-1)?q:0;var u=(this.TrasfYMode==-1)?p:0;var t=this.TrasfXMode*q;var D=this.TrasfYMode*p;if(this.OrigWidth+t<RD3_ClientParams.MinSize){t=-this.OrigWidth+RD3_ClientParams.MinSize}if(this.OrigHeight+D<RD3_ClientParams.MinSize){D=-this.OrigHeight+RD3_ClientParams.MinSize}this.ResElem.style.left=(this.OrigLeft+z)+"px";this.ResElem.style.top=(this.OrigTop+u)+"px";this.ResElem.style.width=(this.OrigWidth+t)+"px";this.ResElem.style.height=(this.OrigHeight+D)+"px";this.CheckScrollbar(n,m);this.UpdateStatusBar()}if(!this.InDetection&&!this.IsDragging&&!this.IsResizing){var B=this.GetTransformableObject(s.id,s,n,m);if(this.IsOnScrollBar(s,n,m)){B=null}if(B==null&&this.TrasfObj!=null){if(this.TrasfObj.ApplyCursor){this.TrasfObj.ApplyCursor("")}else{RD3_Glb.ApplyCursor(this.TrasfElem,"")}}this.TrasfObj=B;if(this.TrasfObj){if(this.TrasfObj.DropElement){s=this.TrasfObj.DropElement()}var g=n-RD3_Glb.GetScreenLeft(s);var f=m-RD3_Glb.GetScreenTop(s);this.TrasfElem=s;var C=RD3_Glb.GetScreenLeft(this.TrasfElem);var A=C+s.offsetWidth;var e=RD3_Glb.GetScreenTop(this.TrasfElem);var d=e+s.offsetHeight;var h=(this.TrasfObj.CanResizeW)?this.TrasfObj.CanResizeW():true;var v=(this.TrasfObj.CanResizeH)?this.TrasfObj.CanResizeH():true;var r=(this.TrasfObj.CanResizeL)?this.TrasfObj.CanResizeL():true;var l=(this.TrasfObj.CanResizeR)?this.TrasfObj.CanResizeR():true;var i=(this.TrasfObj.CanResizeT)?this.TrasfObj.CanResizeT():true;var w=(this.TrasfObj.CanResizeD)?this.TrasfObj.CanResizeD():true;if(g<=RD3_ClientParams.ResizeLimit&&h&&r){this.TrasfXMode=-1}else{if(this.TrasfElem.offsetWidth-g<=RD3_ClientParams.ResizeLimit&&h&&l){this.TrasfXMode=1}else{this.TrasfXMode=0}}if(f<=RD3_ClientParams.ResizeLimit&&v&&i){this.TrasfYMode=-1}else{if(this.TrasfElem.offsetHeight-f<=RD3_ClientParams.ResizeLimit&&v&&w){this.TrasfYMode=1}else{this.TrasfYMode=0}}var k="";switch(this.TrasfXMode){case -1:switch(this.TrasfYMode){case -1:k="nw-resize";break;case 0:k="e-resize";break;case 1:k="sw-resize";break}break;case 0:switch(this.TrasfYMode){case -1:k="n-resize";break;case 0:k="move";break;case 1:k="n-resize";break}break;case 1:switch(this.TrasfYMode){case -1:k="sw-resize";break;case 0:k="e-resize";break;case 1:k="nw-resize";break}break}var o=true;var j=true;if(this.TrasfObj.IsMoveable){o=this.TrasfObj.IsMoveable()}if(this.TrasfObj.IsResizable){j=this.TrasfObj.IsResizable()}if(o&&!j){this.TrasfXMode=0;this.TrasfYMode=0;k="move"}else{if(!o&&j){if(this.TrasfXMode==0&&this.TrasfYMode==0){k="";if(this.TrasfObj.ApplyCursor){this.TrasfObj.ApplyCursor(k)}else{RD3_Glb.ApplyCursor(this.TrasfElem,k)}this.TrasfObj=null}}}if(this.TrasfObj){if(this.TrasfObj.ApplyCursor){this.TrasfObj.ApplyCursor(k)}else{RD3_Glb.ApplyCursor(this.TrasfElem,k)}}}}};DDManager.prototype.GetObject=function(b,c){if(!b){return null}var j=RD3_DesktopManager.ObjectMap[b];if(j==null&&b=="welcome"){j=RD3_DesktopManager.WebEntryPoint.WelcomeForm}if(j==null){var e=false;var d=b.indexOf(":lv");if(d<=0){d=b.indexOf(":fv");e=true}if(d>0){if(c){var l=b.substr(0,d);var i=(e)?0:parseInt(b.substr(d+3,9999));j=RD3_DesktopManager.ObjectMap[l];if(j){var g=j.ParentPanel.ActualPosition+i;var h=j.ParentPanel.ListGroupRoot;if(j.ParentPanel.IsGrouped()){g=j.ParentPanel.GetRowIndex(i)}if(j.ParentPanel.PanelMode!=RD3_Glb.PANEL_FORM&&e){g=j.ParentPanel.ActualPosition+j.ParentPanel.ActualRow;if(h!=null){g=j.ParentPanel.GetRowIndex(j.ParentPanel.ActualRow)}}if(j.ParentPanel.PanelMode!=RD3_Glb.PANEL_LIST&&!e){g=j.ParentPanel.ActualPosition;if(h!=null){g=j.ParentPanel.GetRowIndex(0)}}if(!j.ListList){g=j.ParentPanel.ActualPosition+j.ParentPanel.ActualRow;if(h!=null){g=j.ParentPanel.GetRowIndex(j.ParentPanel.ActualRow)}}return j.PValues[g]}}else{b=b.substr(0,d)}}var f=b.indexOf(":lsg:");if(f!=-1){b=b.substr(0,f)}var k=b.substr(b.length-4);if(k==":cap"||k==":txt"||k==":img"||k==":div"||k==":frl"||k==":clo"||k==":con"||k==":min"||k==":max"||k==":hlp"||k==":dbg"||k.substring(0,3)==":bd"||k==":lht"||k==":hdr"||k==":tdi"||k==":bba"||k==":tlc"){b=b.substr(0,b.length-4)}var k=b.substr(b.length-5);if(k==":link"||k==":fcke"||k==":lcke"||k==":html"){b=b.substr(0,b.length-5)}var k=b.substr(b.length-6);if(k==":tcmb1"||k==":tcmb2"||k==":tcmb3"){b=b.substr(0,b.length-6)}var k=b.substr(b.length-7);if(k==":header"||k==":status"){b=b.substr(0,b.length-7)}var k=b.substr(b.length-8);if(k==":menusep"){b=b.substr(0,b.length-8)}k=b.substr(b.length-3);if(k==":fc"||k==":lc"||k==":bb"){b=b.substr(0,b.length-3)}if(b=="forms-container"||b.indexOf("dock-container")!=-1){b="wep"}k=b.substr(0,3);if(k=="tl:"){b=b.substr(3)}j=RD3_DesktopManager.ObjectMap[b];if(!j&&(b.substr(0,4)=="pan:"||b.substr(0,4)=="cmb:")){j=RD3_DesktopManager.ObjectMap[b.substr(0,b.lastIndexOf(":"))]}}return j};DDManager.prototype.GetDraggableObject=function(c){var b=this.GetObject(c);if(b){if(b.IsDraggable){if(!b.IsDraggable(c)){b=null}else{if(b.DragObj){b=b.DragObj(c)}}}else{b=null}}return b};DDManager.prototype.GetTransformableObject=function(f,d,b,e){if(!f){return null}var c=this.GetObject(f);if(c){if(c.IsTransformable){if(!c.IsTransformable(f)){c=null}else{if(c.DragObj){c=c.DragObj(f,d,b,e)}}}else{c=null}}return c};DDManager.prototype.GetDroppableObject=function(l,h){if(!this.DropList){return null}var o=new Array();var c=this.DropList.length;for(var f=c-1;f>=0;f--){var e=this.DropList[f];this.DragObj2=false;var q=(e.AbsLeft<=l&&e.AbsRight>=l&&e.AbsTop<=h&&e.AbsBottom>=h);if(!q&&e.AbsLeft2){q=(e.AbsLeft2<=l&&e.AbsRight2>=l&&e.AbsTop2<=h&&e.AbsBottom2>=h);this.DragObj2=true}if(q){var j=true;if(e.GetParentFrame){j=false;var g=e.GetParentFrame();if(g){var b=g.ContentBox;var d=RD3_Glb.GetScreenLeft(b,true);var m=RD3_Glb.GetScreenTop(b,true);var a=d+b.clientWidth;var k=m+b.clientHeight;if(d<e.AbsRight&&a>e.AbsLeft&&m<e.AbsBottom&&k>e.AbsTop){j=true}}}if(j){if(e instanceof WebForm){return null}else{return e}}}}return null};DDManager.prototype.Reset=function(b){if(this.CloneElem&&!b){this.CloneElem.parentNode.removeChild(this.CloneElem);this.CloneElem=null}if(this.ResElem.parentNode){this.ResElem.parentNode.removeChild(this.ResElem)}if(this.DragElem&&!b){this.DragElem.style.visibility="";if(RD3_Glb.IsWebKit()||RD3_Glb.IsFirefox()){var d=this.DragElem.getElementsByTagName("input");var c=d.length;for(var a=0;a<c;a++){if(d[a].orgChecked){d[a].checked=true;d[a].orgChecked=undefined}}}this.DragElem=null}this.HLDropObj();this.HLDragElem.style.display="none";this.IsDragging=false;this.InDetection=false;this.IsResizing=false;this.DragObj=null;this.DropList=null;this.XPos=0;this.YPos=0;this.TrasfObj=null;this.TrasfElem=null;this.TrasfXMode=0;this.TrasfYMode=0;window.defaultStatus=""};DDManager.prototype.StartDrag=function(t){if(!this.DragObj&&!this.TrasfObj){return}this.InDetection=false;this.IsDragging=true;var j=this.TrasfObj?this.TrasfObj:this.DragObj;if(j&&j.DropElement){this.DragElem=j.DropElement()}if(j&&j.GetDropList){this.DropList=j.GetDropList()}else{this.DropList=RD3_DesktopManager.WebEntryPoint.GetDropList(j)}if(j.CreateDragImage){this.CloneElem=j.CreateDragImage()}else{if(RD3_Glb.IsWebKit()||RD3_Glb.IsFirefox()){var f=this.DragElem.getElementsByTagName("input");var p=f.length;for(var r=0;r<p;r++){if(f[r].type=="radio"){f[r].orgChecked=f[r].checked}}}this.CloneElem=this.DragElem.cloneNode(true);if(RD3_Glb.IsWebKit()||RD3_Glb.IsFirefox()){if(this.DragElem.type=="textarea"){this.CloneElem.value=this.DragElem.value}else{var c=this.DragElem.getElementsByTagName("textarea");var g=this.CloneElem.getElementsByTagName("textarea");var p=c.length;for(var r=0;r<p;r++){g[r].value=c[r].value}}}if(RD3_Glb.IsIE()){var m=this.DragElem.getElementsByTagName("input");var h=this.CloneElem.getElementsByTagName("input");var p=m.length;for(var r=0;r<p;r++){if(h[r].type=="checkbox"){h[r].checked=m[r].checked}}}if(this.DragElem.tagName=="SPAN"||this.DragElem.tagName=="IMG"){var u=document.createElement("div");u.appendChild(this.CloneElem);this.CloneElem.style.top="0px";this.CloneElem.style.left="0px";this.CloneElem=u}}this.CloneElem.style.display="none";this.CloneElem.style.position="absolute";this.CloneElem.id="clone-element";var a="";if(RD3_Glb.IsMobile()){var e=1.5;var v=this.DragElem.offsetWidth;if(v<this.DragElem.offsetHeight){v=this.DragElem.offsetHeight}if(v<60&&v>0){e=e*(60/v);if(e>8){e=8}}a="RD3_Glb.SetTransform(document.getElementById('clone-element'), 'scale3d("+e+","+e+",1)');";var k=RD3_KBManager.GetObject(this.DragElem,true);if(k&&k.OnTouchUp){k.OnTouchUp(t,true,this.DragElem)}}if(!j.NoOpacity){if(RD3_Glb.IsMobile()){a+=";document.getElementById('clone-element').style.opacity='0.6'"}else{this.CloneElem.style.opacity="0.6";this.CloneElem.style.filter="alpha(opacity=60)"}}if(a!=""){window.setTimeout(a,50)}if(this.DragElem.tagName=="SPAN"){this.CloneElem.style.width=(this.DragElem.offsetWidth+4)+"px";this.CloneElem.style.height=(this.DragElem.offsetHeight)+"px"}else{this.CloneElem.style.width=(this.DragElem.clientWidth)+"px";this.CloneElem.style.height=(this.DragElem.clientHeight)+"px"}var b=false;if(!this.TrasfObj){b=true;if(j&&j.WantDragHL){b=j.WantDragHL()}}this.OrigLeft=RD3_Glb.GetScreenLeft(this.DragElem,true);this.OrigTop=RD3_Glb.GetScreenTop(this.DragElem,true);this.OrigWidth=this.DragElem.clientWidth;this.OrigHeight=this.DragElem.clientHeight;this.TrueOrigLeft=this.OrigLeft;this.TrueOrigTop=this.OrigTop;this.TrueOrigWidth=this.OrigWidth;this.TrueOrigHeight=this.OrigHeight;if(RD3_Glb.IsChrome()){var l=this.DragElem;while(l){l.origScrollLeft=l.scrollLeft;l.origScrollTop=l.scrollTop;l=l.parentNode}}var q=0;var s=0;if(this.DragObj&&this.DragObj.AccountOverFlowX){s=this.DragObj.AccountOverFlowX()}if(this.DragObj&&this.DragObj.AccountOverFlowY){q=this.DragObj.AccountOverFlowY()}this.OrigLeft-=s;this.OrigTop-=q;if(b){this.HLDragElem.style.left=this.OrigLeft+"px";this.HLDragElem.style.top=this.OrigTop+"px";this.HLDragElem.style.width=(this.DragElem.offsetWidth)+"px";this.HLDragElem.style.height=(this.DragElem.offsetHeight)+"px";this.HLDragElem.style.display=""}else{if(RD3_ClientParams.MoveBorders!=""){this.CloneElem.style.border=RD3_ClientParams.MoveBorders}this.DragElem.style.visibility="hidden"}document.body.appendChild(this.CloneElem)};DDManager.prototype.HLDropObj=function(e){if(e==this.LastDropObj){return}this.LastDropObj=e;if(e){var b=e.AbsLeft-2;var c=e.AbsTop-2;var a=e.AbsRight-e.AbsLeft;var d=e.AbsBottom-e.AbsTop;if(this.DragObj2){b=e.AbsLeft2-2;c=e.AbsTop2-2;a=e.AbsRight2-e.AbsLeft2;d=e.AbsBottom2-e.AbsTop2}this.HLDropElem.style.left=b+"px";this.HLDropElem.style.top=c+"px";this.HLDropElem.style.width=a+"px";this.HLDropElem.style.height=d+"px";this.HLDropElem.style.display=""}else{this.HLDropElem.style.display="none"}};DDManager.prototype.UpdateStatusBar=function(){var l="";if(this.TrasfObj&&this.TrasfObj.UpdateDDStatus){var b,k;if(this.IsResizing){b=this.ResElem;k=this.TrasfElem}else{b=this.CloneElem;k=this.DragElem}var d=parseFloat(k.style.width)/k.clientWidth;var m=(b.offsetLeft-this.TrueOrigLeft)*d;var j=(b.offsetTop-this.TrueOrigTop)*d;var a=(b.clientWidth-this.TrueOrigWidth)*d;var e=(b.clientHeight-this.TrueOrigHeight)*d;var g=parseFloat(k.style.left);var f=parseFloat(k.style.top);var i=parseFloat(k.style.width);var c=parseFloat(k.style.height);l=this.TrasfObj.UpdateDDStatus(g,f,i,c,m,j,a,e,this.TrasfXMode,this.TrasfYMode)}window.defaultStatus=l};DDManager.prototype.OnKeyDown=function(c){var a=window.event?window.event:c;var b=(a.charCode)?a.charCode:a.keyCode;if(this.OpenCombo){this.OpenCombo.OnKeyDown(c)}if(b==27&&(this.IsDragging||this.IsResizing)){this.Reset()}};DDManager.prototype.OnSelectStart=function(b){if(this.IsDragging||this.IsResizing){return false}b=window.event?window.event:b;var a=(window.event)?window.event.srcElement:b.target;if(a.tagName=="INPUT"||a.tagName=="TEXTAREA"||RD3_Glb.isInsideEditor(a)){return true}else{return false}};DDManager.prototype.ScrollaBC=function(d,g,f){var l=RD3_DesktopManager.ObjectMap[d];var m=l.ContentBox;var e=false;if(m==undefined){m=l.FramesBox;e=true}var a=m.scrollTop;var b=m.scrollLeft;m.scrollTop+=f;m.scrollLeft+=g;var p=(m.scrollTop)-a;var q=(m.scrollLeft)-b;if(this.DropList){var c=this.DropList.length;for(var j=0;j<c;j++){var h=this.DropList[j];if(h.GetParentFrame){var o=h.GetParentFrame();if(o==l||(o.WebForm==l&&e)){h.AbsLeft-=q;h.AbsRight-=q;h.AbsTop-=p;h.AbsBottom-=p}}}}this.HLDropElem.style.left=(this.HLDropElem.offsetLeft-q)+"px";this.HLDropElem.style.top=(this.HLDropElem.offsetTop-p)+"px";var k=(this.DragObj)?this.DragObj.GetParentFrame():null;if(!k||k==l||(e&&k.WebForm==l)){this.HLDragElem.style.left=(this.HLDragElem.offsetLeft-q)+"px";this.HLDragElem.style.top=(this.HLDragElem.offsetTop-p)+"px"}if(this.IsResizing){if(q!=0){if(this.OrigWidth+q<RD3_ClientParams.MinSize){q=-this.OrigWidth+RD3_ClientParams.MinSize}this.ResElem.style.left=(this.OrigLeft-q)+"px";this.ResElem.style.width=(this.OrigWidth+q)+"px";this.OrigLeft-=q;this.OrigWidth+=q}if(p!=0){if(this.OrigHeight+p<RD3_ClientParams.MinSize){p=-this.OrigHeight+RD3_ClientParams.MinSize}this.ResElem.style.top=(this.OrigTop-p)+"px";this.ResElem.style.height=(this.OrigHeight+p)+"px";this.OrigTop-=p;this.OrigHeight+=p}}else{if(!RD3_Glb.IsChrome()){this.TrueOrigLeft-=q;this.TrueOrigTop-=p}}};DDManager.prototype.CheckScrollbar=function(l,j){if(RD3_Glb.IsMobile()){return}if(this.ScrollTimerID){return}var e=(this.DragObj?this.DragObj:this.TrasfObj);if(!e.GetParentFrame){return}var h=e.GetParentFrame().WebForm;var o=RD3_Glb.GetScreenTop(h.FramesBox);var c=RD3_Glb.GetScreenLeft(h.FramesBox);var a=c+h.FramesBox.clientWidth;var k=o+h.FramesBox.clientHeight;var m=RD3_Glb.IsTouch()?24:12;if(j<k&&j>k-m&&h.FramesBox.scrollHeight>h.FramesBox.clientHeight&&l>=c&&l<=a){RD3_DDManager.ScrollaBC(h.Identifier,0,12);this.ScrollTimerID=window.setInterval("RD3_DDManager.ScrollaBC('"+h.Identifier+"', 0, 12)",20)}else{if(j>o&&j<o+m&&h.FramesBox.scrollHeight>h.FramesBox.clientHeight&&l>=c&&l<=a){RD3_DDManager.ScrollaBC(h.Identifier,0,-12);this.ScrollTimerID=window.setInterval("RD3_DDManager.ScrollaBC('"+h.Identifier+"', 0, -12)",20)}else{if(l<a&&l>a-m&&h.FramesBox.scrollWidth>h.FramesBox.clientWidth&&j>=o&&j<=k){RD3_DDManager.ScrollaBC(h.Identifier,12,0);this.ScrollTimerID=window.setInterval("RD3_DDManager.ScrollaBC('"+h.Identifier+"', 12, 0)",20)}else{if(l>c&&l<c+m&&h.FramesBox.scrollWidth>h.FramesBox.clientWidth&&j>=o&&j<=k){RD3_DDManager.ScrollaBC(h.Identifier,-12,0);this.ScrollTimerID=window.setInterval("RD3_DDManager.ScrollaBC('"+h.Identifier+"', -12, 0)",20)}}}}if(this.ScrollTimerID){return}var b=h.Frames.length;for(var d=0;d<b&&!this.ScrollTimerID;d++){var g=h.Frames[d];if(g&&g.ContentBox){var o=RD3_Glb.GetScreenTop(g.ContentBox);var c=RD3_Glb.GetScreenLeft(g.ContentBox);var a=c+g.ContentBox.clientWidth;var k=o+g.ContentBox.clientHeight;if(j<k&&j>k-m&&g.ContentBox.scrollHeight>g.ContentBox.clientHeight&&l>=c&&l<=a){RD3_DDManager.ScrollaBC(g.Identifier,0,12);this.ScrollTimerID=window.setInterval("RD3_DDManager.ScrollaBC('"+g.Identifier+"', 0, 12)",20)}else{if(j>o&&j<o+m&&g.ContentBox.scrollHeight>g.ContentBox.clientHeight&&l>=c&&l<=a){RD3_DDManager.ScrollaBC(g.Identifier,0,-12);this.ScrollTimerID=window.setInterval("RD3_DDManager.ScrollaBC('"+g.Identifier+"', 0, -12)",20)}else{if(l<a&&l>a-m&&g.ContentBox.scrollWidth>g.ContentBox.clientWidth&&j>=o&&j<=k){RD3_DDManager.ScrollaBC(g.Identifier,12,0);this.ScrollTimerID=window.setInterval("RD3_DDManager.ScrollaBC('"+g.Identifier+"', 12, 0)",20)}else{if(l>c&&l<c+m&&g.ContentBox.scrollWidth>g.ContentBox.clientWidth&&j>=o&&j<=k){RD3_DDManager.ScrollaBC(g.Identifier,-12,0);this.ScrollTimerID=window.setInterval("RD3_DDManager.ScrollaBC('"+g.Identifier+"', -12, 0)",20)}}}}}}};DDManager.prototype.AfterProcessResponse=function(){if(!this.IsDragging&&!this.IsResizing){if(this.CloneElem){this.CloneElem.parentNode.removeChild(this.CloneElem);this.CloneElem=null}if(this.DragElem){this.DragElem.style.visibility="";this.DragElem=null}}};DDManager.prototype.OnMouse=function(b,a){var c=(window.event)?window.event.srcElement:b.target;while(c&&(c.className=="panel-value-activator"||c.className=="combo-img"||c.className=="combo-activator")){c=c.previousSibling}if(!c){return}var e=RD3_Glb.GetRD3ObjectId(c);var d=this.GetObject(e);if(d&&d.OnMouseOverObj&&a=="over"){d.OnMouseOverObj(b,c)}if(d&&d.OnMouseOutObj&&a==""){d.OnMouseOutObj(b,c)}if(d&&d.OnMouseDownObj&&a=="down"){d.OnMouseDownObj(b,c)}};DDManager.prototype.IsOnScrollBar=function(b,a,e){if(b.scrollHeight>b.clientHeight&&b.scrollHeight>b.offsetHeight){var d=RD3_Glb.GetScreenLeft(b)+b.clientWidth;if(a>d){return true}}if(b.scrollWidth>b.clientWidth&&b.scrollWidth>b.offsetWidth){var c=RD3_Glb.GetScreenTop(b)+b.clientHeight;if(e>c){return true}}return false};DDManager.prototype.SetMouseOver=function(a){this.ResetMouseOver();this.TouchSource=a;var b=document.createEvent("MouseEvents");b.initEvent("mouseover",true,true);this.TouchSource.dispatchEvent(b)};DDManager.prototype.ResetMouseOver=function(){if(this.TouchSource){var a=document.createEvent("MouseEvents");a.initEvent("mouseout",true,true);this.TouchSource.dispatchEvent(a);this.HandleTouchEvent(this.TouchSource,"move",a);this.TouchSource=null}};DDManager.prototype.OnTouchRight=function(){if(this.TouchMove){return}this.TouchEvent.button=999;var a=this.TouchEvent.target;while(a){if(a.className=="frame-container"){this.GetObject(a.id).OnMouseUp(this.TouchEvent);break}a=a.parentNode}this.TouchEvent.button=2;this.TouchEvent.explicitOriginalTarget=this.TouchEvent.target;if(RD3_KBManager.IDRO_OnRightClick(this.TouchEvent)){this.TouchMove=true}};DDManager.prototype.HandleTouchEvent=function(f,e,i){if(e!="down"){this.OnMouse(i)}var m=false;var l=false;var c=false;var k=false;var j=false;var g=null;var b=false;var h=f;while(h){var a=h.id?h.id:"";if(h.className=="frame-container"&&a.indexOf("scz")==-1){l=true;g=this.GetObject(h.id)}if(h.className=="frame-container"&&a.indexOf("suf:")==0){b=true}if(h.className&&h.className.substr(0,14)=="messagetooltip"){m=true}if(h.className&&h.className.substr(0,11)=="tab-caption"){c=true}if(h.className&&h.className.substr(0,12)=="menu-command"){k=true}if(h.className&&h.className.substr(0,16)=="menu-bar-command"){k=true}if(h.className&&h.className.substr(0,15)=="popup-menu-item"){k=true}if(h.className&&h.className.substr(0,9)=="form-list"){k=true}if(h.className&&h.className.substr(0,8)=="taskbar-"){j=true}if(h.className&&h.className.substr(0,11)=="popup-error"){j=true}if(h.className&&RD3_Glb.HasClass(h,"menu-back-button")){k=true}if(h.className&&RD3_Glb.HasClass(h,"popover-back-button")){k=true}h=h.parentNode}if(c){l=false}if(l&&b&&f&&f.tagName=="INPUT"&&f.className.indexOf("toolbar-button")!=-1){l=false}if(f&&f.className&&f.className.substr(0,10)=="button-bar"){l=false}if(f.tagName=="AREA"){l=false}if(f.className=="button-bar-button"){l=false}if(f.className=="menu-bar-command"){k=true}if(f.className=="indicator-text"||f.className=="toolbar-command-showcaption"){k=true}if(f.className=="form-cover-inactive"){j=true;l=false}if(k&&f.tagName=="A"){f=f.parentNode}if(f.id&&f.id.substr(0,13)=="taskbar-start"){j=true}if(!l&&f&&(f.tagName=="INPUT"||f.tagName=="IMG"||f.tagName=="AREA"||m||c||k||j)){if(!j){if(e=="up"){if(c||k){RD3_Glb.TouchHL(f,"panel-page-down",false);RD3_Glb.TouchHL(f,"panel-page-active")}else{if(f.id!=""){RD3_Glb.TouchHL(f,"panel-field-down",false);RD3_Glb.TouchHL(f,"panel-field-active")}}}if(e=="down"){if(c||k){RD3_Glb.TouchHL(f,"panel-page-down",true,0)}else{if(f.id!=""){RD3_Glb.TouchHL(f,"panel-field-down",true,0)}}}if(e=="move"){RD3_Glb.TouchHL(f,"panel-page-down",false);RD3_Glb.TouchHL(f,"panel-field-down",false)}}if(e=="up"){var d=document.createEvent("MouseEvents");d.initMouseEvent("click",true,true,window,1,i.clientX,i.clientY,i.clientX,i.clientY);f.dispatchEvent(d)}}else{if(g){if(e=="up"){g.OnMouseUp(i)}if(e=="down"){g.OnMouseDown(i)}}}};DDManager.prototype.FindPopup=function(b){for(var a=0;a<this.iOpenPopup.length;a++){if(this.iOpenPopup[a]==b){return a}}return -1};DDManager.prototype.AddPopup=function(b){var a=this.FindPopup(b);if(a==-1){this.iOpenPopup.push(b)}};DDManager.prototype.RemovePopup=function(b){var a=this.FindPopup(b);if(a>=0){this.iOpenPopup.splice(a,1)}};DDManager.prototype.ClosePopup=function(a){while(this.iOpenPopup.length>0){this.iOpenPopup.pop().Close();if(a){break}}};DDManager.prototype.OnAllClicks=function(b){var a=new Date()-this.ChompTimeStamp;if(a<600){RD3_Glb.StopEvent(b);if(document.activeElement){document.activeElement.blur()}}};DDManager.prototype.ChompClick=function(a){this.ChompTimeStamp=new Date()};DDManager.prototype.OnGeneralDrag=function(a){if(a&&a.dataTransfer){a.dataTransfer.dropEffect="none"}RD3_Glb.StopEvent(a);return false};DDManager.prototype.OnWelcomeDown=function(a){if(RD3_DesktopManager.WebEntryPoint.UseZones()){for(var b=2;b<=5;b++){RD3_DesktopManager.WebEntryPoint.GetScreenZone(b).OnMouseDown(a,true)}}};var RD3_DesktopManager;var RD3_Glb;var RD3_ClientParams;var RD3_ClientEvents;var RD3_GFXManager;var RD3_Debugger;var RD3_DDManager;var RD3_KBManager;var RD3_TooltipManager;var RD3_ServerParams;var RD3_ShellObject;function InitRD3(){if(!navigator.cookieEnabled){document.getElementById("wait-box-text").innerHTML="Enable cookies to continue";return}if(window.top==window.self){var e=window.location.href.indexOf("?");if(e!=-1&&(!window.RD4_Enabled||window.location.href.substring(e,e+5).toUpperCase()!="?CMD=")){window.location.href=window.location.href.substring(0,e);return}}RD3_Glb=new GlobalObject();if(RD3_Glb.IsChrome()||RD3_Glb.IsSafari()||RD3_Glb.IsIE(11,true)){document.body.setAttribute("spellcheck","false")}if(RD3_Glb.IsMobile()&&(!(RD3_Glb.IsWebKit()||RD3_Glb.IsIE(10,true)))){var g="<br><br>This application requires a mobile browser. Please install <a href='http://www.google.com/chrome'>Google Chrome</a> or <a href='http://support.apple.com/kb/DL1531'>Safari</a>.";g+="<br><br>Questa applicazione richiede un browser mobile oppure <a href='http://www.google.com/chrome'>Google Chrome</a> o <a href='http://support.apple.com/kb/DL1531'>Safari</a>.";var c=document.getElementById("wait-box");c.className="wait-box-error";c.innerHTML=g;return}RD3_ClientParams=new ClientParams();RD3_ClientEvents=new ClientEvents();RD3_GFXManager=new GFXManager();RD3_DesktopManager=new DesktopManager();RD3_Debugger=new DebuggerManager();RD3_DDManager=new DDManager();RD3_ServerParams=new ServerParams();RD3_KBManager=new KBManager();RD3_TooltipManager=new TooltipManager();RD3_ShellObject=new Shell();if(RD3_Glb.IsMobile()&&(RD3_Glb.IsIphone(7)||RD3_Glb.IsIpad(7))&&RD3_ShellObject.IsInsideShell()){var a=document.querySelector("meta[name=viewport]");a.setAttribute("content","width=device-width, height=device-height, minimum-scale=1, maximum-scale=1, user-scalable=no")}if(window.RD4_Enabled){var b=false;if(RD3_Glb.IsSafari()||RD3_Glb.IsChrome()){b=true}else{if(RD3_Glb.IsMobile()){b=RD3_ShellObject.IsInsideShell()}else{b=RD3_Glb.IsTouch()}}if(!b){var g="<br><br>This application is offline and requires a native shell, Chrome or <a href='http://support.apple.com/kb/DL1531'>Safari</a>.";g+="<br><br>Questa applicazione &egrave; offline e richiede una shell nativa, Chrome oppure <a href='http://support.apple.com/kb/DL1531'>Safari</a>.";var c=document.getElementById("wait-box");c.className="wait-box-error";c.innerHTML=g;return}}RD3_DesktopManager.Init();RD3_TooltipManager.Init();RD3_CustomInit();if(RD3_Glb.IsIE(6)){RD3_ClientParams.MaxOpenRequests=1}if(window.RD4_Enabled){var e=window.location.href.toUpperCase().indexOf("?CMD=");if(e!=-1){var d=window.location.href.substring(e+5);var f="";e=d.indexOf("&");if(e!=-1){f=d.substring(e+1);d=d.substring(0,e)}if(RD3_ShellObject.IsInsideShell()){RD3_ShellObject.SendCmd("SVCCMD",{URL:window.location.href,CMD:d,PARAMS:f})}else{RD3_SendCommand(d,f)}}}}function RD3_CustomInit(){}function RD3_SendCommand(c,d){var a=c;if(d){a+="&"+d}var b=new IDEvent("cmd",this.WebEntryPoint.Identifier,null,RD3_Glb.EVENT_ACTIVE,a)}function DesktopManager(){this.TickID=0;this.AppName="";this.MessagePump=null;this.MessagePumpRD4=null;this.WebEntryPoint=null;this.ObjectMap=null;this.PDFPrints=new Array();this.CurrentRequest=null;this.CurrentRequestBlocking=false}DesktopManager.prototype.Init=function(){if(RD3_Glb.IsFirefox()){RD3_Glb.LoadJsCssFile("firefox.css")}else{if(RD3_Glb.IsTouch()){if(RD3_Glb.IsIE(10,true)){RD3_Glb.LoadJsCssFile("ie10.css")}if(RD3_Glb.IsEdge()){RD3_Glb.LoadJsCssFile("edge.css")}if(!RD3_Glb.IsMobile()||RD3_Glb.IsSmartPhone()){RD3_Glb.LoadJsCssFile("iphone.css")}var b=document.createElement("link");b.setAttribute("rel","apple-touch-icon");b.setAttribute("href","images/appicon.png");document.getElementsByTagName("head")[0].appendChild(b);b=document.createElement("link");b.setAttribute("rel","apple-touch-startup-image");if(RD3_Glb.IsIpad()){b.setAttribute("href","images/startupipad.png")}else{b.setAttribute("href","images/startup.png")}document.getElementsByTagName("head")[0].appendChild(b);if(RD3_Glb.IsAndroid()){if(RD3_Glb.IsAndroid(4,4,0)){RD3_Glb.LoadJsCssFile("kitkat.css")}else{RD3_Glb.LoadJsCssFile("android.css")}}}else{if(RD3_Glb.IsSmartPhone()){if(RD3_Glb.IsIE(10,true)){RD3_Glb.LoadJsCssFile("ie10.css")}RD3_Glb.LoadJsCssFile("iphone.css");if(RD3_Glb.IsChrome()){RD3_Glb.LoadJsCssFile("chrome.css")}}else{if(RD3_Glb.IsSafari()){RD3_Glb.LoadJsCssFile("safari.css")}else{if(RD3_Glb.IsChrome()){RD3_Glb.LoadJsCssFile("chrome.css");if(RD3_Glb.IsEdge()){RD3_Glb.LoadJsCssFile("edge.css")}}else{if(RD3_Glb.IsIE(10,true)){RD3_Glb.LoadJsCssFile("ie10.css")}}}}}}this.TickID=setTimeout("RD3_DesktopManager.Tick()",15);this.MessagePump=new MessagePump();this.MessagePumpRD4=new MessagePumpRD4();this.ObjectMap=new HashTable();var a=document.getElementById("wait-box-text");if(a){a.innerHTML=(RD3_StartAppMsg?RD3_StartAppMsg:"Starting application...");Size=0}var g=window.location.href.lastIndexOf("/");if(g>1){var d=window.location.href.lastIndexOf("/",g-1);if(d>1){this.AppName=window.location.href.substring(d+1,g)}}var f=false;try{if(window.localStorage&&window.localStorage[this.AppName+"_start"]){f=true}}catch(c){f=false}if(f){this.MessagePump.OWAMessagePump=new OWAMessagePump();this.MessagePump.OWAMessagePump.restoreFromStorage()}else{var h=new IDEvent("start","",null,RD3_Glb.EVENT_ACTIVE)}};DesktopManager.prototype.ProcessResponse=function(b){var a=new Date();var h=this.MessagePump.GetRequest(b);if(h&&h.readyState==4){this.MessagePump.RemoveRequest(b);if(h.status==200){this.CurrentRequest=b;if(RD3_ClientParams.MaxOpenRequests==1){this.CurrentRequestBlocking=this.MessagePump.LastReqBlocking}else{this.CurrentRequestBlocking=h.Blocking}var l=h.responseXML;var j=false;if(l){j=this.ProcessXmlDoc(l)}var e=new Date();var k=(RD3_ClientParams.MaxOpenRequests==1?this.MessagePump.LastReqStartTime:h.StartTime);defaultStatus="Time: "+(a-k)+" + "+(e-a)+" = "+(e-k)+" ms";if(!j){if(h.responseText.toLowerCase().indexOf("<html")!=-1){window.location.reload(true)}else{if(RD3_Glb.IsIE()&&l&&l.childNodes&&l.childNodes.length==0){var g=h.responseText;if(g.indexOf("\n")!=-1){g=g.substring(g.indexOf("\n")+1)}if(l.loadXML(g)){j=this.ProcessXmlDoc(l)}}if(!j){if(h.responseText==""){if(RD3_Glb.IsChrome()){j=this.FixChromeEmptyRequest(h)}if(!j){alert("Internal browser error")}}else{this.ProcessXmlText(this.RemoveInvalidCharacter(h.responseText))}}}return j}}else{if(this.WebEntryPoint&&this.WebEntryPoint.CanOWA){if(!this.MessagePump.OWAMessagePump&&confirm(ClientMessages.WEP_OWA_CANOFF)){this.MessagePump.OWAMessagePump=new OWAMessagePump()}if(this.MessagePump.OWAMessagePump){var d=h.sentEvents.length;for(var f=0;f<d;f++){this.MessagePump.OWAMessagePump.AddEvent(h.sentEvents[f])}return true}}var c="Invalid response from server: ResponseCode = "+h.status+" - "+h.statusText+"\n\nPress the OK button to retry.\n\nIf the problem persists contact Technical Support and report this problem";if(h.status==12029||(h.status==0&&RD3_Glb.IsTouch())){c=ClientMessages.WEP_SRV_NOTFOUND}else{if(h.status==0&&RD3_Glb.IsChrome()){c=""}}if(c==""||confirm(c)){window.location.reload(true)}else{if(RD3_ShellObject.IsInsideShell()){window.close()}}return false}}};DesktopManager.prototype.ProcessResponseRD4=function(e){var g=new Date();var f=this.MessagePumpRD4.GetRequest(e);if(f){this.MessagePumpRD4.RemoveRequest(e);this.CurrentRequest=e;if(RD3_ClientParams.MaxOpenRequests==1){this.CurrentRequestBlocking=this.MessagePumpRD4.LastReqBlocking}else{this.CurrentRequestBlocking=f.Blocking}var a=f.responseXML;var d=false;if(a){d=this.ProcessXmlDoc(a)}var b=new Date();var c=(RD3_ClientParams.MaxOpenRequests==1?this.MessagePumpRD4.LastReqStartTime:f.StartTime);defaultStatus="Time: "+(g-c)+" + "+(b-g)+" = "+(b-c)+" ms";if(!d){if(f.responseText.toLowerCase().indexOf("<html")!=-1){document.clear();document.write(f.responseText)}else{this.ProcessXmlText(this.RemoveInvalidCharacter(f.responseXML))}}return d}};DesktopManager.prototype.ProcessXmlDoc=function(a){var d=a.getElementsByTagName("rd3");if(d.length==0){return false}RD3_KBManager.StopChange=true;if(this.WebEntryPoint){this.WebEntryPoint.BeforeProcessResponse()}var b=d.item(0);var g=b.childNodes.length;for(var c=0;c<g;c++){var f=b.childNodes[c];var e=f.nodeName;switch(e){case"start":this.HandleStart(f);break;case"chg":this.HandleChange(f);break;case"ins":this.HandleInsert(f);break;case"del":this.HandleDelete(f);break;case"close":this.HandleClose(f);break;case"open":this.HandleOpen(f);break;case"activateform":this.HandleActivateForm(f);break;case"msgbox":this.HandleMessageBox(f);break;case"error":this.HandleError(f);break;case"redirect":this.HandleRedirect(f);break;case"opendoc":this.HandleOpenDocument(f);break;case"rcache":this.HandleResetCache(f);break;case"mulsel":this.HandleMultipleSelection(f);break;case"printpdf":this.HandlePdfPrint(f);break;case"popup":this.HandlePopup(f);break;case"preview":this.HandlePreview(f);break;case"traylet":this.HandleTraylet(f);break;case"focus":this.HandleFocus(f);break;case"exe":this.HandleExecute(f);break;case"sound":this.HandleSound(f);break;case"tooltip":RD3_TooltipManager.HandleTooltip(f);break;case"restip":RD3_TooltipManager.ResetTooltip(f);break;case"rstgrp":this.HandleResetGroups(f);break;case"expgrp":this.HandleExpandGroups(f);break;case"dbg":this.HandleDebug(f);break;case"shell":this.HandleShell(f);break;case"resetTree":this.HandleResetTree(f);break;case"searchval":this.HandleSearchValue(f);break;case"edcmd":this.HandleEditorCommand(f);break}}if(this.WebEntryPoint){this.WebEntryPoint.AfterProcessResponse()}RD3_DDManager.AfterProcessResponse();RD3_KBManager.StopChange=false;return true};DesktopManager.prototype.ProcessXmlText=function(d){var b=null;if(document.implementation&&document.implementation.createDocument){b=document.implementation.createDocument("","",null);var c=new DOMParser();b=c.parseFromString(d,"text/xml")}else{b=new ActiveXObject("MSXML2.DOMDocument");b.async="false";b.loadXML(d)}var a=Math.floor(Math.random()*1111111);this.CurrentRequest="r"+a;if(!this.ProcessXmlDoc(b)){if(d==""){alert("Empty XML response")}else{alert("Invalid XML format:\n\n"+d)}}};DesktopManager.prototype.AddEvent=function(a){if(window.RD4_Enabled){this.MessagePumpRD4.AddEvent(a)}else{this.MessagePump.AddEvent(a)}if(a.Tipo!="chg"&&a.Tipo!="grlexp"&&a.Tipo!="panscr"){RD3_KBManager.CheckFocus=true}};DesktopManager.prototype.SendEvents=function(a){this.MessagePump.SendEvents();this.MessagePumpRD4.SendEvents();if(a){this.MessagePump.Tick();this.MessagePumpRD4.Tick()}};DesktopManager.prototype.Tick=function(){if((RD3_Glb.IsIphone(7)||RD3_Glb.IsIpad(7))&&RD3_Glb.IsMobile()){var e=window.orientation==0||window.orientation==180;if(RD3_Glb.IsIpad(7)){var a=395;if(RD3_Glb.IsIpad(8)){a=430}var c=307;if(RD3_Glb.IsIpad(8)){c=342}if(document.body.scrollTop>a&&!e){document.body.scrollTop=a}if(document.body.scrollTop>c&&e){document.body.scrollTop=c}}if(RD3_Glb.IsIphone(7)){var a=206;if(RD3_Glb.IsIphone(8)){a=236}var c=260;if(RD3_Glb.IsIphone(8)){c=290}if(document.body.scrollTop>a&&!e){document.body.scrollTop=a}if(document.body.scrollTop>c&&e){document.body.scrollTop=c}}}this.TickID=setTimeout(function(){RD3_DesktopManager.Tick()},15);this.MessagePump.Tick();this.MessagePumpRD4.Tick();RD3_GFXManager.Tick();RD3_KBManager.Tick();if(!RD3_GFXManager.Animating()){var d=this.PDFPrints.length;for(var b=d-1;b>=0;b--){if(this.PDFPrints[b].Tick()){this.PDFPrints.splice(b,1)}}if(this.WebEntryPoint){if(this.WebEntryPoint.Realized){this.WebEntryPoint.Tick()}this.WebEntryPoint.VSList.Tick();this.WebEntryPoint.ScrollingMenu()}}};DesktopManager.prototype.HandleStart=function(c){if(c.getAttribute("owa")=="1"){if(window.localStorage){c.removeAttribute("owa");var b=(RD3_Glb.IsIE()?c.ownerDocument.xml:(new XMLSerializer()).serializeToString(c.ownerDocument));window.localStorage[this.AppName+"_start"]=b}else{alert("This browser does not support offline mode")}window.location.reload(true);return}if(this.WebEntryPoint!=null){this.WebEntryPoint.Unrealize()}this.WebEntryPoint=new WebEntryPoint();this.WebEntryPoint.InResponse=true;if(c.hasChildNodes()){var a=c.childNodes[0];if(a.nodeType!=1){a=c.childNodes[1]}this.WebEntryPoint.LoadFromXml(a)}this.WebEntryPoint.Realize(document.body);this.WebEntryPoint.AfterStart=true;if(RD3_ShellObject.IsInsideShell()){RD3_ShellObject.SendCmd("SERVICESTARTED")}};DesktopManager.prototype.HandleChange=function(b){var a=b.getAttribute("id");var c=this.ObjectMap[a];if(c!=null){c.ChangeProperties(b)}};DesktopManager.prototype.HandleInsert=function(c){var a=c.getAttribute("parid");var b=this.ObjectMap[a];if(b!=null){b.InsertChild(c)}};DesktopManager.prototype.HandleDelete=function(a){var b=a.getAttribute("id");var c=this.ObjectMap[b];if(c!=null){if(c.OnDeleteObject){c.OnDeleteObject()}c.Unrealize()}};DesktopManager.prototype.HandleClose=function(a){var b=a.getAttribute("id");this.WebEntryPoint.CloseForm(b)};DesktopManager.prototype.HandleMessageBox=function(d){var f=d.getAttribute("id");var c=d.getAttribute("type");var b=d.getAttribute("opts");var e=d.getAttribute("voice");if(e&&c=="0"){this.WebEntryPoint.VoiceObj.HandleMessageBox(f,parseInt(c),b)}else{var a=new MessageBox(f,parseInt(c),true,b);a.Blocking=this.CurrentRequestBlocking;if(RD3_KBManager.FocusFieldTimerId){this.MB2Open=a;window.setTimeout("RD3_DesktopManager.MB2Open.Open();RD3_DesktopManager.MB2Open = null;",20)}else{a.Open()}if(e){this.WebEntryPoint.VoiceObj.HandleMessageBox(f,parseInt(c),b,a)}}};DesktopManager.prototype.HandleError=function(b){if(RD3_Glb.IsMobile()){var d=b.getAttribute("hdr");var c=b.getAttribute("des");var a=new MessageBox(c,RD3_Glb.MSG_BOX);a.Open();a.CaptionBox.innerHTML=d}else{var a=new PopupError(b);a.Open()}};DesktopManager.prototype.HandleOpen=function(e){var c=e.childNodes;var f=c.length;for(var d=0;d<f;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"frm":this.WebEntryPoint.OpenForm(b,parseInt(e.getAttribute("openas")));break}}};DesktopManager.prototype.HandleActivateForm=function(a){var b=a.getAttribute("id");this.WebEntryPoint.ActivateForm(b)};DesktopManager.prototype.HandleRedirect=function(c){var a=c.getAttribute("id");if(this.WebEntryPoint){this.WebEntryPoint.Redirecting=true}var b=new GFX("redirect",true,document.body,false);b.Url=a;RD3_GFXManager.FinishAllGFX();RD3_GFXManager.AddEffect(b);if(this.WebEntryPoint){this.WebEntryPoint.SoundAction("logoff","play")}RD3_GFXManager.StopAnimation=true};DesktopManager.prototype.HandleOpenDocument=function(c){var a=c.getAttribute("id");var b=c.getAttribute("fea");if(b==undefined||b==null){b=""}this.OpenDocument(a,"",b)};DesktopManager.prototype.HandleResetCache=function(a){var b=a.getAttribute("id");this.CallEventHandler(b,"ResetCache",null,a)};DesktopManager.prototype.HandleResetTree=function(a){var b=a.getAttribute("id");this.CallEventHandler(b,"ResetTree",null,a)};DesktopManager.prototype.HandleResetGroups=function(a){var b=a.getAttribute("id");this.CallEventHandler(b,"ResetGroups",null,a)};DesktopManager.prototype.HandleExpandGroups=function(a){var c=a.getAttribute("id");var b=a.getAttribute("exp");this.CallEventHandler(c,"SetExpanded",null,(b==1))};DesktopManager.prototype.HandleResetGroups=function(a){var b=a.getAttribute("id");this.CallEventHandler(b,"ResetGroups",null,a)};DesktopManager.prototype.HandleExpandGroups=function(a){var c=a.getAttribute("id");var b=a.getAttribute("exp");this.CallEventHandler(c,"SetExpanded",null,(b==1))};DesktopManager.prototype.HandleMultipleSelection=function(a){var b=a.getAttribute("id");this.CallEventHandler(b,"MultipleSelection",null,a)};DesktopManager.prototype.HandlePdfPrint=function(a){var b=new PDFPrint(a);this.PDFPrints.push(b)};DesktopManager.prototype.HandlePopup=function(a){var c=a.getAttribute("id");var b=this.ObjectMap[c];if(b){b.Popup(a)}};DesktopManager.prototype.HandlePreview=function(c){var d=c.getAttribute("addr");var b=c.getAttribute("capt");var a=new PopupPreview(d,b);a.Open()};DesktopManager.prototype.HandleTraylet=function(a){var b=a.getAttribute("id");var c='<iframe id=traylet style="width:1px;height:1px" src="'+b+'"></iframe>';this.WebEntryPoint.TrayletBox.innerHTML=c};DesktopManager.prototype.HandleFocus=function(d){var b=d.getAttribute("sels");if(b&&b!=""){var c=d.getAttribute("sele");this.SelSt=b;this.SelEn=c;this.SelFld=d.getAttribute("id")}var e=this.ObjectMap[d.getAttribute("id")];var a=d.getAttribute("row");if(e.TranslateServerRow){a=e.TranslateServerRow(a)}this.HandleFocus2(d.getAttribute("id"),a)};DesktopManager.prototype.HandleFocus2=function(b,a){if(this.WebEntryPoint&&this.WebEntryPoint.InResponse){RD3_KBManager.DontCheckFocus=true}if(RD3_KBManager.FocusFieldTimerId){window.clearTimeout(RD3_KBManager.FocusFieldTimerId)}RD3_KBManager.FocusFieldTimerId=0;if(this.WebEntryPoint&&this.WebEntryPoint.Realized&&this.WebEntryPoint.WepBox.style.visibility=="hidden"){RD3_GFXManager.FocusFldId=b;RD3_GFXManager.FocusFldRow=a;return}RD3_KBManager.FocusFieldTimerId=window.setTimeout(function(){RD3_KBManager.FocusFieldTimerId=0;RD3_DesktopManager.CallEventHandler(b,"Focus",null,a)},10)};DesktopManager.prototype.HandleExecute=function(node){var cmd=node.getAttribute("cmd");if(cmd.indexOf("*")==0){this.WebEntryPoint.ExecuteRitardati.push(cmd.substring(1))}else{eval(cmd)}};DesktopManager.prototype.HandleDebug=function(b){var r=b.getAttribute("SESS");var q=null;var o=(RD3_Glb.IsTouch()||RD3_ShellObject.IsInsideShell());if(r!=""&&r!=null){var g=false;if(!this.WebEntryPoint[r+"Dbg"]){g=true}if(!g&&(o&&!this.WebEntryPoint[r+"Dbg"].Realized)){g=true}if(!g&&(!o&&this.WebEntryPoint[r+"Dbg"].closed)){g=true}if(g){if(o){this.WebEntryPoint[r+"Dbg"]=new PopupPreview("","SESSION "+r);this.WebEntryPoint[r+"Dbg"].AutoClose=true;this.WebEntryPoint[r+"Dbg"].DebugPreview=true;this.WebEntryPoint[r+"Dbg"].Realize("-popover");this.WebEntryPoint[r+"Dbg"].PreviewFrame.contentWindow.name="DTTSESSNAME"+r;this.WebEntryPoint[r+"Dbg"].Open()}else{this.WebEntryPoint[r+"Dbg"]=window.open("","DTTSESSNAME"+r)}}q=o?this.WebEntryPoint[r+"Dbg"].PreviewFrame.contentWindow:this.WebEntryPoint[r+"Dbg"]}else{var g=false;if(this.WebEntryPoint.dbgWindow==null){g=true}if(!g&&(o&&!this.WebEntryPoint.dbgWindow.Realized)){g=true}if(!g&&(!o&&this.WebEntryPoint.dbgWindow.closed)){g=true}if(g){if(o){this.WebEntryPoint.dbgWindow=new PopupPreview("","DEBUG");this.WebEntryPoint.dbgWindow.AutoClose=true;this.WebEntryPoint.dbgWindow.DebugPreview=true;this.WebEntryPoint.dbgWindow.Realize("-popover");this.WebEntryPoint.dbgWindow.PreviewFrame.contentWindow.name="DTT";this.WebEntryPoint.dbgWindow.Open()}else{this.WebEntryPoint.dbgWindow=window.open("","DTTWINDOW")}}q=o?this.WebEntryPoint.dbgWindow.PreviewFrame.contentWindow:this.WebEntryPoint.dbgWindow}var m=b.getAttribute("main");if(m){q.document.close();q.document.write(m);if(o){this.WebEntryPoint.dbgWindow.OnReadyStateChange()}}var p=b.getAttribute("ItemList");var a=b.getAttribute("CmdForm");var n=b.getAttribute("Detail");var f=b.getAttribute("ReqTop");var h=b.getAttribute("ReqRef");var l=b.getAttribute("ReqPrc");if(q.frames){for(var e=0;e<q.frames.length;e++){var k=q.frames[e];if(k.name=="ItemList"&&p){k.document.close();k.document.write(p)}if(k.name=="CmdForm"&&a){k.document.close();k.document.write(a)}if(k.name=="Detail"){if(n){k.document.close();k.document.write(n)}for(var d=0;d<k.frames.length;d++){var c=k.frames[d];if(c.name=="ReqTop"&&f){c.document.close();c.document.write(f)}if(c.name=="ReqRef"&&h){c.document.close();c.document.write(h)}if(c.name=="ReqPrc"&&l){c.document.close();c.document.write(l)}}}}}};DesktopManager.prototype.HandleShell=function(c){var d=c.getAttribute("cmd");var a=c.getAttribute("params");if(RD3_ShellObject.IsInsideShell()){var e=RD3_ShellObject.SendCmd(d,a);if(e){var b=new IDEvent("shell","",null,RD3_Glb.EVENT_ACTIVE,"shell",d,a,e)}}};DesktopManager.prototype.HandleSearchValue=function(c){var a=c.getAttribute("id");var b=c.getAttribute("val");var d=this.ObjectMap[a];if(d!=null&&d.SetSearchBoxValue){d.SetSearchBoxValue(b)}};DesktopManager.prototype.HandleEditorCommand=function(b){var a=b.getAttribute("id");var d=b.getAttribute("CMD");var f=b.getAttribute("VAL");var c=(b.getAttribute("RES")=="-1");var e=this.ObjectMap[a];if(e!=null&&e.OnServerEditorCommand){e.OnServerEditorCommand(d,f,c)}};DesktopManager.prototype.CallEventHandler=function(g,a,f,d){var c=window.event?window.event:f;if(f&&(f.tagName||f.Identifier)){c=f}var e=this.ObjectMap[g];if(e!=null){var b=e[a];if(b!=null){return b.call(e,c,d)}}};DesktopManager.prototype.OpenDocument=function(g,b,e){var f=window.open(g,b,e);if(f){try{f.focus()}catch(d){}}else{if(!RD3_Glb.IsIE(10,false)){var c=g.indexOf("mailto:")==-1;if(c){if(RD3_ClientParams.RedirectWhenBlocked){document.location.assign(g)}else{if(RD3_ClientParams.AlertWhenBlocked){var a=new MessageBox(ClientMessages.WEP_POPUP_Blocked,RD3_Glb.MSG_BOX,false);a.Open()}}}}}};DesktopManager.prototype.FixChromeEmptyRequest=function(f){var g=this.MessagePump.CreateRequest();g.StartTime=new Date();g.ID=-f.ID;var c=this.MessagePump.CreateXMLDoc("rd3");var e=c.getElementsByTagName("rd3");var a=e[0];var d=c.createElement("resend");a.appendChild(d);var b=1;while(b<=5){g.open("POST",this.MessagePump.ServerURL,false);g.setRequestHeader("Content-Type","text/xml");g.send(c);if(g.responseXML&&this.ProcessXmlDoc(g.responseXML)){return true}b++}return false};DesktopManager.prototype.HandleSound=function(b){var a=b.getAttribute("id");var c=b.getAttribute("action");var e=b.getAttribute("volume");if(e!=null){e=parseInt(e)}var g=b.getAttribute("t1");if(g!=null){g=parseInt(g)}var f=b.getAttribute("t2");if(f!=null){f=parseInt(f)}var i=b.getAttribute("notify")=="1";var d=b.getAttribute("progress")=="1";var h=b.getAttribute("video");if(h!=null){var j="RD3_DesktopManager.WebEntryPoint.SoundAction('"+a+"','"+c+"',"+e+","+g+","+f+","+i+","+d+",'"+h+"')";window.setTimeout(j,10)}else{this.WebEntryPoint.SoundAction(a,c,e,g,f,i,d)}};DesktopManager.prototype.RemoveInvalidCharacter=function(e){for(var b=0;b<e.length;b++){var d=e.charAt(b);if(d=="&"&&b<e.length-1&&e.charAt(b+1)=="#"){var a=b;var g="";for(b+=2;b<e.length;b++){if(e.charAt(b)!=";"){g+=e.charAt(b)}else{break}}var f="";if(g.charAt(0)=="x"){f=parseInt(g.substr(1),16)}else{f=parseInt(g,10)}if(!(f==9||f==10||f==13||(f>=32&f<=55295)||(f>=57344&&f<=65533))){e=e.substr(0,a)+e.substr(b+1);b-=2+g.length+1}}}return e};function InitRD4(){if(!self.Worker||!self.openDatabase){var c="<br><br>This application requires a webkit browser. Please install <a href='http://www.google.com/chrome'>Google Chrome</a> or <a href='http://www.apple.com/safari'>Safari</a>.";c+="<br><br>Questa applicazione richiede un browser webkit. Si prega di installare <a href='http://www.google.com/chrome'>Google Chrome</a> o <a href='http://www.apple.com/it/safari'>Safari</a>.";var b=document.getElementById("wait-box");b.className="wait-box-error";b.innerHTML=c;return}window.RD4_Enabled=true;window.RD4_ApplicationManager=new Worker("?WCI=RD3&WCE=GZ&FN=JScript/full.js");window.RD4_ApplicationManager.onmessage=OnWorkerMessage;window.RD4_ApplicationManager.onerror=OnWorkerError;window.ServerSessions=new HashTable();if(window.RD4_PreInit){for(var a=0;a<window.RD4_PreInit.length;a++){ExecuteOnWorker(window.RD4_PreInit[a])}}InitRD3()}function InitServerSession(a){if(RD3_ShellObject.IsInsideShell()){RD3_ShellObject.SendCmd("NEWSS",{NAME:a})}var c=new Worker("?WCI=RD3&WCE=GZ&FN=JScript/full.js");c.onmessage=OnWorkerMessage;c.onerror=OnWorkerError;ServerSessions[a]=c;if(RD3_ShellObject.IsInsideShell()&&window.RD4_PreInit){for(var b=0;b<window.RD4_PreInit.length;b++){c.postMessage({type:"EXEC",message:window.RD4_PreInit[b]})}}}function OnWorkerMessage(c){switch(c.data.type){case"debug":WriteToConsole(c.data.message,c.data.channel);break;case"progress":RD4_ApplicationManager.progress=c.data.message;break;case"SSM":switch(c.data.message){case"Start":InitServerSession(c.data.name);ServerSessions[c.data.name].postMessage(c.data);break;case"End":if(c.data.kill){ServerSessions[c.data.name].terminate()}else{ServerSessions[c.data.name].postMessage(c.data)}break;case"Remove":ServerSessions[c.data.name].terminate();delete ServerSessions[c.data.name];break;case"Message":ServerSessions[c.data.name].postMessage(c.data);break}break;case"db":try{var a=openDatabase(c.data.name,c.data.ver,c.data.desc,c.data.size);if(a&&a.close){a.close()}}catch(b){WriteToConsole("[OnWorkerMessage] Can't open database: ERROR = "+b,"error")}break;default:RD3_DesktopManager.MessagePumpRD4.CheckResponse(c.data);break}}function OnWorkerError(a){WriteToConsole(a,"error")}function WriteToConsole(b,a){var c="";if(b instanceof Error||(self.ErrorEvent&&b instanceof self.ErrorEvent)){c=b.message;if(b.stack){c+="\n"+b.stack}}else{c=b}switch(a){case"error":console.error(c);break;case"output":console.log(c);break}}function ExecuteOnWorker(a){window.RD4_ApplicationManager.postMessage({type:"EXEC",message:a})}function GlobalObject(){this.EVENT_CLIENTSIDE=1;this.EVENT_SERVERSIDE=2;this.EVENT_IMMEDIATE=4;this.EVENT_BLOCKING=8;this.EVENT_URGENT=15;this.EVENT_ACTIVE=7;this.EVENT_DEFERRED=3;this.GFX_SHOWFOLD=1;this.GFX_HIDEFOLD=2;this.GFX_HIGHON=3;this.GFX_HIGHOFF=4;this.FORMTOOL_NONE=0;this.FORMTOOL_LEFT=1;this.FORMTOOL_RIGHT=2;this.FORMTOOL_DISTRIB=3;this.FORMSCROLL_NONE=0;this.FORMSCROLL_HORIZ=1;this.FORMSCROLL_VERT=2;this.FORMSCROLL_BOTH=3;this.FORMDOCK_NONE=1;this.FORMDOCK_LEFT=2;this.FORMDOCK_RIGHT=3;this.FORMDOCK_TOP=4;this.FORMDOCK_BOTTOM=5;this.FRESMODE_NONE=1;this.FRESMODE_EXTEND=2;this.FRESMODE_STRETCH=3;this.RESMODE_NONE=1;this.RESMODE_MOVE=2;this.RESMODE_STRETCH=3;this.MENUTYPE_LEFTSB=1;this.MENUTYPE_RIGHTSB=2;this.MENUTYPE_MENUBAR=3;this.MENUTYPE_TASKBAR=4;this.MENUTYPE_GROUPED=5;this.STYLE_TIME=6;this.STYLE_DATE=7;this.IND_ALI_SX=2;this.IND_ALI_CX=3;this.IND_ALI_DX=4;this.PANEL_LIST=0;this.PANEL_FORM=1;this.JFREECHART=1;this.FUSIONCHART=2;this.JQPLOT=5;this.CHARTJS=6;this.GOOGLECHART=7;this.TABOR_TOP=1;this.TABOR_LEFT=2;this.TABOR_BOTTOM=3;this.TABOR_RIGHT=4;this.STRTC_AUTO=1;this.STRTC_NONE=2;this.STRTC_FILL=3;this.STRTC_ENLARGE=4;this.STRTC_CROP=5;this.VISCTRL_AUTO=1;this.VISCTRL_EDIT=2;this.VISCTRL_COMBO=3;this.VISCTRL_CHECK=4;this.VISCTRL_OPTION=5;this.VISCTRL_BUTTON=6;this.VISCTRL_HTMLEDIT=7;this.PS_QBE=1;this.PS_DATA=2;this.PS_UPDATED=3;this.PCM_FORMLIST=1;this.PCM_SEARCH=2;this.PCM_FIND=4;this.PCM_INSERT=8;this.PCM_DELETE=16;this.PCM_CANCEL=32;this.PCM_REQUERY=64;this.PCM_UPDATE=128;this.PCM_DUPLICATE=256;this.PCM_LOOKUP=512;this.PCM_BLOBEDIT=1024;this.PCM_BLOBDELETE=2048;this.PCM_BLOBNEW=4096;this.PCM_BLOBSAVEAS=8192;this.PCM_PRINT=16384;this.PCM_ATTACH=65536;this.PCM_CSV=131072;this.PCM_GROUP=32768;this.PCM_CUSTOM1=262144;this.PCM_CUSTOM2=524288;this.PCM_CUSTOM3=1048576;this.PCM_CUSTOM4=2097152;this.PCM_CUSTOM5=4194304;this.PCM_CUSTOM6=8388608;this.PCM_CUSTOM7=16777216;this.PCM_CUSTOM8=33554432;this.PCM_CUSTOM1=-1;this.PCM_CUSTOM2=-2;this.PCM_CUSTOM3=-4;this.PCM_CUSTOM4=-8;this.PCM_CUSTOM5=-22;this.PCM_CUSTOM6=-50;this.PCM_CUSTOM7=-100;this.PCM_CUSTOM8=-296;this.PCM_NAVIGATION=1073741824;this.CZ_FORMLIST=0;this.CZ_SEARCH=1;this.CZ_FIND=2;this.CZ_INSERT=3;this.CZ_DELETE=4;this.CZ_CANCEL=5;this.CZ_REQUERY=6;this.CZ_UPDATE=7;this.CZ_DUPLICATE=8;this.CZ_LOOKUP=9;this.CZ_BLOBEDIT=10;this.CZ_BLOBDELETE=11;this.CZ_BLOBNEW=12;this.CZ_BLOBSAVEAS=13;this.CZ_PRINT=14;this.CZ_GROUP=15;this.CZ_ATTACH=16;this.CZ_CSV=17;this.CZ_CUSTOM1=18;this.CZ_CUSTOM2=19;this.CZ_CUSTOM3=20;this.CZ_CUSTOM4=21;this.CZ_CUSTOM5=22;this.CZ_CUSTOM6=23;this.CZ_CUSTOM7=24;this.CZ_CUSTOM8=25;this.CZ_NAVIGATE=30;this.CZ_COLLAPSE=32;this.CZ_LOCK=33;this.CZ_STATUSBAR=34;this.CZ_CMDSET=35;this.CZ_QBETIP=36;this.MSG_BOX=0;this.MSG_CONFIRM=1;this.MSG_INPUT=2;this.DELAY=0;this.PROGRESS=1;this.BORDER_DEFAULT=0;this.BORDER_NONE=1;this.BORDER_THIN=2;this.BORDER_THICK=3;this.WS_NORMAL=0;this.WS_MAXIMIZE=1;this.WS_MINIMIZE=2;this.BCM_PRINT=1;this.BCM_NAVIGATION=2;this.BCM_CSV=4;this.KEYS_ENTERESC=1;this.KEYS_MOVEMENT=2;this.KEYS_ALPHANUMERICAL=4;this.CTRL_DATE=1;this.CTRL_TIME=2;this.CTRL_DATETIME=3;this.CTRL_KEYNUM=4;this.CTRL_CPICKER=5;this.SCRZONE_VISTAB=0;this.SCRZONE_HIDTAB=1;this.SCRZONE_AUTTAB=2;this.SCRZONE_PINNEDZONE=0;this.SCRZONE_UNPINNEDZONE=1;this.SCRZONE_HIDDENZONE=2;this.SCRZONE_SELECTEDMENU=-1;this.SCRZONE_SELECTEDNONE=-2;this.SCRZONE_SWIPENONE=1;this.SCRZONE_SWIPECOLLAPSABLE=2;this.SCRZONE_SWIPEHIDE=3;this.SWIPE_LEFT=1;this.SWIPE_RIGHT=2;this.SWIPE_TOP=3;this.SWIPE_BOTTOM=4;this.SWIPE_TOPLEFT=5;this.SWIPE_BOTTOMLEFT=6;this.SWIPE_TOPRIGHT=7;this.SWIPE_BOTTOMRIGHT=8;this.SCRZONE_VERTICALPOPOVER=0;this.SCRZONE_VERTICALCOLLAPSE=1;this.SCRZONE_VERTICALHIDE=2;this.SCRZONE_VERTICALNOCHANGE=3;this.SwipeDelta=80;this.SwipeLimit=40;this.IDE_BOLD=1;this.IDE_ITALIC=2;this.IDE_UNDERLINE=4;this.IDE_STRIKE=8;this.IDE_UL=16;this.IDE_OL=32;this.IDE_LEFT=64;this.IDE_CENTER=128;this.IDE_JUSTIFY=256;this.IDE_RIGHT=512;this.IDE_BACK=1024;this.IDE_FORE=2048;this.IDE_LINK=4096;this.IDE_IMAGE=8192;this.IDE_CHANGE=16384;this.IDE_FONT=32768;this.IDE_SIZE=65536;this.IDE_TOKEN=131072;this.IDE_FORECH=262144;this.IDE_BACKCH=524288;this.ImagesCache=new HashTable()}GlobalObject.prototype.log2=function(b){var a=0;while(b!=0){a++;b>>=1}a--;return a};GlobalObject.prototype.AddHLEvents=function(e,d,f,c){if(!f){f="OnMouseOver"}if(!c){c="OnMouseOut"}var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+d+"', '"+f+"', ev)");var b=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+d+"', '"+c+"', ev)");if(e.addEventListener){e.addEventListener("mouseover",a,false);e.addEventListener("mouseout",b,false)}else{e.onmouseover=a;e.onmouseout=b}};GlobalObject.prototype.RemoveTags=function(f){var d=f.length;var b="";var a=true;for(var c=0;c<d;c++){var e=f.charAt(c);switch(e){case"<":a=false;break;case">":a=true;break;default:if(a){b+=e}break}}return b};GlobalObject.prototype.GetScreenLeft=function(d,c){var a=d.scrollLeft;var b=(RD3_DesktopManager.WebEntryPoint)?RD3_DesktopManager.WebEntryPoint.WepBox:document.body;while(d&&d!=b){a+=d.offsetLeft-d.scrollLeft+d.clientLeft;if(c){a+=this.TranslateX(d)}d=d.offsetParent}a+=document.body.scrollLeft;return a};GlobalObject.prototype.GetScreenTop=function(c,b){var d=c.scrollTop;var a=(RD3_DesktopManager.WebEntryPoint)?RD3_DesktopManager.WebEntryPoint.WepBox:document.body;while(c&&c!=a){d+=c.offsetTop-c.scrollTop+c.clientTop;if(b){d+=this.TranslateY(c)}c=c.offsetParent}d+=document.body.scrollTop;return d};GlobalObject.prototype.FormatMessage=function(a,f,e,d,c,b){if(f==undefined){f=""}if(e==undefined){e=""}if(d==undefined){d=""}if(c==undefined){c=""}if(b==undefined){b=""}a=a.replace("|1",f);a=a.replace("|2",e);a=a.replace("|3",d);a=a.replace("|4",c);a=a.replace("|5",b);return a};GlobalObject.prototype.AdaptToParent=function(f,h,c){if(!h){h=0}if(!c){c=0}if(f.parentNode){var i=this.GetCurrentStyle(f);var b=this.GetCurrentStyle(f.parentNode);if(!b){return}if(h!=-1){var d=(f.parentNode.clientWidth-h);if(RD3_ServerParams.Theme=="zen"&&this.IsIE(10,true)&&f.parentNode.clientWidth==0&&f.parentNode.offsetWidth>0){d=(f.parentNode.offsetWidth-h)}d=d-parseInt("0"+i.marginLeft,10)-parseInt("0"+f.style.marginRight,10)-parseInt("0"+b.paddingLeft,10)-parseInt("0"+b.paddingRight,10);var e=true;if(RD3_Glb.IsMobile()&&i.boxSizing&&i.boxSizing=="border-box"){e=false}if(e){d=d-parseInt("0"+i.paddingLeft,10)-parseInt("0"+i.paddingRight,10)-parseInt("0"+i.borderLeft,10)-parseInt("0"+i.borderRight,10)}if(e&&(this.IsIE(10,true)||RD3_Glb.IsFirefox())){if(i.borderLeft==""&&i.borderLeftWidth!=""&&i.borderLeftStyle!=""&&i.borderLeftStyle!="none"){d=d-parseInt("0"+i.borderLeftWidth,10)}if(i.borderRight==""&&i.borderRightWidth!=""&&i.borderRightStyle!=""&&i.borderRightStyle!="none"){d=d-parseInt("0"+i.borderRightWidth,10)}}var g=d;f.style.width=((g<0)?0:g)+"px"}if(c!=-1){var j=(f.parentNode.clientHeight-c);j=j-parseInt("0"+i.marginTop,10)-parseInt("0"+f.style.marginBottom,10)-parseInt("0"+b.paddingTop,10)-parseInt("0"+b.paddingBottom,10);j=j-parseInt("0"+i.paddingTop,10)-parseInt("0"+i.paddingBottom,10)-parseInt("0"+i.borderTop,10)-parseInt("0"+i.borderBottom,10);if(e&&(this.IsIE(10,true)||RD3_Glb.IsFirefox())){if(i.borderTop==""&&i.borderTopWidth!=""&&i.borderTopStyle!=""&&i.borderTopStyle!="none"){j=j-parseInt("0"+i.borderTopWidth,10)}if(i.borderBottom==""&&i.borderBottomWidth!=""&&i.borderBottomStyle!=""&&i.borderBottomStyle!="none"){j=j-parseInt("0"+i.borderBottomWidth,10)}}var a=j;f.style.height=((a<0)?0:a)+"px"}}};GlobalObject.prototype.ApplyCursor=function(e,d){e.style.cursor=d;var b;var f=e.childNodes;var a=f.length;for(b=0;b<a;b++){if(f[b].style){f[b].style.cursor=d}}};GlobalObject.prototype.IsNumericObject=function(a){return a==1||a==2||a==3||a==4};GlobalObject.prototype.IsDateTimeObject=function(a){return a==6||a==8};GlobalObject.prototype.IsDateOrTimeObject=function(a){return a==6||a==7||a==8};GlobalObject.prototype.IsIE=function(a,b){if(this.uaIE==undefined){this.uaIE=navigator.userAgent.indexOf("MSIE")>-1;this.uaIEVer=parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE ")+5));if(!this.uaIE&&(navigator.userAgent.indexOf("Trident/7.0")!=-1||navigator.userAgent.indexOf("Trident/8.0")!=-1)){this.uaIE=true;this.uaIEVer=11}}if(!a){return this.uaIE}else{if(b==undefined){return(this.uaIE&&this.uaIEVer==a)}if(b==false){return(this.uaIE&&this.uaIEVer<a)}else{return(this.uaIE&&this.uaIEVer>=a)}}};GlobalObject.prototype.IsSafari=function(a){if(this.uaSafari==undefined){this.uaSafari=navigator.userAgent.indexOf("IEMobile")==-1&&navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")<0;this.uaSafariVer=parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("Version/")+8))}if(!a){return this.uaSafari}else{return(this.uaSafari&&this.uaSafariVer==a)}};GlobalObject.prototype.IsIphone=function(a){if(this.uaIphone==undefined){this.uaIphone=navigator.userAgent.indexOf("IEMobile")==-1&&navigator.userAgent.indexOf("iPhone")>-1;this.uaIphoneVer=parseInt(navigator.userAgent.substr(navigator.userAgent.indexOf("Version/")+8,1));if(this.uaIphone&&!this.uaIphoneVer&&navigator.userAgent.indexOf("Version/")==-1&&navigator.userAgent.indexOf(" OS ")){this.uaIphoneVer=parseInt(navigator.userAgent.substr(navigator.userAgent.indexOf(" OS ")+4,1))}}if(!a){return this.uaIphone}else{return(this.uaIphone&&this.uaIphoneVer>=a)}};GlobalObject.prototype.IsIpad=function(a){if(this.uaIpad==undefined){this.uaIpad=navigator.userAgent.indexOf("iPad")>-1;this.uaIpadVer=parseInt(navigator.userAgent.substr(navigator.userAgent.indexOf("Version/")+8,1));if(this.uaIpad&&!this.uaIpadVer&&navigator.userAgent.indexOf("Version/")==-1&&navigator.userAgent.indexOf(" OS ")){this.uaIpadVer=parseInt(navigator.userAgent.substr(navigator.userAgent.indexOf(" OS ")+4,1))}}if(!a){return this.uaIpad}else{return(this.uaIpad&&this.uaIpadVer>=a)}};GlobalObject.prototype.IsAndroid=function(b,c,h){if(this.uaAndroid==undefined){this.uaAndroid=navigator.userAgent.indexOf("IEMobile")==-1&&navigator.userAgent.indexOf("Android")>-1;try{var i="";if(navigator.userAgent.indexOf("Shell")!=-1){var a=navigator.userAgent.indexOf("Version/");i=navigator.userAgent.substr(a+8)}else{var a=navigator.userAgent.indexOf("Android");var g=navigator.userAgent.indexOf(";",a);i=navigator.userAgent.substring(a+8,g)}var d=i.split(".");this.uaAndroidMajorVer=d[0];this.uaAndroidMinorVer=d[1];this.uaAndroidBuildVer=d[2]}catch(e){this.uaAndroidMajorVer=4;this.uaAndroidMinorVer=0;this.uaAndroidBuildVer=3}}if(!b){return this.uaAndroid}else{var f=false;if(this.uaAndroidMajorVer>b){f=true}else{if(this.uaAndroidMajorVer==b&&this.uaAndroidMinorVer>c){f=true}else{if(this.uaAndroidMajorVer==b&&this.uaAndroidMinorVer==c&&this.uaAndroidBuildVer>=h){f=true}}}return this.uaAndroid&&f}};GlobalObject.prototype.IsTouch=function(){return this.IsIpad()||this.IsIphone()||this.IsAndroid()||(this.IsIE(10,true)&&this.IsMobile()&&window.navigator.msMaxTouchPoints>0)};GlobalObject.prototype.IsFirefox=function(a){if(this.uaFirefox==undefined){this.uaFirefox=navigator.userAgent.indexOf("Firefox")>-1;var b=navigator.userAgent.indexOf("Firefox/");this.uaFirefoxVer=Math.floor(parseFloat(navigator.userAgent.substring(b+8,b+12)))}if(!a){return this.uaFirefox}else{return(this.uaFirefox&&this.uaFirefoxVer==a)}};GlobalObject.prototype.IsEdge=function(){if(this.uaEdge==undefined){this.uaEdge=navigator.userAgent.indexOf("Edge/")>-1}return this.uaEdge};GlobalObject.prototype.IsChrome=function(){if(this.uaChrome==undefined){this.uaChrome=navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")>-1}return this.uaChrome};GlobalObject.prototype.IsWebKit=function(){return this.IsChrome()||this.IsSafari()||(this.IsTouch()&&!this.IsIE())};GlobalObject.prototype.StopEvent=function(b){if(b.preventDefault){b.preventDefault();b.stopPropagation()}else{try{b.keyCode=505;b.keyCode=0}catch(a){}b.returnValue=false;b.cancelBubble=true}};function GetFrame(c,b){var a=null;if(document.all){a=c[b]}else{for(var e=0;e<c.length;e++){try{var f=c[e].name;if(f.indexOf(b)!=-1){a=c[e];break}}catch(d){}}}return(a)?a:window}function IsUndefined(c){var a=false;try{var d=c.tagName}catch(b){a=true}return a}GlobalObject.prototype.CalcBottom=function(a){var b=a.offsetHeight;if(a.offsetTop){b+=a.offsetTop}return b};function Rect(a,d,b,c){this.x=a;this.y=d;this.w=b;this.h=c}GlobalObject.prototype.GetCurrentStyle=function(a){if(a.currentStyle){return(a.currentStyle)}if(document.defaultView&&document.defaultView.getComputedStyle){return(document.defaultView.getComputedStyle(a,""))}return null};GlobalObject.prototype.GetStyleProp=function(a,b){if(a.currentStyle){return(a.currentStyle[b])}if(document.defaultView.getComputedStyle){return(document.defaultView.getComputedStyle(a,"")[b])}return null};GlobalObject.prototype.HasNode=function(d,a){if(d.hasChildNodes()){var b=d.childNodes;var e=b.length;for(var c=0;c<e;c++){if(b[c].nodeName==a){return true}}}return false};GlobalObject.prototype.GetRD3ObjectId=function(b){var c=b.id;var a=b;while((c==""||!this.IsRD3Identifier(c))&&a.parentNode){c=a.parentNode.id;a=a.parentNode}return c};GlobalObject.prototype.IsRD3Identifier=function(a){if((a&&a.length>=4&&a.indexOf(":")==3)||(a&&a=="wep")){return true}else{return false}};GlobalObject.prototype.LoadJsCssFile=function(b){var a="";if(b.lastIndexOf(".")!=-1){a=b.substring(b.lastIndexOf(".")+1)}var c=null;if(a.toUpperCase()=="JS"){c=document.createElement("script");c.setAttribute("type","text/javascript");c.setAttribute("src",b)}else{if(a.toUpperCase()=="CSS"){c=document.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",b)}}if(c){document.getElementsByTagName("head")[0].appendChild(c)}};GlobalObject.prototype.ConvertIntoPx=function(b,a){if(a=="mm"){return b*96/25.4}else{return b*96}};GlobalObject.prototype.ConvertRectPxIntoUM=function(b,a){if(a=="mm"){b.x=b.x/(96/25.4);b.y=b.y/(96/25.4);b.w=b.w/(96/25.4);b.h=b.h/(96/25.4)}else{b.x=b.x/96;b.y=b.y/96;b.w=b.w/96;b.h=b.h/96}};GlobalObject.prototype.ConvertPxIntoUM=function(b,a){if(a=="mm"){return b/(96/25.4)}else{return b/96}};GlobalObject.prototype.GetImgSrc=function(a){if(a==""||a==null||a==undefined){return""}var d=this.ImagesCache[a];if(!d){if(this.uaIE&&this.uaIEVer<8){var c=document.getElementById("ImgFrm");if(c){var b=c.contentWindow.document.getElementById(a);if(b){d=b.src}}}else{var b=document.getElementById(a);if(b){d=b.src}}if(d){this.ImagesCache.add(a,d)}}if(d){return d}else{return a}};GlobalObject.prototype.FindObjById=function(b,c){if(c!=""){var a=0;for(a=0;a<b.length;a++){if(b[a].Identifier==c){return a}}}return -1};GlobalObject.prototype.BlobShowPreview=function(a){if(!a){return false}if(this.IsIE(10,false)&&a=="application/msword"){return true}if(a.indexOf("image/")!=-1||a=="application/pdf"||a.indexOf("text/")!=-1){return true}return false};GlobalObject.prototype.HasClass=function(c,b){if(!c||!c.className){return false}var a=" "+c.className+" ";return(a&&a.indexOf&&a.indexOf(" "+b+" ")>=0)};GlobalObject.prototype.AddClass=function(c,a){if(!c){return}if(!this.HasClass(c,a)){var b=c.className;if(b.charAt(b.length-1)!=" "){b+=" "}b+=a;c.className=b}};GlobalObject.prototype.RemoveClass=function(c,a){if(!c){return}if(this.HasClass(c,a)){var b=c.className;b=b.replace(a,"");b=this.Trim(b);c.className=b}};GlobalObject.prototype.RemoveClass2=function(c,a){if(!c){return}if(this.HasClass(c,a)){var b=" "+c.className+" ";b=b.replace(" "+a+" "," ");b=this.Trim(b);c.className=b}};GlobalObject.prototype.SetClass=function(b,a,c){if(c){this.AddClass(b,a)}else{this.RemoveClass(b,a)}};GlobalObject.prototype.SwitchClass=function(e,b,a,c){if(!c){var d=b;b=a;a=d}if(this.HasClass(e,b)){this.RemoveClass(e,b);this.AddClass(e,a)}};GlobalObject.prototype.Trim=function(a){while(a.substring(0,1)==" "){a=a.substring(1,a.length)}while(a.substring(a.length-1,a.length)==" "){a=a.substring(0,a.length-1)}return a};GlobalObject.prototype.GetFlashVersion=function(){if(!this.flashVersion){this.flashVersion="0,0,0";try{try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");try{a.AllowScriptAccess="always"}catch(b){this.flashVersion="6,0,0"}}catch(b){}this.flashVersion=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}catch(b){try{if(navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin){this.flashVersion=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description.replace(/\D+/g,",").match(/^,?(.+),?$/)[1]}}catch(b){}}}return this.flashVersion};GlobalObject.prototype.IsFlashPresent=function(){var a=this.GetFlashVersion().split(",").shift();return(a>=9)};GlobalObject.prototype.GetAbsolutePath=function(){if(!RD3_Glb.IsIE()||window.location.protocol!="https:"){return""}var a=window.location.href;if(a.lastIndexOf("/")==-1){return a+"/"}return a.substring(0,a.lastIndexOf("/"))+"/"};GlobalObject.prototype.IsAbsoluteUrl=function(a){if(a.substr(0,5)=="blob:"){return true}if(a.substr(0,5)=="data:"){return true}if(a.substr(0,5)=="http:"){return true}if(a.substr(0,6)=="https:"){return true}return false};GlobalObject.prototype.getSelEnd=function(e){if(typeof(e.selectionEnd)!="undefined"){return e.selectionEnd}else{var d,b;var c;d=document.selection.createRange();if(d.text==""){return getCursorPos(e)}b=e.createTextRange();c=0;try{while(b.compareEndPoints("StartToEnd",d)){c++;b.moveStart("character")}return c}catch(a){return -1}}};GlobalObject.prototype.getTextAreaSelection=function(e,d){if(typeof(e.selectionStart)!="undefined"){if(d){return e.selectionEnd}else{return e.selectionStart}}else{try{var a=document.selection.createRange();var c=a.duplicate();c.moveToElementText(e);c.setEndPoint("EndToEnd",a);var f=c.text.length-a.text.length;if(d){return(f+a.text.length)}else{return f}}catch(b){return -1}}};GlobalObject.prototype.HTMLEncode=function(b){var a=b;a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return a};GlobalObject.prototype.TouchHL=function(d,c,a,b){if(c==undefined){c="panel-field-active"}if(a==undefined){a=true}if(b==undefined){b=RD3_ClientParams.TouchHLDelay}while(d&&d.id==""){d=d.parentNode}if(d){if(!a){this.RemoveClass(d,c)}else{this.AddClass(d,c);if(b>0){window.setTimeout("RD3_Glb.RemoveClass(document.getElementById('"+d.id+"'),'"+c+"')",b)}}}};GlobalObject.prototype.IsEditFld=function(b){if(RD3_Glb.isInsideEditor(b)){return true}if(b.tagName!="INPUT"){return false}var a=b.type;return(a=="text"||a=="number"||a=="tel"||a=="date"||a=="time"||a=="datetime")};GlobalObject.prototype.ElementFromPoint=function(c,b){var a=document.elementFromPoint(c,b);if(a&&a.nodeType==3){a=a.parentNode}return a};GlobalObject.prototype.GetParentFrame=function(b){if(this.isInsideEditor(b)&&b.tagName!="IFRAME"){var a=b.ownerDocument.IDOwnerObject;if(a&&a.indexOf("ide:")==0){var c=RD3_DesktopManager.ObjectMap[a];if(c&&c instanceof IDEditor){b=c.EditorObj}}}while(b){if(this.HasClass(b,"frame-container")){return RD3_DDManager.GetObject(b.id)}b=b.parentNode}return null};GlobalObject.prototype.SetDisplay=function(d,b,c){if(!d){return}var a=d.style;a.display=b;if(RD3_Glb.IsIE(10,false)||c){a.visibility=(b=="none")?"hidden":""}};GlobalObject.prototype.IsMobile=function(){return(typeof(RD3_Mobile)!="undefined"&&RD3_Mobile)};GlobalObject.prototype.IsMobile7=function(){return(typeof(RD3_Mobile7)!="undefined"&&RD3_Mobile7)};GlobalObject.prototype.IsQuadro=function(){return(RD3_ServerParams.Theme=="quadro")};GlobalObject.prototype.IsSmartPhone=function(){if(this.IsPhone==undefined){this.IsPhone=this.IsMobile()&&window.innerWidth<=800&&window.innerHeight<=800}return this.IsPhone};GlobalObject.prototype.TranslateY=function(e){if(!this.IsMobile()){return 0}if(RD3_Glb.IsIE(10,true)){var c=e.style;var d=RD3_Glb.GetTransform(c);d=d.replace(/3d/g,"");var a=d.replace(/[^0-9-.,]/g,"").split(",");try{var f=parseInt(a[1]);if(isNaN(f)){f=0}return f}catch(b){return 0}}else{var c=window.getComputedStyle(e);var f=0;var a=RD3_Glb.GetTransform(c).replace(/[^0-9-.,]/g,"").split(",");f=parseInt(a[5]);if(isNaN(f)){f=0}return f}};GlobalObject.prototype.TranslateX=function(f){if(!this.IsMobile()){return 0}if(RD3_Glb.IsIE(10,true)){var d=f.style;var e=RD3_Glb.GetTransform(d);e=e.replace(/3d/g,"");var b=e.replace(/[^0-9-.,]/g,"").split(",");try{var a=parseInt(b[0]);if(isNaN(a)){a=0}return a}catch(c){return 0}}else{var d=window.getComputedStyle(f);var a=0;var b=RD3_Glb.GetTransform(d).replace(/[^0-9-.,]/g,"").split(",");var a=parseInt(b[4]);if(isNaN(a)){a=0}return a}};GlobalObject.prototype.NoScroll=function(a){if(this.IsAndroid()&&RD3_DesktopManager.WebEntryPoint.ScrollMobilePage){RD3_DesktopManager.WebEntryPoint.ScrollMobilePage=false;return}var b=a.target?a.target:a.srcElement;b.scrollTop=0;b.scrollLeft=0};GlobalObject.prototype.SortObj=function(d,c){return d.left-c.left};GlobalObject.prototype.GetToolbarLimit=function(e,b){var h=0;var l=e.offsetWidth;var d=24;var j=new Array();var g=e.firstChild;while(g){if(g.offsetWidth>0&&g.offsetLeft>=0){var k=(g.id=="menu-button-container"&&g.style.visibility=="");k=k||(b&&g.style.visibility==""&&(this.HasClass(g,"toolbar-frame-container")||this.HasClass(g,"toolbar-form-container")));if(k){var c=g.firstChild;while(c){if(c.offsetWidth>0&&!RD3_Glb.HasClass(c,"toolbar-separator")&&c.style.display==""){j.push({obj:c,left:c.offsetLeft+g.offsetLeft,right:c.offsetLeft+c.offsetWidth+g.offsetLeft})}c=c.nextSibling}}else{if(this.IsQuadro()&&g.id=="menu-button-container"&&g.firstChild){g=g.firstChild}if(this.IsMobile7()&&g.id=="menu-button-container"&&g.style.visibility=="hidden"){j.push({obj:g,left:g.offsetLeft,right:g.offsetLeft})}else{if(g.tagName!="SPAN"){j.push({obj:g,left:g.offsetLeft,right:g.offsetLeft+g.offsetWidth})}}}}g=g.nextSibling}j=j.sort(RD3_Glb.SortObj);for(var f=0;f<j.length;f++){if(j[f].left-h>d){break}h=j[f].right}for(var f=j.length-1;f>=0;f--){if(l-j[f].right>d){break}l=j[f].left}return{sx:h,dx:l}};GlobalObject.prototype.GetToolbarSeparator=function(a){var b=a.firstChild;while(b){if(RD3_Glb.HasClass(b,"toolbar-separator")){return b}b=b.nextSibling}};GlobalObject.prototype.AdjustCaptionPosition=function(c,a){var g=c.offsetWidth;if(g==0){return}a.style.marginLeft="";a.style.marginRight="";a.style.width="";var b=a.offsetWidth;var d=RD3_Glb.GetToolbarLimit(c,true);var e={sx:g/2-b/2,dx:g/2+b/2};var f=d.sx<=e.sx&&d.dx>=e.dx;if(this.IsQuadro()){f=false;d.sx+=4;d.dx-=8}if(d.sx<d.dx&&!f){a.style.marginLeft=d.sx+"px";a.style.marginRight=(g-d.dx)+"px";if(RD3_Glb.IsMobile()){a.style.width=(d.dx-d.sx)+"px"}if(this.IsQuadro()||this.IsMobile7()){if(d.sx==4){a.style.borderLeft="none"}else{a.style.borderLeft=""}}}};GlobalObject.prototype.AdjustCustomToolbar=function(e,b){var d=this.GetToolbarSeparator(e);if(d){var c=RD3_Glb.GetToolbarLimit(b);c.sx+=8;if(this.IsQuadro()){c.sx+=6}var a=c.dx-c.sx-e.offsetWidth+d.offsetWidth;if(a>=0){d.style.width=a+"px"}else{d.style.width=""}}};GlobalObject.prototype.CanScroll=function(c){while(c){var a=null;try{a=window.getComputedStyle(c)}catch(b){}if(a&&a.overflowY=="scroll"){return true}c=c.parentNode}};GlobalObject.prototype.GetBadgeWidth=function(d,b){var a=document.createElement("DIV");a.className="badge-"+b;a.innerHTML=d;a.style.position="absolute";document.body.appendChild(a);var c=a.offsetWidth;document.body.removeChild(a);return c};GlobalObject.prototype.SetBorderRadius=function(a,b){if(this.IsIE(10,true)){a.style.borderRadius=b}else{a.style.webkitBorderRadius=b}};GlobalObject.prototype.SetTransitionProperty=function(a,b){if(this.IsIE(10,true)){b=b.replace(/-webkit-transform/g,"transform");a.style.transitionProperty=b}else{a.style.webkitTransitionProperty=b}};GlobalObject.prototype.SetTransitionDuration=function(a,b){if(this.IsIE(10,true)){a.style.transitionDuration=b}else{a.style.webkitTransitionDuration=b}};GlobalObject.prototype.SetTransform=function(a,b){if(this.IsIE(10,true)){a.style.transform=b}else{a.style.webkitTransform=b}};GlobalObject.prototype.SetTransitionTimingFunction=function(a,b){if(this.IsIE(10,true)){a.style.transitionTimingFunction=b}else{a.style.webkitTransitionTimingFunction=b}};GlobalObject.prototype.SetBorderTopLeftRadius=function(a,b){if(this.IsIE(10,true)){a.style.borderTopLeftRadius=b}else{a.style.webkitBorderTopLeftRadius=b}};GlobalObject.prototype.SetBorderTopRightRadius=function(a,b){if(this.IsIE(10,true)){a.style.borderTopRightRadius=b}else{a.style.webkitBorderTopRightRadius=b}};GlobalObject.prototype.AddEndTransaction=function(c,a,d){var b=this.IsIE(10,true)?"transitionend":"webkitTransitionEnd";c.addEventListener(b,a,d)};GlobalObject.prototype.RemoveEndTransaction=function(c,a,d){var b=this.IsIE(10,true)?"transitionend":"webkitTransitionEnd";c.removeEventListener(b,a,d)};GlobalObject.prototype.GetTransitionDuration=function(a){if(this.IsIE(10,true)){return a.style.transitionDuration}else{return a.style.webkitTransitionDuration}};GlobalObject.prototype.GetTransform=function(a){if(a.style){a=a.style}if(this.IsIE(10,true)){return a.transform}else{return a.webkitTransform}};GlobalObject.prototype.GetTransitionTimingFunction=function(a){if(this.IsIE(10,true)){return a.style.transitionTimingFunction}else{return a.style.webkitTransitionTimingFunction}};GlobalObject.prototype.IsPortrait=function(a){if(!a&&RD3_DesktopManager.WebEntryPoint.CmdObj.ForceVerticalMenu){return true}var b=RD3_DesktopManager.WebEntryPoint.WepBox.offsetHeight>RD3_DesktopManager.WebEntryPoint.WepBox.offsetWidth;if(this.IsAndroid()){b=window.matchMedia("all and (orientation: portrait)").matches}if(this.IsIpad(7)||this.IsIphone(7)){b=window.orientation==0||window.orientation==180}return b};GlobalObject.prototype.Adapt4Retina=function(b,e,a,d){if(!RD3_Glb.IsMobile7()&&!RD3_Glb.IsQuadro()){return false}if(!RD3_ClientParams.MobileRetina){return false}if(e==""){return false}if(e.indexOf("images/")!=-1){e=e.substring(e.indexOf("images/")+7)}e=e.replace(")","");if(!this.RetinaMap){this.RetinaMap=new HashTable()}var c=this.RetinaMap[e];if(!c||c.width==0){c=new Image();this.RetinaMap[e]=c;c.onload=new Function("ev","return RD3_Glb.OnRetinaImageLoad('"+b+"', '"+e+"', "+a+(d!==undefined?", '"+d+"'":"")+")");c.src=this.GetImgSrc("images/"+e)}else{setTimeout("RD3_Glb.OnRetinaImageLoad('"+b+"', '"+e+"', "+a+(d!==undefined?", '"+d+"'":"")+")",1)}return true};GlobalObject.prototype.OnRetinaImageLoad=function(b,f,a,e){var g=RD3_DesktopManager.ObjectMap[b];if(!g||(!g.Realized&&!(g instanceof PValue)&&!(g instanceof IDCombo))){return}var d=this.RetinaMap[f];var c=d.height;var h=d.width;this.RetinaMap[f]={width:h,height:c};if(c>a){c=d.height/2;h=d.width/2}if(g instanceof PValue){g=g.ParentField.GetCurrentCell(g.Index-1)}if(h&&g&&g.OnAdaptRetina){g.OnAdaptRetina(h,c,e)}};GlobalObject.prototype.isInsideEditor=function(a){if(!RD3_ServerParams.UseIDEditor){return false}if(this.IsMobile()){while(a){if(a.tagName=="DIV"&&a.getAttribute("contentEditable")!=null&&a.getAttribute("contentEditable").toLowerCase()=="true"){return true}a=a.parentNode}return false}if(a&&a.ownerDocument&&(a.ownerDocument.designMode=="on"||a.ownerDocument.designMode=="On")){return true}if(a&&a.tagName=="IFRAME"&&a.src==""){var b=null;if(a.contentDocument){b=a.contentDocument}else{if(a.contentWindow&&a.contentWindow.document){b=a.contentWindow.document}}if(b&&(b.designMode=="on"||b.designMode=="On")){return true}}if(a&&a.ownerDocument&&a.ownerDocument.URL=="about:blank"){return true}return false};function HashTable(a){this.length=0;if(a){this.Items=new Array()}}HashTable.prototype.add=function(a,b){this[""+a]=b;this.length++;if(this.Items){this.Items.push(b)}};HashTable.prototype.remove=function(b){if(this.Items){var c=this[b];var d=this.Items.length;for(var a=0;a<d;a++){if(this.Items[a]==c){this.Items.splice(a,1);break}}}delete this[""+b];this.length--};HashTable.prototype.GetItem=function(a){if(this.Items){return this.Items[a]}};function KBManager(){this.ActiveObject=null;this.LastActiveObject=null;this.ActiveElement=null;this.CheckFocus=false;this.DontCheckFocus=false;this.FocusFieldTimerId=0;this.StopChange=false;this.SuperActiveTimer=null;this.SuperActiveSrc=null;this.LoosingFocus=false;this.ActiveButton=null;this.Init()}KBManager.prototype.Init=function(){var d=new Function("ev","return RD3_KBManager.IDRO_KeyDown(ev)");var g=new Function("ev","return RD3_KBManager.IDRO_GetFocus(ev)");var j=new Function("ev","return RD3_KBManager.IDRO_LostFocus(ev)");var h=new Function("ev","return RD3_KBManager.IDRO_KeyPress(ev)");var f=new Function("ev","return RD3_KBManager.IDRO_KeyUp(ev)");var b=new Function("ev","return RD3_KBManager.IDRO_OnDrop(ev)");var e=new Function("ev","return RD3_KBManager.IDRO_OnPaste(ev)");var i=new Function("ev","return RD3_KBManager.IDRO_DoubleClick(ev)");var c=new Function("ev","return RD3_KBManager.IDRO_OnChange(ev)");var a=new Function("ev","return RD3_KBManager.IDRO_OnRightClick(ev)");if(document.addEventListener){document.body.addEventListener("keydown",d,true);document.body.addEventListener("keypress",h,true);document.body.addEventListener("keyup",f,true);document.body.addEventListener("drop",b,true);document.body.addEventListener("paste",e,true);document.body.addEventListener("dblclick",i,true);document.body.addEventListener("contextmenu",a,false)}else{document.body.attachEvent("onkeydown",d);document.body.attachEvent("onactivate",g);document.body.attachEvent("ondeactivate",j);document.body.attachEvent("onkeypress",h);document.body.attachEvent("onkeyup",f);document.body.attachEvent("ondrop",b);document.body.attachEvent("onpaste",e);document.body.attachEvent("ondblclick",i);document.body.attachEvent("oncontextmenu",a)}};KBManager.prototype.IDRO_KeyDown=function(n){RD3_DDManager.OnKeyDown(n);var h=(window.event)?window.event:n;var d=(h.charCode)?h.charCode:h.keyCode;var p=(window.event)?h.srcElement:h.explicitOriginalTarget;var o=this.GetCell(p,true);var c=o.IsEnabled;var b=o.Mask;var i=this.IsListGroup(p);if(o){o.RemoveWatermark()}var e=this.GetObject(p);if(e&&e.SendtextSelChange&&e.UseTextSel){if(this.SelTextTimer){window.clearTimeout(this.SelTextTimer);this.SelTextSrc=null;this.SelTextObj=null}this.SelTextTimer=window.setTimeout(new Function("ev","if (RD3_KBManager.SelTextObj && RD3_KBManager.SelTextObj.SendtextSelChange){RD3_KBManager.SelTextObj.SendtextSelChange(RD3_KBManager.SelTextSrc);}"),50);this.SelTextSrc=p;this.SelTextObj=e}var m=(RD3_DesktopManager.WebEntryPoint&&RD3_DesktopManager.WebEntryPoint.CmdObj.MenuBarOpen);if((h.altKey||m)&&((d>=48&&d<=90)||d==27)){if(RD3_DesktopManager.WebEntryPoint.CmdObj.HandleAccell(h,d)){this.CheckKey(p,h);RD3_Glb.StopEvent(h);return false}}var a=(RD3_DesktopManager.WebEntryPoint)?RD3_DesktopManager.WebEntryPoint.MenuType:0;if((h.ctrlKey&&d==RD3_ClientParams.TaskMenuAccellCode)&&a==RD3_Glb.MENUTYPE_TASKBAR){RD3_DesktopManager.WebEntryPoint.OnStartClick(h)}if(((d>=33&&d<=40)||d==9)&&!RD3_DDManager.OpenCombo){var g=this.GetObject(p);if(g&&g.HandleNavKeys&&this.CanHandleKeys(g)){if(RD3_Glb.IsEditFld(p)&&!i){var l=true;if(h.shiftKey&&(d==37||d==39||d==35||d==36)){l=false}if(l){this.IDRO_OnChange(h)}}else{if((d==33||d==34)&&RD3_Glb.IsChrome()&&p&&p.tagName=="TEXTAREA"){h.preventDefault();p.scrollTop=p.scrollTop+(d==33?-1:1)*(p.clientHeight-6)}}if(g.HandleNavKeys(h)){this.CheckKey(p,h);RD3_Glb.StopEvent(h);return false}}}if(d>=112&&d<=123){var g=this.GetObject(p);if(g&&g.HandleFunctionKeys&&this.CanHandleKeys(g)){if(RD3_Glb.IsChrome()||RD3_Glb.IsSafari()){var f=this.ActiveObject;try{p.blur()}catch(j){}this.ActiveObject=f;this.CheckFocus=true}this.IDRO_OnChange(h);if(g.HandleFunctionKeys(h)){this.CheckKey(p,h);RD3_Glb.StopEvent(h);return false}}}if(c&&!i){var k=true;if(b&&RD3_Glb.IsEditFld(p)){k=hk(n);this.CheckKey(p,h);if(!k){RD3_Glb.StopEvent(h)}}else{this.CheckKey(p,h)}var g=this.GetObject(p);if(g&&!this.CanHandleKeys(g)){RD3_Glb.StopEvent(h)}if(g&&g.SuperActive&&!RD3_Glb.IsDateOrTimeObject(g.DataType)&&!g.HasValueSource){if(this.SuperActiveTimer){window.clearTimeout(this.SuperActiveTimer);this.SuperActiveSrc=null}this.SuperActiveTimer=window.setTimeout(new Function("ev","return RD3_KBManager.IDRO_OnChange(RD3_KBManager.SuperActiveSrc)"),10);this.SuperActiveSrc=p}return k}if(h.ctrlKey&&d==67){return true}this.CheckKey(p,h);if(p.tagName=="INPUT"&&d==13){return true}if(d==9||(d>=35&&d<=40)){return true}else{RD3_Glb.StopEvent(h);return false}};KBManager.prototype.IDRO_GetFocus=function(k,d){var h=(window.event)?window.event:k;var n=(window.event)?h.srcElement:h.currentTarget;if(d!=undefined){n=d}var m=this.GetCell(n,true);var c=m.IsEnabled;var b=m.Mask;var e=m.MaskType;if(n&&n.className=="panel-field-list-box"){return}if(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsMobile()&&RD3_Glb.IsTouch()&&m&&m.ParentField&&m.IsEnabled&&!(m.IntCtrl instanceof IDCombo)&&m.ParentField.UsePopupControl()){n.blur();return}if(RD3_Glb.IsIE()&&n==document.body&&n!=this.ActiveElement){if(!this.CheckFocus&&!RD3_KBManager.FocusFieldTimerId){this.CheckFocus=true}return}var j=false;if(RD3_Glb.IsIE(10,false)&&this.ActiveElement&&RD3_Glb.isInsideEditor(this.ActiveElement)){j=true}if("INPUT-TEXTAREA-SELECT".indexOf(n.tagName)>-1||RD3_Glb.isInsideEditor(n)){this.ActiveElement=n}else{var i=n.hasChildNodes()?n.childNodes[0]:null;if(i&&"INPUT-TEXTAREA-SELECT".indexOf(i.tagName)>-1){this.ActiveElement=i;this.CheckFocus=true}}if(c&&b&&n.tagName=="INPUT"){var g=false;if(m&&m.HasWatermark){m.RemoveWatermark();g=true}mc(b,e,k);if(m&&m.GetDOMObj(false)&&m.GetDOMObj(false).value==""&&g){if(m.ControlType==2){var f=m.GetDOMObj(false);f.value=m.ParentField.WaterMark;m.Text=m.ParentField.WaterMark;RD3_Glb.AddClass(f,"panel-field-value-watermark");m.HasWatermark=true;if(m.MaxLength>0&&m.NumRows==1&&(RD3_Glb.IsChrome()||RD3_Glb.IsSafari())){f.removeAttribute("maxLength")}}if(m.ControlType==3){m.Text=m.ParentField.WaterMark;m.HasWatermark=true;m.IntCtrl.SetWatermark();m.IntCtrl.SetText(m.ParentField.WaterMark,true,true)}}}if(c&&n.tagName=="INPUT"&&m&&m.HasWatermark&&RD3_Glb.IsTouch()){n.select();n.selectionStart=0;n.selectionEnd=0}this.ActiveObject=this.GetObject(n);if(this.ActiveObject&&this.ActiveObject.GotFocus){this.ActiveElement=n;if("INPUT-TEXTAREA-SELECT".indexOf(n.tagName)==-1&&!RD3_Glb.isInsideEditor(n)){var l=n.hasChildNodes()?n.childNodes[0]:null;if(l&&"INPUT-TEXTAREA-SELECT".indexOf(l.tagName)>-1){this.ActiveElement=l}}if(this.FocusFieldTimerId){window.clearTimeout(this.FocusFieldTimerId)}this.FocusFieldTimerId=0;if(j){window.setTimeout("RD3_DesktopManager.MessagePump.SendEvents(); var bj = RD3_DesktopManager.ObjectMap['"+this.ActiveObject.Identifier+"']; if (bj){ bj.GotFocus(RD3_KBManager.ActiveElement, null); }",300)}else{this.ActiveObject.GotFocus(n,h)}}var a=true;if(RD3_Glb.IsIE()&&this.ActiveObject instanceof IDPanel&&n.className=="panel-scroll-container"){a=false}if(this.ActiveObject&&this.ActiveObject!=RD3_DesktopManager.WebEntryPoint&&a){this.LastActiveObject=this.ActiveObject}};KBManager.prototype.IDRO_LostFocus=function(g,c){if((RD3_Glb.IsIphone(7)||RD3_Glb.IsIpad(7))&&RD3_Glb.IsMobile()){document.body.scrollTop=0}this.LoosingFocus=true;var f=(window.event)?window.event:g;var i=(window.event)?f.srcElement:f.currentTarget;if(c!=undefined){i=c}var h=this.GetCell(i,true);var b=h.IsEnabled;var a=h.Mask;if(b&&(a||RD3_Glb.IsMobile())&&i.tagName=="INPUT"){var e=false;if(a&&h&&h.HasWatermark){h.RemoveWatermark();e=true}if(a){umc(g)}if(h&&h.GetDOMObj(false)&&h.GetDOMObj(false).value==""&&(e||(RD3_Glb.IsMobile()&&h.ParentField&&h.ParentField.WaterMark!=""))){if(h.ControlType==2){var d=h.GetDOMObj(false);d.value=h.ParentField.WaterMark;h.Text=h.ParentField.WaterMark;RD3_Glb.AddClass(d,"panel-field-value-watermark");h.HasWatermark=true;if(h.MaxLength>0&&h.NumRows==1&&(RD3_Glb.IsChrome()||RD3_Glb.IsSafari())){d.removeAttribute("maxLength")}}if(h.ControlType==3){h.Text=h.ParentField.WaterMark;h.HasWatermark=true;h.IntCtrl.SetWatermark();h.IntCtrl.SetText(h.ParentField.WaterMark,true,true)}}}var d=this.GetObject(i);if(d&&d.LostFocus){d.LostFocus(i,f)}if(d==this.ActiveObject){this.ActiveObject=null}if(RD3_Glb.IsTouch()&&RD3_DDManager.OpenCombo){RD3_DDManager.OpenCombo.OnMouseDown(f)}this.LoosingFocus=false};KBManager.prototype.IDRO_KeyPress=function(d){var b=(window.event)?window.event:d;var c=(b.charCode)?b.charCode:b.keyCode;var e=(window.event)?b.srcElement:b.explicitOriginalTarget;var a=this.GetCell(e,true);var g=a.MaxLength;if(c==13&&RD3_DDManager.OpenCombo){RD3_DDManager.OpenCombo.Close()}if(e.tagName=="TEXTAREA"&&g>0&&e.value.length>=g&&c!=0){if(e.value.length>g){e.value=e.value.substr(0,g)}this.CheckKey(e,d);return false}if(e.tagName!="TEXTAREA"&&!RD3_Glb.isInsideEditor(e)){var f=this.GetObject(e,true);if(f&&f.OnKeyPress){RD3_DesktopManager.CallEventHandler(f.Identifier,"OnKeyPress",b)}}if(c>=32&&a){a.PwdSvuotata=undefined}this.CheckKey(e,d);return true};KBManager.prototype.IDRO_KeyUp=function(f){var e=(window.event)?window.event:f;var c=(e.charCode)?e.charCode:e.keyCode;var i=(window.event)?e.srcElement:e.explicitOriginalTarget;var h=this.GetCell(i,true);var d=h.MaxLength;if(!h||!h.IsEnabled||h.ControlType==4||h.ControlType==5||h.ControlType==6||h.ControlType==10||h.ControlType==101||h.HasWatermark){return true}if((c>0&&c<=46)||i.tagName!="INPUT"||(c>=112&&c<=123)){return true}if(h&&h.ParentField&&h.ParentField.AutoTab()){if(h.Mask!=""){var b=false;var j=i.value.length;var a=i.value;for(var g=0;g<j;g++){if((h.MaskType=="D"&&isMaskToken(a.charAt(g),h.MaskType))||a.charAt(g)=="_"){b=true;break}}if(!b&&j>=h.Mask.length){umc(f);h.ParentField.ParentPanel.FocusNextField(h.ParentField,f)}}else{if(i.value.length>=d&&d>0){h.ParentField.ParentPanel.FocusNextField(h.ParentField,f)}}}return true};KBManager.prototype.IDRO_OnDrop=function(e){var c=(window.event)?window.event:e;var d=(c.charCode)?c.charCode:c.keyCode;var f=(window.event)?c.srcElement:c.currentTarget;var a=this.GetCell(f);var b=a.IsEnabled;var h=a.MaxLength;if(f.tagName=="TEXTAREA"&&b&&h>0&&window.clipboardData){var g=window.clipboardData.getData("Text");if(g.length+f.value.length>h){window.clipboardData.setData("Text",g.substr(0,h-f.value.length))}}if(b){return true}else{return false}};KBManager.prototype.IDRO_OnPaste=function(e){var c=(window.event)?window.event:e;var d=(c.charCode)?c.charCode:c.keyCode;var f=(window.event)?c.srcElement:c.currentTarget;var a=this.GetCell(f,true);var b=a.IsEnabled;var h=a.MaxLength;if(f.tagName=="TEXTAREA"&&b&&h>0&&window.clipboardData){var g=window.clipboardData.getData("Text");if(g.length+f.value.length>h){window.clipboardData.setData("Text",g.substr(0,h-f.value.length))}}if(b){return true}else{return false}};KBManager.prototype.GetObject=function(b,d){while(b&&(b.className=="panel-value-activator"||b.className=="combo-img"||b.className=="combo-activator")){b=b.previousSibling}if(RD3_Glb.isInsideEditor(b)&&b.tagName!="IFRAME"){var a=b.ownerDocument.IDOwnerObject;if(a&&a.indexOf("ide:")==0){return RD3_DesktopManager.ObjectMap[a]}}while(b&&b!=document.body){if(b.id&&b.id!=""){var c=RD3_DDManager.GetObject(b.id,d);if(c){return c}}b=b.parentNode}return null};KBManager.prototype.GetCell=function(b,d){if(d==undefined){d=false}var c=this.GetObject(b);var a=(c&&c.GetCurrentCell?c.GetCurrentCell(0,b):null);if(a==null&&d&&c instanceof BookSpan){a=this.GetSpanCell(c)}return(a?a:new PCell())};KBManager.prototype.GetSpanCell=function(b){var a=null;if(b instanceof BookSpan&&b.Enabled&&b.ControlType==RD3_Glb.VISCTRL_EDIT){a=new PCell();a.ControlType=b.ControlType;a.Text=b.Text;a.MaxLength=b.MaxLen;a.IntCtrl=b.SpanObj;var c=b.GetVS();if(b.Mask){c.OldMask=c.Mask;c.Mask=b.Mask}a.Mask=c.ComputeMask(b.DataType,b.MaxLen,b.Scale);a.MaskType=c.ComputeMaskType(b.DataType);if(b.Mask){c.Mask=c.OldMask}}return a};KBManager.prototype.IDRO_DoubleClick=function(c){var b=(window.event)?window.event:c;var d=(window.event)?b.srcElement:b.explicitOriginalTarget;if(d.getAttribute&&d.getAttribute("id")=="resize-object"){var a=RD3_DDManager.MD_Target;d=a&&a.className=="panel-field-caption-list"?a:d}var e=this.GetObject(d,true);if(e&&e.OnDoubleClick){return RD3_DesktopManager.CallEventHandler(e.Identifier,"OnDoubleClick",b)}else{return true}};KBManager.prototype.IDRO_OnChange=function(c,f){if(this.StopChange){return false}var b=(window.event)?window.event:c;var d=(window.event)?b.srcElement:b.originalTarget;if(d==undefined||f){d=c}var e=this.GetObject(d,true);var a=true;if(e&&e.OnChange){a=RD3_DesktopManager.CallEventHandler(e.Identifier,"OnChange",(f?d:b))}if(RD3_Glb.IsSafari()||RD3_Glb.IsChrome()){if(d.tagName=="INPUT"&&(d.type=="radio"||d.type=="checkbox")){this.IDRO_GetFocus(c)}}return a};KBManager.prototype.GetFKTip=function(b){if(b==0){return""}var a=" (";if(b>24){a+="Ctrl+";b-=24}if(b>12){a+="Shift+";b-=12}a+="F"+b+")";return a};KBManager.prototype.GetActiveElement=function(){if(document.activeElement==undefined){return this.ActiveElement}else{return document.activeElement}};KBManager.prototype.AfterProcessResponse=function(){if(!this.DontCheckFocus){this.CheckFocus=true}this.DontCheckFocus=false};KBManager.prototype.Tick=function(){if(RD3_Glb.IsTouch()||RD3_Glb.IsMobile()){this.CheckFocus=false}if(this.CheckFocus){if(RD3_KBManager.FocusFieldTimerId){return}this.CheckFocus=false;var b=false;if(!RD3_Glb.IsIE()){if(this.ActiveElement){try{this.ActiveElement.focus();this.CheckMask(this.ActiveElement);b=true}catch(a){}}}else{var c=document.activeElement;if(!c||("INPUT-TEXTAREA-SELECT-IFRAME".indexOf(c.tagName)==-1&&!RD3_Glb.isInsideEditor(c))){if(this.ActiveElement){try{this.ActiveElement.focus();this.CheckMask(this.ActiveElement);b=true}catch(a){}}}else{b=true;if(this.ActiveElement){this.CheckMask(this.ActiveElement)}}}if(!b){this.FocusSomeone()}}};KBManager.prototype.FocusSomeone=function(){var b=false;var c=null;if(this.ActiveObject&&this.ActiveObject.WebForm){c=this.ActiveObject}if(this.ActiveObject&&this.ActiveObject.GetParentFrame){c=this.ActiveObject.GetParentFrame()}if(c){try{b=c.WebForm.Focus(c)}catch(a){b=false}}if(!b&&RD3_DesktopManager.WebEntryPoint&&RD3_DesktopManager.WebEntryPoint.Realized&&RD3_DesktopManager.WebEntryPoint.WepBox.style.visibility==""){RD3_DesktopManager.WebEntryPoint.Focus()}};KBManager.prototype.IDRO_OnRightClick=function(c){var a=false;var b=(window.event)?window.event:c;var d=(window.event)?b.srcElement:b.explicitOriginalTarget;RD3_DesktopManager.WebEntryPoint.CmdObj.ClosePopup();this.ActiveObject=this.GetObject(d);if(this.ActiveObject&&this.ActiveObject.OnRightClick){a=this.ActiveObject.OnRightClick(b)}if(this.ActiveObject&&this.ActiveObject!=RD3_DesktopManager.WebEntryPoint){this.LastActiveObject=this.ActiveObject}RD3_Glb.StopEvent(b);return a};KBManager.prototype.SurrogateChangeEvent=function(){if(this.ActiveElement){var b=this.GetObject(this.ActiveElement,true);if(this.ActiveElement){try{this.ActiveElement.blur()}catch(a){}}if(b&&b.OnChange){RD3_KBManager.LoosingFocus=true;RD3_DesktopManager.CallEventHandler(b.Identifier,"OnChange",this.ActiveElement);RD3_KBManager.LoosingFocus=false}}};KBManager.prototype.CheckMask=function(e){var a=this.GetCell(e,true);var c=a.IsEnabled;var d=a.Mask;var b=a.MaskType;if(c&&d&&e.tagName=="INPUT"){mc(d,b,null,e)}};KBManager.prototype.CanHandleKeys=function(e){if(RD3_DesktopManager.MessagePump.IsBlocking()){return false}var g=null;if(e instanceof PField){g=e.ParentPanel.WebForm}if(e instanceof WebFrame){g=e.WebForm}if(e instanceof WebForm){g=e}if(e instanceof Command&&e.FormIndex>0){g=RD3_DesktopManager.ObjectMap["frm:"+e.FormIndex]}if(g){if(g.SubFormObj){return true}var a=RD3_DesktopManager.WebEntryPoint.ActiveForm;if(a&&a.Identifier==g.Identifier){return true}var d=RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var b=0;b<d;b++){var c=RD3_DesktopManager.WebEntryPoint.StackForm[b];if(c.Docked&&c.Identifier==g.Identifier){return true}}return false}return true};KBManager.prototype.IsListGroup=function(b){var a=b.id;if(a&&a.indexOf(":lsg:")!=-1){return true}else{return false}};KBManager.prototype.IDRO_GotFocusCK=function(b){var a=b.editor;this.ActiveElement=b.sender;this.ActiveObject=RD3_DDManager.GetObject(a.name,false);if(this.ActiveObject&&this.ActiveObject.GotFocusCK){if(this.FocusFieldTimerId){window.clearTimeout(this.FocusFieldTimerId)}this.FocusFieldTimerId=0;this.ActiveObject.GotFocusCK(a)}if(this.ActiveObject&&this.ActiveObject!=RD3_DesktopManager.WebEntryPoint){this.LastActiveObject=this.ActiveObject}};KBManager.prototype.CheckKey=function(h,d){var f=-1;var a=d.type;var g=0;if(a=="keydown"){g=d.keyCode}else{if(a=="keypress"){g=(RD3_Glb.IsIE()?d.keyCode:d.charCode)}}if(g==0){return}if(g==13||g==27){if(a=="keydown"){f=RD3_Glb.KEYS_ENTERESC}}else{if(a=="keydown"&&g>=112&&g<=123){f=RD3_Glb.KEYS_ENTERESC}else{if(g==8||g==9){f=RD3_Glb.KEYS_MOVEMENT}else{if(a=="keydown"&&((g>=33&&g<=40)||g==46)){f=RD3_Glb.KEYS_MOVEMENT}else{if(a=="keypress"){f=RD3_Glb.KEYS_ALPHANUMERICAL}}}}}if(f==-1){return}var b=false;var c=null;var i=h;while(i&&i!=document.body){if(i.className&&i.id&&i.id!=""&&i.className=="frame-container"){c=RD3_DesktopManager.ObjectMap[i.id];break}i=i.parentNode}if(c&&c.HandledKeys!=undefined){if((c.HandledKeys&f)!=0){b=true}if(!b&&c.WebForm&&(c.WebForm.HandledKeys&f)!=0){b=true}}else{if(c==null){c=this.GetObject(h,false);if(c&&(c instanceof WebForm)&&(c.HandledKeys&f)!=0){b=true}else{c=null}}}if(!b&&RD3_DesktopManager.WebEntryPoint&&(RD3_DesktopManager.WebEntryPoint.HandledKeys&f)!=0){b=true}if(b){var e=new IDEvent("keypress",c?c.Identifier:"",d,RD3_ClientParams.KeyPressEventType,g,f,null,null,null,null,false,null,null,true)}};KBManager.prototype.CKinstanceReady=function(d){var g=d.editor.document;var a=d.editor.name;var h=a.length>5?a.substring(0,a.length-5):"";var f=RD3_DesktopManager.ObjectMap[h];if(!f){return}if(f.UseTextSel){var b=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+h+"', 'KeyPressCKEditor', ev, '"+a+"')");var c=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+h+"', 'KeyPressCKEditor', ev, '"+a+"')");if(g.$.body.addEventListener){g.$.body.addEventListener("mouseup",b,true)}else{g.$.body.attachEvent("onmouseup",b)}d.editor.on("key",c)}try{document.getElementById(d.editor.id+"_contents").style.height=d.editor.config.height}catch(e){}};KBManager.prototype.TextAreaMobileKeyUp=function(h){var e=(window.event)?window.event:h;var c=(window.event)?e.srcElement:e.explicitOriginalTarget;var b=(e.charCode)?e.charCode:e.keyCode;if(b!=13||c.tagName!="TEXTAREA"){return}var g=-1;if(typeof(c.selectionStart)!="undefined"){g=c.selectionEnd}else{try{var d=document.selection.createRange();var i=d.duplicate();i.moveToElementText(c);i.setEndPoint("EndToEnd",d);var a=i.text.length-d.text.length;g=(a+d.text.length)}catch(f){}}if(g==c.value.length){c.scrollTop=c.scrollHeight-c.offsetHeight}};function MessagePump(){this.Requests=new HashTable(true);this.Responses=new Array();this.EventQueue=new Array();this.RequestNumber=1;this.ServerURL=window.location.href.replace(window.location.search,"");if(this.ServerURL.indexOf("#")>0){this.ServerURL=this.ServerURL.substring(0,this.ServerURL.indexOf("#"))}this.ServerURL=this.ServerURL+"?WCI=RD3";this.BlockBox=document.createElement("div");this.BlockBox.setAttribute("id","block-box");document.body.appendChild(this.BlockBox);this.DelayDlg=new PopupDelay();this.XPos=0;this.YPos=0;this.LoadVisible=false;this.OWAMessagePump=null}MessagePump.prototype.AddEvent=function(d){var c=true;var f=this.EventQueue.length;for(var a=0;a<f;a++){var b=this.EventQueue[a];if(b.IsEqual(d)){b.CopyFrom(d);c=false;break}if(this.EventQueue[a].DelayCopies&&this.EventQueue[a].Tipo==d.Tipo){this.EventQueue[a].StartTime=d.StartTime}}if(d.XPosAbs){this.XPos=d.XPosAbs}if(d.YPosAbs){this.YPos=d.YPosAbs}if(c){this.EventQueue.push(d)}return true};MessagePump.prototype.SendEvents=function(){var b=this.EventQueue.length;for(var a=0;a<b;a++){this.EventQueue[a].DelayTime=0}};MessagePump.prototype.GetRequest=function(a){return this.Requests[a]};MessagePump.prototype.RemoveRequest=function(a){this.Requests.remove(a)};MessagePump.prototype.Tick=function(){if(this.Requests.length<RD3_ClientParams.MaxOpenRequests){if(this.EventsToSend()){this.SendRequest()}}var c=RD3_DesktopManager.WebEntryPoint;if(RD3_ClientParams.ShowAjaxIndicator&&c&&c.Realized&&c.ComImg){if(this.Requests.length>0){if(!this.LoadVisible){c.ComImg.style.visibility="";this.LoadVisible=true}}else{if(this.LoadVisible){c.ComImg.style.visibility="hidden";this.LoadVisible=false}}}var d=0;if(this.Requests.length>0){d=(RD3_ClientParams.MaxOpenRequests==1?this.LastReqStartTime:this.Requests.GetItem(0).StartTime)}if(d>0&&(new Date()-d)>RD3_ClientParams.DelayDlgTime&&c&&c.Realized){if(!this.DelayDlg.Opened){this.DelayDlg.Open(RD3_ServerParams.DelayDefaultMessage,RD3_Glb.DELAY)}else{this.DelayDlg.AdaptLayout()}}else{if(this.DelayDlg.Opened){this.DelayDlg.Close()}}var a=this.IsBlocking();if(a&&this.BlockBox.style.display==""){this.BlockBox.style.display="block";RD3_KBManager.CheckFocus=false;document.body.focus()}if(!a&&this.BlockBox.style.display=="block"){this.BlockBox.style.cursor="default";this.BlockBox.style.display="";this.BlockBox.style.cursor=""}this.HandleResponses();if(this.OWAMessagePump){this.OWAMessagePump.Tick()}};MessagePump.prototype.IsBlocking=function(){var b=this.Requests.length;for(var a=0;a<b;a++){if(RD3_ClientParams.MaxOpenRequests==1?this.LastReqBlocking:this.Requests.GetItem(a).Blocking){return true}}return false};MessagePump.prototype.SendRequest=function(){if(this.EventQueue.length>0){if(this.OWAMessagePump){var c=this.EventQueue.length;for(var j=0;j<c;j++){var k=this.EventQueue.shift();this.OWAMessagePump.AddEvent(k)}}else{if(RD3_DesktopManager&&RD3_DesktopManager.WebEntryPoint){RD3_DesktopManager.WebEntryPoint.SetRefreshInterval()}var o=this.CreateRequest();if(RD3_ClientParams.MaxOpenRequests==1){this.LastReqStartTime=new Date()}else{o.StartTime=new Date()}var a=Math.floor(Math.random()*1111111);var h="r"+a;this.Requests.add(h,o);var b=this.CreateXMLDoc("rd3");var d=b.getElementsByTagName("rd3");var m=d[0];m.setAttribute("num",this.RequestNumber);this.RequestNumber++;var g=(RD3_DesktopManager&&RD3_DesktopManager.WebEntryPoint&&RD3_DesktopManager.WebEntryPoint.CanOWA);if(g){o.sentEvents=new Array()}var f=false;var c=this.EventQueue.length;for(var j=0;j<c;j++){var k=this.EventQueue.shift();k.WriteXmlNode(m,b);if(k.IsBlocking){f=true}if(g){o.sentEvents.push(k)}}if(RD3_ClientParams.MaxOpenRequests==1){this.LastReqBlocking=f}else{o.Blocking=f}var l="";if(this.RequestNumber==2){l=RD3_ShellObject.SendInfo()}if(RD3_Glb.IsIpad()||RD3_Glb.IsIphone()){l+="&RNDID="+h}o.open("POST",this.ServerURL+l,true);o.onreadystatechange=function(){RD3_DesktopManager.MessagePump.CheckResponse(h)};o.setRequestHeader("Content-Type","text/xml");o.send(b)}}};MessagePump.prototype.CheckResponse=function(a){var b=this.GetRequest(a);if(b&&b.readyState==4){this.Responses.push(a);this.HandleResponses()}};MessagePump.prototype.HandleResponses=function(){if(!RD3_GFXManager.Blocking()){if(this.Responses.length!=0){var b=this.Responses.length;for(var a=0;a<b;a++){RD3_DesktopManager.ProcessResponse(this.Responses[a])}this.Responses.splice(0,b)}}};MessagePump.prototype.CreateRequest=function(){var a=null;if(window.XMLHttpRequest){try{a=new XMLHttpRequest()}catch(b){a=null}}else{if(window.ActiveXObject){try{a=new ActiveXObject("Msxml2.XMLHTTP");RD3_ClientParams.MaxOpenRequests=1}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){a=null}}}}return a};MessagePump.prototype.CreateXMLDoc=function(a){var c=null;if(document.implementation&&document.implementation.createDocument){c=document.implementation.createDocument("",a,null);var b=c.createProcessingInstruction("xml","version='1.0' encoding='UTF-8'");c.insertBefore(b,c.firstChild);return c}else{c=new ActiveXObject("MSXML2.DOMDocument");var d="<"+a+"/>";c.loadXML(d);var b=c.createProcessingInstruction("xml","version='1.0' encoding='UTF-8'");c.insertBefore(b,c.firstChild);return c}};MessagePump.prototype.EventsToSend=function(){if(RD3_DesktopManager&&RD3_DesktopManager.WebEntryPoint&&RD3_DesktopManager.WebEntryPoint.Redirecting){return false}if(this.OWAMessagePump){return true}var c=this.EventQueue.length;var b=new Date();for(var a=0;a<c;a++){if(this.EventQueue[a].CanBeFired(b)){return true}}return false};MessagePump.prototype.GetEvent=function(d,a){var f=d.Identifier?d.Identifier:d;var e=this.EventQueue.length;for(var b=0;b<e;b++){var c=this.EventQueue[b];if((c.ObjId==f||f=="")&&(!a||a==c.Tipo)){return c}}};function MessagePumpRD4(){this.Requests=new HashTable(true);this.Responses=new Array();this.EventQueue=new Array();this.RequestNumber=1;this.BlockBox=document.createElement("div");this.BlockBox.setAttribute("id","block-box");document.body.appendChild(this.BlockBox);this.DelayDlg=new PopupDelay();this.XPos=0;this.YPos=0;this.LoadVisible=false}MessagePumpRD4.prototype.AddEvent=function(d){var c=true;var f=this.EventQueue.length;for(var a=0;a<f;a++){var b=this.EventQueue[a];if(b.IsEqual(d)){b.CopyFrom(d);c=false;break}if(this.EventQueue[a].DelayCopies&&this.EventQueue[a].Tipo==d.Tipo){this.EventQueue[a].StartTime=d.StartTime}}if(d.XPosAbs){this.XPos=d.XPosAbs}if(d.YPosAbs){this.YPos=d.YPosAbs}if(c){this.EventQueue.push(d)}return true};MessagePumpRD4.prototype.SendEvents=function(){var b=this.EventQueue.length;for(var a=0;a<b;a++){this.EventQueue[a].DelayTime=0}};MessagePumpRD4.prototype.GetRequest=function(a){return this.Requests[a]};MessagePumpRD4.prototype.RemoveRequest=function(a){this.Requests.remove(a)};MessagePumpRD4.prototype.Tick=function(){if(this.Requests.length<RD3_ClientParams.MaxOpenRequests){if(this.EventsToSend()){this.SendRequest()}}var c=RD3_DesktopManager.WebEntryPoint;if(RD3_ClientParams.ShowAjaxIndicator&&c&&c.Realized&&c.ComImg){if(this.Requests.length>0){if(!this.LoadVisible){c.ComImg.style.visibility="";this.LoadVisible=true}}else{if(this.LoadVisible){c.ComImg.style.visibility="hidden";this.LoadVisible=false}}}var d=0;if(this.Requests.length>0){d=(RD3_ClientParams.MaxOpenRequests==1?this.LastReqStartTime:this.Requests.GetItem(0).StartTime)}if(d>0&&(new Date()-d)>RD3_ClientParams.DelayDlgTime&&c&&c.Realized){if(!this.DelayDlg.Opened){this.DelayDlg.Open(RD3_ServerParams.DelayDefaultMessage,RD3_Glb.DELAY)}else{this.DelayDlg.AdaptLayout()}}else{if(this.DelayDlg.Opened){this.DelayDlg.Close()}}var a=this.IsBlocking();if(a&&this.BlockBox.style.display==""){this.BlockBox.style.display="block";RD3_KBManager.CheckFocus=false;document.body.focus()}if(!a&&this.BlockBox.style.display=="block"){this.BlockBox.style.cursor="default";this.BlockBox.style.display="";this.BlockBox.style.cursor=""}this.HandleResponses()};MessagePumpRD4.prototype.IsBlocking=function(){var b=this.Requests.length;for(var a=0;a<b;a++){if(RD3_ClientParams.MaxOpenRequests==1?this.LastReqBlocking:this.Requests.GetItem(a).Blocking){return true}}return false};MessagePumpRD4.prototype.SendRequest=function(){if(this.EventQueue.length>0){if(RD3_DesktopManager&&RD3_DesktopManager.WebEntryPoint){RD3_DesktopManager.WebEntryPoint.SetRefreshInterval()}var j=this.CreateRequest();if(RD3_ClientParams.MaxOpenRequests==1){this.LastReqStartTime=new Date()}else{j.StartTime=new Date()}var a=Math.floor(Math.random()*1111111);this.Requests.add("r"+a,j);var b=this.CreateXMLDoc("rd3");var d=b.getElementsByTagName("rd3");var k=d[0];k.setAttribute("num",this.RequestNumber);this.RequestNumber++;var f=false;var c=this.EventQueue.length;for(var g=0;g<c;g++){var h=this.EventQueue.shift();h.WriteXmlNode(k,b);if(h.IsBlocking){f=true}}if(RD3_ClientParams.MaxOpenRequests==1){this.LastReqBlocking=f}else{j.Blocking=f}j.ID="r"+a;j.Referrer=document.referrer;if(b.xml){j.InputStream=b.xml}else{j.InputStream=new XMLSerializer().serializeToString(b)}RD4_ApplicationManager.postMessage(j)}};MessagePumpRD4.prototype.CheckResponse=function(a){var b=this.GetRequest(a.Request.ID);if(b){if(a.responseXML){b.responseXML=this.CreateXMLDoc("rd3");b.responseXML.loadXML(a.responseXML);b.responseText=a.responseXML}else{b.responseText=a.responseText}this.Responses.push(a.Request.ID);this.HandleResponses()}};MessagePumpRD4.prototype.HandleResponses=function(){if(!RD3_GFXManager.Blocking()){if(this.Responses.length!=0){var b=this.Responses.length;for(var a=0;a<b;a++){RD3_DesktopManager.ProcessResponseRD4(this.Responses[a])}this.Responses.splice(0,b)}}};MessagePumpRD4.prototype.CreateRequest=function(){return{}};MessagePumpRD4.prototype.CreateXMLDoc=function(a){var c=null;if(document.implementation&&document.implementation.createDocument){c=document.implementation.createDocument("",a,null);var b=c.createProcessingInstruction("xml","version='1.0' encoding='UTF-8'");c.insertBefore(b,c.firstChild);if(Document.prototype.loadXML==undefined){Document.prototype.loadXML=function(g){try{var j=(new DOMParser()).parseFromString(g,"text/xml");while(this.hasChildNodes()){this.removeChild(this.lastChild)}for(var f=0;f<j.childNodes.length;f++){this.appendChild(this.importNode(j.childNodes[f],true))}return true}catch(h){return false}}}return c}else{c=new ActiveXObject("MSXML2.DOMDocument");var d="<"+a+"/>";c.loadXML(d);var b=c.createProcessingInstruction("xml","version='1.0' encoding='UTF-8'");c.insertBefore(b,c.firstChild);return c}};MessagePumpRD4.prototype.EventsToSend=function(){var c=this.EventQueue.length;var b=new Date();for(var a=0;a<c;a++){if(this.EventQueue[a].CanBeFired(b)){return true}}return false};MessagePumpRD4.prototype.GetEvent=function(d,a){var f=d.Identifier?d.Identifier:d;var e=this.EventQueue.length;for(var b=0;b<e;b++){var c=this.EventQueue[b];if((c.ObjId==f||f=="")&&(!a||a==c.Tipo)){return c}}};function OWAMessagePump(){this.LastOnlineCheck=new Date();this.OnlineReq=null}OWAMessagePump.prototype.Tick=function(){this.OnTick();if(this.OnlineReq==null&&new Date()-this.LastOnlineCheck>RD3_ClientParams.OWAOfflineCheck*1000){this.LastOnlineCheck=new Date();var b=RD3_DesktopManager.MessagePump;this.OnlineReq=b.CreateRequest();this.OnlineReq.StartTime=new Date();var a=b.ServerURL.substring(0,b.ServerURL.indexOf("?"));this.OnlineReq.open("POST",a,true);this.OnlineReq.onreadystatechange=new Function("return RD3_DesktopManager.MessagePump.OWAMessagePump.CheckResponse(1);");this.OnlineReq.setRequestHeader("Content-Type","text/xml");this.OnlineReq.send()}};OWAMessagePump.prototype.CheckResponse=function(a){if(this.OnlineReq.readyState==4){if(a==1){if(this.OnlineReq.status==200&&confirm(ClientMessages.WEP_OWA_CANON)){var g=RD3_DesktopManager.MessagePump;this.OnlineReq=g.CreateRequest();this.OnlineReq.StartTime=new Date();var c=g.CreateXMLDoc("rd3");var j=c.getElementsByTagName("rd3")[0];j.setAttribute("num","owa");var h=RD3_DesktopManager.AppName;var d=localStorage[h+"_maxID"];var k=(d?parseInt(d,10):1);for(var e=1;e<k;e++){var f=new IDEvent();f.LoadFromString(localStorage[h+"_EVT"+e]);f.WriteXmlNode(j,c)}var b=g.ServerURL.substring(0,g.ServerURL.indexOf("?"))+"?CMD=OWABackOnline";this.OnlineReq.open("POST",b,true);this.OnlineReq.onreadystatechange=new Function("return RD3_DesktopManager.MessagePump.OWAMessagePump.CheckResponse(2);");this.OnlineReq.setRequestHeader("Content-Type","text/xml");this.OnlineReq.send(c);return}}else{if(a==2){if(this.OnlineReq.status==200&&this.OnlineReq.responseText=="OK"){this.AfterBackOnline();RD3_DesktopManager.MessagePump.OWAMessagePump=null;var h=RD3_DesktopManager.AppName;localStorage.removeItem(h+"_start");var d=localStorage[h+"_maxID"];var k=(d?parseInt(d,10):1);for(var e=1;e<k;e++){localStorage.removeItem(h+"_EVT"+e)}localStorage.removeItem(h+"_maxID");window.location.reload(true)}else{alert(ClientMessages.WEP_OWA_NOON)}}}this.OnlineReq=null}};OWAMessagePump.prototype.restoreFromStorage=function(){var f=RD3_DesktopManager.AppName;var c=localStorage[f+"_start"];var a;if(RD3_Glb.IsIE()){a=RD3_DesktopManager.MessagePump.CreateXMLDoc("rd3");a.loadXML(c)}else{a=(new DOMParser()).parseFromString(c,"text/xml")}RD3_DesktopManager.ProcessXmlDoc(a);var b=localStorage[f+"_maxID"];var e=(b?parseInt(b,10):1);for(var d=1;d<e;d++){var g=new IDEvent();g.LoadFromString(localStorage[f+"_EVT"+d]);this.ReplayEvent(g)}this.AfterReplay()};OWAMessagePump.prototype.AddEvent=function(k){if(k.Tipo=="chg"){var g=RD3_DesktopManager.ObjectMap[k.ObjId];if(g&&g instanceof PValue){var l=g.ParentField;var b=l.ParentPanel;k.Tag=b.TableName+"|"+l.DBCode+"|";for(var h=0;h<b.Fields.length;h++){var j=b.Fields[h];if(j.IsPK){if(k.Tag.substring(k.Tag.length-1,k.Tag.length)!="|"){k.Tag+=","}k.Tag+=j.DBCode+"="+j.PValues[g.Index].Text}}}}if(!this.OnEvent(k)){if(k.Tipo!="fev"&&k.Tipo!="start"&&k.Tipo!="resize"&&k.Tipo!="sound"){var p=RD3_DesktopManager.AppName;var d=localStorage[p+"_maxID"];var t=(d?parseInt(d,10):1);var o=true;var q=0;var c="";try{var u=k.ToString();localStorage[p+"_EVT"+t]=u;var a=localStorage[p+"_EVT"+t];if(a!=u){q=1;o=false}else{q=2;var n=new IDEvent();n.LoadFromString(a)}if(o){t++;localStorage[p+"_maxID"]=t}}catch(m){o=false;c=m}if(!o){alert("ATTENZIONE: tornare ONLINE appena possibile. Errore "+q+": "+c)}}}};OWAMessagePump.prototype.ReplayEvent=function(b){if(b.Tipo=="chg"){var a=RD3_DesktopManager.ObjectMap[b.ObjId];if(a&&a instanceof PValue){a.Text=b.Par1;a.UpdateScreen()}}this.OnReplayEvent(b)};OWAMessagePump.prototype.OnEvent=function(a){};OWAMessagePump.prototype.OnReplayEvent=function(a){};OWAMessagePump.prototype.OnTick=function(){};OWAMessagePump.prototype.AfterReplay=function(){setTimeout("alert(ClientMessages.WEP_OWA_OFFLINE);",500)};OWAMessagePump.prototype.AfterBackOnline=function(){};function ServerParams(){this.Theme="";this.SmartLookupIcon=false;this.ShowDisabledIcons=false;this.RightAlignedIcons=false;this.ShowFieldImageInValue=true;this.ShowDisabledFieldActivator=true;this.AllowMasterPanelNavigation=false;this.TooltipErrorMode=1;this.EnableFrameResize=false;this.UseHTML5Upload=true;this.CompletePanelBorders=false;this.UseZones=true;this.BorderType=RD3_Glb.BORDER_DEFAULT;this.UseIDEditor=true;this.EnterChangeFocus=false;this.CurrencyMask="#,###,###,##0.00";this.DateMask="dd/mm/yyyy";this.TimeMask="hh:nn";this.FloatMask="#,###,###,###.####";this.Aggiorna="";this.AzzeraQBE="";this.BottoneRitorna="";this.CampoObbl="";this.CancellaDoc="";this.CaricaDoc="";this.ChiudiForm="";this.ModalChiudiForm="";this.ChiudiAppl="";this.ChiudiTutto="";this.ComandoAllegati="";this.ComandoGruppi="";this.ComandoCommenti="";this.ConfirmDelete="";this.ModalConfirm="";this.CreatePDF="";this.ConfirmMenu="";this.Print="";this.ShowBlob="";this.UploadBlob="";this.MostraMenu="";this.MostraRiquadro="";this.NascondiMenu="";this.NascondiRiquadro="";this.PaginaNM="";this.PanelPaginaPrec="";this.BookPaginaPrec="";this.PanelPaginaSucc="";this.BookPaginaSucc="";this.SBP_DATA1="";this.SBP_DATA2="";this.SBP_INSERT="";this.SBP_QBE="";this.SBP_UPD="";this.TooltipCancel="";this.TooltipCerca="";this.TooltipDelete="";this.TooltipDeseleziona="";this.TooltipDuplicate="";this.TooltipFormList="";this.TooltipInsert="";this.TooltipLock="";this.TooltipShowCheck="";this.TooltipShowRowSel="";this.TooltipRefresh="";this.TooltipSelectAll="";this.TooltipTrova="";this.TooltipUnlock="";this.TooltipUpdate="";this.BookFine="";this.PanelFine="";this.PanelInizio="";this.BookInizio="";this.VideateAperte="";this.VisualizzaDocumento="";this.RigaN="";this.RigaNM="";this.TooltipExport="";this.ErrorNum="";this.ErrorEffects="";this.ErrorAction="";this.ErrorSrc="";this.ErrorButton="";this.DelayDefaultMessage="";this.TooltipMultipleCommandset="";this.UnloadMessage="PREMI CANCEL, POI CHIUDI L'APPLICAZIONE\nCON IL PULSANTE APPOSITO IN ALTO A DESTRA";this.UnloadMessage=undefined}ServerParams.prototype.LoadFromXml=function(a){this.LoadProperties(a)};ServerParams.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"thm":this.SetTheme(a);break;case"sli":this.SetSmartLookupIcon(a!="NO");break;case"shd":this.SetShowDisabledIcons(a=="1");break;case"rai":this.SetRightAlignedIcons(a=="1");break;case"sfi":this.SetShowFieldImageInValue(a=="1");break;case"amp":this.SetAllowMasterPanelNavigation(a=="1");break;case"sda":this.SetShowDisabledFieldActivator(a=="1");break;case"tem":this.SetTooltipErrorMode(a);break;case"frs":this.SetEnableFrameResize(a=="1");break;case"jsu":this.SetUseHTML5Upload(a=="1");break;case"cpb":this.SetCompletePanelBorders(a=="1");break;case"uzn":this.SetUseZones(a=="1");break;case"brt":this.SetBorderType(a);break;case"ued":this.SetUseIDEditor(a=="1");break;case"ent":this.SetEnterChangeFocus(a=="1");break;case"cmk":this.SetCurrencyMask(a);break;case"dmk":this.SetDateMask(a);break;case"tmk":this.SetTimeMask(a);break;case"fmk":this.SetFloatMask(a);break;case"M001":this.Aggiorna=a;break;case"M002":this.AzzeraQBE=a;break;case"M003":this.BottoneRitorna=a;break;case"M004":this.CampoObbl=a;break;case"M005":this.CancellaDoc=a;break;case"M006":this.CaricaDoc=a;break;case"M007":this.ChiudiForm=a;break;case"M008":this.ModalChiudiForm=a;break;case"M009":this.ChiudiAppl=a;break;case"M010":this.ChiudiTutto=a;break;case"M011":this.ComandoAllegati=a;break;case"M012":this.ComandoCommenti=a;break;case"M013":this.ConfirmDelete=a;break;case"M014":this.ModalConfirm=a;break;case"M015":this.CreatePDF=a;break;case"M016":this.ConfirmMenu=a;break;case"M017":this.Print=a;break;case"M018":this.ShowBlob=a;break;case"M019":this.UploadBlob=a;break;case"M020":this.MostraMenu=a;break;case"M021":this.MostraRiquadro=a;break;case"M022":this.NascondiMenu=a;break;case"M023":this.NascondiRiquadro=a;break;case"M024":this.PaginaNM=RD3_Glb.IsIphone()?"|1/|2":a;break;case"M025":this.PanelPaginaPrec=a;break;case"M026":this.BookPaginaPrec=a;break;case"M027":this.PanelPaginaSucc=a;break;case"M028":this.BookPaginaSucc=a;break;case"M029":this.SBP_DATA1=RD3_Glb.IsIphone()?"|1":a;break;case"M030":this.SBP_DATA2=RD3_Glb.IsIphone()?"|1/|2":a;break;case"M031":this.SBP_INSERT=RD3_Glb.IsIphone()?"NEW":a;break;case"M032":this.SBP_QBE=RD3_Glb.IsIphone()?"QBE":a;break;case"M033":this.SBP_UPD=RD3_Glb.IsIphone()?"MOD":a;break;case"M034":this.TooltipCancel=a;break;case"M035":this.TooltipCerca=a;break;case"M036":this.TooltipDelete=a;break;case"M037":this.TooltipDeseleziona=a;break;case"M038":this.TooltipDuplicate=a;break;case"M039":this.TooltipFormList=a;break;case"M040":this.TooltipInsert=a;break;case"M041":this.TooltipLock=a;break;case"M042":this.TooltipShowCheck=a;break;case"M043":this.TooltipShowRowSel=a;break;case"M044":this.TooltipRefresh=a;break;case"M045":this.TooltipSelectAll=a;break;case"M046":this.TooltipTrova=a;break;case"M047":this.TooltipUnlock=a;break;case"M048":this.TooltipUpdate=a;break;case"M049":this.BookFine=a;break;case"M050":this.PanelFine=a;break;case"M051":this.PanelInizio=a;break;case"M052":this.BookInizio=a;break;case"M053":this.VideateAperte=a;break;case"M054":this.VisualizzaDocumento=a;break;case"M055":this.RigaN=RD3_Glb.IsIphone()?"|1":a;break;case"M056":this.RigaNM=RD3_Glb.IsIphone()?"|1/|2":a;break;case"M057":this.TooltipExport=a;break;case"M058":this.ErrorNum=a;break;case"M059":this.ErrorEffects=a;break;case"M060":this.ErrorAction=a;break;case"M061":this.ErrorSrc=a;break;case"M062":this.ErrorButton=a;break;case"M063":this.DelayDefaultMessage=a;break;case"M064":this.ComandoGruppi=a;break;case"M065":this.TooltipMultipleCommandset=a;break}}};ServerParams.prototype.SetTheme=function(a){this.Theme=a};ServerParams.prototype.SetSmartLookupIcon=function(a){this.SmartLookupIcon=a};ServerParams.prototype.SetShowDisabledIcons=function(a){this.ShowDisabledIcons=a};ServerParams.prototype.SetRightAlignedIcons=function(a){this.RightAlignedIcons=a};ServerParams.prototype.SetShowFieldImageInValue=function(a){this.ShowFieldImageInValue=a};ServerParams.prototype.SetCurrencyMask=function(a){this.CurrencyMask=a};ServerParams.prototype.SetDateMask=function(a){this.DateMask=a};ServerParams.prototype.SetTimeMask=function(a){this.TimeMask=a};ServerParams.prototype.SetFloatMask=function(a){this.FloatMask=a};ServerParams.prototype.SetAllowMasterPanelNavigation=function(a){this.AllowMasterPanelNavigation=a};ServerParams.prototype.SetShowDisabledFieldActivator=function(a){this.ShowDisabledFieldActivator=a};ServerParams.prototype.SetTooltipErrorMode=function(a){this.TooltipErrorMode=a};ServerParams.prototype.SetEnableFrameResize=function(a){this.EnableFrameResize=a};ServerParams.prototype.SetUseHTML5Upload=function(a){this.UseHTML5Upload=a};ServerParams.prototype.SetCompletePanelBorders=function(a){this.CompletePanelBorders=a};ServerParams.prototype.SetUseZones=function(a){this.UseZones=a};ServerParams.prototype.SetBorderType=function(a){this.BorderType=a};ServerParams.prototype.SetUseIDEditor=function(a){this.UseIDEditor=a};ServerParams.prototype.SetEnterChangeFocus=function(a){this.EnterChangeFocus=a};function Shell(){}Shell.prototype.SendCmd=function(f,h){var b=self._ShellURL+"?_CMD="+f;if(h){if(typeof(h)=="string"){b+="&"+h}else{var e=Object.keys(h);for(var d=0;d<e.length;d++){var c=e[d];var g=h[c];b+="&"+c+"="+btoa(unescape(encodeURIComponent(g)))}}}var a=new XMLHttpRequest();a.open("GET",b,false);a.send(null);return a.responseText};Shell.prototype.SendInfo=function(){if(this.IsInsideShell()){return"&ISSHELL=1&VERSION="+this.Version()+"&HASCAMERA="+(this.HasCamera()?"1":"0")+"&DEVICEID="+this.DeviceID()+"&DEVICENAME="+this.DeviceName()+"&SYNCHSRV="+this.SynchServer()}else{return""}};Shell.prototype.IsInsideShell=function(){return(self._ShellURL!=undefined)};Shell.prototype.IsInsideCaravel=function(){if(this.iIsInsideCaravel===undefined){if(this.IsInsideShell()){switch(parseInt(this.SendCmd("ISINSIDECARAVEL"))){case 0:this.iIsInsideCaravel=0;break;case 1:this.iIsInsideCaravel=-1;break;default:this.iIsInsideCaravel=null;break}}else{this.iIsInsideCaravel=null}}return this.iIsInsideCaravel};Shell.prototype.Version=function(){if(this.iVersion==undefined){this.iVersion=(this.IsInsideShell()?this.SendCmd("GETVER"):"")}return this.iVersion};Shell.prototype.HasCamera=function(){if(this.iHasCamera==undefined){this.iHasCamera=(this.IsInsideShell()&&this.SendCmd("HASCAMERA")=="OK")}return this.iHasCamera};Shell.prototype.DeviceID=function(){if(this.iDeviceID==undefined){this.iDeviceID=(this.IsInsideShell()?this.SendCmd("GETSETTING",{KEY:"DEVICEID"}):"")}return this.iDeviceID};Shell.prototype.DeviceName=function(){if(this.iDeviceName==undefined){this.iDeviceName=(this.IsInsideShell()?this.SendCmd("GETSETTING",{KEY:"DEVICENAME"}):"")}return this.iDeviceName};Shell.prototype.DeviceIP=function(){return(this.IsInsideShell()?this.SendCmd("GETSETTING",{KEY:"DEVICEIP"}):"")};Shell.prototype.SynchServer=function(){return(this.IsInsideShell()?this.SendCmd("GETSETTING",{KEY:"SYNCSRV"}):"")};Shell.prototype.StartListen=function(c,a,b){if(this.IsInsideShell()){return this.SendCmd("STARTLISTEN",{LANG:c,DETTYPE:a,RECTYPE:b})}};Shell.prototype.StopListen=function(){if(this.IsInsideShell()){return this.SendCmd("STOPLISTEN")}};Shell.prototype.Say=function(c,b,a){if(this.IsInsideShell()){return this.SendCmd("SAY",{TEXT:c,LANG:b,RATE:a})}};function TooltipManager(){this.BaseTooltip=null;this.BaseTooltipBis=null;this.CustomTooltip=null;this.Style="info";this.DelayShow=750;this.DelayHide=4000;this.AnimDef="fade:250";this.OldXPos=-1;this.OldYPos=-1;this.Enabled=true;this.Tooltips=new Array()}TooltipManager.prototype.Init=function(){this.BaseTooltip=new MessageTooltip(this);this.BaseTooltipBis=new MessageTooltip(this);var d=new Function("ev","return RD3_TooltipManager.OnMouseOver(ev)");var f=new Function("ev","return RD3_TooltipManager.OnMouseMove(ev)");var a=new Function("ev","return RD3_TooltipManager.OnMouseOut(ev)");var c=new Function("ev","return RD3_TooltipManager.OnMouseDown(ev)");var e=new Function("ev","return RD3_TooltipManager.OnClick(ev)");var b=new Function("ev","return RD3_TooltipManager.OnKeyDown(ev)");if(document.addEventListener){document.addEventListener("mouseover",d,true);document.addEventListener("mousemove",f,true);document.addEventListener("mouseout",a,true);document.addEventListener("mousedown",c,true);document.addEventListener("click",e,true);document.body.addEventListener("keydown",b,true)}else{document.attachEvent("onmouseover",d);document.attachEvent("onmousemove",f);document.attachEvent("onmouseout",a);document.attachEvent("onmousedown",c);document.attachEvent("onclick",e);document.body.attachEvent("onkeydown",b)}};TooltipManager.prototype.OnMouseOver=function(c){if(!this.Enabled||RD3_Glb.IsMobile()){return}if(RD3_DDManager.IsDragging){return}var a=(window.event)?window.event.clientX:c.clientX;var f=(window.event)?window.event.clientY:c.clientY;var d=(window.event)?window.event.srcElement:c.target;if(!d){return}var e=RD3_KBManager.GetObject(d);if(e&&e.GetTooltip){if(this.BaseTooltip.Opened){var b=this.BaseTooltip;this.BaseTooltip=this.BaseTooltipBis;this.BaseTooltipBis=b}this.BaseTooltip.Reset();this.BaseTooltip.SetStyle(this.Style);this.BaseTooltip.SetObj(d);this.BaseTooltip.SetDelay(this.DelayShow,this.DelayHide);this.BaseTooltip.SetAnimDef(this.AnimDef);if(e.CustomTooltip){this.CustomTooltip=e.CustomTooltip;this.CustomTooltip.Activate(a,f)}else{if(e.GetTooltip(this.BaseTooltip,d)){this.BaseTooltip.SetOwner(e);this.BaseTooltip.Activate(a,f)}}}};TooltipManager.prototype.OnMouseMove=function(b){if(!this.Enabled){return}var a=(window.event)?window.event.clientX:b.clientX;var c=(window.event)?window.event.clientY:b.clientY;if(this.OldXPos==a&&this.OldYPos==c){return}this.OldXPos=a;this.OldYPos=c;if(this.BaseTooltip.Owner!=this){if(RD3_DDManager.IsDragging){this.BaseTooltip.SetOwner(this);this.BaseTooltip.Deactivate()}else{if(this.BaseTooltip.DelayShow>0&&this.BaseTooltip.ShowTimerID>0){this.BaseTooltip.Activate(a,c)}}}};TooltipManager.prototype.OnMouseDown=function(a){if(!this.Enabled){return}this.DeactivateAll()};TooltipManager.prototype.OnClick=function(a){if(!this.Enabled){return}var b=(window.event)?window.event.srcElement:a.target;if(!b){return}var c=RD3_KBManager.GetObject(b);if(c instanceof MessageTooltip){c.Deactivate(c.ReusableTooltip)}};TooltipManager.prototype.OnMouseOut=function(a){if(!this.Enabled){return}if(RD3_DDManager.IsDragging){return}if(this.CustomTooltip){this.CustomTooltip.Deactivate();return}if(this.BaseTooltip.Owner!=this){if(this.BaseTooltip.DelayShow>0){this.BaseTooltip.SetOwner(this);this.BaseTooltip.Deactivate()}}};TooltipManager.prototype.OnKeyDown=function(a){if(!this.Enabled){return}this.DeactivateAll()};TooltipManager.prototype.DeactivateAll=function(){if(!this.Enabled){return}if(this.BaseTooltip.Owner!=this){if(this.BaseTooltip.DelayShow>0){this.BaseTooltip.Deactivate(true)}}for(var a in this.Tooltips){var b=this.Tooltips[a];if(b.ShowOnInactivity){b.Deactivate()}}};TooltipManager.prototype.SetEnabled=function(a){this.Enabled=a};TooltipManager.prototype.SetObjTitle=function(a,b){if(!this.Enabled&&!RD3_Glb.IsMobile()){if(b!=""){a.setAttribute("title",b)}else{a.removeAttribute("title")}}};TooltipManager.prototype.HandleTooltip=function(g){var l=new MessageTooltip();var f=g.getAttribute("id");if(f!=""){var j=document.getElementById(f);if(j){l.SetOwner(RD3_KBManager.GetObject(j));l.SetObj(j)}else{var d=RD3_DesktopManager.ObjectMap[f];if(d){l.SetOwner(d);if(d.GetDOMObj){l.SetObj(d.GetDOMObj())}}}if(!l.Obj){return}}l.SetTitle(g.getAttribute("title"));l.SetText(g.getAttribute("text"));var q=g.getAttribute("anchorx");var p=g.getAttribute("anchory");if(q!=null&&p!=null){l.SetAnchor(parseInt(q),parseInt(p))}var e=g.getAttribute("position");if(e!=null){l.SetPosition(parseInt(e))}var h=g.getAttribute("showdelay");var k=g.getAttribute("hidedelay");h=(h==null?750:parseInt(h));k=(k==null?4000:parseInt(k));l.SetDelay(h,k);var i=g.getAttribute("showoninactivity");if(i!=null){l.SetShowOnInactivity(i!="0")}var n=g.getAttribute("width");if(n!=null){l.SetWidth(parseInt(n))}var c=g.getAttribute("height");if(c!=null){l.SetHeight(parseInt(c))}var m=g.getAttribute("style");if(m!=null){l.SetStyle(m)}else{l.SetStyle(this.Style)}var a=g.getAttribute("haswhisker");if(a!=null){l.SetHasWhisker(a!="0")}var b=g.getAttribute("image");if(b!=null){l.SetImage(b)}l.SetAnimDef(this.AnimDef);if(l.DelayShow==-1){l.SetDelay(0,0);l.SetCanClose(false);l.SetAnimDef("none");l.Owner.CustomTooltip=l}else{this.Tooltips.push(l);l.Activate()}};TooltipManager.prototype.OnDeactivate=function(b){if(b==this.CustomTooltip){return}if(b==this.BaseTooltip||b==this.BaseTooltipBis){b.SetOwner(this);b.SetObj(null);return}var c=this.Tooltips.length;for(var a=0;a<c;a++){if(this.Tooltips[a]==b){this.Tooltips.splice(a,1)}}b.SetOwner(null)};TooltipManager.prototype.IsObjVisible=function(a){while(a&&a!=document.body){if(a.style&&(a.style.display=="none"||a.style.visibility=="hidden")){return false}a=a.parentNode}return(a!=null)};TooltipManager.prototype.ResetTooltip=function(b){var d=b.getAttribute("id");var a=0;while(a<this.Tooltips.length){var c=this.Tooltips[a];if(c.Obj&&this.IsObjParent(c.Obj,d)){c.Deactivate()}else{a++}}};TooltipManager.prototype.IsObjParent=function(a,b){a=a.parentNode;while(a&&a!=document.body){if(a.getAttribute("id")==b){return true}a=a.parentNode}return false};function DebuggerItem(b,a){this.Message=b;this.DateTime=new Date();this.Type=a;this.Sequence=false}DebuggerItem.prototype.Print=function(){return"<br>("+this.DateTime.getTime()+"): "+this.Message};DebuggerItem.prototype.PrintSequence=function(a){if(a){if(this.DateTime>a){return"<br>(->"+(this.DateTime-a)+" ms): "+this.Message}else{return"<br>(->"+(a-this.DateTime)+" ms): "+this.Message}}else{return this.Print()}};function DebuggerManager(){this.DebuggerItems=new Array();this.Started=false;this.Msg=null;this.ProcCollection=new Array();this.DateCollection=new Array()}DebuggerManager.prototype.AddMessage=function(d,c,a){if(!this.Started){return}var b=new DebuggerItem(d,c);if(a){b.Sequence=a}this.DebuggerItems.push(b)};DebuggerManager.prototype.EnterProc=function(a){if(!this.Started){return}this.AddMessage("[Proc "+a+"]: Enter",0,true);this.ProcCollection.push(a);this.DateCollection.push(new Date())};DebuggerManager.prototype.ExitProc=function(){if(!this.Started){return}var b=this.ProcCollection.pop();var a=this.DateCollection.pop();if(b&&a){var c=new Date()-a;this.AddMessage("[Proc "+b+"]: Exited, Duration: "+c+" ms",0,true)}};DebuggerManager.prototype.Log=function(a){if(!this.Started){return}this.AddMessage(a,0,false)};DebuggerManager.prototype.Start=function(){this.Started=true};DebuggerManager.prototype.Stop=function(){this.Started=false};DebuggerManager.prototype.Show=function(){if(this.Started){var b="<div style='overflow:auto; height:300px; width:400px;'>";var f=this.DebuggerItems.length;var e=null;for(var c=0;c<f;c++){var d=this.DebuggerItems[c];if(d.Sequence&&e){b+=d.PrintSequence(e)}else{b+=d.Print()}e=d.DateTime}b+="</div>";var a=new MessageBox(b,RD3_Glb.MSG_BOX,false);a.Open()}};DebuggerManager.prototype.CopyToClipboard=function(a){};function ClientEvents(){}ClientEvents.prototype.HandleEvent=function(a){return true};ClientEvents.prototype.OnDebug=function(a){return true};ClientEvents.prototype.OnHelp=function(a){return true};function IDEvent(i,g,e,l,d,c,b,o,n,f,j,m,k,h){this.Tipo=i;this.ObjId=g;this.ObjName="";this.Par1=null;this.Par2=null;this.Par3=null;this.Par4=null;this.Par5=null;this.Par6=null;this.Tag=null;this.StartTime=new Date();this.DelayType=j;this.DelayCopies=h;if(d!=undefined){this.ObjName=d}if(c!=undefined){this.Par1=c}if(b!=undefined){this.Par2=b}if(o!=undefined){this.Par3=o}if(n!=undefined){this.Par4=n}if(m!=undefined){this.Par5=m}if(k!=undefined){this.Par6=k}if(e!=undefined){if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.XPos=e.screenX;this.YPos=e.screenY;this.XPosAbs=this.XPos;this.YPosAbs=this.YPos}else{this.XPos=window.event?window.event.offsetX:e.layerX;this.YPos=window.event?window.event.offsetY:e.layerY;var a=window.event?event.srcElement:e.target;if(a){this.XPosAbs=RD3_Glb.GetScreenLeft(a)+this.XPos;this.YPosAbs=RD3_Glb.GetScreenTop(a)+this.YPos}}this.ShiftPress=window.event?window.event.shiftKey:e.shiftKey;this.CtrlPress=window.event?window.event.ctrlKey:e.ctrlKey;this.AltPress=window.event?window.event.altKey:e.altKey}this.IsBlocking=l&RD3_Glb.EVENT_BLOCKING;this.ClientSide=l&RD3_Glb.EVENT_CLIENTSIDE;this.ServerSide=l&RD3_Glb.EVENT_SERVERSIDE;if(l&RD3_Glb.EVENT_IMMEDIATE){this.DelayTime=RD3_ClientParams.DelayTimes[i];if(!this.DelayTime){this.DelayTime=0}}else{this.DelayTime=600000}if(f!=undefined&&f!=null){this.DelayTime=f}if(this.ClientSide){if(!RD3_ClientEvents.HandleEvent(this)){this.ClientSide=false;this.ServerSide=false}}if(this.ServerSide){RD3_DesktopManager.AddEvent(this)}}IDEvent.prototype.WriteXmlNode=function(b,a){var c=a.createElement(this.Tipo);if(this.ObjId!=""){c.setAttribute("oid",this.ObjId)}if((this.ObjName+"")!=""){c.setAttribute("obn",this.ObjName)}if(this.XPos){c.setAttribute("xck",this.XPos)}if(this.YPos){c.setAttribute("yck",this.YPos)}if(this.ShiftPress){c.setAttribute("shp",this.ShiftPress?"-1":"0")}if(this.CtrlPress){c.setAttribute("ctp",this.CtrlPress?"-1":"0")}if(this.AltPress){c.setAttribute("atp",this.AltPress?"-1":"0")}if(this.Par1!=null){c.setAttribute("par1",this.HandleCharBugs(this.Par1))}if(this.Par2!=null){c.setAttribute("par2",this.HandleCharBugs(this.Par2))}if(this.Par3!=null){c.setAttribute("par3",this.HandleCharBugs(this.Par3))}if(this.Par4!=null){c.setAttribute("par4",this.HandleCharBugs(this.Par4))}if(this.Par5!=null){c.setAttribute("par5",this.HandleCharBugs(this.Par5))}if(this.Par6!=null){c.setAttribute("par6",this.HandleCharBugs(this.Par6))}if(this.Tag!=null){c.setAttribute("tag",this.HandleCharBugs(this.Tag))}if(RD3_KBManager.LastActiveObject){c.setAttribute("ace",RD3_KBManager.LastActiveObject.Identifier)}b.appendChild(c)};IDEvent.prototype.HandleCharBugs=function(a){if(!RD3_Glb.IsSafari(3)){return a}if(!a.replace||(a.indexOf('"')==-1&&a.indexOf("&")==-1)){return a}a=a.replace(/&/g,"&amp;");a=a.replace(/"/g,"&quot;");return a};IDEvent.prototype.CanBeFired=function(a){return(a-this.StartTime>=this.DelayTime)};IDEvent.prototype.IsEqual=function(a){if(this.Tipo=="panms"&&this.ObjName!=a.ObjName){return false}if(this.Tipo=="pantb"){return false}if(this.Tipo=="trnexp"){return false}if(this.Tipo=="fev"){return false}if(this.Tipo=="keypress"){return false}if(this.Tipo=="resize"&&this.ObjName!=a.ObjName){return false}if(this.Tipo=="sound"&&this.ObjName!=a.ObjName){return false}if(this.Tipo=="cmd"){return false}if(this.Tipo=="IWFiles"){return false}return(this.Tipo==a.Tipo&&this.ObjId==a.ObjId)};IDEvent.prototype.CopyFrom=function(a){this.Tipo=a.Tipo;this.ObjId=a.ObjId;this.ObjName=a.ObjName;this.Par1=a.Par1;this.Par2=a.Par2;this.Par3=a.Par3;this.Par4=a.Par4;this.Par5=a.Par5;this.Par6=a.Par6;this.XPos=a.XPos;this.YPos=a.YPos;this.ShiftPress=a.ShiftPress;this.CtrlPress=a.CtrlPress;this.AltPress=a.AltPress;if(this.DelayTime>a.DelayTime){this.DelayTime=a.DelayTime}if(this.DelayType){this.StartTime=a.StartTime}this.IsBlocking=a.IsBlocking;this.ServerSide=a.ServerSide;this.ClientSide=a.ClientSide};IDEvent.prototype.ToString=function(){var a=this.Tipo+"~";a+=this.ObjId+"~";a+=this.ObjName+"~";a+=this.XPos+"~";a+=this.YPos+"~";a+=(this.ShiftPress?"-1":"0")+"~";a+=(this.CtrlPress?"-1":"0")+"~";a+=(this.AltPress?"-1":"0")+"~";a+=this.Par1+"~";a+=this.Par2+"~";a+=this.Par3+"~";a+=this.Par4+"~";a+=this.Par5+"~";a+=this.Par6+"~";a+=this.Tag+"~";return a};IDEvent.prototype.LoadFromString=function(a){var b=a.split("~");this.Tipo=b[0];this.ObjId=b[1];this.ObjName=b[2];if(b[2]!="undefined"){this.XPos=parseInt(b[3],10)}if(b[3]!="undefined"){this.YPos=parseInt(b[4],10)}this.ShiftPress=(b[5]=="-1");this.CtrlPress=(b[6]=="-1");this.AltPress=(b[7]=="-1");this.Par1=b[8];this.Par2=b[9];this.Par3=b[10];this.Par4=b[11];this.Par5=b[12];this.Par6=b[13];this.Tag=b[14]};function GFX(b,h,f,c,g,e){this.Classe=b;this.Flin=h;this.Obj=f;this.ObjOut=g;this.Skipped=c;this.Tipo=RD3_ClientParams.GFXDef[this.Classe];if(e){this.Tipo=e}this.Durata=250;this.Blocking=false;this.WebkitTick=0;var d=this.Tipo.indexOf(":");if(d>-1){var a=this.Tipo.indexOf("!");if(a!=-1){this.Blocking=true;this.Tipo=this.Tipo.substring(0,a)}this.Durata=parseInt(this.Tipo.substring(d+1));this.Tipo=this.Tipo.substring(0,d)}if(c||this.Tipo=="none"||!RD3_ClientParams.EnableGFX||RD3_Glb.IsMobile()){this.Durata=0}this.Finished=false;this.Started=false;this.CloseFormAnimation=false;this.OldValue=false;this.Immediate=false;this.UnrealizeOnFinish=false;this.ExecuteFinish=false}GFX.prototype.Start=function(){if(this.Durata==0){this.SetFinished();return}this.StartDate=new Date();if(this.Obj&&this.Obj.style){this.ObjOverflow=this.Obj.style.overflow}switch(this.Classe){case"menu":this.MenuStart();break;case"sidebar":this.SideBarStart();break;case"start":this.StartStart();break;case"form":this.FormStart();break;case"frame":this.FrameStart();break;case"tree":this.TreeStart();break;case"modal":this.ModalStart();break;case"list":this.ListStart();break;case"tab":this.TabStart();break;case"popup":this.PopupStart();break;case"graph":this.GraphStart();break;case"book":this.BookStart();break;case"message":this.MessageStart();break;case"lastmessage":this.LastMessageStart();break;case"redirect":this.RedirectStart();break;case"preview":this.PreviewStart();break;case"docked":this.DockedStart();break;case"popupres":this.PopupResizeStart();break;case"tooltip":this.TooltipStart();break;case"taskbar":this.TaskBarStart();break;case"combo":this.ComboStart();break;case"group":this.GroupStart();break;case"zone":this.ZoneStart();break;case"unpinned":this.UnpinnedStart();break}};GFX.prototype.Tick=function(){if(this.WebkitTick>0){this.WebkitTick--;if(this.WebkitTick==0){this.SetFinished()}}if(this.IsFinished()){return}if(!this.Started&&RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){if(RD3_GFXManager.WebKitAnimating()){return}this.StartWebKit()}this.Started=true;if(this.IsWebKit){return}var b=new Date();var a=(b-this.StartDate)/this.Durata;if(a>=1){a=1;if(this.ExecuteFinish){this.SetFinished();return}}a=Math.sqrt(a);switch(this.Classe){case"menu":this.MenuTick(a);break;case"sidebar":if(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){this.SideBarRightTick(a)}else{this.SideBarTick(a)}break;case"start":this.StartTick(a);break;case"form":this.FormTick(a);break;case"frame":this.FrameTick(a);break;case"tree":this.TreeTick(a);break;case"modal":this.ModalTick(a);break;case"list":this.ListTick(a);break;case"tab":this.TabTick(a);break;case"popup":this.PopupTick(a);break;case"graph":this.GraphTick(a);break;case"book":this.BookTick(a);break;case"message":this.MessageTick(a);break;case"lastmessage":this.LastMessageTick(a);break;case"redirect":this.RedirectTick(a);break;case"preview":this.PreviewTick(a);break;case"docked":this.DockedTick(a);break;case"popupres":this.PopupResizeTick(a);break;case"tooltip":this.TooltipTick(a);break;case"taskbar":this.TaskBarTick(a);break;case"combo":this.ComboTick(a);break;case"group":this.GroupTick(a);break;case"zone":this.ZoneTick(a);break;case"unpinned":this.UnpinnedTick(a);break}if(a==1){this.ExecuteFinish=true}};GFX.prototype.SetFinished=function(){if(this.IsWebKit){if(this.ObjW<0){this.ObjW=-this.ObjW}if(this.ObjH<0){this.ObjH=-this.ObjH}}if(this.TargetObj){this.TargetObj.removeEventListener("webkitTransitionEnd",RD3_GFXManager.OnEndAnimation,false);this.TargetObj=null}this.ResetWebKitTiming();switch(this.Classe){case"menu":this.MenuFinish();break;case"sidebar":this.SideBarFinish();break;case"start":this.StartFinish();break;case"form":this.FormFinish();break;case"frame":this.FrameFinish();break;case"tree":this.TreeFinish();break;case"modal":this.ModalFinish();break;case"list":this.ListFinish();break;case"tab":this.TabFinish();break;case"popup":this.PopupFinish();break;case"graph":this.GraphFinish();break;case"book":this.BookFinish();break;case"message":this.MessageFinish();break;case"lastmessage":this.LastMessageFinish();break;case"redirect":this.RedirectFinish();break;case"preview":this.PreviewFinish();break;case"docked":this.DockedFinish();break;case"popupres":this.PopupResizeFinish();break;case"tooltip":this.TooltipFinish();break;case"taskbar":this.TaskBarFinish();break;case"combo":this.ComboFinish();break;case"group":this.GroupFinish();break;case"zone":this.ZoneFinish();break;case"unpinned":this.UnpinnedFinish();break}this.Finished=true;this.Obj=null;this.ObjOut=null};GFX.prototype.IsFinished=function(){return this.Finished};GFX.prototype.FinishGFX=function(a){var b=false;if(this.Classe=="form"&&a.Classe=="form"){b=true}if(this.Classe=="docked"&&a.Classe=="docked"&&this.Obj&&this.Obj.DockType==a.Obj.DockType){if(this.Flin){return true}else{b=true;this.ObjDockType=this.Obj.DockType}}if((this.Classe=="sidebar"&&a.Classe=="docked")||(this.Classe=="docked"&&a.Classe=="sidebar")){b=true}if(a.Obj==this.Obj&&this.CanBeFinished(a.Classe,a.Tipo)){b=true}if(b){if(!this.Started&&!this.Finished){if(this.Classe=="list"&&a.Classe=="list"){this.Finished=true}}if(this.Classe=="form"&&a.Classe=="form"&&this.ObjOut==a.ObjOut&&this.CloseFormAnimation&&a.CloseFormAnimation){this.CloseFormAnimation=false}}if(b&&!this.Finished){this.SetFinished()}if(this.Classe=="form"&&a.Classe=="form"&&this.Obj&&this.Obj.Realized){this.Obj.AlreadyVisible=false}return this.BlockAnim(a.Classe,a.Tipo,a)};GFX.prototype.CanBeFinished=function(b,a){if(this.Classe=="form"&&b=="message"){return false}if(this.Classe=="modal"&&b=="message"){return false}return true};GFX.prototype.BlockAnim=function(b,a,c){if(this.Classe=="form"&&b=="message"){return true}if(this.Classe=="modal"&&b=="message"){return true}if(this.Classe=="docked"&&b=="docked"&&((this.Obj&&this.Obj.DockType==c.Obj.DockType)||(this.ObjDockType==c.Obj.DockType))){return true}return false};GFX.prototype.FinishModalClosing=function(a){if(this.Classe=="modal"&&this.Obj&&this.Obj.Identifier==a&&!this.IsFinished()&&!this.Flin&&this.CloseFormAnimation){this.SetFinished()}};GFX.prototype.FormStart=function(){this.InFrm=(this.Obj.Identifier)?true:false;this.OutFrm=(this.ObjOut&&this.ObjOut.Identifier)?true:false;if(this.InFrm){this.Obj.Animating=true}if(this.OutFrm){this.ObjOut.Animating=true}var a=this.InFrm?this.Obj.FormBox.style:this.Obj.style;var b=null;if(this.ObjOut){b=this.OutFrm?this.ObjOut.FormBox.style:this.ObjOut.style}a.position="absolute";if(this.ObjOut){b.position="absolute"}this.ObjOv=a.overflow;a.overflow="hidden";if(this.ObjOut){this.ObjOutOv=b.overflow;b.overflow="hidden"}a.display="";if(this.ObjOut){b.display=""}if(RD3_Glb.IsFirefox(3)){if(this.Tipo=="scroll-h"||this.Tipo=="scroll-v"){this.Tipo=this.Tipo.replace("scroll","fold")}this.Flin=true}var d=this.WillBeWebKit();if(this.Tipo=="fade"){if(RD3_Glb.IsIE(10,false)){a.filter="filter: alpha(opacity = 0);";if(this.InFrm){this.Obj.FramesBox.style.filter="filter: alpha(opacity = 0);"}}else{a.opacity=0}if(this.ObjOut){if(RD3_Glb.IsIE(10,false)){b.filter="filter: alpha(opacity = 100);";if(this.OutFrm){this.ObjOut.FramesBox.style.filter="filter: alpha(opacity = 100);"}}else{b.opacity=1}}}if(this.Tipo=="scroll-v"){if(this.Flin){this.ObjH=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetHeight;this.ObjH-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingTop"));this.ObjH-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingBottom"));if(d){a.webkitTransform="translateY(-"+this.ObjH+"px)"}else{a.top="-"+this.ObjH+"px"}}else{this.ObjH=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetHeight;this.ObjPadding=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingTop"));this.ObjH-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingBottom"));if(d){a.webkitTransform="translateY("+this.ObjH+"px)";this.ObjH=-this.ObjH}else{a.top=(this.ObjH)+"px"}}}if(this.Tipo=="scroll-h"){if(this.Flin){this.ObjW=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetWidth;this.ObjW-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingLeft"));this.ObjW-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingRight"));if(d){a.webkitTransform="translateX("+this.ObjW+"px)";this.ObjW=-this.ObjW}else{a.left=(this.ObjW)+"px"}}else{this.ObjW=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetWidth;this.ObjW-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingLeft"));this.ObjW-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingRight"));if(d){a.webkitTransform="translateX(-"+this.ObjW+"px)"}else{a.left="-"+this.ObjW+"px"}}}if(this.Tipo=="fold-v"){if(this.Flin){this.ObjH=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetHeight;this.ObjH-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingTop"));this.ObjH-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingBottom"));a.top="-"+this.ObjH+"px"}else{this.ObjH=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetHeight;this.ObjPadding=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingTop"));this.ObjH-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingBottom"));a.top=(this.ObjH)+"px"}}if(this.Tipo=="fold-h"){if(this.Flin){this.ObjW=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetWidth;this.ObjW-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingLeft"));this.ObjW-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingRight"));a.left=(this.ObjW)+"px"}else{this.ObjW=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetWidth;this.ObjW-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingLeft"));this.ObjW-=parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingRight"));a.left="-"+this.ObjW+"px"}}if(this.InFrm){var c=this.Obj.RecalcLayout;this.Obj.AdaptLayout();this.Obj.RecalcLayout=c;this.StartDate=new Date()}if(this.Tipo=="fold-h"){a.width="0px";if(!this.Flin){a.left=0+parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingLeft"))+"px"}}if(this.Tipo=="fold-v"){a.height="0px";if(this.Flin){a.top=0+parseFloat(RD3_Glb.GetStyleProp(RD3_DesktopManager.WebEntryPoint.FormsBox,"paddingTop"))+"px"}}};GFX.prototype.FormTick=function(d){var c=this.InFrm?this.Obj.FormBox.style:this.Obj.style;var a=this.InFrm?this.Obj.FramesBox.style:null;var f=null;var e=null;if(this.ObjOut){f=this.OutFrm?this.ObjOut.FormBox.style:this.ObjOut.style;e=this.OutFrm?this.ObjOut.FramesBox.style:null}if(this.Tipo=="fade"){if(RD3_Glb.IsIE(10,false)){c.filter="filter: alpha(opacity = "+Math.floor(d*100)+");";if(a){a.filter="filter: alpha(opacity = "+Math.floor(d*100)+");"}}else{c.opacity=d}if(this.ObjOut){if(RD3_Glb.IsIE(10,false)){f.filter="filter: alpha(opacity = "+Math.floor(100-(d*100))+");";if(e){e.filter="filter: alpha(opacity = "+Math.floor(100-(d*100))+");"}}else{f.opacity=1-d}}}if(this.Tipo=="scroll-v"){if(this.Flin){c.top="-"+Math.floor(this.ObjH-d*this.ObjH)+"px";if(this.ObjOut){f.top=Math.floor(d*this.ObjH)+"px"}}else{c.top=Math.floor(this.ObjH-d*this.ObjH+this.ObjPadding)+"px";if(this.ObjOut){f.top=Math.floor(0-d*this.ObjH)+"px"}}}if(this.Tipo=="scroll-h"){if(this.Flin){c.left="-"+Math.floor(this.ObjW-d*this.ObjW)+"px";if(this.ObjOut){f.left=Math.floor(d*this.ObjW)+"px"}}else{c.left=Math.floor(this.ObjW-d*this.ObjW)+"px";if(this.ObjOut){f.left=Math.floor(0-d*this.ObjW)+"px"}}}if(this.Tipo=="fold-h"){if(this.Flin){c.width=Math.floor(d*this.ObjW)+"px";c.left=Math.floor(this.ObjW-(d*this.ObjW))+"px";if(this.ObjOut){f.width=Math.floor((1-d)*this.ObjW)+"px"}}else{c.width=Math.floor(d*this.ObjW)+"px";if(this.ObjOut){f.width=Math.floor((1-d)*this.ObjW)+"px";f.left=Math.floor(d*this.ObjW)+"px"}}}if(this.Tipo=="fold-v"){if(this.Flin){c.height=Math.floor(d*this.ObjH)+"px";if(this.ObjOut){f.height=Math.floor((1-d)*this.ObjH)+"px";f.top=Math.floor(d*this.ObjH)+"px"}var b=this.InFrm?this.Obj.FormBox:this.Obj;b.scrollTop="0px"}else{c.height=Math.floor(d*this.ObjH)+"px";c.top=Math.floor(this.ObjH-(d*this.ObjH)+this.ObjPadding)+"px";if(this.ObjOut){f.height=Math.floor((1-d)*this.ObjH)+"px"}}}};GFX.prototype.FormFinish=function(){this.InFrm=(this.Obj.Identifier)?true:false;this.OutFrm=(this.ObjOut&&this.ObjOut.Identifier)?true:false;if(this.InFrm){this.Obj.Animating=false}if(this.OutFrm){this.ObjOut.Animating=false}var b=this.InFrm?this.Obj.FormBox.style:this.Obj.style;var a=this.InFrm?this.Obj.FramesBox.style:null;var e=null;var c=null;if(this.ObjOut){e=this.OutFrm?this.ObjOut.FormBox.style:this.ObjOut.style;c=this.OutFrm?this.ObjOut.FramesBox.style:null}if(this.ObjOut){e.position="";e.top="";e.left="";if(this.IsWebKit){e.webkitTransform=""}if(this.ObjOutOv!=undefined){e.overflow=this.ObjOutOv}if(RD3_Glb.IsIE(10,false)){e.removeAttribute("filter");if(c){c.removeAttribute("filter")}}else{e.opacity=1}}if(RD3_Glb.IsIE(10,false)){b.removeAttribute("filter");if(a){a.removeAttribute("filter")}}else{b.opacity=1}b.position="";b.top="";b.left="";if(this.IsWebKit){b.webkitTransform=""}if(this.ObjOv!=undefined){b.overflow=this.ObjOv}if(!this.OutFrm&&this.ObjOut){this.ObjOut.style.display="none"}if(!this.InFrm){this.Obj.style.display=""}if(this.CloseFormAnimation&&this.ObjOut&&this.Classe=="form"){RD3_DesktopManager.WebEntryPoint.CompleteCloseFormAnimation(this.ObjOut,!this.InForm)}var f=RD3_DesktopManager.WebEntryPoint;if(this.InFrm){f.ActiveForm=this.Obj}else{f.ActiveForm=null;f.VisibleForm=null}var d=(this.Tipo=="none"||this.Durata==0)&&(this.Obj!=this.ObjOut)?true:false;f.HandleFinishFormAnimation(d)};GFX.prototype.MenuStart=function(){this.Obj.style.display="";this.ObjSize=this.Obj.style.height;this.ObjEndSize=this.Obj.offsetHeight;var a=RD3_DesktopManager.WebEntryPoint.FormListBox;this.ObjFLSize=(a)?a.offsetHeight:0;this.Obj.style.overflowY="hidden";if(this.Flin){this.Obj.style.height="0px"}};GFX.prototype.MenuTick=function(c){var b=0;var a=0;if(this.Flin){b=Math.floor(this.ObjEndSize*c);a=this.ObjFLSize-b-2}else{b=Math.floor(this.ObjEndSize*(1-c));a=this.ObjFLSize+this.ObjEndSize-b-2}this.Obj.style.height=b+"px";var d=RD3_DesktopManager.WebEntryPoint.FormListBox;if(a>0&&d){d.style.height=a+"px"}};GFX.prototype.MenuFinish=function(){if(this.StartDate){this.Obj.style.overflow=this.ObjOverflow;this.Obj.style.height=this.ObjSize}this.Obj.style.display=this.Flin?"":"none";RD3_DesktopManager.WebEntryPoint.AdaptFormListBox();RD3_DesktopManager.WebEntryPoint.AdaptScrollBox()};GFX.prototype.SideBarStart=function(){this.Obj.style.display="";this.ObjSize=this.Obj.style.width;this.ObjEndSize=this.Obj.offsetWidth;this.ObjFOW=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetWidth;this.ObjFOL=RD3_DesktopManager.WebEntryPoint.FormsBox.offsetLeft;this.ObjSOW=RD3_DesktopManager.WebEntryPoint.StatusBarBox.offsetWidth;this.ObjSOL=RD3_DesktopManager.WebEntryPoint.StatusBarBox.offsetLeft;this.ObjTOW=RD3_DesktopManager.WebEntryPoint.ToolBarBox.offsetWidth;this.ObjTOL=RD3_DesktopManager.WebEntryPoint.ToolBarBox.offsetLeft;var c=RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var a=0;a<c;a++){var b=RD3_DesktopManager.WebEntryPoint.StackForm[a];if(b.Docked){switch(b.DockType){case RD3_Glb.FORMDOCK_LEFT:this.ObjDLOW=RD3_DesktopManager.WebEntryPoint.LeftDockedBox.offsetWidth;this.ObjDLOL=RD3_DesktopManager.WebEntryPoint.LeftDockedBox.offsetLeft;this.ObjDLS=RD3_DesktopManager.WebEntryPoint.LeftDockedBox.style;break;case RD3_Glb.FORMDOCK_TOP:this.ObjDTOW=RD3_DesktopManager.WebEntryPoint.TopDockedBox.offsetWidth;this.ObjDTOL=RD3_DesktopManager.WebEntryPoint.TopDockedBox.offsetLeft;this.ObjDTS=RD3_DesktopManager.WebEntryPoint.TopDockedBox.style;break;case RD3_Glb.FORMDOCK_BOTTOM:this.ObjDBOW=RD3_DesktopManager.WebEntryPoint.BottomDockedBox.offsetWidth;this.ObjDBOL=RD3_DesktopManager.WebEntryPoint.BottomDockedBox.offsetLeft;this.ObjDBS=RD3_DesktopManager.WebEntryPoint.BottomDockedBox.style;break;case RD3_Glb.FORMDOCK_RIGHT:this.ObjDROW=RD3_DesktopManager.WebEntryPoint.RightDockedBox.offsetWidth;this.ObjDROL=RD3_DesktopManager.WebEntryPoint.RightDockedBox.offsetLeft;this.ObjDRS=RD3_DesktopManager.WebEntryPoint.RightDockedBox.style;break}}}this.Obj.style.overflow="hidden";this.Obj.style.position="relative"};GFX.prototype.SideBarRightTick=function(f){var c=0;var b=0;var h=0;var a=0;var d=0;var e=0;if(this.Flin){c=Math.floor(this.ObjEndSize*f);b=this.ObjFOW-c-2;a=this.ObjSOW-c-2;d=this.ObjTOW-c-2;e=-c}else{c=Math.floor(this.ObjEndSize*(1-f));b=this.ObjFOW+this.ObjEndSize-c-2;a=this.ObjSOW+this.ObjEndSize-c-2;d=this.ObjTOW+this.ObjEndSize-c-2;e=this.ObjEndSize-c}h=Math.floor(this.ObjEndSize-c);if(this.Tipo=="scroll"){this.Obj.style.left=h+"px"}if(this.Tipo=="fold"){this.Obj.style.width=c+"px";this.Obj.style.left=h+"px"}var g=RD3_DesktopManager.WebEntryPoint.FormsBox.style;g.width=b+"px";g=RD3_DesktopManager.WebEntryPoint.StatusBarBox.style;g.width=a+"px";g=RD3_DesktopManager.WebEntryPoint.ToolBarBox.style;g.width=d+"px";if(this.ObjDRS){this.ObjDRS.left=(this.ObjDROL+e)+"px"}if(this.ObjDTS){this.ObjDTS.width=(this.ObjDTOW+e)+"px"}if(this.ObjDBS){this.ObjDBS.width=(this.ObjDBOW+e)+"px"}};GFX.prototype.SideBarTick=function(f){var g=0;var b=0;var e=0;var h=0;var d=0;var a=0;var c=0;var j=0;if(this.Flin){g=Math.floor(this.ObjEndSize*f);b=this.ObjFOW-g-2;h=this.ObjSOW-g-2;d=this.ObjTOW-g-2;if(this.ObjDTOW){a=this.ObjDTOW-g-2}if(this.ObjDBOW){c=this.ObjDBOW-g-2}if(this.ObjDLOW){j=this.ObjDLOW-g-2}}else{g=Math.floor(this.ObjEndSize*(1-f));b=this.ObjFOW+this.ObjEndSize-g-2;h=this.ObjSOW+this.ObjEndSize-g-2;d=this.ObjTOW+this.ObjEndSize-g-2;if(this.ObjDTOW){a=this.ObjDTOW+this.ObjEndSize-g-2}if(this.ObjDBOW){c=this.ObjDBOW+this.ObjEndSize-g-2}if(this.ObjDLOW){j=this.ObjDLOW+this.ObjEndSize-g-2}}e=Math.floor(g-this.ObjEndSize);if(this.Tipo=="scroll"){this.Obj.style.left=e+"px"}if(this.Tipo=="fold"){this.Obj.style.width=g+"px"}var i=RD3_DesktopManager.WebEntryPoint.FormsBox.style;i.left=(this.ObjFOL+(this.ObjFOW-b))+"px";i.width=b+"px";i=RD3_DesktopManager.WebEntryPoint.StatusBarBox.style;i.left=(this.ObjSOL+(this.ObjSOW-h))+"px";i=RD3_DesktopManager.WebEntryPoint.ToolBarBox.style;i.left=(this.ObjTOL+(this.ObjTOW-d))+"px";if(this.ObjDTS){this.ObjDTS.left=(this.ObjDTOL+(this.ObjDTOW-a))+"px"}if(this.ObjDBS){this.ObjDBS.left=(this.ObjDBOL+(this.ObjDBOW-c))+"px"}if(this.ObjDLS){this.ObjDLS.left=(this.ObjDLOL+(this.ObjDLOW-j))+"px"}};GFX.prototype.SideBarFinish=function(){if(this.WillBeWebKit()&&this.Durata>0){this.SideBarTick(this.Flin?0.99:1.01);this.Obj.style.webkitTransform="";RD3_DesktopManager.WebEntryPoint.FormsBox.style.webkitTransform="";RD3_DesktopManager.WebEntryPoint.StatusBarBox.style.webkitTransform="";RD3_DesktopManager.WebEntryPoint.ToolBarBox.style.webkitTransform="";if(this.ObjDL){this.ObjDL.style.webkitTransform=""}if(this.ObjDT){this.ObjDT.style.webkitTransform=""}if(this.ObjDB){this.ObjDB.style.webkitTransform=""}}if(this.StartDate){this.Obj.style.overflow=this.ObjOverflow;this.Obj.style.width=this.ObjSize}this.Obj.style.display=this.Flin?"":"none";this.Obj.style.position="";if((this.ObjDLOW||this.ObjDTOW||this.ObjDROW||this.ObjDBOW)&&this.Flin){RD3_DesktopManager.WebEntryPoint.SideMenuBoxW=0}};GFX.prototype.StartStart=function(){if(RD3_Glb.IsIE(10,false)){document.body.style.filter="filter: alpha(opacity = 0);"}else{document.body.style.opacity=0}};GFX.prototype.StartTick=function(a){if(RD3_Glb.IsIE(10,false)){document.body.style.filter="filter: alpha(opacity = "+Math.floor(a*100)+");"}else{document.body.style.opacity=a}};GFX.prototype.StartFinish=function(){if(RD3_Glb.IsIE(10,false)){document.body.style.removeAttribute("filter")}else{document.body.style.opacity=1}var c=RD3_DesktopManager.WebEntryPoint;if(c.ActiveForm){c.ActiveForm.Animating=false}var b=c.StackForm.length;for(var a=0;a<b;a++){if(c.StackForm[a].Docked){c.StackForm[a].Animating=false}}if(RD3_GFXManager.FocusFldId&&RD3_GFXManager.FocusFldId!=""){RD3_DesktopManager.HandleFocus2(RD3_GFXManager.FocusFldId,RD3_GFXManager.FocusFldRow);RD3_GFXManager.FocusFldId="";RD3_GFXManager.FocusFldRow=0}};GFX.prototype.FrameStart=function(){this.ObjH=this.Flin?this.Obj.ToolbarBox.offsetHeight:this.Obj.Height;this.ObjSh=this.Flin?this.Obj.Height:this.Obj.ToolbarBox.offsetHeight;this.Obj.CollapsingHeight=this.ObjSh;this.Obj.Collapsing=true;if(this.Obj.ParentFrame){var a=this.Obj.ParentFrame.ChildFrame1==this.Obj?this.Obj.ParentFrame.ChildBox1:this.Obj.ParentFrame.ChildBox2;if(a){a.style.overflow="hidden"}}if(!this.Flin){this.Obj.ContentBox.style.display="";var b=this.Obj.FrameBox.style.height;this.Obj.FrameBox.style.height=this.ObjH+"px";this.OldRec=this.Obj.RecalcLayout;this.Obj.AdaptLayout();this.Obj.RecalcLayout=this.OldRec;if(!this.Obj.ParentFrame){this.Obj.FrameBox.style.height=this.ObjSh+"px"}this.StartDate=new Date()}RD3_KBManager.CheckFocus=false;this.overX=this.Obj.ContentBox.style.overflowX;this.Obj.ContentBox.style.overflowX="hidden";this.overY=this.Obj.ContentBox.style.overflowY;this.Obj.ContentBox.style.overflowY="hidden"};GFX.prototype.FrameTick=function(a){if(!this.Obj.ParentFrame){if(this.Flin){this.Obj.FrameBox.style.height=Math.floor(this.ObjH+((this.ObjSh-this.ObjH)*(1-a)))+"px"}else{this.Obj.FrameBox.style.height=Math.floor(this.ObjH-((this.ObjH-this.ObjSh)*(1-a)))+"px"}}else{if(this.Flin){this.Obj.CollapsingHeight=Math.floor(this.ObjH+((this.ObjSh-this.ObjH)*(1-a)))}else{this.Obj.ContentBox.style.height=Math.floor((this.ObjH-this.ObjSh)*a)+"px";this.Obj.CollapsingHeight=Math.floor(this.ObjH-((this.ObjH-this.ObjSh)*(1-a)))}this.Obj.WebForm.Frames[0].SetCollapsingChildLayout()}};GFX.prototype.FrameFinish=function(){this.Obj.Collapsing=false;if(this.Obj.ParentFrame){var a=this.Obj.ParentFrame.ChildFrame1==this.Obj?this.Obj.ParentFrame.ChildBox1:this.Obj.ParentFrame.ChildBox2;if(a){a.style.overflow=""}}if(this.Flin){if(!this.Obj.IsPreview){this.Obj.ContentBox.style.display="none"}this.Obj.CollapseButton.src=RD3_Glb.GetImgSrc("images/expand"+(this.Obj.SmallIcons?"_sm":"")+".gif");this.Obj.IconImg.style.display="none";RD3_TooltipManager.SetObjTitle(this.Obj.CollapseButton,RD3_ServerParams.MostraRiquadro);this.Obj.WebForm.ClosePreview();if(!this.Obj.IsPreview){this.Obj.SetHeight()}}else{this.Obj.ContentBox.style.display="";if(!RD3_Glb.IsMobile()){this.Obj.CollapseButton.src=RD3_Glb.GetImgSrc("images/collapse"+(this.Obj.SmallIcons?"_sm":"")+".gif")}if(this.Obj.Image!=""){this.Obj.IconImg.style.display=""}RD3_TooltipManager.SetObjTitle(this.Obj.CollapseButton,RD3_ServerParams.NascondiRiquadro);this.Obj.SetHeight();this.Obj.Focus()}this.Obj.ContentBox.style.overflowX=this.overX?this.overX:"";this.Obj.ContentBox.style.overflowY=this.overY?this.overY:"";this.Obj.SetShowToolbar();this.Obj.SetShowStatusBar();this.Obj.SetLockable();RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveFormChanged();if(this.Obj.WebForm.Realized&&this.OldValue!=this.Obj.Collapsed){this.Obj.RecalcResize=true;if(this.Immediate){if(RD3_Glb.IsChrome()){setTimeout(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Obj.WebForm.Identifier+"', 'AdaptLayout', ev)"),10)}else{this.Obj.WebForm.AdaptLayout()}}else{this.Obj.WebForm.RecalcLayout=true}}RD3_KBManager.CheckFocus=true;RD3_KBManager.ActiveObject=null};GFX.prototype.TreeStart=function(){var a=this.Obj.style;a.display="";this.ObjEndSize=this.Obj.offsetHeight;if(this.Flin){a.height="0px"}else{a.height=this.Obj.offsetHeight+"px"}a.overflow="hidden"};GFX.prototype.TreeTick=function(c){var b=0;var a=0;if(this.Flin){b=Math.floor(this.ObjEndSize*c)}else{b=Math.floor(this.ObjEndSize*(1-c))}this.Obj.style.height=b+"px"};GFX.prototype.TreeFinish=function(){if(this.StartDate){this.Obj.style.overflow=""}this.Obj.style.display=this.Flin?"":"none";this.Obj.style.height=""};GFX.prototype.ModalStart=function(){this.Obj.Animating=true;var a=this.Obj.PopupFrame.PopupBox.style;this.Obj.PopupFrame.SetVisible(true);this.ObjOv=a.overflow;if(!this.WillBeWebKit()){a.overflow="hidden"}this.TargetX=this.Obj.OpenX;this.TargetY=this.Obj.OpenY;if(this.Flin){this.Obj.FormBox.style.display="";var b=this.Obj.RecalcLayout;this.Obj.AdaptLayout();this.Obj.RecalcLayout=b;this.StartDate=new Date();if(!this.WillBeWebKit()){a.width="0px";a.height="0px"}if(this.Tipo=="point-tr"){a.left=(this.Obj.FormLeft+this.Obj.FormWidth)+"px"}if(this.Tipo=="point-bl"){a.top=(this.Obj.FormTop+this.Obj.FormHeight)+"px"}if(this.Tipo=="point-br"){a.top=(this.Obj.FormTop+this.Obj.FormHeight)+"px";a.left=(this.Obj.FormLeft+this.Obj.FormWidth)+"px"}if(this.Tipo=="zoom"){a.top=this.TargetY+"px";a.left=this.TargetX+"px";if(RD3_Glb.IsIE(10,false)){a.filter="filter: alpha(opacity = 0);"}else{a.opacity=0}}}if(this.Tipo=="zoom"&&!this.WillBeWebKit()){this.Obj.SetButtonVisibility("hidden");this.Obj.FramesBox.style.display="none";this.Obj.FramesBox.style.visibility="hidden";this.Obj.MessagesBox.style.display="none"}};GFX.prototype.ModalTick=function(b){if(this.Flin){var c=this.Obj.PopupFrame.PopupBox.style;c.width=(b*this.Obj.FormWidth)+"px";c.height=(b*this.Obj.FormHeight)+"px";if(this.Tipo=="point-tr"){c.left=((this.Obj.FormLeft+this.Obj.FormWidth)-b*this.Obj.FormWidth)+"px"}if(this.Tipo=="point-bl"){c.top=((this.Obj.FormTop+this.Obj.FormHeight)-b*this.Obj.FormHeight)+"px"}if(this.Tipo=="point-br"){c.top=((this.Obj.FormTop+this.Obj.FormHeight)-b*this.Obj.FormHeight)+"px";c.left=((this.Obj.FormLeft+this.Obj.FormWidth)-b*this.Obj.FormWidth)+"px"}if(this.Tipo=="zoom"){var a=0;if(this.TargetX<=this.Obj.FormLeft){a=this.TargetX+(this.Obj.FormLeft-this.TargetX)*b}else{a=this.TargetX-(this.TargetX-this.Obj.FormLeft)*b}var d=0;if(this.TargetY<=this.Obj.FormTop){d=this.TargetY+(this.Obj.FormTop-this.TargetY)*b}else{d=this.TargetY-(this.TargetY-this.Obj.FormTop)*b}c.top=d+"px";c.left=a+"px";if(RD3_Glb.IsIE(10,false)){c.filter="filter: alpha(opacity = "+Math.floor(b*100)+");"}else{c.opacity=b}}}else{var c=this.Obj.PopupFrame.PopupBox.style;c.width=(1-b)*this.Obj.FormWidth+"px";c.height=(1-b)*this.Obj.FormHeight+"px";if(this.Tipo=="point-tr"){c.left=(this.Obj.FormLeft+b*this.Obj.FormWidth)+"px"}if(this.Tipo=="point-bl"){c.top=(this.Obj.FormTop+b*this.Obj.FormHeight)+"px"}if(this.Tipo=="point-br"){c.top=(this.Obj.FormTop+b*this.Obj.FormHeight)+"px";c.left=(this.Obj.FormLeft+b*this.Obj.FormWidth)+"px"}if(this.Tipo=="zoom"){var a=0;if(this.Obj.FormLeft<=this.TargetX){a=this.Obj.FormLeft+(this.TargetX-this.Obj.FormLeft)*b}else{a=this.Obj.FormLeft-(this.Obj.FormLeft-this.TargetX)*b}var d=0;if(this.Obj.FormTop<=this.TargetY){d=this.Obj.FormTop+(this.TargetY-this.Obj.FormTop)*b}else{d=this.Obj.FormTop-(this.Obj.FormTop-this.TargetY)*b}c.top=d+"px";c.left=a+"px";if(RD3_Glb.IsIE(10,false)){c.filter="filter: alpha(opacity = "+Math.floor(100-(b*100))+");"}else{c.opacity=1-b}}}};GFX.prototype.ModalFinish=function(){this.Obj.Animating=false;if(this.Flin){if(this.ObjOv){this.Obj.PopupFrame.PopupBox.style.overflow=this.ObjOv}else{this.Obj.PopupFrame.PopupBox.style.overflow=""}if(!this.Skipped){this.Obj.SetFormLeft(null,true);this.Obj.SetFormTop(null,true);this.Obj.SetFormWidth(null,true);this.Obj.SetFormHeight(null,true)}if(this.IsWebKit){this.Obj.PopupFrame.PopupBox.style.webkitTransform="scale(1.0) translateX(0px) translateY(0px)"}this.Obj.AlreadyVisible=true}if(this.Tipo=="zoom"){if(RD3_Glb.IsIE(10,false)){this.Obj.PopupFrame.PopupBox.style.removeAttribute("filter")}else{this.Obj.PopupFrame.PopupBox.style.opacity=1}this.Obj.SetButtonVisibility("");this.Obj.FramesBox.style.display="";if(!this.CloseFormAnimation){this.Obj.FramesBox.style.visibility=""}this.Obj.MessagesBox.style.display=""}if(this.Flin){var a=false;var b=RD3_DesktopManager.WebEntryPoint.ActiveForm;if((b&&b!=this.Obj)||(this.Durata==0)){a=true}RD3_DesktopManager.WebEntryPoint.HandleFinishFormAnimation(a);if(RD3_GFXManager.ModalFocusFldId&&RD3_GFXManager.ModalFocusFldId!=""){RD3_DesktopManager.HandleFocus2(RD3_GFXManager.ModalFocusFldId,RD3_GFXManager.ModalFocusFldRow);RD3_GFXManager.ModalFocusFldId="";RD3_GFXManager.ModalFocusFldRow=0}else{if(this.Flin.Modal!=0){RD3_KBManager.ActiveObject=null;RD3_KBManager.LastActiveObject=null;RD3_KBManager.ActiveElement=null;document.body.focus();RD3_KBManager.CheckFocus=true}}}else{if(this.CloseFormAnimation){RD3_DesktopManager.WebEntryPoint.CompleteCloseFormAnimation(this.Obj,false)}else{if(this.ObjOv){this.Obj.PopupFrame.PopupBox.style.overflow=this.ObjOv}else{this.Obj.PopupFrame.PopupBox.style.overflow=""}this.Obj.AlreadyVisible=false;this.Obj.PopupFrame.SetVisible(false)}RD3_DesktopManager.WebEntryPoint.HandleCloseAllVisibility()}};GFX.prototype.ListStart=function(){if(!this.Obj.ListBox||!this.Obj.FormBox){this.SetFinished();return}if((this.Flin&&this.Obj.FormBox.style.display!="none")||(!this.Flin&&this.Obj.ListBox.style.display!="none")){this.SetFinished();return}this.Obj.ListBox.style.display="";this.Obj.FormBox.style.display="";if(RD3_Glb.IsIE()){this.Obj.ListBox.style.visibility="";this.Obj.FormBox.style.visibility=""}this.Obj.AnimatingPanel=true;var a=this.Obj.RecalcLayout;this.Obj.AdaptLayout();this.StartDate=new Date();this.Obj.RecalcLayout=a;if(this.Tipo=="fade"){if(this.Flin){if(RD3_Glb.IsIE(10,false)){this.Obj.FormBox.style.filter="filter: alpha(opacity = 0);"}else{this.Obj.FormBox.style.opacity=0}if(RD3_Glb.IsIE(10,false)){this.Obj.ListBox.style.filter="filter: alpha(opacity = 100);"}else{this.Obj.ListBox.style.opacity=1}}else{if(RD3_Glb.IsIE(10,false)){this.Obj.FormBox.style.filter="filter: alpha(opacity = 100);"}else{this.Obj.FormBox.style.opacity=1}if(RD3_Glb.IsIE(10,false)){this.Obj.ListBox.style.filter="filter: alpha(opacity = 0);"}else{this.Obj.ListBox.style.opacity=0}}}if(this.Tipo=="scroll-h"){this.XOver=this.Obj.ContentBox.style.overflowX;this.YOver=this.Obj.ContentBox.style.overflowY;this.Obj.ContentBox.style.overflowX="hidden";this.Obj.ContentBox.style.overflowY="hidden";this.ObjH=this.Obj.ContentBox.offsetWidth;if(this.Flin){if(this.WillBeWebKit()){this.Obj.FormBox.style.webkitTransform="translateX("+this.ObjH+"px)";this.ObjH=-this.ObjH}else{this.Obj.FormBox.style.left=this.ObjH+"px"}this.Obj.ListBox.style.left="0px"}else{if(this.WillBeWebKit()){this.Obj.ListBox.style.webkitTransform="translateX(-"+this.ObjH+"px)"}else{this.Obj.ListBox.style.left="-"+this.ObjH+"px"}this.Obj.FormBox.style.left="0px"}}if(this.Tipo=="scroll-v"){this.XOver=this.Obj.ContentBox.style.overflowX;this.YOver=this.Obj.ContentBox.style.overflowY;this.Obj.ContentBox.style.overflowX="hidden";this.Obj.ContentBox.style.overflowY="hidden";this.ObjH=this.Obj.ContentBox.offsetHeight;if(this.Flin){this.Obj.FormBox.style.top=this.ObjH+"px";this.Obj.ListBox.style.top="0px"}else{this.Obj.ListBox.style.top="-"+this.ObjH+"px";this.Obj.FormBox.style.top="0px"}}if(this.Tipo=="fold-h"){this.FormW=this.Obj.FormBox.offsetWidth;this.ListW=this.Obj.ListBox.offsetWidth;this.ObjH=this.Obj.ContentBox.offsetWidth;if(this.Flin){this.Obj.FormBox.style.left=this.ObjH+"px";this.Obj.FormBox.style.width="0px";this.Obj.ListBox.style.left="0px"}else{this.Obj.ListBox.style.width="0px";this.Obj.FormBox.style.left="0px"}}if(this.Tipo=="fold-v"){this.FormH=this.Obj.FormBox.offsetHeight;this.ListH=this.Obj.ListBox.offsetHeight;this.ObjH=this.Obj.ContentBox.offsetHeight;if(this.Flin){this.Obj.FormBox.style.top=this.ObjH+"px";this.Obj.FormBox.style.height="0px";this.Obj.ListBox.style.top="0px"}else{this.Obj.ListBox.style.height="0px";this.Obj.FormBox.style.top="0px"}}};GFX.prototype.ListTick=function(a){if(this.Tipo=="fade"){if(this.Flin){if(a<0.5){if(RD3_Glb.IsIE(10,false)){this.Obj.ListBox.style.filter="filter: alpha(opacity = "+Math.floor(100-((a*2)*100))+");"}else{this.Obj.ListBox.style.opacity=1-(a*2)}}else{if(RD3_Glb.IsIE(10,false)){this.Obj.ListBox.style.filter="filter: alpha(opacity = 0);"}else{this.Obj.ListBox.style.opacity=0}if(RD3_Glb.IsIE(10,false)){this.Obj.FormBox.style.filter="filter: alpha(opacity = "+Math.floor(a*100)+");"}else{this.Obj.FormBox.style.opacity=a}}}else{if(a<0.5){if(RD3_Glb.IsIE(10,false)){this.Obj.FormBox.style.filter="filter: alpha(opacity = "+Math.floor(100-((a*2)*100))+");"}else{this.Obj.FormBox.style.opacity=1-(a*2)}}else{if(RD3_Glb.IsIE(10,false)){this.Obj.FormBox.style.filter="filter: alpha(opacity = 0);"}else{this.Obj.FormBox.style.opacity=0}if(RD3_Glb.IsIE(10,false)){this.Obj.ListBox.style.filter="filter: alpha(opacity = "+Math.floor(a*100)+");"}else{this.Obj.ListBox.style.opacity=a}}}}if(this.Tipo=="scroll-h"){if(this.Flin){this.Obj.FormBox.style.left=this.ObjH*(1-a)+"px";this.Obj.ListBox.style.left=0-this.ObjH*a+"px"}else{this.Obj.FormBox.style.left=this.ObjH*a+"px";this.Obj.ListBox.style.left=0-this.ObjH*(1-a)+"px"}}if(this.Tipo=="scroll-v"){if(this.Flin){this.Obj.FormBox.style.top=this.ObjH*(1-a)+"px";this.Obj.ListBox.style.top=0-this.ObjH*a+"px"}else{this.Obj.FormBox.style.top=this.ObjH*a+"px";this.Obj.ListBox.style.top=0-this.ObjH*(1-a)+"px"}}if(this.Tipo=="fold-h"){if(this.Flin){this.Obj.ListBox.style.width=this.ObjH-(a*this.ObjH)+"px";this.Obj.FormBox.style.width=(a*this.ObjH)+"px";this.Obj.FormBox.style.left=this.ObjH-(a*this.ObjH)+"px"}else{this.Obj.ListBox.style.width=(a*this.ObjH)+"px";this.Obj.FormBox.style.width=this.ObjH-(a*this.ObjH)+"px";this.Obj.FormBox.style.left=(a*this.ObjH)+"px"}}if(this.Tipo=="fold-v"){if(this.Flin){this.Obj.ListBox.style.height=this.ObjH-(a*this.ObjH)+"px";this.Obj.FormBox.style.height=(a*this.ObjH)+"px";this.Obj.FormBox.style.top=this.ObjH-(a*this.ObjH)+"px"}else{this.Obj.ListBox.style.height=(a*this.ObjH)+"px";this.Obj.FormBox.style.height=this.ObjH-(a*this.ObjH)+"px";this.Obj.FormBox.style.top=(a*this.ObjH)+"px"}}};GFX.prototype.ListFinish=function(){if(this.ObjH<0){this.ObjH=-this.ObjH}if(this.Obj.HasList&&this.Obj.ListBox){var b=this.Obj.ListBox.style;b.display=(this.Obj.PanelMode==RD3_Glb.PANEL_LIST)?"":"none";if(RD3_Glb.IsIE(10,false)){b.removeAttribute("filter")}else{b.opacity=1}if(this.IsWebKit){b.webkitTransform=""}b.left="";b.top="";if(this.Tipo=="fold-h"&&this.ListW){b.width=this.ListW+"px"}if(this.Tipo=="fold-v"&&this.ListH){b.height=this.ListH+"px"}b.position="static";b.position="";this.Obj.ListBox.scrollTop="0px"}if(this.Obj.HasForm&&this.Obj.FormBox){var b=this.Obj.FormBox.style;b.display=(this.Obj.PanelMode==RD3_Glb.PANEL_FORM)?"":"none";if(RD3_Glb.IsIE(10,false)){b.removeAttribute("filter")}else{b.opacity=1}if(this.IsWebKit){b.webkitTransform=""}b.left="";b.top="";if(this.Tipo=="fold-h"&&this.FormW){b.width=this.FormW+"px"}if(this.Tipo=="fold-v"&&this.FormH){b.height=this.FormH+"px"}b.position="static";b.position="";this.Obj.FormBox.scrollTop="0px"}var a=this.Obj.ContentBox.style;if(this.XOver){a.overflowX=this.XOver}else{a.overflowX=""}if(this.YOver){a.overflowY=this.YOver}else{a.overflowY=""}this.Obj.AnimatingPanel=false;if(this.Durata==0||this.Tipo=="none"){if(this.Immediate){this.Obj.AdaptLayout()}else{this.Obj.RecalcLayout=true}}if(RD3_Glb.IsIE()){if(this.Obj.PanelMode==RD3_Glb.PANEL_LIST&&!this.Obj.Realizing){this.Obj.FormBox.style.visibility="hidden";this.Obj.ListBox.style.visibility=""}if(this.Obj.PanelMode==RD3_Glb.PANEL_FORM&&!this.Obj.Realizing){this.Obj.FormBox.style.visibility="";this.Obj.ListBox.style.visibility="hidden"}}this.Obj.ResetPosition=true;this.Obj.RefreshToolbar=true};GFX.prototype.TabStart=function(){this.FirstTick=true};GFX.prototype.TabTick=function(a){if(this.FirstTick){this.FirstTick=false;this.TabFirstTick()}else{this.TabAnimationTick(a)}};GFX.prototype.TabFirstTick=function(){this.Obj.ContentBox.style.display="";this.ObjOut.ContentBox.style.display="";if(this.Tipo=="fade"){if(RD3_Glb.IsIE(10,false)){this.Obj.ContentBox.style.filter="filter: alpha(opacity = 0);"}else{this.Obj.ContentBox.style.opacity=0}if(RD3_Glb.IsIE(10,false)){this.ObjOut.ContentBox.style.filter="filter: alpha(opacity = 100);"}else{this.ObjOut.ContentBox.style.opacity=1}}if(this.Tipo=="scroll-h"){this.ObjW=this.Obj.TabView.ContentBox.offsetWidth;if(this.Flin){if(this.WillBeWebKit()){this.Obj.ContentBox.style.webkitTransform="translateX(-"+this.ObjW+"px)"}else{this.Obj.ContentBox.style.left="-"+this.ObjW+"px"}}else{if(this.WillBeWebKit()){this.Obj.ContentBox.style.webkitTransform="translateX("+this.ObjW+"px)";this.ObjW=-this.ObjW}else{this.Obj.ContentBox.style.left=this.ObjW+"px"}}}if(this.Tipo=="fold-h"){this.ObjW=this.Obj.TabView.ContentBox.offsetWidth;if(this.Flin){this.Obj.ContentBox.style.left="-"+this.ObjW+"px"}else{this.Obj.ContentBox.style.left=this.ObjW+"px"}}if(!this.Obj.Content.Realized){this.Obj.Content.Realize(this.Obj.ContentBox);this.Obj.AdaptLayout();if(!this.Obj.Selected){this.Obj.Content.AdaptLayout()}}else{if(this.Obj.TabView.WebForm.Realized&&this.Obj.Realized){this.Obj.Content.AdaptLayout()}}this.StartDate=new Date();if(this.Tipo=="fold-h"){if(this.Flin){this.Obj.ContentBox.style.left="0px";this.Obj.ContentBox.style.width="0px"}else{this.Obj.ContentBox.style.width="0px"}}};GFX.prototype.TabAnimationTick=function(a){if(this.Tipo=="fade"){if(a<0.4){if(RD3_Glb.IsIE(10,false)){this.ObjOut.ContentBox.style.filter="filter: alpha(opacity = "+Math.floor(100-((a*2)*100))+");"}else{this.ObjOut.ContentBox.style.opacity=1-(a*2)}}else{var b=1-(a*2);b=b<0?0:b;if(RD3_Glb.IsIE(10,false)){this.ObjOut.ContentBox.style.filter="filter: alpha(opacity = "+b*100+");"}else{this.ObjOut.ContentBox.style.opacity=b}if(RD3_Glb.IsIE(10,false)){this.Obj.ContentBox.style.filter="filter: alpha(opacity = "+Math.floor(a*100)+");"}else{this.Obj.ContentBox.style.opacity=a}}}if(this.Tipo=="scroll-h"){if(this.Flin){this.ObjOut.ContentBox.style.left=(a*this.ObjW)+"px";this.Obj.ContentBox.style.left=0-((1-a)*this.ObjW)+"px"}else{this.ObjOut.ContentBox.style.left=0-(a*this.ObjW)+"px";this.Obj.ContentBox.style.left=((1-a)*this.ObjW)+"px"}}if(this.Tipo=="fold-h"){if(this.Flin){this.ObjOut.ContentBox.style.width=((1-a)*this.ObjW)+"px";this.ObjOut.ContentBox.style.left=(a*this.ObjW)+"px";this.Obj.ContentBox.style.width=(a*this.ObjW)+"px"}else{this.ObjOut.ContentBox.style.width=((1-a)*this.ObjW)+"px";this.Obj.ContentBox.style.width=(a*this.ObjW)+"px";this.Obj.ContentBox.style.left=((1-a)*this.ObjW)+"px"}}};GFX.prototype.TabFinish=function(){if(this.ObjW<0){this.ObjW=-this.ObjW}var c=this.Obj.ContentBox.style;if(this.IsWebKit){c.webkitTransform=""}c.left="";c.display="";if(this.ObjW){c.width=this.ObjW+"px"}if(RD3_Glb.IsIE(10,false)){c.removeAttribute("filter")}else{c.opacity=1}this.Obj.SelectPage(true);if(this.ObjOut&&this.ObjOut!=this.Obj){var b=this.ObjOut.ContentBox.style;b.display="none";b.left="";if(this.IsWebKit){b.webkitTransform=""}if(this.ObjW){b.width=this.ObjW+"px"}if(RD3_Glb.IsIE(10,false)){b.removeAttribute("filter")}else{b.opacity=1}this.ObjOut.SelectPage(false)}if(this.Durata==0||this.Tipo=="none"){var a=false;if(this.Obj.TabView.Identifier.indexOf("scz")>-1){a=true}if(!this.Obj.Content.Realized){if(!a){this.Obj.Content.Realize(this.Obj.ContentBox)}}else{if(this.Obj.TabView.WebForm.Realized&&this.Obj.Realized){this.Obj.Content.AdaptLayout()}}}};GFX.prototype.PopupStart=function(){this.FirstTick=true};GFX.prototype.PopupTick=function(a){if(this.FirstTick){this.FirstTick=false;if(this.Flin){this.Obj.RealizePopup(this.Node)}var b=this.Obj.PopupContainerBox.offsetHeight;this.ObjH=b>5?b-5:b;this.ObjT=this.Obj.PopupContainerBox.offsetTop;if(this.Flin){this.Obj.PopupContainerBox.style.height="0px";if(this.Obj.Direction==3){this.Obj.PopupContainerBox.style.top=this.ObjT+this.ObjH+"px"}}if(this.Tipo=="scroll"){this.Obj.PopupContainerBox.style.overflow="hidden"}}else{if(this.Tipo=="fold"){if(this.Flin){this.Obj.PopupContainerBox.style.height=(a*this.ObjH)+"px";if(this.Obj.Direction==3){this.Obj.PopupContainerBox.style.top=this.ObjT+this.ObjH-(a*this.ObjH)+"px"}}else{this.Obj.PopupContainerBox.style.height=((1-a)*this.ObjH)+"px";if(this.Obj.Direction==3){this.Obj.PopupContainerBox.style.top=this.ObjT+this.ObjH-((1-a)*this.ObjH)+"px"}}}if(this.Tipo=="scroll"){if(this.Flin){this.Obj.PopupContainerBox.style.height=(a*this.ObjH)+"px";this.Obj.PopupContainerBox.scrollTop=Math.floor((1-a)*this.ObjH);if(this.Obj.Direction==3){this.Obj.PopupContainerBox.style.top=this.ObjT+this.ObjH-(a*this.ObjH)+"px"}}else{this.Obj.PopupContainerBox.style.height=((1-a)*this.ObjH)+"px";this.Obj.PopupContainerBox.scrollTop=Math.floor(a*this.ObjH);if(this.Obj.Direction==3){this.Obj.PopupContainerBox.style.top=this.ObjT+this.ObjH-((1-a)*this.ObjH)+"px"}}}}};GFX.prototype.PopupFinish=function(){if((this.Durata==0||this.Tipo=="none")&&this.Flin){this.Obj.RealizePopup(this.Node)}if(this.Flin){if(this.Obj.PopupContainerBox){this.Obj.PopupContainerBox.style.height="";if(this.Tipo=="scroll"){this.Obj.PopupContainerBox.style.overflow=""}}this.Obj.Gfx=null}else{if(this.Obj.PopupContainerBox){this.Obj.PopupContainerBox.parentNode.removeChild(this.Obj.PopupContainerBox);this.Obj.PopupContainerBox=null}this.Obj.IsClosing=false;this.Obj.Gfx=null}};GFX.prototype.GraphStart=function(){this.OldImg=this.Obj.Img.cloneNode(true);this.Obj.Img.style.position="absolute";this.OldImg.style.position="absolute";this.Obj.Img.parentNode.appendChild(this.OldImg);this.OvX=this.Obj.ContentBox.style.overflowX;this.OvY=this.Obj.ContentBox.style.overflowY;this.Obj.ContentBox.style.overflowX="hidden";this.Obj.ContentBox.style.overflowY="hidden";if(this.Tipo=="fade"){if(this.Flin){if(RD3_Glb.IsIE(10,false)){this.Obj.Img.style.filter="filter: alpha(opacity = 0);";this.Obj.Img.src=this.Obj.File}else{this.OldImg.style.opacity=0;this.FirstTick=true;this.FirstStartDate=this.StartDate}}}this.StartDate=new Date()};GFX.prototype.GraphTick=function(a){if(this.FirstTick){if(this.Tipo=="fade"){if(this.OldImg.complete){this.FirstTick=false;this.Obj.Img.src=this.Obj.File;if(this.Flin){if(RD3_Glb.IsIE(10,false)){this.Obj.Img.style.filter="filter: alpha(opacity = 0);";this.OldImg.style.filter="filter: alpha(opacity = 1);"}else{this.Obj.Img.style.opacity=0;this.OldImg.style.opacity=1}}}else{this.StartDate=new Date();if(this.StartDate-this.FirstStartDate>this.Durata){this.StartDate=this.FirstStartDate;this.Obj.Img.src=this.Obj.File}}}}else{if(this.Tipo=="fade"){if(this.Flin){if(RD3_Glb.IsIE(10,false)){this.OldImg.style.filter="filter: alpha(opacity = "+Math.floor((1-(a))*100)+");"}else{this.OldImg.style.opacity=1-a}if(RD3_Glb.IsIE(10,false)){this.Obj.Img.style.filter="filter: alpha(opacity = "+Math.floor((a)*100)+");"}else{this.Obj.Img.style.opacity=a}}else{if(RD3_Glb.IsIE(10,false)){this.OldImg.style.filter="filter: alpha(opacity = "+Math.floor((1-a)*100)+");"}else{this.OldImg.style.opacity=1-a}}}}};GFX.prototype.GraphFinish=function(){if(this.OldImg&&this.OldImg.parentNode){this.OldImg.parentNode.removeChild(this.OldImg);this.OldImg=null}if(this.Durata==0||this.Tipo=="none"){this.Obj.Img.src=this.Obj.File}if(RD3_Glb.IsIE(10,false)){this.Obj.Img.style.removeAttribute("filter")}else{this.Obj.Img.style.opacity=1}this.Obj.Img.style.position="";this.Obj.Img.style.visibility=(this.Obj.File=="")?"hidden":"";this.Obj.ContentBox.style.overflowX=this.OvX?this.OvX:"";this.Obj.ContentBox.style.overflowY=this.OvY?this.OvY:""};GFX.prototype.BookStart=function(){if(!this.Obj&&!this.ObjOut){this.SetFinished();return}this.ParentStyle=this.Obj?this.Obj.ParentBook.ContentBox.style:this.ObjOut.ParentBook.ContentBox.style;this.OverX=this.ParentStyle.overflowX;this.OverY=this.ParentStyle.overflowY;this.ParentStyle.overflowX="hidden";this.ParentStyle.overflowY="hidden";if(this.Obj){this.ObjStyle=this.Obj.PageBox.style;this.ObjStyle.display="";this.ObjStyle.zIndex="20"}if(this.ObjOut){this.ObjOutStyle=this.ObjOut.PageBox.style;this.ObjOutStyle.display="";this.ObjOutStyle.zIndex="19"}if(this.Obj&&!this.Obj.Adapted){this.Obj.AdaptLayout()}if(this.Tipo=="fade"){if(this.Obj){if(RD3_Glb.IsIE(10,false)){this.ObjStyle.filter="filter: alpha(opacity = 0);"}else{this.ObjStyle.opacity=0}}if(this.ObjOut){if(RD3_Glb.IsIE(10,false)){this.ObjOutStyle.filter="filter: alpha(opacity = 100);"}else{this.ObjOutStyle.opacity=1}}}if(this.Tipo=="fold"){var c=this.Obj?this.Obj.PageBox.offsetWidth:this.ObjOut.PageBox.offsetWidth;var b=this.ObjOut?this.ObjOut.PageBox.offsetWidth:c;if(c==b){this.ObjW=this.Obj?this.Obj.PageBox.offsetWidth:this.ObjOut.PageBox.offsetWidth;if(this.Obj){this.NewPagOv=this.ObjStyle.overflow;this.ObjStyle.overflow="hidden";if(this.Flin){this.ObjStyle.left="0px"}else{this.ObjStyle.left=(this.ObjOutW?this.ObjOutW:this.ObjW)+"px"}this.ObjStyle.width="0px"}if(this.ObjOut){this.OldPagOv=this.ObjOutStyle.overflow;this.ObjOutStyle.overflow="hidden";this.ObjOutW=this.ObjOut.PageBox.offsetWidth}}else{this.Tipo="scroll"}}if(this.Tipo=="scroll"){var a=this.Obj?this.Obj.ParentBook.ContentBox.offsetWidth:this.ObjOut.ParentBook.ContentBox.offsetWidth;var c=this.Obj?this.Obj.PageBox.offsetWidth:this.ObjOut.PageBox.offsetWidth;var b=this.ObjOut?this.ObjOut.PageBox.offsetWidth:c;if(c<a&&b<a){this.ObjW=a}else{this.ObjW=this.Flin?c:b}if(this.Obj){if(this.Flin){if(this.WillBeWebKit()){this.ObjStyle.webkitTransform="translateX(-"+this.ObjW+"px)"}else{this.ObjStyle.left="-"+this.ObjW+"px"}}else{if(this.WillBeWebKit()){this.ObjStyle.webkitTransform="translateX("+this.ObjW+"px)";this.ObjW=-this.ObjW}else{this.ObjStyle.left=this.ObjW+"px"}}}}this.StartDate=new Date()};GFX.prototype.BookTick=function(c){if(this.Tipo=="fade"){var b=c;var a=c;if(this.ObjOut){b=1-(c)}if(this.Obj){if(RD3_Glb.IsIE(10,false)){this.ObjStyle.filter="filter: alpha(opacity = "+(a*100)+");"}else{this.ObjStyle.opacity=a}}if(this.ObjOut){if(RD3_Glb.IsIE(10,false)){this.ObjOutStyle.filter="filter: alpha(opacity = "+(b*100)+");"}else{this.ObjOutStyle.opacity=b}}}if(this.Tipo=="scroll"){if(this.Flin){if(this.ObjOut){this.ObjOutStyle.left=(this.ObjW*c)+"px"}if(this.Obj){this.ObjStyle.left=0-(this.ObjW*(1-c))+"px"}}else{if(this.ObjOut){this.ObjOutStyle.left=0-(this.ObjW*c)+"px"}if(this.Obj){this.ObjStyle.left=this.ObjW*(1-c)+"px"}}}if(this.Tipo=="fold"){if(this.Flin){if(this.Obj){this.ObjStyle.width=(c*this.ObjW)+"px"}if(this.ObjOut){this.ObjOutStyle.width=((1-c)*this.ObjW)+"px";this.ObjOutStyle.left=(c*this.ObjW)+"px"}}else{if(this.Obj){this.ObjStyle.width=(c*this.ObjW)+"px";this.ObjStyle.left=((1-c)*this.ObjW)+"px"}if(this.ObjOut){this.ObjOutStyle.width=((1-c)*this.ObjW)+"px"}}}};GFX.prototype.BookFinish=function(){if(!this.Obj&&!this.ObjOut){return}if(!this.ParentStyle){this.ParentStyle=this.Obj?this.Obj.ParentBook.ContentBox.style:this.ObjOut.ParentBook.ContentBox.style}if(!this.ObjStyle&&this.Obj){this.ObjStyle=this.Obj.PageBox.style}if(!this.ObjOutStyle&&this.ObjOut){this.ObjOutStyle=this.ObjOut.PageBox.style}if(this.ObjOut){this.ObjOut.SetActive(false);if(RD3_Glb.IsIE(10,false)){this.ObjOutStyle.removeAttribute("filter")}else{this.ObjOutStyle.opacity=1}this.ObjOutStyle.zIndex="";this.ObjOutStyle.left="";if(this.IsWebKit){this.ObjOutStyle.webkitTransform=""}this.ObjOutStyle.overflow=this.OldPagOv?this.OldPagOv:"";if(this.ObjOutW){this.ObjOutStyle.width=this.ObjOutW}}if(this.Obj){if(RD3_Glb.IsIE(10,false)){this.ObjStyle.removeAttribute("filter")}else{this.ObjStyle.opacity=1}this.ObjStyle.zIndex="";this.ObjStyle.left="";if(this.IsWebKit){this.ObjStyle.webkitTransform=""}this.ObjStyle.overflow=this.NewPagOv?this.NewPagOv:"";if(this.UnrealizeOnFinish){var b=this.Obj.ParentBook.Pages[this.Obj.ParentBook.SelectedPage];b.SetActive(true);b.AdaptLayout();this.Obj.UnrealizeDelayed()}else{this.Obj.SetActive(true)}}this.ParentStyle.overflowX=this.OverX?this.OverX:"";this.ParentStyle.overflowY=this.OverY?this.OverY:"";var a=this.Obj?this.Obj.ParentBook:this.ObjOut.ParentBook;a.SetCaption();a.AnimatingNum=null;a.Fx=null;this.ParentStyle=null;this.ObjStyle=null;this.ObjOutStyle=null;this.Obj=null;this.ObjOut=null};GFX.prototype.MessageStart=function(){if((this.NewHeight==this.OldHeight)||this.Obj.Animating){this.SetFinished();return}};GFX.prototype.MessageTick=function(a){if(this.Flin){this.Obj.MessagesBox.style.height=this.OldHeight+a*(this.NewHeight-this.OldHeight)+"px";RD3_Glb.AdaptToParent(this.Obj.FramesBox,0,this.Obj.CaptionBox.offsetHeight+this.Obj.MessagesBox.offsetHeight)}else{this.Obj.MessagesBox.style.height=this.OldHeight-a*(this.OldHeight-this.NewHeight)+"px";RD3_Glb.AdaptToParent(this.Obj.FramesBox,0,this.Obj.CaptionBox.offsetHeight+this.Obj.MessagesBox.offsetHeight)}};GFX.prototype.MessageFinish=function(){var b=this.Obj.MessagesBox.style;b.height=this.NewHeight+"px";b.borderBottomWidth=this.NewHeight==0?"0px":"";if(this.NewHeight!=this.OldHeight&&this.Obj.Realized&&!this.Obj.Animating){var c="";var a="";if(RD3_Glb.IsChrome()||RD3_Glb.IsSafari()){c=this.Obj.FramesBox.style.overflowX;a=this.Obj.FramesBox.style.overflowY;this.Obj.FramesBox.style.overflowX="hidden";this.Obj.FramesBox.style.overflowY="hidden"}RD3_Glb.AdaptToParent(this.Obj.FramesBox,0,this.Obj.CaptionBox.offsetHeight+this.Obj.MessagesBox.offsetHeight);if(RD3_Glb.IsChrome()||RD3_Glb.IsSafari()){this.Obj.FramesBox.style.overflowX=c;this.Obj.FramesBox.style.overflowY=a}}};GFX.prototype.LastMessageStart=function(){};GFX.prototype.LastMessageTick=function(a){if(RD3_Glb.IsIE(10,false)){this.Obj.MyBox.style.filter="filter: alpha(opacity = "+Math.floor((1-a)*100)+");"}else{this.Obj.MyBox.style.opacity=1-a}};GFX.prototype.LastMessageFinish=function(){this.Obj.Unrealize()};GFX.prototype.RedirectStart=function(){};GFX.prototype.RedirectTick=function(a){if(RD3_Glb.IsIE(10,false)){document.body.style.filter="filter: alpha(opacity = "+Math.floor(100-(a*100))+");"}else{document.body.style.opacity=1-a}};GFX.prototype.RedirectFinish=function(){if(this.Url=="!!!"){if(RD3_Glb.IsIE()){window.open("","_parent","")}else{if(RD3_Glb.IsChrome()||RD3_Glb.IsSafari()){window.open("","_self","")}}window.close();return}document.location.assign(this.Url)};GFX.prototype.PreviewStart=function(){if(this.Obj.Frames[0].FrameBox){this.FrSty=this.Obj.Frames[0].FrameBox.style}else{this.Fr1sty=this.Obj.Frames[0].ChildBox1.style;this.Fr2sty=this.Obj.Frames[0].ChildBox2.style}this.Presty=this.Obj.PreviewFrame.FrameBox.style;if(this.Flin){if(this.Obj.Frames[0].FrameBox){this.FrSty.display=""}else{this.Fr1sty.display="";this.Fr2sty.display=""}if(this.Tipo=="fade"){this.Presty.top="0px";if(RD3_Glb.IsIE(10,false)){this.Presty.filter="filter: alpha(opacity = 0);"}else{this.Presty.opacity=0}}if(this.Tipo=="scroll"){this.Presty.top=(RD3_ServerParams.Theme=="zen"?2:0)+"px";this.ToolSty=this.Obj.PreviewFrame.ToolbarBox.style;this.ToolSty.zIndex=10;this.ToolSty.position="absolute";this.ToolSty.top="0px";this.ToolH=this.Obj.PreviewFrame.ToolbarBox.offsetHeight;this.ObjH=this.Obj.PreviewFrame.ContentBox.offsetHeight;this.Presty=this.Obj.PreviewFrame.ContentBox.style;this.Presty.top="-"+(this.ObjH+this.ToolH)+"px";this.Ofx=this.Presty.overflowX;this.Ofy=this.Presty.overflowY;this.Presty.overflowX="hidden";this.Presty.overflowY="hidden";this.Presty.backgroundColor=RD3_Glb.GetStyleProp(this.Obj.FormBox,"backgroundColor")}if(this.Tipo=="fold"){this.Presty.top="0px";this.ObjH=this.Obj.PreviewFrame.ContentBox.offsetHeight;this.Presty=this.Obj.PreviewFrame.ContentBox.style;this.Presty.height="0px";this.Presty.backgroundColor=RD3_Glb.GetStyleProp(this.Obj.FormBox,"backgroundColor")}}else{if(this.Obj.Frames[0].FrameBox){this.FrSty.display=""}else{this.Fr1sty.display="";this.Fr2sty.display=""}if(this.Tipo=="fade"){this.Presty.top="0px";if(this.Obj.Frames[0].FrameBox){if(RD3_Glb.IsIE(10,false)){this.FrSty.filter="filter: alpha(opacity = 0);"}else{this.FrSty.opacity=0}}else{if(RD3_Glb.IsIE(10,false)){this.Fr1sty.filter="filter: alpha(opacity = 0);";this.Fr2sty.filter="filter: alpha(opacity = 0);"}else{this.Fr1sty.opacity=0;this.Fr2sty.opacity=0}}}if(this.Tipo=="scroll"){this.Presty=this.Obj.PreviewFrame.ContentBox.style;this.ToolSty=this.Obj.PreviewFrame.ToolbarBox.style;this.ToolSty.zIndex=10;this.ToolSty.position="absolute";this.ToolSty.top="0px";this.ToolH=this.Obj.PreviewFrame.ToolbarBox.offsetHeight;this.ObjH=this.Obj.PreviewFrame.ContentBox.offsetHeight;this.Ofx=this.Presty.overflowX;this.Ofy=this.Presty.overflowY;this.Presty.overflowX="hidden";this.Presty.overflowY="hidden";this.Presty.backgroundColor=RD3_Glb.GetStyleProp(this.Obj.FormBox,"backgroundColor")}if(this.Tipo=="fold"){this.Presty.top="0px";this.ObjH=this.Obj.PreviewFrame.ContentBox.offsetHeight;this.Presty=this.Obj.PreviewFrame.ContentBox.style;this.Presty.backgroundColor=RD3_Glb.GetStyleProp(this.Obj.FormBox,"backgroundColor")}}};GFX.prototype.PreviewTick=function(a){if(this.Tipo=="fade"){if(this.Flin){if(RD3_Glb.IsIE(10,false)){this.Presty.filter="filter: alpha(opacity = "+100*a+");"}else{this.Presty.opacity=a}if(this.Obj.Frames[0].FrameBox){if(RD3_Glb.IsIE(10,false)){this.FrSty.filter="filter: alpha(opacity = "+(100-(100*a))+");"}else{this.FrSty.opacity=1-a}}else{if(RD3_Glb.IsIE(10,false)){this.Fr1sty.filter="filter: alpha(opacity = "+(100-(100*a))+");";this.Fr2sty.filter="filter: alpha(opacity = "+(100-(100*a))+");"}else{this.Fr1sty.opacity=1-a;this.Fr2sty.opacity=1-a}}}else{if(RD3_Glb.IsIE(10,false)){this.Presty.filter="filter: alpha(opacity = "+(100-(100*a))+");"}else{this.Presty.opacity=1-a}if(this.Obj.Frames[0].FrameBox){if(RD3_Glb.IsIE(10,false)){this.FrSty.filter="filter: alpha(opacity = "+100*a+");"}else{this.FrSty.opacity=a}}else{if(RD3_Glb.IsIE(10,false)){this.Fr1sty.filter="filter: alpha(opacity = "+100*a+");";this.Fr2sty.filter="filter: alpha(opacity = "+100*a+");"}else{this.Fr1sty.opacity=a;this.Fr2sty.opacity=a}}}}if(this.Tipo=="scroll"){if(this.Flin){this.Presty.top=((0-((1-a)*this.ObjH))+this.ToolH)+"px"}else{this.Presty.top=((0-(a*this.ObjH))+this.ToolH)+"px"}}if(this.Tipo=="fold"){if(this.Flin){this.Presty.height=(a*this.ObjH)+"px"}else{this.Presty.height=(this.ObjH-(a*this.ObjH))+"px"}}};GFX.prototype.PreviewFinish=function(){if(this.Durata==0||this.Tipo=="none"){if(this.Obj.Frames[0].FrameBox){this.FrSty=this.Obj.Frames[0].FrameBox.style}else{this.Fr1sty=this.Obj.Frames[0].ChildBox1.style;this.Fr2sty=this.Obj.Frames[0].ChildBox2.style}if(this.Tipo=="fade"){this.Presty=this.Obj.PreviewFrame.FrameBox.style}else{this.Presty=this.Obj.PreviewFrame.ContentBox.style}this.ToolSty=this.Obj.PreviewFrame.ToolbarBox.style;this.ToolH=this.Obj.PreviewFrame.ToolbarBox.offsetHeight}if(this.IsWebKit){this.Obj.PreviewFrame.ContentBox.style.webkitTransform=""}if(this.Flin){if(this.Obj.Frames[0].FrameBox){this.FrSty.display="none"}else{this.Fr1sty.display="none";this.Fr2sty.display="none"}if(this.Tipo=="fade"){if(RD3_Glb.IsIE(10,false)){this.Presty.removeAttribute("filter")}else{this.Presty.opacity=1}if(this.Obj.Frames[0].FrameBox){if(RD3_Glb.IsIE(10,false)){this.FrSty.removeAttribute("filter")}else{this.FrSty.opacity=1}}else{if(RD3_Glb.IsIE(10,false)){this.Fr1sty.removeAttribute("filter");this.Fr2sty.removeAttribute("filter")}else{this.Fr1sty.opacity=1;this.Fr2sty.opacity=1}}}if(this.Tipo=="scroll"){if(this.Ofx){this.Presty.overflowX=this.Ofx}if(this.Ofy){this.Presty.overflowY=this.Ofy}this.Presty.top=this.ToolH+"px";this.Presty.backgroundColor="";this.ToolSty.zIndex=0;this.ToolSty.position="";this.ToolSty.top=""}if(this.Tipo=="fold"){this.Presty.backgroundColor=""}this.Obj.RecalcLayout=false}else{if(this.Obj.Frames[0].FrameBox){this.Obj.Frames[0].FrameBox.style.display=""}else{this.Obj.Frames[0].ChildBox1.style.display="";this.Obj.Frames[0].ChildBox2.style.display=""}this.Obj.PreviewFrame.Unrealize();var b=this.Obj.Frames.length;for(var a=0;a<b;a++){if(this.Obj.Frames[a]==this.Obj.PreviewFrame){this.Obj.Frames.splice(a,1);break}}this.Obj.PreviewFrame=null;if(this.Tipo=="fade"){if(this.Obj.Frames[0].FrameBox){if(RD3_Glb.IsIE(10,false)){this.FrSty.removeAttribute("filter")}else{this.FrSty.opacity=1}}else{if(RD3_Glb.IsIE(10,false)){this.Fr1sty.removeAttribute("filter");this.Fr2sty.removeAttribute("filter")}else{this.Fr1sty.opacity=1;this.Fr2sty.opacity=1}}}}this.Presty=null;this.FrSty=null;this.Fr1sty=null;this.Fr2sty=null};GFX.prototype.DockedStart=function(){if(this.Flin){this.Obj.SetActive(true,true);this.Obj.SetVisible(true,false);this.Obj.AdaptDocked();this.Obj.AdaptLayout()}if(RD3_Glb.IsFirefox(3)&&this.Tipo=="scroll"){this.Tipo="fold"}this.Wep=RD3_DesktopManager.WebEntryPoint;if(this.Obj.DockType==RD3_Glb.FORMDOCK_LEFT){this.ObjD=this.Wep.LeftDockedBox.offsetWidth;this.TotalD=this.Wep.WepBox.clientWidth-((this.Wep.HasSideMenu())?this.Wep.SideMenuBox.offsetWidth:0)-this.Wep.RightDockedBox.offsetWidth}if(this.Obj.DockType==RD3_Glb.FORMDOCK_TOP){this.ObjD=this.Wep.TopDockedBox.offsetHeight;this.TotalD=this.Wep.WepBox.clientHeight-this.Wep.StatusBarBox.offsetHeight-this.Wep.ToolBarBox.offsetHeight-this.Wep.HeaderBox.offsetHeight-this.Wep.BottomDockedBox.offsetHeight}if(this.Obj.DockType==RD3_Glb.FORMDOCK_RIGHT){this.ObjD=this.Wep.RightDockedBox.offsetWidth;this.TotalD=this.Wep.WepBox.clientWidth-((this.Wep.HasSideMenu())?this.Wep.SideMenuBox.offsetWidth:0)-this.Wep.LeftDockedBox.offsetWidth}if(this.Obj.DockType==RD3_Glb.FORMDOCK_BOTTOM){this.ObjD=this.Wep.BottomDockedBox.offsetHeight;this.TotalD=this.Wep.WepBox.clientHeight-this.Wep.StatusBarBox.offsetHeight-this.Wep.ToolBarBox.offsetHeight-this.Wep.HeaderBox.offsetHeight-this.Wep.TopDockedBox.offsetHeight}this.FormsTop=this.Wep.StatusBarBox.offsetHeight+this.Wep.ToolBarBox.offsetHeight+this.Wep.HeaderBox.offsetHeight+(this.Obj.DockType==RD3_Glb.FORMDOCK_TOP?0:this.Wep.TopDockedBox.offsetHeight);this.FormsLeft=((this.Wep.HasSideMenu())?this.Wep.SideMenuBox.offsetWidth:0);this.Wep.RecalcLayout=false;if(this.Flin){this.Wep.FormsBox.style.left=this.FormsLeft+(this.Obj.DockType==RD3_Glb.FORMDOCK_LEFT?0:this.Wep.LeftDockedBox.offsetWidth)+"px";this.Wep.FormsBox.style.top=this.FormsTop+"px";this.Wep.LeftDockedBox.style.top=this.FormsTop+"px";this.Wep.RightDockedBox.style.top=this.FormsTop+"px";if(this.Obj.DockType==RD3_Glb.FORMDOCK_LEFT){this.Wep.LeftDockedBox.style.width="0px";this.Wep.LeftDockedBox.style.top=this.FormsTop+"px";this.Wep.LeftDockedBox.style.left=this.FormsLeft+"px"}if(this.Obj.DockType==RD3_Glb.FORMDOCK_TOP){this.Wep.TopDockedBox.style.height="0px";this.Wep.TopDockedBox.style.top=this.FormsTop+"px";this.Wep.TopDockedBox.style.left=this.FormsLeft+"px"}if(this.Obj.DockType==RD3_Glb.FORMDOCK_RIGHT){this.Wep.RightDockedBox.style.width="0px";this.Wep.RightDockedBox.style.top=this.FormsTop+"px";this.Wep.RightDockedBox.style.left=(this.Wep.WepBox.clientWidth)+"px"}if(this.Obj.DockType==RD3_Glb.FORMDOCK_BOTTOM){this.Wep.BottomDockedBox.style.height="0px";this.Wep.BottomDockedBox.style.top=(this.Wep.WepBox.clientHeight)+"px";this.Wep.BottomDockedBox.style.left=this.FormsLeft+"px"}}};GFX.prototype.DockedTick=function(b){if(this.Flin){if(this.Obj.DockType==RD3_Glb.FORMDOCK_LEFT){var a=this.ObjD*b;this.Wep.LeftDockedBox.style.width=a+"px";this.Wep.FormsBox.style.width=(this.TotalD-a)+"px";this.Wep.FormsBox.style.left=(this.FormsLeft+a)+"px";if(this.Tipo=="scroll"){this.Wep.LeftDockedBox.scrollLeft=this.ObjD-a}}if(this.Obj.DockType==RD3_Glb.FORMDOCK_TOP){var c=this.ObjD*b;this.Wep.TopDockedBox.style.height=c+"px";this.Wep.FormsBox.style.height=(this.TotalD-c)+"px";this.Wep.FormsBox.style.top=(this.FormsTop+c)+"px";this.Wep.LeftDockedBox.style.top=(this.FormsTop+c)+"px";this.Wep.RightDockedBox.style.top=(this.FormsTop+c)+"px";if(this.Tipo=="scroll"){this.Wep.TopDockedBox.scrollTop=this.ObjD-c}}if(this.Obj.DockType==RD3_Glb.FORMDOCK_RIGHT){var a=this.ObjD*b;this.Wep.RightDockedBox.style.width=a+"px";this.Wep.RightDockedBox.style.left=(this.Wep.WepBox.clientWidth-a)+"px";this.Wep.FormsBox.style.width=(this.TotalD-a)+"px";if(this.Tipo=="scroll"){this.Wep.RightDockedBox.scrollLeft=0}}if(this.Obj.DockType==RD3_Glb.FORMDOCK_BOTTOM){var c=this.ObjD*b;this.Wep.BottomDockedBox.style.height=c+"px";this.Wep.BottomDockedBox.style.top=(this.Wep.WepBox.clientHeight-c)+"px";this.Wep.FormsBox.style.height=(this.TotalD-c)+"px";this.Wep.LeftDockedBox.style.height=(this.TotalD-c)+"px";this.Wep.RightDockedBox.style.height=(this.TotalD-c)+"px";if(this.Tipo=="scroll"){this.Wep.BottomDockedBox.scrollTop=0}}}else{if(this.Obj.DockType==RD3_Glb.FORMDOCK_LEFT){var a=this.ObjD*(1-b);this.Wep.LeftDockedBox.style.width=a+"px";this.Wep.FormsBox.style.width=(this.TotalD-a)+"px";this.Wep.FormsBox.style.left=(this.FormsLeft+a)+"px";if(this.Tipo=="scroll"){this.Wep.LeftDockedBox.scrollLeft=this.ObjD-a}}if(this.Obj.DockType==RD3_Glb.FORMDOCK_TOP){var c=this.ObjD*(1-b);this.Wep.TopDockedBox.style.height=c+"px";this.Wep.FormsBox.style.height=(this.TotalD-c)+"px";this.Wep.FormsBox.style.top=(this.FormsTop+c)+"px";this.Wep.LeftDockedBox.style.top=(this.FormsTop+c)+"px";this.Wep.RightDockedBox.style.top=(this.FormsTop+c)+"px";if(this.Tipo=="scroll"){this.Wep.TopDockedBox.scrollTop=this.ObjD-c}}if(this.Obj.DockType==RD3_Glb.FORMDOCK_RIGHT){var a=this.ObjD*(1-b);this.Wep.RightDockedBox.style.width=a+"px";this.Wep.RightDockedBox.style.left=(this.Wep.WepBox.clientWidth-a)+"px";this.Wep.FormsBox.style.width=(this.TotalD-a)+"px";if(this.Tipo=="scroll"){this.Wep.RightDockedBox.scrollLeft=0}}if(this.Obj.DockType==RD3_Glb.FORMDOCK_BOTTOM){var c=this.ObjD*(1-b);this.Wep.BottomDockedBox.style.height=c+"px";this.Wep.BottomDockedBox.style.top=(this.Wep.WepBox.clientHeight-c)+"px";this.Wep.FormsBox.style.height=(this.TotalD-c)+"px";this.Wep.LeftDockedBox.style.height=(this.TotalD-c)+"px";this.Wep.RightDockedBox.style.height=(this.TotalD-c)+"px";if(this.Tipo=="scroll"){this.Wep.BottomDockedBox.scrollTop=0}}}};GFX.prototype.DockedFinish=function(){if(!this.Wep){this.Wep=RD3_DesktopManager.WebEntryPoint}if(this.Flin){this.Obj.AdaptDocked();this.Wep.CmdObj.ActiveFormChanged();this.Wep.IndObj.ActiveFormChanged();this.Wep.TimerObj.ActiveFormChanged();this.Wep.HandleCloseAllVisibility();if(this.Wep.ActiveForm){RD3_DesktopManager.HandleFocus2(this.Wep.ActiveForm.Identifier,0)}this.Wep.AdaptLayout()}else{if(this.CloseFormAnimation){this.Obj.Unrealize();var c=this.Wep.StackForm.length;for(var a=0;a<c;a++){var b=this.Wep.StackForm[a];if(b.Identifier==this.IdxForm){this.Wep.StackForm.splice(a,1);break}}}else{this.Obj.SetVisible(false,false);this.Wep.AdaptLayout()}this.Wep.CmdObj.ActiveFormChanged();this.Wep.IndObj.ActiveFormChanged();this.Wep.TimerObj.ActiveFormChanged()}};GFX.prototype.PopupResizeStart=function(){if(!this.Obj||!this.Obj.PopupFrame){this.SetFinished();return}this.Obj.RecalcLayout=false;this.Obj.Animating=true;this.Obj.PopupResAnimating=true;this.LeftAnim=(this.Obj.FormLeft==this.Obj.PopupRect.x)?false:true;this.TopAnim=(this.Obj.FormTop==this.Obj.PopupRect.y)?false:true;this.WidthAnim=(this.Obj.FormWidth==this.Obj.PopupRect.w)?false:true;this.HeightAnim=(this.Obj.FormHeight==this.Obj.PopupRect.h)?false:true};GFX.prototype.PopupResizeTick=function(l){var g=false;if(this.LeftAnim){var b=this.Obj.FormLeft;var a=this.Obj.PopupRect.x;var n=a+l*(b-a);this.Obj.PopupFrame.SetLeft(n)}if(this.TopAnim){var m=this.Obj.FormTop;var i=this.Obj.PopupRect.y;var k=i+l*(m-i);this.Obj.PopupFrame.SetTop(k)}if(this.WidthAnim){var h=this.Obj.FormWidth;var f=this.Obj.PopupRect.w;var e=f+l*(h-f);this.Obj.PopupFrame.SetWidth(e);g=true}if(this.HeightAnim){var d=this.Obj.FormHeight;var c=this.Obj.PopupRect.h;var j=c+l*(d-c);this.Obj.PopupFrame.SetHeight(j);g=true}if(g){this.Obj.PopupFrame.AdaptLayout()}};GFX.prototype.PopupResizeFinish=function(){if(!this.Obj){return}this.Obj.Animating=false;this.Obj.PopupResAnimating=false;this.Obj.SetFormLeft(this.Obj.FormLeft,true);this.Obj.SetFormTop(this.Obj.FormTop,true);this.Obj.SetFormWidth(this.Obj.FormWidth,true);this.Obj.SetFormHeight(this.Obj.FormHeight,true);if(this.Obj.WindowState==RD3_Glb.WS_NORMAL){this.Obj.PopupFrame.ShowThickBorders(true)}if(this.IsWebKit){this.Obj.PopupFrame.PopupBox.style.webkitTransform="scale(1.0) translateX(0px) translateY(0px)"}var c=true;if(this.Obj.AfterPopupResizeFinish){c=this.Obj.AfterPopupResizeFinish()}if(c){this.Obj.AdaptLayout()}if(this.Flin&&this.Obj.WindowState==RD3_Glb.WS_NORMAL&&RD3_Glb.IsFirefox(3)&&this.Obj.PopupFrame&&this.Obj.PopupFrame.PopupBox){var b=this.Obj.PopupFrame.PopupBox;var a=b.parentNode;b.parentNode.removeChild(b);a.appendChild(b)}this.Obj=null;if(RD3_GFXManager.ModalFocusFldId&&RD3_GFXManager.ModalFocusFldId!=""){RD3_DesktopManager.HandleFocus2(RD3_GFXManager.ModalFocusFldId,RD3_GFXManager.ModalFocusFldRow);RD3_GFXManager.ModalFocusFldId="";RD3_GFXManager.ModalFocusFldRow=0}};GFX.prototype.TooltipStart=function(){if(this.Flin){this.Obj.Open();if(RD3_Glb.IsIE(10,false)){var c=this.Obj.PopupBox.style;this.Ttop=parseInt(c.top,10);this.Tleft=parseInt(c.left,10);this.Twidth=parseInt(c.width,10);this.Theight=parseInt(c.height,10);this.Wraptt=document.createElement("DIV");var a=this.Wraptt.style;var b=(this.Obj.WhiskerBase>this.Obj.WhiskerHeight)?this.Obj.WhiskerBase:this.Obj.WhiskerHeight;b+=(this.Obj.BorderRoundWidth+this.Obj.WhiskerOffset);a.top=(this.Ttop-b)+"px";a.left=(this.Tleft-b)+"px";a.width=(this.Twidth+(b*2))+"px";a.height=(this.Theight+(b*2))+"px";a.position="absolute";c.top=b+"px";c.left=b+"px";this.Wraptt.style.zIndex=200;this.Wraptt.appendChild(this.Obj.PopupBox);document.body.appendChild(this.Wraptt)}this.ObjStyle=RD3_Glb.IsIE(10,false)?this.Wraptt.style:this.Obj.PopupBox.style;if(RD3_Glb.IsIE(10,false)){this.ObjStyle.filter="filter: alpha(opacity = 0);"}else{this.ObjStyle.opacity=0}}else{if(RD3_Glb.IsIE(10,false)){var c=this.Obj.PopupBox.style;this.Ttop=parseInt(c.top,10);this.Tleft=parseInt(c.left,10);this.Twidth=parseInt(c.width,10);this.Theight=parseInt(c.height,10);this.Wraptt=document.createElement("DIV");var a=this.Wraptt.style;var b=(this.Obj.WhiskerBase>this.Obj.WhiskerHeight)?this.Obj.WhiskerBase:this.Obj.WhiskerHeight;b+=(this.Obj.BorderRoundWidth+this.Obj.WhiskerOffset);a.top=(this.Ttop-b)+"px";a.left=(this.Tleft-b)+"px";a.width=(this.Twidth+(b*2))+"px";a.height=(this.Theight+(b*2))+"px";a.position="absolute";c.top=b+"px";c.left=b+"px";this.Wraptt.style.zIndex=200;this.Wraptt.appendChild(this.Obj.PopupBox);document.body.appendChild(this.Wraptt)}this.ObjStyle=RD3_Glb.IsIE(10,false)?this.Wraptt.style:this.Obj.PopupBox.style}};GFX.prototype.TooltipTick=function(a){var b=this.Flin?a:(1-a);if(RD3_Glb.IsIE(10,false)){this.ObjStyle.filter="filter: alpha(opacity = "+Math.floor(b*100)+");"}else{this.ObjStyle.opacity=b}};GFX.prototype.TooltipFinish=function(){if(this.Flin){if(this.Durata==0||this.Tipo=="none"){this.Obj.Open();this.ObjStyle=this.Obj.PopupBox.style}else{if(RD3_Glb.IsIE(10,false)){var a=this.Obj.PopupBox.style;a.top=this.Ttop+"px";a.left=this.Tleft+"px";document.body.removeChild(this.Wraptt);document.body.appendChild(this.Obj.PopupBox);this.Wraptt=null;this.ObjStyle=this.Obj.PopupBox.style}}if(RD3_Glb.IsIE(10,false)){this.ObjStyle.removeAttribute("filter")}else{this.ObjStyle.opacity=1}}else{if(RD3_Glb.IsIE(10,false)&&!(this.Durata==0||this.Tipo=="none")){var a=this.Obj.PopupBox.style;a.top=this.Ttop+"px";a.left=this.Tleft+"px";document.body.removeChild(this.Wraptt);document.body.appendChild(this.Obj.PopupBox);this.Wraptt=null;this.ObjStyle=this.Obj.PopupBox.style}if(!(this.Durata==0||this.Tipo=="none")){if(RD3_Glb.IsIE(10,false)){this.ObjStyle.removeAttribute("filter")}else{this.ObjStyle.opacity=1}}this.Obj.Close()}};GFX.prototype.TaskBarStart=function(){if(this.Flin){this.ObjH=this.Obj.offsetHeight;this.ObjT=this.Obj.offsetTop;this.Obj.style.height="0px";this.Obj.style.top=this.ObjT+this.ObjH+"px"}else{if(this.Obj.style.display!="block"){this.SetFinished();return}this.ObjH=this.Obj.offsetHeight;this.ObjT=this.Obj.offsetTop;RD3_DesktopManager.WebEntryPoint.MenuScrollUp.style.display="none";RD3_DesktopManager.WebEntryPoint.MenuScrollDown.style.display="none"}};GFX.prototype.TaskBarTick=function(a){if(this.Flin){this.Obj.style.height=(a*this.ObjH)+"px";this.Obj.style.top=this.ObjT+(this.ObjH-(a*this.ObjH))+"px";this.Obj.scrollTop=0}else{this.Obj.style.height=((1-a)*this.ObjH)+"px";this.Obj.style.top=this.ObjT+(this.ObjH-((1-a)*this.ObjH))+"px";this.Obj.scrollTop=0}};GFX.prototype.TaskBarFinish=function(){if(this.Flin){if(this.Durata==0||this.Tipo=="none"){RD3_DesktopManager.WebEntryPoint.AdaptScrollBox()}else{this.Obj.style.height=this.ObjH+"px";this.Obj.style.top=this.ObjT+"px";this.Obj.scrollTop=0;RD3_DesktopManager.WebEntryPoint.AdaptScrollBox()}}else{RD3_DesktopManager.WebEntryPoint.TaskbarMenuBox.style.display="none";RD3_DesktopManager.WebEntryPoint.MenuScrollUp.style.display="none";RD3_DesktopManager.WebEntryPoint.MenuScrollDown.style.display="none";RD3_DesktopManager.WebEntryPoint.TaskbarStartCell.style.backgroundPosition=""}};GFX.prototype.ComboStart=function(){if(this.Flin){this.ObjH=this.Obj.ComboPopup.offsetHeight;this.ObjT=this.Obj.ComboPopup.offsetTop;this.ObjScr=this.Obj.ComboPopup.scrollTop;this.Obj.ComboPopup.style.height="0px";this.Obj.ComboPopup.style.overflow="hidden";if(this.Obj.ComboUpper){this.Obj.ComboPopup.style.top=this.ObjT+this.ObjH+"px"}}else{this.ObjH=this.Obj.ComboPopup.offsetHeight;this.ObjT=this.Obj.ComboPopup.offsetTop;this.ObjScr=this.Obj.ComboPopup.scrollTop;this.Obj.ComboPopup.style.overflow="hidden"}this.Obj.AnimatingCombo=true};GFX.prototype.ComboTick=function(a){if(!this.Obj.ComboUpper&&!this.Obj.ComboPopup){return}if(this.Flin){if(this.Tipo=="scroll"){if(this.Obj.ComboUpper){this.Obj.ComboPopup.style.height=(a*this.ObjH)+"px";this.Obj.ComboPopup.style.top=this.ObjT+Math.floor((1-a)*this.ObjH)+"px";if(!RD3_Glb.IsFirefox(3)){this.Obj.ComboPopup.scrollTop=this.ObjScr}}else{this.Obj.ComboPopup.style.height=(a*this.ObjH)+"px";if(!RD3_Glb.IsFirefox(3)){this.Obj.ComboPopup.scrollTop=this.ObjScr+Math.floor((1-a)*this.ObjH)}}}if(this.Tipo=="fold"){if(this.Obj.ComboUpper){this.Obj.ComboPopup.style.height=(a*this.ObjH)+"px";this.Obj.ComboPopup.style.top=this.ObjT+Math.floor((1-a)*this.ObjH)+"px";if(!RD3_Glb.IsFirefox(3)){this.Obj.ComboPopup.scrollTop=this.ObjScr+Math.floor((1-a)*this.ObjH)}}else{this.Obj.ComboPopup.style.height=(a*this.ObjH)+"px";if(!RD3_Glb.IsFirefox(3)){this.Obj.ComboPopup.scrollTop=this.ObjScr}}}}else{if(this.Tipo=="scroll"){if(this.Obj.ComboUpper){this.Obj.ComboPopup.style.height=((1-a)*this.ObjH)+"px";this.Obj.ComboPopup.style.top=this.ObjT+Math.floor(a*this.ObjH)+"px";if(!RD3_Glb.IsFirefox(3)){this.Obj.ComboPopup.scrollTop=this.ObjScr}}else{this.Obj.ComboPopup.style.height=((1-a)*this.ObjH)+"px";if(!RD3_Glb.IsFirefox(3)){this.Obj.ComboPopup.scrollTop=this.ObjScr+Math.floor(a*this.ObjH)}}}if(this.Tipo=="fold"){if(this.Obj.ComboUpper){this.Obj.ComboPopup.style.height=((1-a)*this.ObjH)+"px";this.Obj.ComboPopup.style.top=this.ObjT+Math.floor(a*this.ObjH)+"px";if(!RD3_Glb.IsFirefox(3)){this.Obj.ComboPopup.scrollTop=this.ObjScr+Math.floor(a*this.ObjH)}}else{this.Obj.ComboPopup.style.height=((1-a)*this.ObjH)+"px";if(!RD3_Glb.IsFirefox(3)){this.Obj.ComboPopup.scrollTop=this.ObjScr}}}}};GFX.prototype.ComboFinish=function(){if(!this.Obj.ComboPopup){return}if(this.Flin){this.Obj.ComboPopup.style.overflow="";this.Obj.AdaptPopupLayout(true);if(!this.Obj.ComboPopupTimer){this.Obj.ComboPopupTimer=window.setInterval(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Obj.Identifier+"', 'OnTimerTick', ev, true)"),250)}}else{this.Obj.ComboPopup.style.height="";this.Obj.ComboPopup.style.overflow="";this.Obj.ComboPopup.style.display="none"}this.Obj.AnimatingCombo=false};GFX.prototype.GroupStart=function(){if(!RD3_Glb.IsMobile()){this.BlockBox=document.createElement("div");this.BlockBox.className="blocking-box";document.body.appendChild(this.BlockBox);this.BlockBox.style.display="block"}if(this.Obj.Collapsed){var d=this.Obj.MyFields.length;for(var c=0;c<d;c++){this.Obj.MyFields[c].UpdateFieldVisibility()}}var a=(this.Obj.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST);this.deltaH=(a?this.Obj.ListHeight:this.Obj.FormHeight);if(this.Flin){this.deltaH=-this.deltaH}var d=this.Obj.FieldsUnderMe.length;for(var c=0;c<d;c++){var b=this.Obj.FieldsUnderMe[c];b.OriginalTop=(a?b.ListTop:b.FormTop)}};GFX.prototype.GroupTick=function(e){var b=(this.Obj.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST);var g=Math.floor(e*this.deltaH);var h=this.Obj.FieldsUnderMe.length;for(var d=0;d<h;d++){var c=this.Obj.FieldsUnderMe[d];if(b){c.SetListTop(c.OriginalTop+g)}else{c.SetFormTop(c.OriginalTop+g)}}this.Obj.ParentPanel.CalcGroupsLayout();var a=this.Obj.Collapsed;this.Obj.Collapsed=false;if(b){this.Obj.SetListHeight(this.Flin?this.Obj.ListHeight+g:g)}else{this.Obj.SetFormHeight(this.Flin?this.Obj.FormHeight+g:g)}this.Obj.Collapsed=a;if(!this.Flin){var f=(b?this.Obj.ParentPanel.ListBox:this.Obj.ParentPanel.FormBox);if(f.scrollHeight<f.offsetHeight){}f.style.height=f.scrollHeight+"px"}};GFX.prototype.GroupFinish=function(){var a=(this.Obj.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST);if(this.Durata==0||this.Tipo=="none"||!this.Obj.Collapsed){var d=this.Obj.MyFields.length;for(var c=0;c<d;c++){this.Obj.MyFields[c].UpdateFieldVisibility()}this.deltaH=(a?this.Obj.ListHeight:this.Obj.FormHeight);if(this.Flin){this.deltaH=-this.deltaH}}if(this.MoveFields){var d=this.Obj.FieldsUnderMe.length;for(var c=0;c<d;c++){var b=this.Obj.FieldsUnderMe[c];if(a){if(!b.OriginalTop){b.OriginalTop=b.ListTop}b.SetListTop(b.OriginalTop+this.deltaH)}else{if(!b.OriginalTop){b.OriginalTop=b.FormTop}b.SetFormTop(b.OriginalTop+this.deltaH)}b.OriginalTop=null}}this.Obj.ParentPanel.CalcGroupsLayout();if(this.BlockBox){this.BlockBox.parentNode.removeChild(this.BlockBox)}delete this.BlockBox};GFX.prototype.SetWebKitTiming=function(a){a.webkitTransitionDuration=this.Durata+"ms";if(this.Classe!="tab"){a.webkitTransitionDelay="50ms"}if(!this.WebKitStyles){this.WebKitStyles=new Array()}this.WebKitStyles.push(a)};GFX.prototype.ResetWebKitTiming=function(b){if(this.WebKitStyles){var a=0;for(a=0;a<this.WebKitStyles.length;a++){this.WebKitStyles[a].webkitTransitionProperty="";this.WebKitStyles[a].webkitTransitionDuration="";this.WebKitStyles[a].webkitTransitionDelay=""}this.WebKitStyles=null}};GFX.prototype.OnEndAnimation=function(a){if(this.IsFinished()||this.WebkitTick>0){return}if(this.IsMyAnimation(a)){this.SetFinished();return true}};GFX.prototype.IsMyAnimation=function(a){if(this.Obj==a.target||(this.Obj&&this.TargetObj==a.target)){return true}switch(this.Classe){case"graph":if((this.Obj&&this.Obj.Img==a.target)||this.OldImg==a.target){return true}}return false};GFX.prototype.StartWebKit=function(){if(!RD3_ClientParams.UseWebKitGFX){return}switch(this.Classe){case"start":this.WebKitOpacityStart(1,this.Obj,true);break;case"redirect":this.WebKitOpacityStart(0,this.Obj,true);break;case"graph":this.WebKitGraphStart();break;case"form":this.WebKitFormStart();break;case"tab":this.WebKitTabStart();break;case"list":this.WebKitListStart();break;case"book":this.WebKitBookStart();break;case"tooltip":this.WebKitOpacityStart(this.Flin?"1":"0",this.Obj.PopupBox,true);break;case"modal":this.WebKitModalStart();break;case"popupres":this.WebKitPopupResizeStart();break;case"sidebar":this.WebKitSideBarStart();break;case"preview":this.WebKitPreviewStart();break}};GFX.prototype.WillBeWebKit=function(){if(!RD3_ClientParams.UseWebKitGFX||!RD3_Glb.IsTouch()||RD3_Glb.IsIE(10,true)){return}switch(this.Classe){case"form":if(this.Tipo=="scroll-h"||this.Tipo=="scroll-v"){return true}break;case"tab":if(this.Tipo=="scroll-h"){return true}break;case"list":if(this.Tipo=="scroll-h"&&!RD3_Glb.IsChrome()){return true}break;case"book":if(this.Obj&&this.ObjOut&&this.Tipo=="scroll"){return true}break;case"modal":if(this.Tipo=="zoom"){return true}break;case"sidebar":if(this.Tipo=="scroll"&&RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_LEFTSB){return true}break;case"preview":if(this.Tipo=="scroll"){return true}break}};GFX.prototype.WebKitOpacityStart=function(d,c,b){if(!c){return}this.IsWebKit=true;if(b){c.removeEventListener("webkitTransitionEnd",RD3_GFXManager.OnEndAnimation,false);c.addEventListener("webkitTransitionEnd",RD3_GFXManager.OnEndAnimation,false);this.TargetObj=c}var a=c.style;a.webkitTransitionProperty="opacity";this.SetWebKitTiming(a);a.opacity=d};GFX.prototype.WebKitGraphStart=function(){if(this.Tipo=="fade"){if(this.Flin){this.WebKitOpacityStart(0,this.OldImg,false);if(this.Obj){this.WebKitOpacityStart(1,this.Obj.Img,true)}}else{this.WebKitOpacityStart(0,this.OldImg,true)}}};GFX.prototype.WebKitTranslateStart=function(c,b,e,d){if(!c){return}this.IsWebKit=true;if(b){c.removeEventListener("webkitTransitionEnd",RD3_GFXManager.OnEndAnimation,false);c.addEventListener("webkitTransitionEnd",RD3_GFXManager.OnEndAnimation,false);this.TargetObj=c}var a=c.style;a.webkitTransitionProperty="webkitTransform";this.SetWebKitTiming(a);a.webkitTransform=e+"("+d+"px)"};GFX.prototype.WebKitFormStart=function(){if(this.WillBeWebKit()){var a=this.InFrm?this.Obj.FormBox:this.Obj;var d=null;if(this.ObjOut){d=this.OutFrm?this.ObjOut.FormBox:this.ObjOut}var c=(this.Tipo=="scroll-h")?"translateX":"translateY";var b=(this.Tipo=="scroll-h")?this.ObjW:this.ObjH;if(d){this.WebKitTranslateStart(d,false,c,b)}this.WebKitTranslateStart(a,true,c,0)}};GFX.prototype.WebKitTabStart=function(){if(this.WillBeWebKit()){this.TabFirstTick();this.WebKitTranslateStart(this.ObjOut.ContentBox,false,"translateX",this.ObjW);this.WebKitTranslateStart(this.Obj.ContentBox,true,"translateX",0)}};GFX.prototype.WebKitListStart=function(){if(this.WillBeWebKit()){var b=(this.Flin)?this.Obj.FormBox:this.Obj.ListBox;var a=(this.Flin)?this.Obj.ListBox:this.Obj.FormBox;this.WebKitTranslateStart(a,false,"translateX",this.ObjH);this.WebKitTranslateStart(b,true,"translateX",0)}};GFX.prototype.WebKitBookStart=function(){if(this.WillBeWebKit()){if(this.ObjOut){this.WebKitTranslateStart(this.ObjOut.PageBox,false,"translateX",this.ObjW)}if(this.Obj){this.WebKitTranslateStart(this.Obj.PageBox,true,"translateX",0)}}};GFX.prototype.WebKitModalStart=function(){if(this.WillBeWebKit()){this.IsWebKit=true;this.TargetObj=this.Obj.PopupFrame.PopupBox;this.TargetObj.removeEventListener("webkitTransitionEnd",RD3_GFXManager.OnEndAnimation,false);this.TargetObj.addEventListener("webkitTransitionEnd",RD3_GFXManager.OnEndAnimation,false);var a=this.TargetObj.style;if(this.Flin){a.webkitTransform="scale(0.0) translateX(-"+this.Obj.FormWidth+"px) translateY(-"+this.Obj.FormHeight+"px)"}a.webkitTransitionProperty="webkitTransform opacity";this.SetWebKitTiming(a);if(this.Flin){a.opacity="1";a.webkitTransform="scale(1.0) translateX("+(this.Obj.FormLeft-this.TargetX)+"px) translateY("+(this.Obj.FormTop-this.TargetY)+"px)"}else{a.opacity="0";a.webkitTransform="scale(0.0) translateX("+this.TargetX+"px) translateY("+this.TargetY+"px)"}}};GFX.prototype.WebKitPopupResizeStart=function(){this.IsWebKit=true;this.TargetObj=this.Obj.PopupFrame.PopupBox;this.TargetObj.removeEventListener("webkitTransitionEnd",RD3_GFXManager.OnEndAnimation,false);this.TargetObj.addEventListener("webkitTransitionEnd",RD3_GFXManager.OnEndAnimation,false);var e=this.TargetObj.style;if(this.Flin){e.webkitTransform="scaleX(1.0) scaleY(1.0) translateX(0px) translateY(0px)"}e.webkitTransitionProperty="webkitTransform";this.SetWebKitTiming(e);var d=this.Obj.FormWidth/this.Obj.PopupRect.w;var c=this.Obj.FormHeight/this.Obj.PopupRect.h;var b=this.Obj.FormLeft+this.Obj.FormWidth/2-this.Obj.PopupRect.x-this.Obj.PopupRect.w/2;var a=this.Obj.FormTop+this.Obj.FormHeight/2-this.Obj.PopupRect.y-this.Obj.PopupRect.h/2;b=b/d;a=a/c;e.webkitTransform="scaleX("+d+") scaleY("+c+") translateX("+b+"px) translateY("+a+"px)"};GFX.prototype.WebKitSideBarStart=function(){if(this.WillBeWebKit()){var a=this.ObjEndSize;if(!this.Flin){a=-a}this.WebKitTranslateStart(this.Obj,true,"translateX",a);this.WebKitTranslateStart(RD3_DesktopManager.WebEntryPoint.FormsBox,false,"translateX",a);this.WebKitTranslateStart(RD3_DesktopManager.WebEntryPoint.StatusBarBox,false,"translateX",a);this.WebKitTranslateStart(RD3_DesktopManager.WebEntryPoint.ToolBarBox,false,"translateX",a);if(this.ObjDL){this.WebKitTranslateStart(this.ObjDL,false,"translateX",a)}if(this.ObjDT){this.WebKitTranslateStart(this.ObjDT,false,"translateX",a)}if(this.ObjDB){this.WebKitTranslateStart(this.ObjDB,false,"translateX",a)}}};GFX.prototype.WebKitPreviewStart=function(){if(this.WillBeWebKit()){var a=this.Flin?this.ObjH+2*this.ToolH:-this.ObjH-2*this.ToolH;this.WebKitTranslateStart(this.Obj.PreviewFrame.ContentBox,true,"translateY",a)}};GFX.prototype.ZoneStart=function(){this.Wep=RD3_DesktopManager.WebEntryPoint;if(this.Flin){var a=this.Wep.GetScreenZone(this.ZonePos);a.AdaptDocked();a.AdaptLayout();if(this.Obj){this.Obj.SetActive(true,true);this.Obj.SetVisible(true,false);this.Obj.AdaptLayout()}}if(this.ZonePos==RD3_Glb.FORMDOCK_LEFT){this.ObjD=this.Wep.LeftDockedBox.offsetWidth;this.TotalD=this.Wep.WepBox.clientWidth-((this.Wep.HasSideMenu())?this.Wep.SideMenuBox.offsetWidth:0)-this.Wep.RightDockedBox.offsetWidth}if(this.ZonePos==RD3_Glb.FORMDOCK_TOP){this.ObjD=this.Wep.TopDockedBox.offsetHeight;this.TotalD=this.Wep.WepBox.clientHeight-this.Wep.StatusBarBox.offsetHeight-this.Wep.ToolBarBox.offsetHeight-this.Wep.HeaderBox.offsetHeight-this.Wep.BottomDockedBox.offsetHeight}if(this.ZonePos==RD3_Glb.FORMDOCK_RIGHT){this.ObjD=this.Wep.RightDockedBox.offsetWidth;this.TotalD=this.Wep.WepBox.clientWidth-((this.Wep.HasSideMenu())?this.Wep.SideMenuBox.offsetWidth:0)-this.Wep.LeftDockedBox.offsetWidth}if(this.ZonePos==RD3_Glb.FORMDOCK_BOTTOM){this.ObjD=this.Wep.BottomDockedBox.offsetHeight;this.TotalD=this.Wep.WepBox.clientHeight-this.Wep.StatusBarBox.offsetHeight-this.Wep.ToolBarBox.offsetHeight-this.Wep.HeaderBox.offsetHeight-this.Wep.TopDockedBox.offsetHeight}this.FormsTop=this.Wep.StatusBarBox.offsetHeight+this.Wep.ToolBarBox.offsetHeight+this.Wep.HeaderBox.offsetHeight+(this.ZonePos==RD3_Glb.FORMDOCK_TOP?0:this.Wep.TopDockedBox.offsetHeight);this.FormsLeft=((this.Wep.HasSideMenu())?this.Wep.SideMenuBox.offsetWidth:0);this.Wep.RecalcLayout=false;if(this.Flin){this.Wep.FormsBox.style.left=this.FormsLeft+(this.ZonePos==RD3_Glb.FORMDOCK_LEFT?0:this.Wep.LeftDockedBox.offsetWidth)+"px";this.Wep.FormsBox.style.top=this.FormsTop+"px";this.Wep.LeftDockedBox.style.top=this.FormsTop+"px";this.Wep.RightDockedBox.style.top=this.FormsTop+"px";if(this.ZonePos==RD3_Glb.FORMDOCK_LEFT){this.Wep.LeftDockedBox.style.width="0px";this.Wep.LeftDockedBox.style.top=this.FormsTop+"px";this.Wep.LeftDockedBox.style.left=this.FormsLeft+"px"}if(this.ZonePos==RD3_Glb.FORMDOCK_TOP){this.Wep.TopDockedBox.style.height="0px";this.Wep.TopDockedBox.style.top=this.FormsTop+"px";this.Wep.TopDockedBox.style.left=this.FormsLeft+"px"}if(this.ZonePos==RD3_Glb.FORMDOCK_RIGHT){this.Wep.RightDockedBox.style.width="0px";this.Wep.RightDockedBox.style.top=this.FormsTop+"px";this.Wep.RightDockedBox.style.left=(this.Wep.WepBox.clientWidth)+"px"}if(this.ZonePos==RD3_Glb.FORMDOCK_BOTTOM){this.Wep.BottomDockedBox.style.height="0px";this.Wep.BottomDockedBox.style.top=(this.Wep.WepBox.clientHeight)+"px";this.Wep.BottomDockedBox.style.left=this.FormsLeft+"px"}}};GFX.prototype.ZoneTick=function(b){if(this.Flin){if(this.ZonePos==RD3_Glb.FORMDOCK_LEFT){var a=this.ObjD*b;this.Wep.LeftDockedBox.style.width=a+"px";this.Wep.FormsBox.style.width=(this.TotalD-a)+"px";this.Wep.FormsBox.style.left=(this.FormsLeft+a)+"px";if(this.Tipo=="scroll"){this.Wep.LeftDockedBox.scrollLeft=this.ObjD-a}}if(this.ZonePos==RD3_Glb.FORMDOCK_TOP){var c=this.ObjD*b;this.Wep.TopDockedBox.style.height=c+"px";this.Wep.FormsBox.style.height=(this.TotalD-c)+"px";this.Wep.FormsBox.style.top=(this.FormsTop+c)+"px";this.Wep.LeftDockedBox.style.top=(this.FormsTop+c)+"px";this.Wep.RightDockedBox.style.top=(this.FormsTop+c)+"px";if(this.Tipo=="scroll"){this.Wep.TopDockedBox.scrollTop=this.ObjD-c}}if(this.ZonePos==RD3_Glb.FORMDOCK_RIGHT){var a=this.ObjD*b;this.Wep.RightDockedBox.style.width=a+"px";this.Wep.RightDockedBox.style.left=(this.Wep.WepBox.clientWidth-a)+"px";this.Wep.FormsBox.style.width=(this.TotalD-a)+"px";if(this.Tipo=="scroll"){this.Wep.RightDockedBox.scrollLeft=0}}if(this.ZonePos==RD3_Glb.FORMDOCK_BOTTOM){var c=this.ObjD*b;this.Wep.BottomDockedBox.style.height=c+"px";this.Wep.BottomDockedBox.style.top=(this.Wep.WepBox.clientHeight-c)+"px";this.Wep.FormsBox.style.height=(this.TotalD-c)+"px";this.Wep.LeftDockedBox.style.height=(this.TotalD-c)+"px";this.Wep.RightDockedBox.style.height=(this.TotalD-c)+"px";if(this.Tipo=="scroll"){this.Wep.BottomDockedBox.scrollTop=0}}}else{if(this.ZonePos==RD3_Glb.FORMDOCK_LEFT){var a=this.ObjD*(1-b);this.Wep.LeftDockedBox.style.width=a+"px";this.Wep.FormsBox.style.width=(this.TotalD-a)+"px";this.Wep.FormsBox.style.left=(this.FormsLeft+a)+"px";if(this.Tipo=="scroll"){this.Wep.LeftDockedBox.scrollLeft=this.ObjD-a}}if(this.ZonePos==RD3_Glb.FORMDOCK_TOP){var c=this.ObjD*(1-b);this.Wep.TopDockedBox.style.height=c+"px";this.Wep.FormsBox.style.height=(this.TotalD-c)+"px";this.Wep.FormsBox.style.top=(this.FormsTop+c)+"px";this.Wep.LeftDockedBox.style.top=(this.FormsTop+c)+"px";this.Wep.RightDockedBox.style.top=(this.FormsTop+c)+"px";if(this.Tipo=="scroll"){this.Wep.TopDockedBox.scrollTop=this.ObjD-c}}if(this.ZonePos==RD3_Glb.FORMDOCK_RIGHT){var a=this.ObjD*(1-b);this.Wep.RightDockedBox.style.width=a+"px";this.Wep.RightDockedBox.style.left=(this.Wep.WepBox.clientWidth-a)+"px";this.Wep.FormsBox.style.width=(this.TotalD-a)+"px";if(this.Tipo=="scroll"){this.Wep.RightDockedBox.scrollLeft=0}}if(this.ZonePos==RD3_Glb.FORMDOCK_BOTTOM){var c=this.ObjD*(1-b);this.Wep.BottomDockedBox.style.height=c+"px";this.Wep.BottomDockedBox.style.top=(this.Wep.WepBox.clientHeight-c)+"px";this.Wep.FormsBox.style.height=(this.TotalD-c)+"px";this.Wep.LeftDockedBox.style.height=(this.TotalD-c)+"px";this.Wep.RightDockedBox.style.height=(this.TotalD-c)+"px";if(this.Tipo=="scroll"){this.Wep.BottomDockedBox.scrollTop=0}}}};GFX.prototype.ZoneFinish=function(){if(!this.Wep){this.Wep=RD3_DesktopManager.WebEntryPoint}if(this.Flin){var a=this.Wep.GetScreenZone(this.Obj.DockType);a.AdaptLayout();this.Wep.CmdObj.ActiveFormChanged();this.Wep.IndObj.ActiveFormChanged();this.Wep.TimerObj.ActiveFormChanged();this.Wep.HandleCloseAllVisibility();if(this.Wep.ActiveForm){RD3_DesktopManager.HandleFocus2(this.Wep.ActiveForm.Identifier,0)}this.Wep.AdaptLayout()}else{if(this.CloseFormAnimation){if(this.Obj){this.Obj.Unrealize()}var d=this.Wep.StackForm.length;for(var b=0;b<d;b++){var c=this.Wep.StackForm[b];if(c.Identifier==this.IdxForm){this.Wep.StackForm.splice(b,1);break}}}else{if(this.Obj){this.Obj.SetVisible(false,false)}this.Wep.AdaptLayout()}this.Wep.CmdObj.ActiveFormChanged();this.Wep.IndObj.ActiveFormChanged();this.Wep.TimerObj.ActiveFormChanged()}};GFX.prototype.UnpinnedStart=function(){this.Wep=RD3_DesktopManager.WebEntryPoint;var a=this.Wep.GetScreenZone(this.ZonePos);this.ObjD=a.ZoneSize;this.ObjBaseW=RD3_ClientParams.ZoneUnpinnedSize();if(a.TabVisibility==RD3_Glb.SCRZONE_HIDTAB){this.ObjBaseW=0}this.BaseObjLeft=this.Wep.WepBox.offsetWidth-a.ZoneSize-(this.Wep.MenuType==RD3_Glb.MENUTYPE_RIGHTSB?this.Wep.SideMenuBox.offsetWidth:0)-5;this.BaseObjTop=this.Wep.WepBox.offsetHeight-a.ZoneSize-(this.Wep.MenuType==RD3_Glb.MENUTYPE_TASKBAR?this.Wep.SideMenuBox.offsetHeight:0)-5;if(this.Flin){if(this.ZonePos==RD3_Glb.FORMDOCK_RIGHT||this.ZonePos==RD3_Glb.FORMDOCK_LEFT){this.Obj.style.width=this.ObjD+"px"}if(this.ZonePos==RD3_Glb.FORMDOCK_TOP||this.ZonePos==RD3_Glb.FORMDOCK_BOTTOM){this.Obj.style.height=this.ObjD+"px"}a.TabView.ContentBox.style.visibility="hidden";a.TabView.SetHeight(a.ZoneSize);a.AdaptLayout();this.ObjD=this.ObjD-this.ObjBaseW;if(this.ZonePos==RD3_Glb.FORMDOCK_RIGHT||this.ZonePos==RD3_Glb.FORMDOCK_LEFT){this.Obj.style.width=this.ObjBaseW+"px"}if(this.ZonePos==RD3_Glb.FORMDOCK_TOP||this.ZonePos==RD3_Glb.FORMDOCK_BOTTOM){this.Obj.style.height=this.ObjBaseW+"px"}a.TabView.ContentBox.style.visibility="";if(this.ZonePos==RD3_Glb.FORMDOCK_RIGHT){this.Obj.scrollLeft=this.ObjBaseW+this.ObjD}if(this.ZonePos==RD3_Glb.FORMDOCK_BOTTOM){this.Obj.scrollTop=this.ObjBaseW+this.ObjD}}};GFX.prototype.UnpinnedTick=function(b){var a=this.ObjBaseW+(this.ObjD*b);if(!this.Flin){a=this.ObjBaseW+(this.ObjD*(1-b))}this.Obj.scrollLeft=0;this.Obj.scrollTop=0;if(this.ZonePos==RD3_Glb.FORMDOCK_RIGHT||this.ZonePos==RD3_Glb.FORMDOCK_LEFT){this.Obj.style.width=a+"px";this.Obj.scrollLeft=0;if(this.ZonePos==RD3_Glb.FORMDOCK_RIGHT){this.Obj.style.left=(this.BaseObjLeft+this.ObjBaseW+this.ObjD-a)+"px";this.Obj.scrollLeft=this.ObjBaseW+this.ObjD}}if(this.ZonePos==RD3_Glb.FORMDOCK_TOP||this.ZonePos==RD3_Glb.FORMDOCK_BOTTOM){this.Obj.style.height=a+"px";if(this.ZonePos==RD3_Glb.FORMDOCK_BOTTOM){this.Obj.style.top=(this.BaseObjTop+this.ObjBaseW+this.ObjD-a)+"px";this.Obj.scrollTop=this.ObjBaseW+this.ObjD}}};GFX.prototype.UnpinnedFinish=function(){if(!this.Wep){this.Wep=RD3_DesktopManager.WebEntryPoint}if(!this.Flin){var a=this.Wep.GetScreenZone(this.ZonePos);a.TabView.SetOnlyTabs(true);a.TabView.SetSelectedPage(-1);if(!RD3_DesktopManager.WebEntryPoint.InResponse&&!this.Skipped){RD3_DesktopManager.WebEntryPoint.AdaptLayout()}else{RD3_DesktopManager.WebEntryPoint.RecalcLayout=true}}};function GFXManager(){this.ActiveEffects=new Array();this.StopAnimation=false}GFXManager.prototype.AddEffect=function(b){if(this.StopAnimation){return}var a=this.FinishGFX(b);if(a){b.Durata=0}b.Start();if(!b.IsFinished()){this.ActiveEffects.push(b)}};GFXManager.prototype.Tick=function(){var b=this.ActiveEffects.length;for(var a=0;a<b;a++){this.ActiveEffects[a].Tick()}for(var a=b-1;a>=0;a--){if(this.ActiveEffects[a].IsFinished()){this.ActiveEffects.splice(a,1)}}};GFXManager.prototype.Animating=function(){return this.ActiveEffects.length>0};GFXManager.prototype.WebKitAnimating=function(){var b=this.ActiveEffects.length;for(var a=0;a<b;a++){if(this.ActiveEffects[a].IsWebKit&&this.ActiveEffects[a].Started){return true}}return false};GFXManager.prototype.Blocking=function(){var b=this.ActiveEffects.length;for(var a=0;a<b;a++){if(this.ActiveEffects[a].Blocking){return true}}return false};GFXManager.prototype.FinishGFX=function(b){var c=false;var d=this.ActiveEffects.length;for(var a=0;a<d;a++){c=c||this.ActiveEffects[a].FinishGFX(b)}return c};GFXManager.prototype.FinishAllGFX=function(){var b=this.ActiveEffects.length;for(var a=0;a<b;a++){this.ActiveEffects[a].SetFinished()}};GFXManager.prototype.FinishModalClosing=function(b){var c=this.ActiveEffects.length;for(var a=0;a<c;a++){this.ActiveEffects[a].FinishModalClosing(b)}};GFXManager.prototype.OnEndAnimation=function(b){for(var a=0;a<RD3_GFXManager.ActiveEffects.length;a++){if(RD3_GFXManager.ActiveEffects[a].OnEndAnimation(b)){break}}};function IDScroll(c,a,b,d){this.Identifier=c+":scroll";this.MyBox=a;this.Owner=d;this.Active=false;this.Moving=false;this.CanSwipe=true;this.Swiping=false;this.AllowXScroll=false;this.AllowYScroll=true;this.ScrollInput=RD3_Glb.IsAndroid()?false:true;this.ScrollDirection=-1;this.MarginTop=0;this.MarginBottom=0;this.DisplayScrollbar=true;this.Enabled=true;this.PullTrigger=0;this.Reflecting=0;this.ForceSnap=true;this.PageRange=0;this.mm=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseMove', ev)");this.md=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseDown', ev)");this.mu=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseUp', ev)");this.mo=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseOut', ev)");this.mw=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseWheel', ev)");this.ea=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEndAnimation', ev)");this.ge=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnGestureEnd', ev)");this.MA=new Array();this.CA=new Array();this.TA=new Array();this.Max=new Array();this.Min=new Array();this.Snap=new Array();this.Start=null;this.Att=null;this.End=null;this.Org=null;this.TouchTimes=null;this.TouchPos=null;this.LA=null;this.VA=null;this.MO=null;this.TT=null;this.SetContainer(b);RD3_DesktopManager.ObjectMap.add(this.Identifier,this);this.LastMove=null}IDScroll.prototype.Unrealize=function(){if(this.Scrollbar){for(var a=0;a<2;a++){if(this.Scrollbar[a]){this.Scrollbar[a].parentNode.removeChild(this.Scrollbar[a]);this.Scrollbar[a]=null}}}RD3_DesktopManager.ObjectMap[this.Identifier]=null;RD3_DesktopManager.ObjectMap.remove(this.Identifier);if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.ContainerBox.removeEventListener("touchmove",this.mm,true);this.ContainerBox.removeEventListener("touchstart",this.md,true);this.ContainerBox.removeEventListener("touchend",this.mu,true);this.ContainerBox.removeEventListener("touchcancel",this.mo,true);this.ContainerBox.removeEventListener("gestureend",this.ge,true)}else{this.ContainerBox.removeEventListener("mousemove",this.mm,true);this.ContainerBox.removeEventListener("mousedown",this.md,true);this.ContainerBox.removeEventListener("mouseup",this.mu,true);this.ContainerBox.removeEventListener("mouseout",this.mo,true);this.ContainerBox.removeEventListener("mousewheel",this.mw,true)}if(this.MyBox){RD3_Glb.RemoveEndTransaction(this.MyBox,this.ea,true)}};IDScroll.prototype.SetBox=function(a){if(this.Moving){this.MyNewBox=a}else{this.MyBox=a;this.TA=new Array(-200,-200);this.TouchTimes=null;this.CalcLimits()}};IDScroll.prototype.OnMouseDown=function(w,x){if(RD3_DesktopManager.WebEntryPoint.UseZones()){for(var h=2;h<=5;h++){if(!RD3_DesktopManager.WebEntryPoint.GetScreenZone(h).OnMouseDown(w)){return}}}if(!this.Enabled){return}if(x==undefined){x=false}this.CanSwipe=true;this.Swiping=false;this.Reflecting=0;this.NumMove=0;if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}var l=w.target?w.target:w.srcElement;var k=window.getComputedStyle(this.MyBox);if(k.visibility=="hidden"||k.display=="none"||(w.button!=0&&!RD3_Glb.IsMobile())){return}if(this.Owner&&l==this.Owner.ScrollBoxMobile){return}if(this.Owner&&l==this.Owner.SearchBox){return}if(this.Owner&&l==this.Owner.SwipeButton){return}if(this.Owner&&l==this.Owner.MoreButton){return}if(l.tagName=="CANVAS"){return}if(!this.ScrollInput||this.SkipEvent){if(this.CheckInput(w)){this.SkipEvent=false;return}}if(this.Owner&&this.Owner instanceof WebFrame){var p=RD3_DDManager.GetObject(this.Identifier.substr(0,this.Identifier.length-7));var a=p&&p instanceof IDCombo&&p.SlideForm();var v=a||x;if(!v&&(RD3_Glb.GetParentFrame(l)!=this.Owner)){return}}if(RD3_Glb.CanScroll(l)){if(l.tagName=="TEXTAREA"&&this.ScrollInput){if(window.pageYOffset>0||!RD3_Glb.IsTouch()){return}if(l.scrollHeight>l.offsetHeight){}var i=(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true))?w.targetTouches[0].clientY:w.clientY;var f=Math.floor(parseInt(RD3_Glb.GetStyleProp(l,"height"),10)/3);var g=true;if(l.scrollTop==0&&(i<RD3_Glb.GetScreenTop(l,true)+f)){g=false}if((l.scrollTop+l.offsetHeight>=l.scrollHeight)&&(i>=(RD3_Glb.GetScreenTop(l,true)+f*2))){g=false}if(g){return}}else{return}}if(this.Owner&&this.Owner.WebForm){this.Owner.WebForm.OpenMessageBar(-1)}if(this.Owner&&this.Owner instanceof IDPanel){if(this.Owner.SetSwipe(false)){return}}if(this.AllowXScroll){this.InitScrollbar(0)}if(this.AllowYScroll){this.InitScrollbar(1)}this.Active=true;this.EventSent=false;if(w){if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){if(w.targetTouches.length!=1){this.Active=false;return false}if(RD3_Glb.IsTouch()&&(l.tagName=="INPUT"||l.tagName=="TEXTAREA"||RD3_Glb.isInsideEditor(l))){this.SetInputTimer(true,w)}w.preventDefault();this.Start=new Array(w.targetTouches[0].clientX,w.targetTouches[0].clientY)}else{this.Start=new Array(w.clientX,w.clientY)}var r=l;if(r.tagName==undefined){r=r.parentNode}var n=this.GetObj(r);if(n&&n.OnTouchDown&&!this.Moving){var j=n.OnTouchDown(w,this.ScrollInput);if(!j){this.Active=false;return}this.Clicking=true}var u=RD3_Glb.GetRD3ObjectId(l);var c=RD3_DDManager.GetObject(u);if(c&&((c.IsDraggable&&c.IsDraggable(u))||(c.IsTransformable&&c.IsTransformable(u)))){this.SetDDTimer(true,w)}RD3_Glb.StopEvent(w)}this.Att=this.Start;this.Matrix=RD3_Glb.GetTransform(k).replace(/[^0-9-.,]/g,"").split(",");if(RD3_Glb.IsIE(10,true)){var b=RD3_Glb.GetTransform(this.MyBox.style).replace(/3d/g,"");var q=b.replace(/[^0-9-.,]/g,"").split(",");var e=0;var d=0;try{d=parseInt(q[1]);e=parseInt(q[0]);if(isNaN(d)){d=0}if(isNaN(e)){e=0}}catch(t){}this.Org=new Array(e,d)}else{this.Org=new Array(parseInt(this.Matrix[4]),parseInt(this.Matrix[5]))}RD3_Glb.SetTransitionDuration(this.MyBox,(RD3_Glb.IsAndroid()&&this.Moving)?"1ms":"0ms");RD3_Glb.SetTransitionProperty(this.MyBox,"-webkit-transform");RD3_Glb.SetTransform(this.MyBox,"translate3d("+this.Org[0]+"px,"+this.Org[1]+"px, 0px)");RD3_Glb.RemoveEndTransaction(this.MyBox,this.ea,true);if(this.AllowXScroll&&this.Moving){this.SendPageEvent(w,0,this.Org[0]-2)}this.ScrollDirection=this.AllowXScroll?-1:(this.AllowYScroll?1:-1);if(this.AllowYScroll){this.PositionScrollbar(1);this.HideScrollbar(1)}this.Moving=false;this.LA=null;this.VA=null;this.MO=null;this.TA=new Array();this.CalcLimits();this.TouchTimes=new Array();this.TouchPos=new Array();this.TouchTimes.push(new Date());this.TouchPos.push(this.Att)};IDScroll.prototype.OnMouseMove=function(k,l){if(!this.Active||!this.Enabled){return}if(!l){l=false}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}if(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsTouch()){this.NumMove++;if(this.NumMove%2==1){return}}if(k){if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){if(k.targetTouches.length!=1){this.Active=false;return false}k.preventDefault();this.Att=new Array(k.targetTouches[0].clientX,k.targetTouches[0].clientY)}else{this.Att=new Array(k.clientX,k.clientY)}}var f=this.Moving;var n=k.target?k.target:k.srcElement;var p=Math.abs(this.Att[0]-this.Start[0]);var o=Math.abs(this.Att[1]-this.Start[1]);if(p>4||o>4){if(this.ScrollDirection==-1&&(this.AllowXScroll||this.AllowYScroll)){this.ScrollDirection=(p>o&&this.AllowXScroll)?0:1}}if(p>10||o>10){this.SetDDTimer(false);this.SetInputTimer(false);this.Moving=true;if(!f){this.CanSwipe=(o<=10);var c=this.GetObj(n);if(c&&c.OnTouchUp){c.OnTouchUp(k,false)}if(this.ScrollDirection!=-1){this.ShowScrollbar(this.ScrollDirection)}}}var g=(p>o)?0:1;var e=this.Reflecting==0&&this.Moving&&((g==0&&!this.AllowXScroll)||(g==1&&!this.AllowYScroll));e=e||this.Reflecting==1;if(e){if(this.Owner&&this.Owner instanceof WebFrame){if(this.Reflecting==1){this.Owner.OnReflectMouseMove(k,true)}else{if(this.Reflecting==0){this.Reflecting=this.Owner.OnReflectMouseDown(k,true,g)}}}this.HideScrollbar(0);this.HideScrollbar(1);if(this.Reflecting==1){return}}if(this.ScrollDirection==1&&this.PullTrigger>0&&this.Att[1]>this.Start[1]){var i=o+this.Org[1]*2;if(this.Owner&&this.Owner.OnPullTrigger){this.Owner.OnPullTrigger((this.Org[1]>=0)?(i>this.PullTrigger*2):false,(this.Org[1]>=0)?(i-this.PullTrigger*2):0,false,k)}}if(p>24&&o<10&&this.Moving&&!this.Swiping&&!this.AllowXScroll&&this.CanSwipe){this.Swiping=true;this.HideScrollbar(1);var c=this.GetObj(n);if(c&&c.OnSwipe){c.OnSwipe(k,this.Att[0]>this.Start[0])}}var a=new Array();for(var h=0;h<2;h++){var m=0;if(h==1&&this.Org[h]==this.MarginTop){m=this.MarginTop}a[h]=this.Org[h]+this.Att[h]-this.Start[h];if(h==0&&(!this.AllowXScroll)||this.Swiping){a[h]=this.Org[h]}if(h==1&&(!this.AllowYScroll)||this.Swiping){a[h]=this.Org[h]}if(h!=this.ScrollDirection&&this.ScrollDirection>-1){a[h]=this.Org[h]}if(a[h]<this.Min[h]){a[h]=this.Min[h]-(this.Min[h]-a[h])/2;this.SendEvent(h)}if(a[h]>this.Max[h]+m){a[h]=(this.Max[h]+m)-(this.Max[h]+m-a[h])/2}}this.TA=a;if(RD3_Glb.IsAndroid()){this.MyBox.style.webkitTransitionDuration="0ms"}RD3_Glb.SetTransform(this.MyBox,"translate3d("+a[0]+"px,"+a[1]+"px, 0px)");if(this.ScrollDirection!=-1){this.PositionScrollbar(this.ScrollDirection)}var j=true;var b=new Date();if(RD3_Glb.IsAndroid()){var h=this.TouchTimes.length<2?100:b-this.TouchTimes[this.TouchTimes.length-2];if(h<50){j=false}}if(j){this.TouchTimes.push(b);this.TouchPos.push(this.Att)}else{this.TouchTimes.splice(this.TouchTimes.length-1,1);this.TouchPos.splice(this.TouchPos.length-1,1);this.TouchTimes.push(b);this.TouchPos.push(this.Att)}if(this.TouchTimes.length>3){this.TouchTimes.shift();this.TouchPos.shift()}};IDScroll.prototype.OnMouseUp=function(E,H){if(!this.Active||!this.Enabled){return}if(H==undefined){H=false}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}if(this.Reflecting==1&&this.Owner&&this.Owner instanceof WebFrame){this.Owner.OnReflectMouseUp(E,true)}this.Reflecting=0;this.SetInputTimer(false);this.Active=false;var F=this.ScrollDirection;if(E){var x=E.target?E.target:E.srcElement;if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){if(E.changedTouches.length!=1){this.Active=false;return false}this.End=new Array(E.changedTouches[0].clientX,E.changedTouches[0].clientY)}else{this.End=new Array(E.clientX,E.clientY)}var A=false;if(this.ScrollInput&&this.Clicking&&!this.Moving){if(this.CheckInput(E)){A=true}}var y=this.GetObj(x);if(y.IsEnabled&&!y.IsEnabled()){A=false}if(y&&y.OnTouchUp&&this.Clicking){if(!this.Moving){RD3_KBManager.SurrogateChangeEvent()}var o=y.OnTouchUp(E,!this.Moving&&!A);if(!o){return}}this.SetDDTimer(false);RD3_Glb.StopEvent(E);if(A){x.focus();if(RD3_Glb.IsIE(10,true)){x.selectionStart=x.value.length;x.selectionEnd=x.value.length}return}}this.Clicking=false;if(!RD3_Glb.IsTouch()||RD3_Glb.IsIE(10,true)){RD3_DesktopManager.WebEntryPoint.DisableOnClick++}var p=null;if(this.TA[F]>this.Max[F]){p=this.Max[F]}if(this.TA[F]<this.Min[F]){p=this.Min[F]}if(F==-1||this.Swiping){var e=true;for(var C=0;C<2&&e;C++){if(this.Snap[C]&&E){var z=this.Org[C]%this.Snap[C];if(z){p=this.Org[C]-z;if(-z>this.Snap[C]/2){p-=this.Snap[C]}F=C;e=false}}}if(e){this.Moving=false;return false}}if(p!=null){if(F==1&&this.PullTrigger>0&&p==this.Max[F]&&this.Att[1]>this.Start[1]){var D=Math.abs(this.Att[1]-this.Start[1])+this.Org[1]*2;if(this.Owner&&this.Owner.OnPullTrigger){this.Owner.OnPullTrigger((this.Org[1]>=0)?(D>this.PullTrigger*2):false,(this.Org[1]>=0)?(D-this.PullTrigger*2):0,this.Org[1]>=0,E)}}if(F==1&&p==this.Max[F]&&this.Org[F]==0&&this.Moving){p+=this.MarginTop}RD3_Glb.SetTransitionDuration(this.MyBox,"250ms");RD3_Glb.SetTransform(this.MyBox,"translate3d("+(F==0?p:this.Org[0])+"px,"+(F==1?p:this.Org[1])+"px, 0px)");RD3_Glb.AddEndTransaction(this.MyBox,this.ea,true);this.PositionScrollbar(F);this.Moving=false;this.SendPageEvent(E,F,p-2)}else{var q=this.ForceSnap;var k=(this.TouchTimes?this.TouchTimes.length:0);if(!E||(k>1&&this.Moving)){if(!E||(new Date()-this.TouchTimes[k-1])<100||this.Snap[F]){var m=this.VA;if(!m&&k>1){var r=this.TouchTimes[k-1]-this.TouchTimes[0];var u=this.TouchPos[0][F]-this.TouchPos[k-1][F];m=u/r}if(Math.abs(m)<0.5||(E&&(new Date()-this.TouchTimes[k-1])>=100)){m=0}if(m!=0||this.Snap[F]){if(E){if(m>0){if(m<1){m=1}if(m>10){m=10}}if(m<0){if(m>-1){m=-1}if(m<-10){m=-10}}}q=this.ForceSnap||m!=0;if(m==0&&this.Snap[F]&&this.ForceSnap){var s=this.Snap[F]/400;if(s>2){s=2}var G=this.TA[F]-this.Org[F];if(G>0){m=(G/this.Snap[F]>0.5)?s:-s}if(G<0){m=(G/this.Snap[F]<-0.5)?-s:s}q=false}m=m*2;var c=Math.abs(m);var a=c/2;var w=m*100*a;var b=0.5*50*a*a;if(w<0){b=-b}var n=this.TA[F]-(w-b);if(this.Snap[F]){var I=Math.round(-this.Org[F]/this.Snap[F]);var h=Math.floor(-n/this.Snap[F]);if(w<0){h=Math.ceil(-n/this.Snap[F])}if(q){if(h==I&&m>1){h++}else{if(h==I&&m<-1){h--}}}var j=Math.floor(this.MA[F]/this.Snap[F]);if(h>=j){h=j-1}if(this.PageRange){if(h>I&&h-I>this.PageRange){h=I+this.PageRange}if(h<I&&I-h>this.PageRange){h=I-this.PageRange}}if(this.ForceSnap||m!=0){n=-h*this.Snap[F]}var f=0.25*Math.abs(h-I);if(f==0){f=0.25}if(a>f){a=f}}var g=false;this.LA=null;var l=this.CA[F]/8;if(n>this.Max[F]){if(n>this.Max[F]+l){n=this.Max[F];this.LA=this.Max[F]+l;g=true}}if(n<this.Min[F]){this.SendEvent(F);if(n<this.Min[F]-l){n=this.Min[F];this.LA=this.Min[F]-l;g=true}}this.MO=null;if((g?this.LA:n)>this.Max[F]){this.MO=this.Max[F]}if((g?this.LA:n)<this.Min[F]){this.MO=this.Min[F]}this.TT=150;if(g){a=Math.abs(n-this.TA[F])/(c*100);this.TT=Math.ceil(l*1000/c/100*2);if(this.TT>150){var B=l*150/this.TT;this.TT=150;if(this.MO<this.LA){this.LA=this.MO+B}else{this.LA=this.MO-B}}}if(a==0){this.HideScrollbar(F)}RD3_Glb.SetTransitionTimingFunction(this.MyBox,(g)?"linear":"ease-out");RD3_Glb.SetTransitionDuration(this.MyBox,(a*1000)+"ms");RD3_Glb.SetTransform(this.MyBox,"translate3d(0px, 0px, 0px)");RD3_Glb.SetTransform(this.MyBox,"translate3d("+(F==0?n:this.Org[0])+"px,"+(F==1?n:this.Org[1])+"px, 0px)");this.PositionScrollbar(F);RD3_Glb.AddEndTransaction(this.MyBox,this.ea,true);this.SendPageEvent(E,F,n);if(isNaN(a)){this.Moving=false}}else{this.HideScrollbar(F);this.Moving=false}}else{this.HideScrollbar(F);this.Moving=false}}}};IDScroll.prototype.OnMouseOut=function(b){if(!this.Active||!this.Enabled){return}var a=b.relatedTarget;if(RD3_Glb.IsIE(10,true)){a=b.toElement;if(a==null||a.className=="ctrl-date-selector"){return}}while(a){a=a.parentNode;if(a==this.ContainerBox){return}}this.OnMouseUp(b)};IDScroll.prototype.OnEndAnimation=function(a){var b=this.ScrollDirection;if(this.LA!=null){RD3_Glb.SetTransitionTimingFunction(this.MyBox,"ease-out");RD3_Glb.SetTransitionDuration(this.MyBox,this.TT+"ms");RD3_Glb.SetTransform(this.MyBox,"translate3d("+(b==0?this.LA:this.Org[0])+"px,"+(b==1?this.LA:this.Org[1])+"px, 0px)");this.PositionScrollbar(b);this.LA=null}else{if(this.MO!=null){RD3_Glb.SetTransitionTimingFunction(this.MyBox,"ease-out");RD3_Glb.SetTransitionDuration(this.MyBox,this.TT+"ms");RD3_Glb.SetTransform(this.MyBox,"translate3d("+(b==0?this.MO:this.Org[0])+"px,"+(b==1?this.MO:this.Org[1])+"px, 0px)");this.PositionScrollbar(b);this.MO=null}else{this.TT=null;this.VA=null;this.Moving=false;RD3_Glb.RemoveEndTransaction(this.MyBox,this.ea,true);this.HideScrollbar(b);if(this.MyNewBox){this.SetBox(this.MyNewBox);this.MyNewBox=null}if(this.Owner&&this.Owner.OnEndScroll){this.Owner.OnEndScroll(b)}}}};IDScroll.prototype.OnMouseWheel=function(g){if(!this.Enabled||!this.AllowYScroll){return}var i=window.getComputedStyle(this.MyBox);if(i.visibility=="hidden"||i.display=="none"){return}var h=g.target?g.target:g.srcElement;var c=h;while(c){if(c==this.MyBox){break}if(c.className=="form-container"){return}c=c.parentNode}if(RD3_Glb.CanScroll(h)){return}this.Matrix=RD3_Glb.GetTransform(i).replace(/[^0-9-.,]/g,"").split(",");if(RD3_Glb.IsIE(10,true)){var f=RD3_Glb.GetTransform(this.MyBox.style).replace(/3d/g,"");var d=f.replace(/[^0-9-.,]/g,"").split(",");var b=0;var a=0;try{a=parseInt(d[1]);b=parseInt(d[0]);if(isNaN(a)){a=0}if(isNaN(b)){b=0}}catch(e){}this.Org=new Array(b,a)}else{this.Org=new Array(parseInt(this.Matrix[4]),parseInt(this.Matrix[5]))}this.TA=this.Org;this.CalcLimits();this.ScrollDirection=1;if(g.wheelDelta<0){if(this.VA<0||!this.VA){this.InitScrollbar(1);this.ShowScrollbar(1);this.VA=1}else{this.VA++}}else{if(this.VA>0||!this.VA){this.InitScrollbar(1);this.ShowScrollbar(1);this.VA=-1}else{this.VA--}}RD3_Glb.StopEvent(g);this.Active=true;this.Moving=true;this.EventSent=false;this.OnMouseUp()};IDScroll.prototype.InitScrollbar=function(b){this.CreateScrollObj(b);if(this.DisplayScrollbar){this.UseScrollbar[b]=this.MA[b]>this.CA[b]}if(this.UseScrollbar[b]){var a=this.CA[b]/this.MA[b]*this.CA[b];if(b==0){this.Scrollbar[b].style.width=a+"px"}else{this.Scrollbar[b].style.height=a+"px"}}else{this.Scrollbar[b].style.opacity=0}};IDScroll.prototype.CreateScrollObj=function(a){if(!this.Scrollbar){this.Scrollbar=new Array(2);this.UseScrollbar=new Array(2)}if(!this.Scrollbar[a]){this.Scrollbar[a]=document.createElement("div");this.Scrollbar[a].className="touch-scrollbar-"+a;this.ContainerBox.appendChild(this.Scrollbar[a]);RD3_Glb.SetTransitionProperty(this.Scrollbar[a],"-webkit-transform, opacity")}};IDScroll.prototype.ShowScrollbar=function(a){if(!this.UseScrollbar[a]){return}RD3_Glb.SetTransitionDuration(this.Scrollbar[a],"0ms");this.Scrollbar[a].style.opacity=1};IDScroll.prototype.PositionScrollbar=function(e){if(!this.UseScrollbar[e]){return}var c=RD3_Glb.GetTransform(this.MyBox).substr(11).replace(/[^0-9-.,]/g,"").split(",");var a=new Array(parseInt(c[0]),parseInt(c[1]));var b=-a[e]/this.MA[e]*this.CA[e];RD3_Glb.SetTransitionDuration(this.Scrollbar[e],RD3_Glb.GetTransitionDuration(this.MyBox));RD3_Glb.SetTransitionTimingFunction(this.Scrollbar[e],RD3_Glb.GetTransitionTimingFunction(this.MyBox));RD3_Glb.SetTransform(this.Scrollbar[e],"translate3d("+(e==0?b:0)+"px,"+(e==1?b:0)+"px, 0px)");if(this.Owner&&this.Owner instanceof Book&&this.Owner.OnScroll){this.Owner.OnScroll({target:a,time:RD3_Glb.GetTransitionDuration(this.MyBox),funct:RD3_Glb.GetTransitionTimingFunction(this.MyBox)})}};IDScroll.prototype.HideScrollbar=function(a){if(!this.UseScrollbar||!this.UseScrollbar[a]){return}if(this.Scrollbar&&this.Scrollbar[a]){RD3_Glb.SetTransitionDuration(this.Scrollbar[a],"330ms");this.Scrollbar[a].style.opacity=0}};IDScroll.prototype.GetObj=function(a){if(a){return RD3_KBManager.GetObject(a,true)}else{return null}};IDScroll.prototype.SendEvent=function(a){if(this.Owner&&!this.EventSent){this.EventSent=true;if(this.Owner.OnScrollBottom){this.Owner.OnScrollBottom(a)}}};IDScroll.prototype.SendPageEvent=function(c,e,f){if(this.Owner&&this.Owner.OnScrollToPage&&this.Snap[e]){var a=Math.round(-f/this.Snap[e])+1;var b=Math.round(this.MA[e]/this.Snap[e]);if(a>b){a=b}this.Owner.OnScrollToPage(c,e,a,this)}};IDScroll.prototype.ChangeSize=function(d){var g=this.CalcLimits();if((g||d)&&this.Enabled){if(!this.TouchTimes){this.TouchTimes=new Array();this.TouchPos=new Array()}this.LA=null;this.MO=null;this.TT=null;this.Active=true;this.Moving=true;this.EventSent=false;var i=window.getComputedStyle(this.MyBox);this.Matrix=RD3_Glb.GetTransform(i).replace(/[^0-9-.,]/g,"").split(",");if(RD3_Glb.IsIE(10,true)){var f=RD3_Glb.GetTransform(this.MyBox.style).replace(/3d/g,"");var c=f.replace(/[^0-9-.,]/g,"").split(",");var b=0;var a=0;try{a=parseInt(c[1]);b=parseInt(c[0]);if(isNaN(a)){a=0}if(isNaN(b)){b=0}}catch(e){}this.Org=new Array(b,a)}else{this.Org=new Array(parseInt(this.Matrix[4]),parseInt(this.Matrix[5]))}this.TA=this.Org;if(this.ScrollDirection==1&&RD3_Glb.IsSmartPhone()&&RD3_Glb.IsAndroid()){var h=null;if(this.TA[1]>this.Max[1]){h=this.Max[1]}if(this.TA[1]<this.Min[1]){h=this.Min[1]}if(h==this.Max[1]&&this.Org[1]==this.MarginTop&&this.Moving){this.Org[1]=0}}this.OnMouseUp()}};IDScroll.prototype.CalcLimits=function(){if(!this.MyBox){return false}var b=false;var e=new Array(this.MyBox.offsetWidth,this.MyBox.offsetHeight+this.MarginBottom);var a=new Array(this.ContainerBox.offsetWidth,this.ContainerBox.offsetHeight);for(var c=0;c<2;c++){if(e[c]!=this.MA[c]||a[c]!=this.CA[c]){if(e[c]<a[c]){this.Min[c]=0;this.Max[c]=0}else{this.Min[c]=-(e[c]-a[c]+1);this.Max[c]=0}b=true}}this.MA=e;this.CA=a;return b};IDScroll.prototype.GoTop=function(){this.VA=-60;this.Active=true;this.Moving=true;var e=window.getComputedStyle(this.MyBox);this.Matrix=RD3_Glb.GetTransform(e).replace(/[^0-9-.,]/g,"").split(",");if(RD3_Glb.IsIE(10,true)){var f=RD3_Glb.GetTransform(this.MyBox.style).replace(/3d/g,"");var a=f.replace(/[^0-9-.,]/g,"").split(",");var d=0;var c=0;try{c=parseInt(a[1]);d=parseInt(a[0]);if(isNaN(c)){c=0}if(isNaN(d)){d=0}}catch(b){}this.Org=new Array(d,c)}else{this.Org=new Array(parseInt(this.Matrix[4]),parseInt(this.Matrix[5]))}this.TA=this.Org;this.OnMouseUp()};IDScroll.prototype.SetContainer=function(a){this.ContainerBox=a;if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){a.addEventListener("touchmove",this.mm,true);a.addEventListener("touchstart",this.md,true);a.addEventListener("touchend",this.mu,true);a.addEventListener("touchcancel",this.mo,true);a.addEventListener("gestureend",this.ge,true)}else{a.addEventListener("mousemove",this.mm,true);a.addEventListener("mousedown",this.md,true);a.addEventListener("mouseup",this.mu,true);a.addEventListener("mouseout",this.mo,true);a.addEventListener("mousewheel",this.mw,true)}};IDScroll.prototype.SetSnap=function(c,a,d,b){this.Snap[0]=c;this.Snap[1]=a;if(typeof d!="undefined"){this.ForceSnap=d}if(typeof b!="undefined"){this.PageRange=b}};IDScroll.prototype.SetPage=function(g,e){var d=RD3_Glb.TranslateX(this.MyBox);var b=RD3_Glb.TranslateY(this.MyBox);var a=d;var f=b;var c=false;if(g>0&&this.Snap[0]){a=-(g-1)*this.Snap[0];if(a!=d){c=true}}if(e>0&&this.Snap[1]){f=-(e-1)*this.Snap[1];if(f!=b){c=true}}if(c){RD3_Glb.SetTransitionTimingFunction(this.MyBox,"ease-out");RD3_Glb.SetTransitionDuration(this.MyBox,"250ms");RD3_Glb.SetTransform(this.MyBox,"translate3d("+(a)+"px,"+(f)+"px, 0px)");this.HideScrollbar(0);this.HideScrollbar(1)}};IDScroll.prototype.OnGestureEnd=function(a){if(a.scale<0.4){RD3_DesktopManager.WebEntryPoint.OnCloseApp(a)}};IDScroll.prototype.OnDDTimer=function(a){this.DDTimer=null;this.Active=false;this.Clicking=false;RD3_DDManager.OnMouseDown(this.DDEvent)};IDScroll.prototype.SetDDTimer=function(a,c){if(this.DDTimer){window.clearTimeout(this.DDTimer)}this.DDTimer=null;this.DDEvent=null;if(a){var b=(this.AllowXScroll||this.AllowYScroll)?300:15;this.DDTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnDDTimer')",b);if(RD3_Glb.IsIE(10,true)){var d=new Object();d.clientX=c.clientX;d.clientY=c.clientY;d.button=c.button;d.explicitOriginalTarget=c.srcElement;d.srcElement=c.srcElement;d.target=c.srcElement;c=d}this.DDEvent=c}};IDScroll.prototype.CheckInput=function(c){var a=this.ScrollInput||RD3_Glb.IsTouch();var d=c.target?c.target:c.srcElement;if(a&&d.tagName=="INPUT"){var b=this.GetObj(d);if(b&&b instanceof PValue){if(b.ParentField.UsePopupControl()){a=false}}if(b&&b instanceof BookSpan){if(b.UsePopupControl()){a=false}}}if(((d.tagName=="INPUT"&&d.type!="button")||d.tagName=="TEXTAREA"||RD3_Glb.isInsideEditor(d))&&a){return true}};IDScroll.prototype.OnInputTimer=function(a){if(!RD3_Glb.IsTouch()){return}this.InputTimer=null;var b=this.InputEvent.target;var e=this.InputEvent.changedTouches[0].clientX;var d=this.InputEvent.changedTouches[0].clientY;var c=document.createEvent("MouseEvents");c.initEvent("mousedown",true,true,window,1,e,d,e,d);b.dispatchEvent(c);this.SkipEvent=true};IDScroll.prototype.SetInputTimer=function(a,b){if(this.InputTimer){window.clearTimeout(this.InputTimer)}this.InputTimer=null;this.InputEvent=null;if(a){this.InputTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnInputTimer')",300);this.InputEvent=b}};IDScroll.prototype.SetDisableTimer=function(a){this.Enabled=false;if(this.DisableTimer){window.clearTimeout(this.DisableTimer)}this.DisableTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnDisableTimer')",a)};IDScroll.prototype.OnDisableTimer=function(a){this.Enabled=true};IDScroll.prototype.ResetSpeedData=function(){this.TouchTimes=new Array()};function ATimer(){this.IdxForm=0;this.NumTicks=0;this.Interval=0;this.Enabled=false;this.Identifier="";this.Ticks=0;this.TickEventDef=RD3_Glb.EVENT_ACTIVE;this.Realized=false;this.MyTimer=null}ATimer.prototype.LoadFromXml=function(a){this.LoadProperties(a)};ATimer.prototype.ChangeProperties=function(a){this.LoadProperties(a)};ATimer.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"frm":this.SetFormIndex(parseInt(f.nodeValue));break;case"num":this.SetNumTicks(parseInt(f.nodeValue));break;case"int":this.SetInterval(parseInt(f.nodeValue));break;case"ena":this.SetEnabled(f.nodeValue=="1");break;case"tke":this.TickEventDef=parseInt(f.nodeValue);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};ATimer.prototype.SetFormIndex=function(a){this.IdxForm=a};ATimer.prototype.SetNumTicks=function(a){if(a!=undefined){this.NumTicks=a}if(this.Realized&&this.Enabled){if(this.NumTicks>0&&this.Ticks>=this.NumTicks){this.SetEnabled(false)}}};ATimer.prototype.SetInterval=function(a){if(a!=undefined){this.Interval=a}if(this.Realized&&this.Enabled){window.clearInterval(this.MyTimer);this.MyTimer=window.setInterval(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TimerTick', ev)"),this.Interval)}};ATimer.prototype.SetEnabled=function(a){if(a!=undefined){this.Enabled=a}if(this.Realized){if(this.Enabled&&this.CanEnable()){window.clearInterval(this.MyTimer);this.MyTimer=window.setInterval(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TimerTick', ev)"),this.Interval)}else{this.TimerDisable()}}};ATimer.prototype.Realize=function(){this.Realized=true;this.SetEnabled()};ATimer.prototype.Unrealize=function(){this.SetEnabled(false);this.Realized=false;RD3_DesktopManager.ObjectMap.remove(this.Identifier)};ATimer.prototype.TimerTick=function(){this.Ticks++;var a=new IDEvent("timer",this.Identifier,null,this.TickEventDef);if(this.NumTicks>0&&this.Ticks>=this.NumTicks){this.SetEnabled(false)}};ATimer.prototype.CanEnable=function(){var b=this.Enabled;if(b){if(this.IdxForm!=0){var c="frm:"+this.IdxForm;var a=RD3_DesktopManager.ObjectMap[c];if(!a){b=false}}}return b};ATimer.prototype.TimerDisable=function(){if(this.MyTimer){window.clearInterval(this.MyTimer)}this.MyTimer=null;this.Ticks=0};ATimer.prototype.ActiveFormChanged=function(){this.SetEnabled()};ATimer.prototype.FormClosed=function(a){if(a.IdxForm==this.IdxForm){this.SetEnabled()}};function Book(a){WebFrame.call(this,a);this.SelectedPage=0;this.TotalPages=0;this.TotalPagesConfirmed=false;this.HideBorder=false;this.WantDragHL=false;this.WantDropRestore=true;this.EnabledCommands=-5;this.CacheSize=1;this.FixedWidth=0;this.FixedHeight=0;this.ScrollOrientation=0;this.SnapToPage=true;this.OptimizeDOM=false;this.Pages=new Array();this.PlaceHolders=new Array();this.MobilePageContainer=null;this.RefreshMobileContainer=true;this.ForceSetPage=false;this.AnimatingNum=null;this.ActivePage=0;this.Fx=null;this.ToolbarEventDef=RD3_Glb.EVENT_ACTIVE;this.StatusBarTxt=null;this.ToolbarNav=null;this.NextImg=null;this.PrevImg=null;this.BeginImg=null;this.EndImg=null;this.PrintImg=null;this.ExportImg=null;this.ToolbarSeparator1=null;this.ToolbarSeparator2=null}Book.prototype=new WebFrame();Book.prototype.LoadFromXml=function(e){WebFrame.prototype.LoadFromXml.call(this,e);var c=e.childNodes;var g=c.length;for(var d=0;d<g;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"pag":var f=new BookPage(this);f.LoadFromXml(b);break}}};Book.prototype.LoadProperties=function(e){WebFrame.prototype.LoadProperties.call(this,e);var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"pag":this.SetSelectedPage(parseInt(a));break;case"ptt":this.SetTotalPages(parseInt(a));break;case"pcf":this.SetTotalPagesConfirmed(a=="1");break;case"hib":this.SetHideBorder(a=="1");break;case"enc":this.SetEnabledCommands(parseInt(a));break;case"dgp":this.DeletePage(parseInt(a));break;case"csz":this.SetCacheSize(parseInt(a));break;case"fiw":this.SetFixedWidth(parseInt(a));break;case"fih":this.SetFixedHeight(parseInt(a));break;case"scd":this.SetScrollDir(parseInt(a));break;case"fsn":this.SetForceSnap(a=="1");break;case"opt":this.SetOptimizeDOM(a=="1");break;case"tck":this.ToolbarEventDef=parseInt(a);break;case"cpa":this.ChangePageAnimDef=a;break}}};Book.prototype.ChangeProperties=function(d){var b=d.childNodes;var c=RD3_Glb.HasNode(d,"pag");if(b.length>0&&c){this.LoadFromXml(d);var a=false;if(RD3_Glb.IsFirefox(3)&&this.Realized&&this.ContentBox.style.display!="none"){this.ContentBox.style.display="none";a=true}if(this.Realized){this.Realize(null)}this.SetSelectedPage(this.SelectedPage);this.SetCaption();if(a&&this.Realized){this.ContentBox.style.display=""}}else{this.LoadProperties(d)}};Book.prototype.SetSelectedPage=function(f){var a=this.SelectedPage;if(f!=undefined){this.SelectedPage=f}if(this.Realized){var d=null;var e=null;if(a!=this.SelectedPage){this.RefreshMobileContainer=true;this.ForceSetPage=true}if(!RD3_Glb.IsMobile()){var h=this.Pages.length;for(var c=0;c<h;c++){var g=this.Pages[c];if(g){if(g.Number==this.SelectedPage){e=g;if(g.Number==this.ActivePage){d=g}}else{if(g.Number==this.ActivePage){d=g}else{g.SetActive(false)}}}}if(d!=e&&e){var b=true;if(d){b=(d.Number>=e.Number)}if(!this.AnimatingNum||this.AnimatingNum!=e.Number){this.Fx=new GFX("book",b,e,f==undefined,d,this.ChangePageAnimDef);RD3_GFXManager.AddEffect(this.Fx);if(this.Fx){this.AnimatingNum=e.Number}}}else{if(this.SelectedPage==0&&d){if(!this.AnimatingNum||this.AnimatingNum!=0){this.Fx=new GFX("book",true,null,f==undefined,d,this.ChangePageAnimDef);RD3_GFXManager.AddEffect(this.Fx);if(this.Fx){this.AnimatingNum=0}}}}}}};Book.prototype.SetTotalPages=function(b){var a=this.TotalPages;if(b!=undefined){this.TotalPages=b}if(this.Realized){if(a!=this.TotalPages&&b!=undefined){this.RefreshMobileContainer=true}this.SetCaption()}};Book.prototype.SetTotalPagesConfirmed=function(b){var a=this.TotalPagesConfirmed;if(b!=undefined){this.TotalPagesConfirmed=b}if(this.Realized){if(a!=this.TotalPagesConfirmed&&b!=undefined){this.RefreshMobileContainer=true}this.SetCaption()}};Book.prototype.SetScrollDir=function(b){var a=this.ScrollOrientation;if(b!=undefined){this.ScrollOrientation=b}if(this.Realized){if(a!=this.ScrollOrientation&&b!=undefined){this.RefreshMobileContainer=true}}};Book.prototype.SetForceSnap=function(b){var a=this.SnapToPage;if(b!=undefined){this.SnapToPage=b}if(this.Realized){if(a!=this.SnapToPage&&b!=undefined){this.RefreshMobileContainer=true}}};Book.prototype.SetOptimizeDOM=function(b){var a=this.OptimizeDOM;if(b!=undefined){this.OptimizeDOM=b}if(this.Realized){if(a!=this.OptimizeDOM&&b!=undefined){this.RefreshMobileContainer=true}}};Book.prototype.SetHideBorder=function(a){if(a!=undefined){this.HideBorder=a;if(this.Realized){this.ContentBox.className="book-container"+(this.HideBorder?"-noborder":"")}}};Book.prototype.SetEnabledCommands=function(a){if(a!=undefined){this.EnabledCommands=a}if(this.Realized){this.UpdateToolbar()}};Book.prototype.SetCacheSize=function(a){if(a!=undefined){this.CacheSize=a}};Book.prototype.SetFixedWidth=function(b){var a=this.FixedWidth;if(b!=undefined){this.FixedWidth=b}if(a!=this.FixedWidth){this.UpdateFixed=true}};Book.prototype.SetFixedHeight=function(b){var a=this.FixedHeight;if(b!=undefined){this.FixedHeight=b}if(a!=this.FixedHeight){this.UpdateFixed=true}};Book.prototype.DeletePage=function(a){var b=this.Pages[a];if(b){b.Unrealize()}};Book.prototype.Realize=function(c){var a=this.Realized;if(!this.Realized){WebFrame.prototype.Realize.call(this,c)}this.ContentBox.className="book-container"+(this.HideBorder?"-noborder":"");if(!a){this.UpdateMobileContainer()}var d=this.Pages.length;for(var b=0;b<d;b++){if(this.Pages[b]){this.Pages[b].Realize(this.MobilePageContainer?this.MobilePageContainer:this.ContentBox);if(!a){this.Pages[b].SetActive(this.Pages[b].Number==this.SelectedPage)}}}this.UpdateToolbar();this.UpdateFixedZones()};Book.prototype.AdaptLayout=function(){if(!this.Realized){return}var b=this.ContentBox.style.overflow;this.ContentBox.style.overflow="hidden";WebFrame.prototype.AdaptLayout.call(this);var c=this.Pages.length;for(var a=0;a<c;a++){if(this.Pages[a]){this.Pages[a].AdaptLayout()}}this.ContentBox.style.overflow=b;this.RefreshMobileContainer=true};Book.prototype.AfterProcessResponse=function(){WebFrame.prototype.AfterProcessResponse.call(this);var b=this.Pages.length;for(var a=0;a<b;a++){if(this.Pages[a]){this.Pages[a].AfterProcessResponse()}}if(this.RefreshMobileContainer){this.UpdateMobileContainer();if(this.RecalcLayout){this.RecalcLayout=false;this.AdaptLayout();this.RefreshMobileContainer=false}}if(this.UpdateFixed){this.UpdateFixed=false;this.UpdateFixedZones()}};Book.prototype.RealizeToolbar=function(){WebFrame.prototype.RealizeToolbar.call(this);this.StatusBarTxt=document.createElement("span");this.ToolbarNav=document.createElement("span");this.NextImg=document.createElement("img");this.PrevImg=document.createElement("img");this.BeginImg=document.createElement("img");this.EndImg=document.createElement("img");this.PrintImg=document.createElement("img");this.ExportImg=document.createElement("img");this.ToolbarSeparator1=document.createElement("span");this.ToolbarSeparator2=document.createElement("span");this.BeginImg.setAttribute("id",this.Identifier+":top");this.PrevImg.setAttribute("id",this.Identifier+":next");this.NextImg.setAttribute("id",this.Identifier+":prev");this.EndImg.setAttribute("id",this.Identifier+":bottom");this.ExportImg.setAttribute("id",this.Identifier+":print");this.StatusBarTxt.className=(this.SmallIcons)?"book-toolbarsmall-status":"book-toolbar-status";this.NextImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.PrevImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.BeginImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.EndImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.PrintImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.ExportImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.ToolbarSeparator1.className="book-toolbar-sep";this.ToolbarSeparator2.className="book-toolbar-sep";RD3_TooltipManager.SetObjTitle(this.NextImg,RD3_ServerParams.BookPaginaSucc);RD3_TooltipManager.SetObjTitle(this.PrevImg,RD3_ServerParams.BookPaginaPrec);RD3_TooltipManager.SetObjTitle(this.BeginImg,RD3_ServerParams.BookInizio);RD3_TooltipManager.SetObjTitle(this.EndImg,RD3_ServerParams.BookFine);RD3_TooltipManager.SetObjTitle(this.PrintImg,RD3_ServerParams.CreatePDF);RD3_TooltipManager.SetObjTitle(this.ExportImg,RD3_ServerParams.TooltipExport);this.NextImg.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'next')");this.PrevImg.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'prev')");this.BeginImg.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'top')");this.EndImg.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'bottom')");this.PrintImg.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'print')");this.ExportImg.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'csv')");this.NextImg.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.NextImg.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.NextImg.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.NextImg.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.PrevImg.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.PrevImg.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.PrevImg.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.PrevImg.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.BeginImg.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.BeginImg.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.BeginImg.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.BeginImg.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.EndImg.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.EndImg.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.EndImg.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.EndImg.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.PrintImg.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.PrintImg.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.PrintImg.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.PrintImg.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.ExportImg.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.ExportImg.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.ExportImg.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.ExportImg.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.ToolbarBox.appendChild(this.StatusBarTxt);this.ToolbarBox.appendChild(this.ToolbarSeparator1);this.ToolbarBox.appendChild(this.ToolbarNav);this.ToolbarNav.appendChild(this.BeginImg);this.ToolbarNav.appendChild(this.PrevImg);this.ToolbarNav.appendChild(this.NextImg);this.ToolbarNav.appendChild(this.EndImg);this.ToolbarBox.appendChild(this.ToolbarSeparator2);this.ToolbarBox.appendChild(this.PrintImg);this.ToolbarBox.appendChild(this.ExportImg)};Book.prototype.SetSmallIcon=function(b){if(b!=undefined){this.SmallIcons=b}if(this.Realized){if(!this.ChildBox1&&!this.ChildBox2){var a=(this.SmallIcons?"_sm":"");this.CollapseButton.className="frame-toolbar-button"+((this.SmallIcons)?"-small":"")+" frame-collapse-button";this.ToolbarBox.className=(this.SmallIcons)?"frame-toolbarsmall-container":"frame-toolbar-container";this.StatusBarTxt.className=(this.SmallIcons)?"book-toolbarsmall-status":"book-toolbar-status";this.NextImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.PrevImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.BeginImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.EndImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.PrintImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");this.ExportImg.className="book-toolbar-button"+((this.SmallIcons)?"-small":"");if(!RD3_Glb.IsMobile()){if(this.Collapsed){this.CollapseButton.src=RD3_Glb.GetImgSrc("images/expand"+a+".gif");RD3_TooltipManager.SetObjTitle(this.CollapseButton,RD3_ServerParams.MostraRiquadro)}else{this.CollapseButton.src=RD3_Glb.GetImgSrc("images/collapse"+a+".gif");RD3_TooltipManager.SetObjTitle(this.CollapseButton,RD3_ServerParams.NascondiRiquadro)}this.NextImg.src=RD3_Glb.GetImgSrc("images/next"+a+".gif");this.PrevImg.src=RD3_Glb.GetImgSrc("images/prev"+a+".gif");this.BeginImg.src=RD3_Glb.GetImgSrc("images/top"+a+".gif");this.EndImg.src=RD3_Glb.GetImgSrc("images/bottom"+a+".gif");this.PrintImg.src=RD3_Glb.GetImgSrc("images/print"+a+".gif");this.ExportImg.src=RD3_Glb.GetImgSrc("images/csv"+a+".gif")}else{this.ToolbarNav.style.display="none";this.NextImg.style.display="none";this.PrevImg.style.display="none";this.BeginImg.style.display="none";this.EndImg.style.display="none";this.PrintImg.style.display="none";this.ExportImg.style.display="none"}}}};Book.prototype.SetCaption=function(b){if(b!=undefined){this.Caption=b}if(this.Realized&&!this.OnlyContent){var a=RD3_Glb.FormatMessage(RD3_ServerParams.PaginaNM,this.SelectedPage,this.TotalPages)+(this.TotalPagesConfirmed?"":"+");this.CaptionTxt.innerHTML=this.Caption;this.StatusBarTxt.innerHTML=(this.Caption!=""&&this.Caption!=" "?": ":"")+a;if(this.ToolbarBox.scrollLeft&&this.TBScrollTimer==0&&!RD3_Glb.IsTouch()){this.ScrollToolbar(-1)}if(RD3_Glb.IsMobile()){RD3_Glb.AdjustCaptionPosition(this.ToolbarBox,this.CaptionTxt);if(this.ShowStatusBar){this.CaptionTxt.style.width=""}}}};Book.prototype.SetCollapsed=function(b,a){WebFrame.prototype.SetCollapsed.call(this,b)};Book.prototype.SetShowToolbar=function(a){WebFrame.prototype.SetShowToolbar.call(this,a);if(this.Realized){this.UpdateToolbar()}};Book.prototype.SetShowStatusBar=function(b){WebFrame.prototype.SetShowStatusBar.call(this,b);if(this.Realized){var a=!this.Collapsed&&this.ShowStatusBar;this.StatusBarTxt.style.display=a?"":"none"}};Book.prototype.UpdateToolbar=function(){if(!RD3_Glb.IsMobile()){this.ToolbarNav.style.display=this.IsCommandEnabled(RD3_Glb.BCM_NAVIGATION)?"":"none";this.PrintImg.style.display=this.IsCommandEnabled(RD3_Glb.BCM_PRINT)?"":"none";this.ExportImg.style.display=this.IsCommandEnabled(RD3_Glb.BCM_CSV)?"":"none"}this.AdaptScrollBox()};Book.prototype.IsCommandEnabled=function(a){return(this.EnabledCommands&a)&&this.ShowToolbar&&!this.Collapsed};Book.prototype.OnToolbarClick=function(f,c,d){var b=this.ToolbarEventDef;var a=false;var g=this.SelectedPage;switch(c){case"next":g+=1;break;case"prev":g-=1;break;case"top":g=1;break;case"bottom":g=(this.TotalPagesConfirmed?this.TotalPages:-1);break;case"goto":g=d;break}if(this.TotalPagesConfirmed&&g>this.TotalPages){g=this.TotalPages}if(g>0&&this.Pages[g]&&c!="csv"){a=true}if(!a||this.CacheSize!=1){b|=RD3_Glb.EVENT_IMMEDIATE}var e=new IDEvent("booktb",this.Identifier,f,b,c,d);if(e.ClientSide==1&&a&&g!=this.SelectedPage){if(RD3_Glb.IsMobile()){this.SelectedPage=g;if(this.OptimizeDOM){this.RefreshMobileContainer=true}}else{this.SetSelectedPage(g)}this.SetCaption()}};Book.prototype.ResetCache=function(c,b){var g=(this.CacheSize==1?0:parseInt(b.getAttribute("from")));var f=(this.CacheSize==1?0:parseInt(b.getAttribute("to")));var e=this.Pages.length;for(var a=0;a<e;a++){var d=this.Pages[a];if(!d){continue}if(this.CacheSize==1||g==0||f==0){if(d.Number!=this.SelectedPage){d.Unrealize()}}else{if(d.Number<g||d.Number>f){d.Unrealize()}}}this.RecalcLayout=true};Book.prototype.Unrealize=function(){WebFrame.prototype.Unrealize.call(this);var c=this.Pages.length;for(var a=0;a<c;a++){var b=this.Pages[a];if(b){b.Unrealize()}}if(this.IDScroll){this.IDScroll.Unrealize()}this.IDScroll=undefined};Book.prototype.OnToolMouseUse=function(e,b){var a=(window.event)?window.event:e;var d=(window.event)?window.event.srcElement:e.target;if(d){var c="book";if(d.className.indexOf("frame")>=0){c="frame"}d.className=c+"-toolbar-button"+((this.SmallIcons)?"-small":"")+((b=="")?"":"-"+b)}};Book.prototype.IsResizeImmediate=function(){return true};Book.prototype.ParGrowWidth=function(c,b,a){while(c){var d=c.VisStyle.GetBookOffset(true);if(d.w!=0){return}if(c.XAbsPx+c.WPx<b){return}if(c.StretchW>=a){return}c.StretchW=Math.max((!c.StretchW?0:c.StretchW),a);if(c instanceof BookSection){c=c.MastroBox}else{c=c.ParentSect}}};Book.prototype.ParGrowHeight=function(c,a,b){while(c){var d=c.VisStyle.GetBookOffset(true);if(d.h!=0){return}if(c.YAbsPx+c.HPx<a){return}if(c.StretchH>=b){return}c.StretchH=Math.max((!c.StretchH?0:c.StretchH),b);if(c instanceof BookSection){c=c.MastroBox}else{c=c.ParentSect}}};Book.prototype.OnFrameClick=function(c,l,d,j,i,m,g,k){while(k&&k.tagName!="DIV"){k=k.parentNode}if(!k){return}var b=RD3_Glb.GetRD3ObjectId(k);var e=RD3_DesktopManager.ObjectMap[b];var f=e;if(e&&e instanceof BookSection){if(e.SectionBox.style.backgroundColor=="transparent"){if(e.ParentBox){b=e.ParentBox.Identifier;f=e.ParentBox}else{b=e.MastroBox.Identifier;f=e.MastroBox}}}if(f instanceof BookBox){j=m-RD3_Glb.GetScreenLeft(f.BoxBox);i=g-RD3_Glb.GetScreenTop(f.BoxBox);var a=new Rect(j,i,0,0);f.AdaptCoords(a);j=a.x;i=a.y}var h=new IDEvent("rawclk",this.Identifier,c,l?this.MouseDoubleClickEventDef:this.MouseClickEventDef,l,d,Math.floor(m)+"-"+Math.floor(g),Math.floor(j)+"-"+Math.floor(i),b)};Book.prototype.GetTooltip=function(b,c){var a=false;if(c==this.BeginImg){b.SetTitle(ClientMessages.TIP_TITLE_BookInizio);b.SetText(RD3_ServerParams.BookInizio);a=true}else{if(c==this.PrevImg){b.SetTitle(ClientMessages.TIP_TITLE_BookPaginaPrec);b.SetText(RD3_ServerParams.BookPaginaPrec);a=true}else{if(c==this.NextImg){b.SetTitle(ClientMessages.TIP_TITLE_BookPaginaSucc);b.SetText(RD3_ServerParams.BookPaginaSucc);a=true}else{if(c==this.EndImg){b.SetTitle(ClientMessages.TIP_TITLE_BookFine);b.SetText(RD3_ServerParams.BookFine);a=true}else{if(c==this.PrintImg){b.SetTitle(ClientMessages.TIP_TITLE_CreatePDF);b.SetText(RD3_ServerParams.CreatePDF);a=true}else{if(c==this.ExportImg){b.SetTitle(ClientMessages.TIP_TITLE_TooltipExport);b.SetText(RD3_ServerParams.TooltipExport);a=true}}}}}}if(a){b.SetAnchor(RD3_Glb.GetScreenLeft(c)+((c.offsetWidth-4)/2),RD3_Glb.GetScreenTop(c));b.SetPosition(0);return true}else{return WebFrame.prototype.GetTooltip.call(this,b,c)}};Book.prototype.ComputeDropList=function(b,a){if(!this.Realized||this.Pages.length==0){return}this.Pages[this.ActivePage].ComputeDropList(b,a)};Book.prototype.OnTouchStart=function(a){WebFrame.prototype.OnTouchStart.call(this,a);if(a.targetTouches.length!=1){return false}a.preventDefault();this.TouchStartX=a.targetTouches[0].clientX;this.TouchStartY=a.targetTouches[0].clientY;this.TouchOrgX=a.targetTouches[0].clientX;this.TouchOrgY=a.targetTouches[0].clientY;this.TouchTimes=new Array();this.TouchPosY=new Array();this.TouchPosX=new Array();this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);this.HandleTouchEvent(a,"down");this.TouchMoved=false;this.ClearTouchScrollTimer();this.TouchPagePrev=false;this.TouchPageNext=false;if(!this.AnimatingNum&&this.ActivePage>0&&this.Pages.length>0){this.TouchPagePrev=this.ContentBox.scrollLeft==0;this.TouchPageNext=this.ContentBox.scrollLeft+this.ContentBox.clientWidth>=this.Pages[this.ActivePage].PageBox.offsetWidth}return false};Book.prototype.OnTouchMove=function(i){if(this.TouchStartX==-1){return false}i.preventDefault();if(i.targetTouches.length!=1){return false}var k=i.targetTouches[0].clientX-this.TouchStartX;var h=i.targetTouches[0].clientY-this.TouchStartY;var j=new Date();this.TouchStartX=i.targetTouches[0].clientX;this.TouchStartY=i.targetTouches[0].clientY;if(Math.abs(this.TouchStartX-this.TouchOrgX)>RD3_ClientParams.TouchMoveLimit||Math.abs(this.TouchStartY-this.TouchOrgY)>RD3_ClientParams.TouchMoveLimit){this.HandleTouchEvent(i,"move");this.TouchMoved=true}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);if(this.TouchTimes.length>3){this.TouchTimes.shift();this.TouchPosY.shift();this.TouchPosX.shift()}var b=(this.TouchStartX-this.TouchOrgX);var c=(this.TouchStartY-this.TouchOrgY);if(Math.abs(c)<40&&b>120&&this.TouchPagePrev){this.TouchPagePrev=false;this.PrevImg.className="frame-toolbar-button"+((this.SmallIcons)?"-small":"")+"-down";window.setTimeout("document.getElementById('"+this.PrevImg.id+"').className = 'frame-toolbar-button"+((this.SmallIcons)?"-small":"")+"'",300);this.OnToolbarClick(i,"prev");this.FormScroll=false}else{if(Math.abs(c)<40&&b<-120&&this.TouchPageNext){this.TouchPageNext=false;this.NextImg.className="frame-toolbar-button"+((this.SmallIcons)?"-small":"")+"-down";window.setTimeout("document.getElementById('"+this.NextImg.id+"').className = 'frame-toolbar-button"+((this.SmallIcons)?"-small":"")+"'",300);this.OnToolbarClick(i,"next");this.FormScroll=false}else{if(!RD3_DDManager.IsDragging&&!RD3_DDManager.IsResizing){this.TouchScrollBox=null;var a=RD3_Glb.ElementFromPoint(this.TouchStartX,this.TouchStartY);while(a){var d=RD3_DDManager.GetObject(a.id,true);if(d instanceof BookBox){if(d.CanScroll){this.TouchScrollBox=d.BoxBox;break}}a=a.parentNode}if(!this.TouchScrollBox){this.TouchScrollBox=this.ContentBox}var g=this.TouchScrollBox.scrollLeft;var f=this.TouchScrollBox.scrollTop;this.TouchScrollBox.scrollLeft-=k;this.TouchScrollBox.scrollTop-=h;this.FormScroll=this.FormScroll&&g==this.TouchScrollBox.scrollLeft&&f==this.TouchScrollBox.scrollTop}}}WebFrame.prototype.OnTouchMove.call(this,i);return false};Book.prototype.OnTouchEnd=function(g){if(this.TouchStartX==-1){return false}g.preventDefault();if(g.targetTouches.length!=0&&g.changedTouches.length!=1){return false}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}if(!this.TouchMoved){this.HandleTouchEvent(g,"up")}else{if(this.TouchTimes.length==3){var f=this.TouchTimes[2]-this.TouchTimes[0];var b=this.TouchPosX[0]-this.TouchPosX[2];var a=this.TouchPosY[0]-this.TouchPosY[2];if(new Date()-this.TouchTimes[2]<100&&f>0){var c=a/f;var d=b/f;if(Math.abs(d)>0.3||Math.abs(c)>0.3){this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+d+","+c+",0])",10)}}}}WebFrame.prototype.OnTouchEnd.call(this,g);this.TouchStartX=-1;this.TouchStartY=-1;this.TouchMoved=false;this.TouchMove=false;return false};Book.prototype.TouchScrollTimer=function(d,b){if(b.length==3){var c=b[0];var a=b[1];var e=b[2];if(this.TouchScrollBox){this.TouchScrollBox.scrollLeft+=c*10;this.TouchScrollBox.scrollTop+=a*10}if(e<40){c=c*0.97;a=a*0.97;this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+c+","+a+","+(e+1)+"])",10)}}};Book.prototype.ClearTouchScrollTimer=function(){if(this.TouchScrollTimerId>0){window.clearTimeout(this.TouchScrollTimerId);this.TouchScrollTimerId=0;this.TouchScroll=0}};Book.prototype.HandleTouchEvent=function(g,c){var j=g.changedTouches[0].clientX;var i=g.changedTouches[0].clientY;var h=false;if(c=="up"){this.FormScroll=false;if(new Date()-this.SingleTapTime<300&&Math.abs(j-this.SingleTapX)<16&&Math.abs(i-this.SingleTapY)<16){h=true;this.SingleTapTime=0;this.SingleTapX=-100;this.SingleTapY=-100}else{this.SingleTapTime=new Date();this.SingleTapX=j;this.SingleTapY=i}}var a=RD3_Glb.ElementFromPoint(j,i);var f=RD3_Glb.GetParentFrame(a);if(f!=this){return}var d=null;var k=false;if(a){k=(a.tagName=="IMG"||a.tagName=="INPUT");d=RD3_DDManager.GetObject(a.id,true);if(d instanceof BookBox){k=d.CanClick}if(d instanceof BookSpan){k=d.ParentBox.CanClick;a=a.parentNode}if(a.className=="combo-activator"){k=true}}if(c=="down"){this.TouchObj=a}if(c!="down"&&this.TouchObj&&this.TouchObj.id!=""){RD3_Glb.TouchHL(this.TouchObj,"panel-field-down",false)}if(k){if(a.id!=""){if(c=="up"){RD3_Glb.TouchHL(a)}if(c=="down"){RD3_Glb.TouchHL(a,"panel-field-down",true,0)}}if(c=="up"){var b=document.createEvent("MouseEvents");b.initMouseEvent(h?"dblclick":"click",true,true,window,1,j,i,j,i);a.dispatchEvent(b)}}};Book.prototype.UpdateMobileContainer=function(){if(!this.Realized){return}this.RefreshMobileContainer=false;if(!RD3_Glb.IsMobile()){return}if(!this.MobilePageContainer){this.MobilePageContainer=document.createElement("div");this.MobilePageContainer.setAttribute("id",this.Identifier+":mob");this.MobilePageContainer.className="book-mobile-container";this.ContentBox.appendChild(this.MobilePageContainer)}var j=0;var k=0;var p=this.HideBorder?0:2;var g=this.HideBorder?0:8;var f=this.HideBorder?0:8;var e=this.Pages.length;for(var h=1;h<e;h++){if(this.Pages[h]&&this.Pages[h].PageBox){if(this.Pages[h].WidthPx>k){k=this.Pages[h].WidthPx}if(this.Pages[h].HeightPx>j){j=this.Pages[h].HeightPx}}}k=Math.floor(k)+p;j=Math.floor(j)+p;if(j==p){j=this.ContentBoxOffsetHeight-(this.HideBorder?0:8)}if(k==p){k=this.ContentBoxOffsetWidth-(this.HideBorder?0:8)}var q=k;var o=j;var m=0;var l=0;var d=this.TotalPages+(this.TotalPagesConfirmed?0:1);if(!this.TotalPagesConfirmed&&this.ContentBoxOffsetWidth!=0&&k-p<this.ContentBoxOffsetWidth-10){var c=Math.floor(this.ContentBoxOffsetWidth/(k-p));d+=c}for(var h=1;h<=d;h++){if(this.Pages[h]&&this.Pages[h].PageBox){var a=true;if(this.OptimizeDOM){a=Math.abs(h-this.SelectedPage)<=Math.ceil((this.CacheSize-1)/2)}if(a){if(this.Pages[h].PageBox.style.display=="none"){this.RecalcLayout=true}if(this.ScrollOrientation==0){this.Pages[h].PageBox.style.left=m+"px"}else{this.Pages[h].PageBox.style.top=l+"px"}}this.Pages[h].PageBox.style.display=a?"":"none";if(this.PlaceHolders[h]){this.PlaceHolders[h].style.display="none"}}else{if(!this.PlaceHolders[h]){this.PlaceHolders[h]=document.createElement("div");this.PlaceHolders[h].className="book-page-placeholder book-page-container"+(this.HideBorder?"-noborder":"");this.PlaceHolders[h].textContent=h;this.MobilePageContainer.appendChild(this.PlaceHolders[h])}this.PlaceHolders[h].style.display="";var r=this.PlaceHolders[h].style;if(this.ScrollOrientation==0){r.left=m+"px"}else{r.top=l+"px"}r.width=(q-p)+"px";r.height=(o-p)+"px"}m+=k+g;l+=j+f}for(var h=d+1;h<this.PlaceHolders.length;h++){if(this.PlaceHolders[h]){this.PlaceHolders[h].style.display="none"}}var b=false;if(this.ScrollOrientation==0){if(this.MobilePageContainerOffsetWidth!=m){this.MobilePageContainer.style.width=m+"px";this.MobilePageContainerOffsetWidth=this.MobilePageContainer.offsetWidth;b=true}if(this.MobilePageContainerOffsetHeight!=j+f){this.MobilePageContainer.style.height=(j+f)+"px";this.MobilePageContainerOffsetHeight=this.MobilePageContainer.offsetHeight;b=true}}else{if(this.MobilePageContainerOffsetWidth!=k+g){this.MobilePageContainer.style.width=(k+g)+"px";this.MobilePageContainerOffsetWidth=this.MobilePageContainer.offsetWidth;b=true}if(this.MobilePageContainerOffsetHeight!=l){this.MobilePageContainer.style.height=l+"px";this.MobilePageContainerOffsetHeight=this.MobilePageContainer.offsetHeight;b=true}}if(!this.IDScroll){this.IDScroll=new IDScroll(this.Identifier,this.MobilePageContainer,this.ContentBox,this);this.SetScrollbar()}if(this.ScrollOrientation==0){if(this.FixedWidth==0){this.IDScroll.SetSnap(k+g,0,this.SnapToPage,this.OptimizeDOM?Math.ceil((this.CacheSize-1)/2):0)}}else{if(this.FixedHeight==0){this.IDScroll.SetSnap(0,j+f,this.SnapToPage,this.OptimizeDOM?Math.ceil((this.CacheSize-1)/2):0)}}if(b){this.IDScroll.CalcLimits()}if(this.ForceSetPage||this.SnapToPage){if(this.ScrollOrientation==0){this.IDScroll.SetPage(this.SelectedPage,0)}else{this.IDScroll.SetPage(0,this.SelectedPage)}}this.ForceSetPage=false};Book.prototype.OnScrollToPage=function(b,c,a){if(a!=this.SelectedPage){this.OnToolbarClick(b,"goto",a)}};Book.prototype.UpdateFixedZones=function(){var c=this.Pages.length;for(var a=0;a<c;a++){var b=this.Pages[a];if(b){b.UpdateFixedZones()}}this.ContentBox.onscroll=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScroll', ev)")};Book.prototype.OnScroll=function(a){if(this.Pages[this.SelectedPage]){this.Pages[this.SelectedPage].OnScroll(a)}};function BookBox(a){this.Identifier=null;this.XPos=0;this.YPos=0;this.Width=0;this.Height=0;this.VisStyle=null;this.Image="";this.Interline=0;this.Stretch=RD3_Glb.STRTC_AUTO;this.Visible=true;this.CanDrag=false;this.CanDrop=false;this.CanTransform=false;this.CanScroll=false;this.CanClick=false;this.Tooltip="";this.GraphFile="";this.GraphMap="";this.NumRows=1;this.VisualFlags=-1;this.SubForm=null;this.Badge="";this.ClassName;this.BackColor="";this.ForeColor="";this.FontMod="";this.Alignment=1;this.VAlignment=1;this.SubSections=null;this.Spans=null;this.ParentPage=a;this.MastroWithSections=false;this.Alternate=false;this.ParentSect=null;this.ClickEventDef=RD3_Glb.EVENT_ACTIVE;this.DropEventDef=RD3_Glb.EVENT_ACTIVE;this.TransformEventDef=RD3_Glb.EVENT_ACTIVE;this.Realized=false;this.BoxBox=null;this.BoxImg=null;this.BoxGraph=null;this.BoxMap=null;this.BadgeObj=null}BookBox.prototype.LoadFromXml=function(e){this.LoadProperties(e);var c=e.childNodes;var g=c.length;for(var d=0;d<g;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"sec":var f=new BookSection(this.ParentPage);f.LoadFromXml(b);f.ParentBox=this;if(!this.SubSections){this.SubSections=new Array()}this.SubSections[this.SubSections.length]=f;break;case"spn":var f=new BookSpan(this);f.LoadFromXml(b);f.Alternate=this.Alternate;if(!this.Spans){this.Spans=new Array()}this.Spans[this.Spans.length]=f;break;case"frm":this.SetSubForm("1",e);break}}};BookBox.prototype.ChangeProperties=function(a){this.LoadProperties(a)};BookBox.prototype.LoadProperties=function(d){var b=d.attributes;var e=this.ParentPage.UM=="mm";var g=b.length;for(var c=0;c<g;c++){var f=b.item(c);var a=f.nodeValue;switch(f.nodeName){case"xp":this.SetXPos((e)?parseInt(a)/100:parseInt(a)/1000);break;case"yp":this.SetYPos((e)?parseInt(a)/100:parseInt(a)/1000);break;case"wid":this.SetWidth((e)?parseInt(a)/100:parseInt(a)/1000);break;case"hei":this.SetHeight((e)?parseInt(a)/100:parseInt(a)/1000);break;case"sty":this.SetVisStyle(a);break;case"img":this.SetImage(a);break;case"int":this.SetInterline(a);break;case"str":this.SetStretch(parseInt(a));break;case"vis":this.SetVisible(a=="1");break;case"vfl":this.SetVisualFlags(parseInt(a));break;case"dra":this.SetCanDrag(a=="1");break;case"dro":this.SetCanDrop(a=="1");break;case"tra":this.SetCanTransform(a=="1");break;case"scr":this.SetCanScroll(a=="1");break;case"act":this.SetCanClick(a=="1");break;case"tip":this.SetTooltip(a);break;case"grf":this.SetGraphFile(a);break;case"grm":this.SetGraphMap(a);break;case"num":this.SetNumRows(parseInt(a));break;case"csf":this.SetSubForm(parseInt(a),d);break;case"bkc":this.SetBackColor(a);break;case"frc":this.SetForeColor(a);break;case"ftm":this.SetFontMod(a);break;case"aln":this.SetAlignment(parseInt(a));break;case"valn":this.SetVAlignment(parseInt(a));break;case"bdg":this.SetBadge(a);break;case"cln":this.SetClassName(a);break;case"clk":this.ClickEventDef=parseInt(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};BookBox.prototype.SetXPos=function(a){if(a!=undefined){if(this.XPos!=a){this.ParentPage.ParentBook.RecalcLayout=true}this.XPos=a}};BookBox.prototype.SetYPos=function(a){if(a!=undefined){if(this.YPos!=a){this.ParentPage.ParentBook.RecalcLayout=true}this.YPos=a}};BookBox.prototype.SetWidth=function(b){if(b!=undefined){if(this.Width!=b){this.ParentPage.ParentBook.RecalcLayout=true;if(this.Realized&&this.Spans){var c=this.Spans.length;for(var a=0;a<c;a++){this.Spans[a].UpdateWidth(this.Width,b)}}}this.Width=b}};BookBox.prototype.SetHeight=function(b){if(b!=undefined){if(this.Height!=b){this.ParentPage.ParentBook.RecalcLayout=true;if(this.Realized&&this.Spans){var c=this.Spans.length;for(var a=0;a<c;a++){this.Spans[a].UpdateHeight(this.Height,b)}}}this.Height=b}};BookBox.prototype.SetNumRows=function(c){var a=this.NumRows;if(c!=undefined){this.NumRows=c;if(this.Realized&&this.Spans&&(this.NumRows==1)!=(a==1)){var d=this.Spans.length;for(var b=0;b<d;b++){this.Spans[b].Unrealize();this.Spans[b].Realize(this.BoxBox);RD3_DesktopManager.ObjectMap.add(this.Spans[b].Identifier,this.Spans[b])}}}};BookBox.prototype.SetVisStyle=function(b){var a=this.VisStyle;if(b!=undefined){if(b.Identifier){this.VisStyle=b}else{this.VisStyle=RD3_DesktopManager.ObjectMap["vis:"+b]}}if(this.Realized&&this.VisStyle){if(b!=undefined){this.ApplyVisualStyle()}if(a!=this.VisStyle){this.ParentPage.ParentBook.RecalcLayout=true}}};BookBox.prototype.SetImage=function(b){if(b!=undefined){this.Image=b}if(this.Realized){if(this.Image==""){if(this.BoxImg){this.BoxImg.style.display="none"}if(this.BoxBox.style.backgroundImage.substr(0,4)=="url("){this.BoxBox.style.backgroundImage=""}this.SetCanScroll();if(this.Wants4pxPadding()){var d="";var c=this.VisStyle.GetAlignment(1);if(this.Alignment!=1){c=this.Alignment}switch(c){case 3:d="center";break;case 4:d="right";break;case 5:d="justify";break;default:d=(this.IsRightAligned()?"right":"");break}if(d=="left"||d==""){this.BoxBox.style.paddingLeft="4px";this.BoxBox.style.paddingRight=""}else{if(d=="right"){this.BoxBox.style.paddingLeft="";this.BoxBox.style.paddingRight="4px"}}this.ParentPage.ParentBook.RecalcLayout=true}}else{if(this.Stretch==RD3_Glb.STRTC_NONE){this.BoxBox.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+encodeURI(this.Image)+")";if(this.BoxImg){this.BoxImg.style.display="none"}}else{if(!this.BoxImg){this.BoxImg=document.createElement("img");this.BoxImg.setAttribute("id",this.Identifier+":img");this.BoxImg.className="book-box-img";this.BoxImg.src=RD3_Glb.GetImgSrc(this.Image);this.BoxBox.appendChild(this.BoxImg);RD3_Glb.ApplyCursor(this.BoxImg,this.BoxBox.style.cursor);var a=this;if(!RD3_Glb.IsIE(10,false)){this.BoxImg.onload=function(e){a.OnReadyStateChange(e)}}else{this.BoxImg.onreadystatechange=function(e){a.OnReadyStateChange(e)}}}else{this.BoxImg.src=RD3_Glb.GetImgSrc(this.Image);this.BoxImg.style.display=""}if(this.Stretch==RD3_Glb.STRTC_CROP){this.BoxBox.style.overflow="hidden"}else{this.SetCanScroll()}if(this.BoxBox.style.backgroundImage.substr(0,4)=="url("){this.BoxBox.style.backgroundImage=""}if(!this.Wants4pxPadding()){this.BoxBox.style.paddingLeft="";this.BoxBox.style.paddingRight="";this.ParentPage.ParentBook.RecalcLayout=true}}}}};BookBox.prototype.SetInterline=function(a){if(a!=undefined){this.Interline=a}if(this.Realized){if(this.Interline>0){this.BoxBox.style.lineHeight=this.Interline+"pt"}}};BookBox.prototype.SetStretch=function(h){if(h!=undefined){this.Stretch=h}if(this.Realized&&this.Image!=""&&this.Stretch!=RD3_Glb.STRTC_NONE&&!this.BoxImg){this.SetImage()}if(this.Realized&&this.BoxImg){var i=this.BoxImg.style;switch(this.Stretch){case RD3_Glb.STRTC_ENLARGE:case RD3_Glb.STRTC_CROP:i.width="auto";i.height="auto";var f=this.BoxImg.width;var b=this.BoxImg.height;var g=this.BoxBox.clientWidth;var e=this.BoxBox.clientHeight;if(f&&b&&g&&e){var d=b/f;var c=g*d;var a=e/d;if(c>e){if(this.Stretch==RD3_Glb.STRTC_ENLARGE){i.width=a+"px";i.height=e+"px";i.top="0px";i.left=(g-a)/2+"px"}else{if(this.Stretch==RD3_Glb.STRTC_CROP){i.width=g+"px";i.height=c+"px";i.top=(e-c)/2+"px";i.left="0px"}}}else{if(this.Stretch==RD3_Glb.STRTC_ENLARGE){i.width=g+"px";i.height=c+"px";i.top=(e-c)/2+"px";i.left="0px"}else{if(this.Stretch==RD3_Glb.STRTC_CROP){i.width=a+"px";i.height=e+"px";i.top="0px";i.left=(g-a)/2+"px"}}}i.position="absolute"}break;case RD3_Glb.STRTC_AUTO:case RD3_Glb.STRTC_FILL:i.left="0px";i.top="0px";i.width=this.Width+this.ParentPage.UM;i.height=this.Height+this.ParentPage.UM;i.position="";break;case RD3_Glb.STRTC_NONE:i.left="0px";i.top="0px";i.width="";i.height="";i.position="";break}}};BookBox.prototype.SetVisible=function(a){if(a!=undefined){this.Visible=a}if(this.Realized){this.BoxBox.style.display=(this.Visible?"":"none")}};BookBox.prototype.SetCanDrag=function(a){if(a!=undefined){this.CanDrag=a}if(this.Realized){var b=this.VisStyle.GetCursor();if(b==""){var c="";if(this.CanDrag){c="move"}else{if(this.CanClick){c="pointer"}}RD3_Glb.ApplyCursor(this.BoxBox,c);if(this.BoxImg){RD3_Glb.ApplyCursor(this.BoxImg,c)}if(this.SubForm&&this.SubForm.CaptionBox){RD3_Glb.ApplyCursor(this.SubForm.CaptionBox,c);if(this.SubForm.CloseBtn){RD3_Glb.ApplyCursor(this.SubForm.CloseBtn,"pointer")}}}}};BookBox.prototype.SetCanDrop=function(a){if(a!=undefined){this.CanDrop=a}};BookBox.prototype.SetCanTransform=function(a){if(a!=undefined){this.CanTransform=a}};BookBox.prototype.SetVisualFlags=function(a){this.VisualFlags=a};BookBox.prototype.SetCanScroll=function(a){if(a!=undefined){this.CanScroll=a}if(this.Realized&&(this.Image==""||this.Stretch!=RD3_Glb.STRTC_CROP)){this.BoxBox.style.overflowX=(this.CanScroll?"hidden":"hidden");this.BoxBox.style.overflowY=(this.CanScroll?"auto":"hidden");if(RD3_Glb.IsTouch()){this.BoxBox.style.overflowY=(this.CanScroll?"scroll":"hidden");this.BoxBox.style.webkitOverflowScrolling=(this.CanScroll?"touch":"")}}};BookBox.prototype.SetCanClick=function(a){if(a!=undefined){this.CanClick=a}if(this.Realized){var b=this.VisStyle.GetCursor();if(b==""){var c="";if(this.CanDrag){c="move"}else{if(this.CanClick){c="pointer"}}RD3_Glb.ApplyCursor(this.BoxBox,c);if(this.BoxImg){RD3_Glb.ApplyCursor(this.BoxImg,c)}}}};BookBox.prototype.SetTooltip=function(a){if(a!=undefined){this.Tooltip=a}if(this.Realized){RD3_TooltipManager.SetObjTitle(this.BoxBox,this.Tooltip)}};BookBox.prototype.SetGraphFile=function(b){if(b!=undefined){this.GraphFile=b}if(this.Realized){if(this.GraphFile==""){if(this.BoxGraph){this.BoxGraph.style.display="none"}}else{if(!this.BoxGraph){if(window.RD4_Enabled){this.BoxGraph=document.createElement("div");this.BoxGraph.style.width="100%";this.BoxGraph.style.height="100%";this.BoxGraph.style.overflow="hidden"}else{this.BoxGraph=document.createElement("img")}this.BoxGraph.setAttribute("id",this.Identifier+":gra");this.BoxBox.appendChild(this.BoxGraph);this.BoxGraph.className="book-box-graph"}this.BoxGraph.style.display="";if(window.RD4_Enabled){var a=this.Identifier.replace(new RegExp(":","g"),"\\\\:");window.setTimeout("$.jqplot('"+a+"\\\\:gra',"+this.GraphFile+");",100)}else{this.BoxGraph.src=this.GraphFile}}}};BookBox.prototype.SetGraphMap=function(b){if(b!=undefined){this.GraphMap=b}if(this.Realized){if(this.GraphMap==""){if(this.BoxMap){this.BoxMap.style.display="none"}}else{if(window.RD4_Enabled){var a=this.Identifier.replace(new RegExp(":","g"),"\\\\:");window.setTimeout("$('#"+a+"\\\\:gra').bind('jqplotDataClick', function (ev, seriesIndex, pointIndex, data) {RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnGraphClick', null,'S'+((seriesIndex + 1)<=9 ? '0' : '')+(seriesIndex+1)+'I'+(pointIndex+1));});",150);window.setTimeout("$(document).unload(function() {$('*').unbind(); });",150)}else{if(!this.BoxMap){this.BoxMap=document.createElement("span");this.BoxMap.setAttribute("id",this.Identifier+":map");this.BoxBox.appendChild(this.BoxMap)}this.BoxMap.style.display="";this.BoxMap.innerHTML=this.GraphMap;this.BoxGraph.useMap="#"+this.Identifier+":map"}}}};BookBox.prototype.SetSubForm=function(e,d){if(e==0){if(this.SubForm){this.SubForm.Unrealize();this.SubForm=null}}else{if(this.SubForm){this.SubForm.Unrealize()}var a=null;for(var c=0;c<d.childNodes.length;c++){if(d.childNodes.item(c).nodeType==1){a=d.childNodes.item(c);break}}if(a){var f=a.getAttribute("id");var b=RD3_DesktopManager.ObjectMap[f];if(b){if(b.SubFormObj){b.SubFormObj.SubForm=null}b.Unrealize()}}this.SubForm=new WebForm();this.SubForm.SubFormObj=this;this.SubForm.LoadFromXml(a);if(this.Realized){this.SubForm.Realize();this.SubForm.AdaptLayout();RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveFormChanged();this.SetCanDrag()}}};BookBox.prototype.SetBackColor=function(a){if(a!=undefined){this.BackColor=a}if(this.Realized){if(a!=undefined){this.ApplyVisualStyle()}}};BookBox.prototype.SetForeColor=function(a){if(a!=undefined){this.ForeColor=a}if(this.Realized){if(a!=undefined){this.ApplyVisualStyle()}}};BookBox.prototype.SetFontMod=function(a){if(a!=undefined){this.FontMod=a}if(this.Realized){if(a!=undefined){this.ApplyVisualStyle()}}};BookBox.prototype.SetAlignment=function(a){if(a!=undefined){this.Alignment=a}if(this.Realized){if(a!=undefined){this.ApplyVisualStyle()}}};BookBox.prototype.SetVAlignment=function(a){if(a!=undefined){this.VAlignment=a}};BookBox.prototype.SetBadge=function(a){if(a!=undefined){this.Badge=a}if(this.Realized){if(this.Badge==""&&this.BadgeObj!=null){this.BadgeObj.parentElement.removeChild(this.BadgeObj);this.BadgeObj=null}else{if(this.Badge!=""){if(this.BadgeObj==null){this.BadgeObj=document.createElement("div");this.BadgeObj.setAttribute("id",this.Identifier+":bdg");this.BadgeObj.className="badge-red";this.BadgeObj.style.position="absolute"}this.BadgeObj.innerHTML=this.Badge}}}};BookBox.prototype.SetClassName=function(b){var a=this.ClassName;if(b){this.ClassName=b}if(this.Realized&&(a!=this.ClassName||!b)){if(a!=""){RD3_Glb.RemoveClass2(this.BoxBox,a)}if(this.ClassName&&this.ClassName!=""){RD3_Glb.AddClass(this.BoxBox,this.ClassName)}}};BookBox.prototype.Realize=function(e,f){if(this.VisStyle.HasBoxProto()){this.BoxBox=this.VisStyle.GetBoxProto()}else{this.BoxBox=document.createElement("div");this.BoxBox.className="book-box"}this.BoxBox.setAttribute("id",this.Identifier);if(this.SubSections){var b=null;var g=this.SubSections.length;for(var c=0;c<g;c++){var d=this.SubSections[c];if(d.Overlay&&d.MastroBox&&b&&b.Overlay){d.OwnerSection=(b.PageOwner?b:b.OwnerSection);d.SectionBox=b.SectionBox;d.PageOwner=false}d.Realize(this.BoxBox);b=d}}if(this.Spans){var g=this.Spans.length;for(var c=0;c<g;c++){this.Spans[c].Realize(this.BoxBox)}}if(this.SubForm){this.SubForm.Realize();RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveFormChanged()}if(!RD3_Glb.IsMobile()){var a=this;this.BoxBox.onclick=function(h){a.OnClick(h)}}this.Realized=true;this.SetImage();this.SetVisStyle();this.SetInterline();this.SetStretch();this.SetVisible();this.SetCanScroll();this.SetCanClick();this.SetTooltip();this.SetGraphFile();this.SetGraphMap();this.SetCanDrag();this.SetBackColor();this.SetForeColor();this.SetFontMod();this.SetAlignment();this.SetVAlignment();this.SetBadge();this.ApplyVisualStyle();this.SetClassName();this.BoxBox.style.display="none";this.VisStyle.SetBoxProto(this.BoxBox);if(f){e.insertBefore(this.BoxBox,f)}else{e.appendChild(this.BoxBox)}};BookBox.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);if(this.SubSections){var b=this.SubSections.length;for(var a=0;a<b;a++){this.SubSections[a].Unrealize()}}if(this.Spans){var b=this.Spans.length;for(var a=0;a<b;a++){this.Spans[a].Unrealize()}}if(this.SubForm){this.SubForm.Unrealize()}if(this.BoxBox&&this.BoxBox.parentNode){this.BoxBox.parentNode.removeChild(this.BoxBox)}this.BoxBox=null;this.BoxGraphImg=null;this.BoxImg=null;this.BoxImgContainer=null;this.BoxMap=null;this.Realized=false};BookBox.prototype.UnrealizeDelayed=function(){var a=RD3_DesktopManager.ObjectMap[""+this.Identifier];if(a==this){RD3_DesktopManager.ObjectMap.remove(this.Identifier)}if(this.SubSections){var c=this.SubSections.length;for(var b=0;b<c;b++){this.SubSections[b].UnrealizeDelayed()}}if(this.Spans){var c=this.Spans.length;for(var b=0;b<c;b++){this.Spans[b].UnrealizeDelayed()}}if(this.BoxBox&&this.BoxBox.parentNode){this.BoxBox.parentNode.removeChild(this.BoxBox)}this.BoxBox=null;this.BoxGraphImg=null;this.BoxImg=null;this.BoxImgContainer=null;this.BoxMap=null;this.Realized=false};BookBox.prototype.AdaptLayout=function(){if(!this.Realized){return}this.AdaptBox();if(this.BoxImg){this.SetStretch()}if(this.SubSections){var b=this.SubSections.length;for(var a=0;a<b;a++){this.SubSections[a].AdaptLayout()}}if(this.Spans){var b=this.Spans.length;for(var a=0;a<b;a++){this.Spans[a].AdaptLayout()}}if(this.SubForm){this.SubForm.AdaptLayout()}if(this.StretchW||this.StretchH){if(this.StretchW){this.WPx=Math.round(this.WPx+this.StretchW);this.BoxBox.style.width=this.WPx+"px";this.StretchW=0}if(this.StretchH){this.HPx=Math.round(this.HPx+this.StretchH);this.BoxBox.style.height=this.HPx+"px";this.StretchH=0}}};BookBox.prototype.AfterProcessResponse=function(){if(this.SubSections){var b=this.SubSections.length;for(var a=0;a<b;a++){this.SubSections[a].AfterProcessResponse()}}if(this.SubForm){this.SubForm.AfterProcessResponse()}};BookBox.prototype.IsDraggable=function(){return this.CanDrag};BookBox.prototype.IsTransformable=function(){return this.CanTransform};BookBox.prototype.OnDrop=function(c,b){if(this.ParentPage.ParentBook.CanDrop||!this.CanDrop||c.GetParentFrame()!=this.GetParentFrame()){return false}var a=new IDEvent("drp",this.Identifier,b,this.DropEventDef,c.Identifier);return true};BookBox.prototype.OnTransform=function(a,f,b,c,e){var d=new IDEvent("trasf",this.Identifier,e,this.TransformEventDef,"",a,f,b,c)};BookBox.prototype.DropElement=function(){return this.BoxBox};BookBox.prototype.OnClick=function(b){if(window.event&&b==undefined){b=window.event}if(this.Visible&&this.CanClick){if(RD3_Glb.IsAndroid()||(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsTouch())){RD3_DDManager.ChompClick()}var a=new IDEvent("clk",this.Identifier,b,this.ClickEventDef)}else{if(this.Visible&&this.Spans&&this.Spans.length==1&&this.Spans[0].ControlType==RD3_Glb.VISCTRL_CHECK){this.Spans[0].OnCheckBoxClick(b)}}};BookBox.prototype.OnGraphClick=function(c,a){if(this.Visible){var b=new IDEvent("graclk",this.Identifier,c,this.ClickEventDef,a)}};BookBox.prototype.GetDOMObj=function(){return this.BoxBox};BookBox.prototype.ComputeDropList=function(c,a){if(!this.Realized){return}if(this.CanDrop&&this!=a){c.push(this);this.AbsLeft=RD3_Glb.GetScreenLeft(this.BoxBox,true);this.AbsTop=RD3_Glb.GetScreenTop(this.BoxBox,true);this.AbsRight=this.AbsLeft+this.BoxBox.offsetWidth-1;this.AbsBottom=this.AbsTop+this.BoxBox.offsetHeight-1}if(this.SubSections){var d=this.SubSections.length;for(var b=0;b<d;b++){this.SubSections[b].ComputeDropList(c,a)}}if(this.SubForm){this.SubForm.ComputeDropList(c,a)}};BookBox.prototype.GetParentFrame=function(){return this.ParentPage.ParentBook};BookBox.prototype.IsRightAligned=function(){if(this.VisStyle){var a=this.VisStyle.GetAlignment(1);if(this.Alignment!=1){a=this.Alignment}if(a==4){return true}}if(this.Spans&&this.Spans.length>0&&!this.Spans[0].Enabled){return this.Spans[0].IsRightAligned()}return false};BookBox.prototype.ContainsSections=function(){return this.MastroWithSections||this.SubSections};BookBox.prototype.WantDragHL=function(){return this.ParentPage.ParentBook.WantDragHL};BookBox.prototype.WantDropRestore=function(){return this.ParentPage.ParentBook.WantDropRestore};BookBox.prototype.AdaptBox=function(){if(this.Realized){var n=new Rect();var f=0;var b=0;var a=this.ParentSect;while(a){f+=a.XPos;b+=a.YPos;if(a instanceof BookSection){a=a.MastroBox}else{a=a.ParentSect}}n.x=Math.round(RD3_Glb.ConvertIntoPx(this.XPos+f,this.ParentPage.UM))-Math.round(RD3_Glb.ConvertIntoPx(f,this.ParentPage.UM));n.y=Math.round(RD3_Glb.ConvertIntoPx(this.YPos+b,this.ParentPage.UM))-Math.round(RD3_Glb.ConvertIntoPx(b,this.ParentPage.UM));n.w=Math.round(RD3_Glb.ConvertIntoPx(this.XPos+f+this.Width,this.ParentPage.UM))-n.x-Math.round(RD3_Glb.ConvertIntoPx(f,this.ParentPage.UM));n.h=Math.round(RD3_Glb.ConvertIntoPx(this.YPos+b+this.Height,this.ParentPage.UM))-n.y-Math.round(RD3_Glb.ConvertIntoPx(b,this.ParentPage.UM));this.XAbsPx=Math.round(RD3_Glb.ConvertIntoPx(this.XPos+f,this.ParentPage.UM));this.YAbsPx=Math.round(RD3_Glb.ConvertIntoPx(this.YPos+b,this.ParentPage.UM));var i=this.VisStyle.GetBookOffset(true);var g=this.VisStyle.GetBookOffset();g.x-=i.x;g.y-=i.y;g.w-=i.w;g.h-=i.h;if(this.ParentSect){var j=this.ParentSect;if(!j.PageOwner){j=j.OwnerSection}var c=j.VisStyle;if(c){var q=c.GetBookOffset(true);if(q.x>0&&i.x!=0&&n.x==0){n.x-=q.x}if(q.w==0&&i.w!=0&&n.x+n.w>=j.WPx){j.StretchW=Math.max((!j.StretchW?0:j.StretchW),i.w);this.ParentPage.ParentBook.ParGrowWidth(j.MastroBox,this.XAbsPx+n.w,i.w)}if(q.y>0&&i.y!=0&&n.y==0){n.y-=q.y}if(q.h==0&&i.h!=0&&n.y+n.h>=j.HPx){j.StretchH=Math.max((!j.StretchH?0:j.StretchH),i.h);this.ParentPage.ParentBook.ParGrowHeight(j.MastroBox,this.YAbsPx+n.h,i.h)}}}n.w-=i.x+(g.x+g.w);n.h-=i.y+(g.y+g.h);if(this.Wants4pxPadding()){n.w-=4}if(n.w<0){n.w=0}if(n.h<0){n.h=0}this.BoxBox.style.left=n.x+"px";this.BoxBox.style.top=n.y+"px";this.BoxBox.style.width=n.w+"px";this.BoxBox.style.height=n.h+"px";this.BoxBox.style.display=(this.Visible?"":"none");this.XPx=n.x;this.YPx=n.y;this.WPx=n.w;this.HPx=n.h;if(this.MastroWithSections&&(this.Image==""||this.Stretch!=RD3_Glb.STRTC_CROP)){var i=this.VisStyle.GetBookOffset(true);this.BoxBox.style.overflowX=(this.CanScroll?"hidden":(i.x||i.w?"hidden":""));if(RD3_Glb.IsTouch()){this.BoxBox.style.overflowY=(this.CanScroll?"scroll":(i.y||i.h?"hidden":""))}else{this.BoxBox.style.overflowY=(this.CanScroll?"auto":(i.y||i.h?"hidden":""))}}if(this.BadgeObj){this.ParentPage.PageBox.appendChild(this.BadgeObj);var e=this.BadgeObj.clientHeight;var r=this.BadgeObj.clientWidth;var p=this.XAbsPx+n.w-r/2+3;var m=this.YAbsPx-e/2-2;this.BadgeObj.style.left=p+"px";this.BadgeObj.style.top=m+"px"}if(this.VAlignment!=1){var d=this.Spans[0].SpanObj;var s=this.Spans[this.Spans.length-1].SpanObj;var k=s.offsetTop+s.offsetHeight-d.offsetTop;var l=0;if(this.VAlignment==2){l=(n.h-k)/2-1}else{if(this.VAlignment==3){l=n.h-k-1}}this.BoxBox.style.paddingTop=(l+g.y)+"px";this.BoxBox.style.height=(n.h-l)+"px"}}};BookBox.prototype.OnReadyStateChange=function(){if(!RD3_Glb.IsIE(10,false)||this.BoxImg.readyState=="complete"){this.SetStretch()}};BookBox.prototype.AdaptCoords=function(c){var a=this.ParentPage.UM;RD3_Glb.ConvertRectPxIntoUM(c,a);var b=1/RD3_ClientParams.ChgResMM;if(a=="in"){b=1/RD3_ClientParams.ChgResIN}c.x=Math.round(c.x*b)/b;c.y=Math.round(c.y*b)/b;c.w=Math.round(c.w*b)/b;c.h=Math.round(c.h*b)/b};BookBox.prototype.GetUM=function(){return this.ParentPage.UM};BookBox.prototype.Wants4pxPadding=function(){if(this.Spans&&this.Spans.length==1&&this.Spans[0].ControlType==RD3_Glb.VISCTRL_COMBO){return false}if(this.SubForm!=null){return false}var d="";var c=this.VisStyle.GetAlignment(1);if(this.Alignment!=1){c=this.Alignment}switch(c){case 3:d="center";break;case 4:d="right";break;case 5:d="justify";break;default:d=(this.IsRightAligned()?"right":"");break}var b=this.Image;if(b==""&&this.Spans&&this.Spans.length==1){b=(this.Spans[0].HasImage?this.Spans[0].Text:"")}var a=this.VisStyle.GetBorders(1);return(a!=1&&a!=9&&b==""&&(d=="left"||d==""||d=="right"))};BookBox.prototype.UpdateDDStatus=function(j,i,k,d,m,l,a,f,c,b){var g=new Rect(j,i,k,d);this.AdaptCoords(g);j=g.x;i=g.y;k=g.w;d=g.h;g=new Rect(m,l,a,f);this.AdaptCoords(g);m=g.x;l=g.y;a=g.w;f=g.h;var e=this.ParentPage.UM;if(c==0&&b==0){return RD3_Glb.FormatMessage(ClientMessages.DDM_STATUS_Moving,"(X="+(j+e)+", Y="+(i+e)+")","(X="+((j+m)+e)+", Y="+((i+l)+e)+"), delta (dX="+(m+e)+", dY="+(l+e)+")")}else{if(b==0){return RD3_Glb.FormatMessage(ClientMessages.DDM_STATUS_Resizing,"W="+(k+e),"W="+((k+a)+e)+", dW="+(a+e))}else{if(c==0){return RD3_Glb.FormatMessage(ClientMessages.DDM_STATUS_Resizing,"H="+(d+e),"H="+((d+f)+e)+", dH="+(f+e))}else{return RD3_Glb.FormatMessage(ClientMessages.DDM_STATUS_Resizing,"(W="+(k+e)+", H="+(d+e)+")","(W="+((k+a)+e)+", H="+((d+f)+e)+"), delta (dW="+(a+e)+", dH="+(f+e)+")")}}}};BookBox.prototype.InsertChild=function(d){var b=d.getAttribute("id");if(RD3_DesktopManager.ObjectMap[b]){return}var i=d.getAttribute("previd");if(b.substring(0,3)=="spn"){var a=new BookSpan(this);a.LoadFromXml(d);a.Alternate=this.Alternate;if(!this.Spans){this.Spans=new Array()}var j=RD3_Glb.FindObjById(this.Spans,i);if(j!=-1&&j<this.Spans.length){if(this.Realized){a.Realize(this.BoxBox,this.Spans[j].SpanObj)}this.Spans.splice(j,0,a)}else{if(this.Realized){a.Realize(this.BoxBox)}this.Spans[this.Spans.length]=a}if(this.Realized&&this.BoxBox.style.cursor!=""&&!(a.SpanObj instanceof IDCombo)){a.SpanObj.style.cursor=this.BoxBox.style.cursor}if(this.Realized){this.ApplyVisualStyle()}}else{if(b.substring(0,3)=="sec"){var e=new BookSection(this.ParentPage);e.LoadProperties(d);e.ParentBox=this;if(!this.SubSections){this.SubSections=new Array()}var j=RD3_Glb.FindObjById(this.SubSections,i);if(e.Overlay){var h=null;if(j>0){h=this.SubSections[j-1]}else{if(j==-1){h=this.SubSections[this.SubSections.length-1]}}if(h&&h.Overlay){e.OwnerSection=(h.PageOwner?h:h.OwnerSection);e.SectionBox=e.OwnerSection.SectionBox;e.PageOwner=false}var f=null;if(j!=-1&&j<this.SubSections.length-1){f=this.SubSections[j+1]}if(f&&f.Overlay&&f.PageOwner){f.PageOwner=false;if(e.PageOwner&&this.Realized){e.Realize(this.BoxBox,f.SectionBox)}while(f.SectionBox.childNodes.length){var g=f.SectionBox.childNodes[0];if(e.PageOwner){e.SectionBox.appendChild(f.SectionBox.removeChild(g))}else{e.OwnerSection.SectionBox.appendChild(f.SectionBox.removeChild(g))}}f.SectionBox.parentNode.removeChild(f.SectionBox);f.OwnerSection=(e.PageOwner?e:e.OwnerSection);f.SectionBox=(e.PageOwner?e.SectionBox:e.OwnerSection.SectionBox)}}if(j!=-1&&j<this.SubSections.length){if(!e.Realized&&this.Realized){e.Realize(this.BoxBox,this.SubSections[j].SectionBox)}this.SubSections.splice(j,0,e)}else{if(!e.Realized&&this.Realized){e.Realize(this.BoxBox)}this.SubSections[this.SubSections.length]=e}}}this.ParentPage.ParentBook.RecalcLayout=true};BookBox.prototype.OnDeleteObject=function(c){var a=(this.ParentSect?this.ParentSect.BoxList:this.ParentPage.MastroBoxes);if(a){var d=a.length;for(var b=0;b<d;b++){if(a[b]==this){a.splice(b,1);break}}}};BookBox.prototype.ApplyCursor=function(a){if(this.VisStyle.GetCursor()==""){RD3_Glb.ApplyCursor(this.BoxBox,a);if(this.BoxImg){RD3_Glb.ApplyCursor(this.BoxImg,a)}}};BookBox.prototype.CanResizeW=function(){return(this.VisualFlags&1)&&this.CanTransform};BookBox.prototype.CanResizeH=function(){return(this.VisualFlags&2)&&this.CanTransform};BookBox.prototype.CanMoveX=function(){return(this.VisualFlags&4)&&this.CanTransform};BookBox.prototype.CanMoveY=function(){return(this.VisualFlags&8)&&this.CanTransform};BookBox.prototype.CanCancelMove=function(){return(this.VisualFlags&16)};BookBox.prototype.IsMoveable=function(){return this.CanMoveX()||this.CanMoveY()};BookBox.prototype.IsResizable=function(){return this.CanResizeW()||this.CanResizeH()};BookBox.prototype.VisHyperLink=function(){return this.VisualFlags&32};BookBox.prototype.GetTooltip=function(a,b){if(this.Tooltip==""){return false}a.SetObj(this.BoxBox);a.SetText(this.Tooltip);a.SetImage("");a.SetAutoAnchor(true);a.SetPosition(2);return true};BookBox.prototype.ApplyVisualStyle=function(a){var c="";var b=this.VisStyle.GetAlignment(1);if(this.Alignment!=1){b=this.Alignment}switch(b){case 2:c="left";break;case 3:c="center";break;case 4:c="right";break;case 5:c="justify";break;default:c=(this.IsRightAligned()?"right":"");break}this.VisStyle.ApplyStyle(this.BoxBox,this.Alternate,c,this.BackColor,this.ForeColor,this.FontMod,null,this.VisHyperLink());this.BoxBox.style.textAlign=c;if(this.Wants4pxPadding()){if(c=="left"||c==""){this.BoxBox.style.paddingLeft="4px";this.BoxBox.style.paddingRight=""}else{if(c=="right"){this.BoxBox.style.paddingLeft="";this.BoxBox.style.paddingRight="4px"}}}else{if(this.VisStyle.GetBorders(1)!=9){this.BoxBox.style.paddingLeft="";this.BoxBox.style.paddingRight=""}}};BookBox.prototype.OnChange=function(a){if(this.Spans.length==1){this.Spans[0].OnChange(a)}};BookBox.prototype.OnTouchDown=function(a){return true};BookBox.prototype.OnTouchUp=function(b,a){if(a&&this.CanClick){if(RD3_Glb.IsAndroid()||(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsTouch())){RD3_DDManager.ChompClick()}this.OnClick(b)}return true};function BookPage(a){this.Identifier=null;this.Number="";this.Width=0;this.Height=0;this.UM="mm";this.FitMode=1;this.HeightPx=0;this.WidthPx=0;this.MastroBoxes=new Array();this.Sections=new Array();this.ParentBook=a;this.Active=false;this.Adapted=false;this.ShowPageOnInit=true;this.Realized=false;this.PageBox=null}BookPage.prototype.LoadFromXml=function(g){this.LoadProperties(g);var d=g.childNodes;var h=d.length;for(var f=0;f<h;f++){var b=d.item(f);var a=b.nodeName;switch(a){case"box":var e=new BookBox(this);e.LoadFromXml(b);this.MastroBoxes[this.MastroBoxes.length]=e;break;case"sec":var c=new BookSection(this);c.LoadFromXml(b);this.Sections[this.Sections.length]=c;break}}};BookPage.prototype.ChangeProperties=function(a){this.LoadProperties(a)};BookPage.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"num":this.SetNumber(parseInt(a));break;case"um":this.SetUM(a);break;case"wid":this.SetWidth((this.UM=="mm")?parseInt(a)/100:parseInt(a)/1000);break;case"hei":this.SetHeight((this.UM=="mm")?parseInt(a)/100:parseInt(a)/1000);break;case"fit":this.SetFitMode(parseInt(a));break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};BookPage.prototype.SetNumber=function(a){if(a!=undefined){this.Number=a}if(this.ParentBook.Pages[this.Number]){if(this.ParentBook.AnimatingNum&&this.ParentBook.AnimatingNum==this.Number){this.ParentBook.Fx.UnrealizeOnFinish=true;this.ShowPageOnInit=false}else{this.ParentBook.Pages[this.Number].Unrealize()}}this.ParentBook.Pages[this.Number]=this;if(this.Identifier){RD3_DesktopManager.ObjectMap.add(this.Identifier,this)}};BookPage.prototype.SetUM=function(a){if(a!=undefined){this.UM=a}};BookPage.prototype.SetFitMode=function(a){if(a!=undefined){this.FitMode=a}};BookPage.prototype.SetWidth=function(a){if(a!=undefined){this.Width=a;this.WidthPx=RD3_Glb.ConvertIntoPx(a,this.UM)}if(this.Realized){this.PageBox.style.width=this.WidthPx+"px";this.ParentBook.UpdateFixed=true}};BookPage.prototype.SetHeight=function(a){if(a!=undefined){this.Height=a;this.HeightPx=RD3_Glb.ConvertIntoPx(a,this.UM)}if(this.Realized){this.PageBox.style.height=this.HeightPx+"px";this.ParentBook.UpdateFixed=true}};BookPage.prototype.Realize=function(d){if(this.Realized){return}this.PageBox=document.createElement("div");this.PageBox.setAttribute("id",this.Identifier);this.PageBox.className="book-page-container"+(this.ParentBook.HideBorder?"-noborder":"");if(!this.ShowPageOnInit){this.PageBox.style.display="none"}var f=this.MastroBoxes.length;for(var a=0;a<f;a++){this.MastroBoxes[a].Realize(this.PageBox)}var c=new HashTable();f=this.Sections.length;for(var a=0;a<f;a++){var b=this.Sections[a];if(b.Overlay&&b.MastroBox){var e=c[b.MastroBox.Identifier];if(e&&e.Overlay){b.OwnerSection=(e.PageOwner?e:e.OwnerSection);b.SectionBox=b.OwnerSection.SectionBox;b.PageOwner=false}}b.Realize(this.PageBox);if(b.MastroBox){c[b.MastroBox.Identifier]=b}}c=null;this.Realized=true;this.SetWidth();this.SetHeight();d.appendChild(this.PageBox);this.ParentBook.RecalcLayout=true};BookPage.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.ParentBook.Pages[this.Number]=null;var b=this.MastroBoxes.length;for(var a=0;a<b;a++){this.MastroBoxes[a].Unrealize()}b=this.Sections.length;for(var a=0;a<b;a++){this.Sections[a].Unrealize()}if(this.PageBox&&this.PageBox.parentNode){this.PageBox.parentNode.removeChild(this.PageBox)}if(this.FixedLeftScroll){this.FixedLeftScroll.Unrealize()}this.FixedLeftScroll=null;if(this.FixedTopScroll){this.FixedTopScroll.Unrealize()}this.FixedTopScroll=null;if(this.FixedTopLeftScroll){this.FixedTopLeftScroll.Unrealize()}this.FixedTopLeftScroll=null};BookPage.prototype.UnrealizeDelayed=function(){var a=RD3_DesktopManager.ObjectMap[""+this.Identifier];if(a==this){RD3_DesktopManager.ObjectMap.remove(this.Identifier)}var c=this.MastroBoxes.length;for(var b=0;b<c;b++){this.MastroBoxes[b].Unrealize()}c=this.Sections.length;for(var b=0;b<c;b++){this.Sections[b].UnrealizeDelayed()}if(this.PageBox){this.PageBox.parentNode.removeChild(this.PageBox)}};BookPage.prototype.AdaptLayout=function(){if(!this.Realized){return}if(this.PageBox.style.display=="none"){return}var b=this.MastroBoxes.length;for(var a=0;a<b;a++){this.MastroBoxes[a].AdaptLayout()}b=this.Sections.length;for(var a=0;a<b;a++){this.Sections[a].AdaptLayout()}this.Adapted=true};BookPage.prototype.AfterProcessResponse=function(){var b=this.MastroBoxes.length;for(var a=0;a<b;a++){this.MastroBoxes[a].AfterProcessResponse()}b=this.Sections.length;for(var a=0;a<b;a++){this.Sections[a].AfterProcessResponse()}};BookPage.prototype.SetActive=function(a){if(!this.Realized){return}this.Active=a;this.PageBox.style.display=(a)?"":"none";if(this.FixedPageBox){this.FixedPageBox.style.display=(a)?"":"none"}if(this.FixedTopPageBox){this.FixedTopPageBox.style.display=(a)?"":"none"}if(this.FixedLeftPageBox){this.FixedLeftPageBox.style.display=(a)?"":"none"}if(this.FixedTopLeftPageBox){this.FixedTopLeftPageBox.style.display=(a)?"":"none"}if(!this.Active&&this.ParentBook.ActivePage==this.Number){this.ParentBook.ActivePage=0}if(this.Active){this.ParentBook.ActivePage=this.Number;if(!RD3_Glb.IsMobile()){var b=this.ParentBook.ContentBox.style;b.overflowX=(this.FitMode!=1)?"hidden":"auto";b.overflowY=(this.FitMode==3)?"hidden":"auto"}}};BookPage.prototype.ComputeDropList=function(c,a){if(!this.Realized){return}var d=this.MastroBoxes.length;for(var b=0;b<d;b++){this.MastroBoxes[b].ComputeDropList(c,a)}d=this.Sections.length;for(var b=0;b<d;b++){this.Sections[b].ComputeDropList(c,a)}};BookPage.prototype.InsertChild=function(e){var a=e.getAttribute("id");if(RD3_DesktopManager.ObjectMap[a]){return}var s=e.getAttribute("previd");if(a.substring(0,3)=="box"){var g=new BookBox(this);g.LoadProperties(e);var t=RD3_Glb.FindObjById(this.MastroBoxes,s);if(t!=-1&&t<this.MastroBoxes.length){if(this.Realized){g.Realize(this.PageBox,this.MastroBoxes[t].BoxBox)}this.MastroBoxes.splice(t,0,g)}else{if(this.Realized){g.Realize(this.PageBox)}this.MastroBoxes[this.MastroBoxes.length]=g}}else{if(a.substring(0,3)=="sec"){var k=new BookSection(this);k.LoadProperties(e);var t=RD3_Glb.FindObjById(this.Sections,s);if(k.Overlay){var q=null;if(t>0){for(var h=t-1;h>=0&&!q;h--){if(this.Sections[h].MastroBox==k.MastroBox){q=this.Sections[h]}}}else{if(t==-1){for(var h=this.Sections.length-1;h>=0&&!q;h--){if(this.Sections[h].MastroBox==k.MastroBox){q=this.Sections[h]}}}}if(q&&q.Overlay&&q.MastroBox==k.MastroBox){k.OwnerSection=(q.PageOwner?q:q.OwnerSection);k.SectionBox=k.OwnerSection.SectionBox;k.PageOwner=false}var j=null;if(t!=-1&&t<this.Sections.length-1){for(var h=t+1;h<this.Sections.length&&!j;h++){if(this.Sections[h].MastroBox==k.MastroBox){j=this.Sections[h]}}}if(j&&j.Overlay&&j.PageOwner){j.PageOwner=false;if(k.PageOwner&&this.Realized){k.Realize(this.PageBox,j.SectionBox)}while(j.SectionBox.childNodes.length){var p=j.SectionBox.childNodes[0];if(k.PageOwner){k.SectionBox.appendChild(j.SectionBox.removeChild(p))}else{k.OwnerSection.SectionBox.appendChild(j.SectionBox.removeChild(p))}}j.SectionBox.parentNode.removeChild(j.SectionBox);j.OwnerSection=(k.PageOwner?k:k.OwnerSection);j.SectionBox=(k.PageOwner?k.SectionBox:k.OwnerSection.SectionBox);var d=this.Sections.length;for(var h=0;h<d;h++){if(this.Sections[h].OwnerSection==j){this.Sections[h].OwnerSection=j.OwnerSection}}}}if(t!=-1&&t<this.Sections.length){if(!k.Realized&&this.Realized){k.Realize(this.PageBox,this.Sections[t].SectionBox)}this.Sections.splice(t,0,k)}else{if(!k.Realized&&this.Realized){k.Realize(this.PageBox)}this.Sections[this.Sections.length]=k}if(!k.Overlay){var j=null;if(t!=-1&&t<this.Sections.length-1){for(var h=t+1;h<this.Sections.length&&!j;h++){if(this.Sections[h].MastroBox==k.MastroBox){j=this.Sections[h]}}}if(j&&j.Overlay&&!j.PageOwner){j.SectionBox=j.OwnerSection.SectionBox.cloneNode(false);j.SectionBox.setAttribute("id",j.Identifier);var o=null;var d=this.Sections.length;for(var h=t+1;h<d;h++){var l=this.Sections[h];if(!l.Overlay||l.PageOwner){o=l;break}l.OwnerSection=j;l.SectionBox=j.SectionBox;var m=l.BoxList.length;for(var f=0;f<m;f++){var r=l.BoxList[f];j.SectionBox.appendChild(r.BoxBox)}}j.PageOwner=true;j.OwnerSection=null;if(o){o.SectionBox.parentNode.insertBefore(j.SectionBox,o.SectionBox)}else{j.MastroBox.BoxBox.appendChild(j.SectionBox)}j.SectionBox.parentNode.insertBefore(k.SectionBox,j.SectionBox)}}}}this.ParentBook.RecalcLayout=true};BookPage.prototype.UpdateFixedZones=function(){if(!this.Realized){return}var g=Math.min(this.Width,this.ParentBook.FixedWidth/(this.UM=="mm"?100:1000));var c=Math.min(this.Height,this.ParentBook.FixedHeight/(this.UM=="mm"?100:1000));if(g!=0&&!this.FixedLeftPageBox){this.FixedLeftPageBox=document.createElement("div");this.FixedLeftPageBox.setAttribute("id",this.Identifier+"fixLeft");this.FixedLeftPageBox.className="book-page-container-fixed book-page-container-fixed-left";this.ParentBook.ContentBox.appendChild(this.FixedLeftPageBox);if(RD3_Glb.IsMobile()){this.FixedLeftScroll=new IDScroll(this.ParentBook.Identifier+":fxl",this.ParentBook.ContentBox,this.FixedLeftPageBox,this.ParentBook);this.FixedLeftScroll.AllowXScroll=false;this.FixedLeftScroll.AllowYScroll=false}}else{if(g==0&&this.FixedLeftPageBox){while(this.FixedLeftPageBox.childNodes.length){this.PageBox.appendChild(this.FixedLeftPageBox.childNodes[0])}if(this.FixedLeftPageBox.parentNode){this.FixedLeftPageBox.parentNode.removeChild(this.FixedLeftPageBox)}this.FixedLeftPageBox=null;if(this.FixedLeftScroll){this.FixedLeftScroll.Unrealize()}this.FixedLeftScroll=null}}if(c!=0&&!this.FixedTopPageBox){this.FixedTopPageBox=document.createElement("div");this.FixedTopPageBox.setAttribute("id",this.Identifier+"fixTop");this.FixedTopPageBox.className="book-page-container-fixed book-page-container-fixed-top";this.ParentBook.ContentBox.appendChild(this.FixedTopPageBox);if(RD3_Glb.IsMobile()){this.FixedTopScroll=new IDScroll(this.ParentBook.Identifier+":fxt",this.ParentBook.ContentBox,this.FixedTopPageBox,this.ParentBook);this.FixedTopScroll.AllowXScroll=false;this.FixedTopScroll.AllowYScroll=false}}else{if(c==0&&this.FixedTopPageBox){while(this.FixedTopPageBox.childNodes.length){this.PageBox.appendChild(this.FixedTopPageBox.childNodes[0])}if(this.FixedTopPageBox.parentNode){this.FixedTopPageBox.parentNode.removeChild(this.FixedTopPageBox)}this.FixedTopPageBox=null;if(this.FixedTopScroll){this.FixedTopScroll.Unrealize()}this.FixedTopScroll=null}}if(g!=0&&g!=0&&!this.FixedTopLeftPageBox){this.FixedTopLeftPageBox=document.createElement("div");this.FixedTopLeftPageBox.setAttribute("id",this.Identifier+"fixTopLeft");this.FixedTopLeftPageBox.className="book-page-container-fixed book-page-container-fixed-left book-page-container-fixed-top";this.ParentBook.ContentBox.appendChild(this.FixedTopLeftPageBox);if(RD3_Glb.IsMobile()){this.FixedTopLeftScroll=new IDScroll(this.ParentBook.Identifier+":fxtl",this.ParentBook.ContentBox,this.FixedTopLeftPageBox,this.ParentBook);this.FixedTopLeftScroll.AllowXScroll=false;this.FixedTopLeftScroll.AllowYScroll=false}}else{if((g==0||g==0)&&this.FixedTopLeftPageBox){while(this.FixedTopLeftPageBox.childNodes.length){this.PageBox.appendChild(this.FixedTopLeftPageBox.childNodes[0])}if(this.FixedTopLeftPageBox.parentNode){this.FixedTopLeftPageBox.parentNode.removeChild(this.FixedTopLeftPageBox)}this.FixedTopLeftPageBox=null;if(this.FixedTopLeftScroll){this.FixedTopLeftScroll.Unrealize()}this.FixedTopLeftScroll=null}}if((g||c)&&!this.FixedPageBox){this.FixedPageBox=document.createElement("div");this.FixedPageBox.setAttribute("id",this.Identifier+"fix");this.FixedPageBox.className="book-page-container-fixed";if(RD3_Glb.IsMobile()){this.ParentBook.MobilePageContainer.insertBefore(this.FixedPageBox,this.ParentBook.MobilePageContainer.firstChild)}else{this.ParentBook.ContentBox.insertBefore(this.FixedPageBox,this.ParentBook.ContentBox.firstChild)}this.FixedPageBox.appendChild(this.PageBox);this.ParentBook.ContentBox.style.overflow="hidden";if(RD3_Glb.IsIE()){this.ParentBook.ContentBox.style.overflowX="hidden";this.ParentBook.ContentBox.style.overflowY="hidden"}if(RD3_Glb.IsMobile()){if(this.ParentBook.IDScroll){this.ParentBook.IDScroll.Unrealize()}this.ParentBook.IDScroll=new IDScroll(this.ParentBook.Identifier,this.PageBox,this.FixedPageBox,this.ParentBook);this.ParentBook.SetScrollbar();RD3_Glb.SetTransform(this.PageBox,"translate3d(0px,0px,0px)")}else{this.FixedPageBox.style.overflow="auto";this.FixedPageBox.onscroll=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScroll', ev)")}}else{if((g==0&&c==0)&&this.FixedPageBox){while(this.FixedPageBox.childNodes.length){this.ParentBook.ContentBox.appendChild(this.FixedPageBox.childNodes[0])}if(this.FixedPageBox.parentNode){this.FixedPageBox.parentNode.removeChild(this.FixedPageBox)}this.FixedPageBox=null;this.ParentBook.ContentBox.style.overflow="";this.PageBox.style.marginLeft="";this.PageBox.style.marginTop="";if(RD3_Glb.IsMobile()){if(this.ParentBook.IDScroll){this.ParentBook.IDScroll.Unrealize()}this.ParentBook.IDScroll=null;this.ParentBook.UpdateMobileContainer()}}}if(this.FixedLeftPageBox||this.FixedTopPageBox){var f=Math.round(RD3_Glb.ConvertIntoPx(g,this.UM));var j=Math.round(RD3_Glb.ConvertIntoPx(c,this.UM));var e=RD3_Glb.GetCurrentStyle(this.PageBox).backgroundColor;if(e=="transparent"||e=="rgba(0, 0, 0, 0)"){e=RD3_Glb.GetCurrentStyle(this.ParentBook.WebForm.FormBox).backgroundColor}if(this.FixedLeftPageBox){this.FixedLeftPageBox.style.height=this.HeightPx+1+"px";this.FixedLeftPageBox.style.width=f+"px";this.FixedLeftPageBox.style.backgroundColor=e}if(this.FixedTopPageBox){this.FixedTopPageBox.style.width=this.WidthPx+1+"px";this.FixedTopPageBox.style.height=j+"px";this.FixedTopPageBox.style.backgroundColor=e}if(this.FixedTopLeftPageBox){this.FixedTopLeftPageBox.style.width=f+"px";this.FixedTopLeftPageBox.style.height=j+"px";this.FixedTopLeftPageBox.style.backgroundColor=e;this.FixedTopLeftPageBox.style.zIndex=2}if(this.FixedPageBox){this.FixedPageBox.style.left=f+"px";this.FixedPageBox.style.top=j+"px";if(this.ParentBook.ContentBox.clientWidth>f){this.FixedPageBox.style.width=this.ParentBook.ContentBox.clientWidth-f+"px"}if(this.ParentBook.ContentBox.clientHeight>j){this.FixedPageBox.style.height=this.ParentBook.ContentBox.clientHeight-j+"px"}if(RD3_Glb.IsMobile()){this.ParentBook.IDScroll.CalcLimits()}this.PageBox.style.marginLeft=-f+"px";this.PageBox.style.marginTop=-j+"px"}}var h=this.MastroBoxes.length;for(var d=0;d<h;d++){var a=this.MastroBoxes[d];if(this.FixedLeftPageBox&&a.XPos+a.Width<=g&&a.YPos>=c){this.FixedLeftPageBox.appendChild(a.BoxBox)}else{if(this.FixedTopPageBox&&a.YPos+a.Height<=c&&a.XPos>=g){this.FixedTopPageBox.appendChild(a.BoxBox)}else{if(this.FixedTopLeftPageBox&&a.XPos+a.Width<=g&&a.YPos+a.Height<=c){this.FixedTopLeftPageBox.appendChild(a.BoxBox)}else{this.PageBox.appendChild(a.BoxBox)}}}}};BookPage.prototype.OnScroll=function(d){if(!this.FixedLeftPageBox&&!this.FixedTopPageBox){return}var b=0;var a=0;if(RD3_Glb.IsMobile()){b=-d.target[0];a=-d.target[1]}else{var c=null;if(d.srcElement){c=d.srcElement}else{if(d.explicitOriginalTarget){c=d.originalTarget}}if(c){b=c.scrollLeft;a=c.scrollTop}}if(b<0){b=0}if(a<0){a=0}if(this.FixedLeftPageBox){if(RD3_Glb.IsMobile()){RD3_Glb.SetTransitionDuration(this.FixedLeftPageBox,d.time);RD3_Glb.SetTransitionTimingFunction(this.FixedLeftPageBox,d.funct);RD3_Glb.SetTransform(this.FixedLeftPageBox,"translate3d(0px,"+-a+"px, 0px)")}else{this.FixedLeftPageBox.style.top=-a+"px"}}if(this.FixedTopPageBox){if(RD3_Glb.IsMobile()){RD3_Glb.SetTransitionDuration(this.FixedTopPageBox,d.time);RD3_Glb.SetTransitionTimingFunction(this.FixedTopPageBox,d.funct);RD3_Glb.SetTransform(this.FixedTopPageBox,"translate3d("+-b+"px,0px, 0px)")}else{this.FixedTopPageBox.style.left=-b+"px"}}};function BookSection(a){this.Identifier=null;this.XPos=0;this.YPos=0;this.Width=0;this.Height=0;this.VisStyle=0;this.NumCol=1;this.ColSpace=0;this.RecNumber=0;this.Visible=true;this.MastroBox=null;this.Overlay=false;this.ClassName;this.BoxList=new Array();this.ParentPage=a;this.ParentBox=null;this.PageOwner=true;this.Realized=false;this.SectionBox=null}BookSection.prototype.LoadFromXml=function(f){this.LoadProperties(f);var c=f.childNodes;var g=c.length;for(var e=0;e<g;e++){var b=c.item(e);var a=b.nodeName;switch(a){case"box":var d=new BookBox(this.ParentPage);d.ParentSect=this;d.Alternate=(this.RecNumber%2==0);d.LoadFromXml(b);this.BoxList[this.BoxList.length]=d;break}}};BookSection.prototype.ChangeProperties=function(a){this.LoadProperties(a)};BookSection.prototype.LoadProperties=function(e){var b=e.attributes;var f=this.ParentPage.UM=="mm";var h=b.length;for(var d=0;d<h;d++){var g=b.item(d);var c=g.nodeName;var a=g.nodeValue;switch(c){case"xp":this.SetXPos((f)?parseInt(a)/100:parseInt(a)/1000);break;case"yp":this.SetYPos((f)?parseInt(a)/100:parseInt(a)/1000);break;case"wid":this.SetWidth((f)?parseInt(a)/100:parseInt(a)/1000);break;case"hei":this.SetHeight((f)?parseInt(a)/100:parseInt(a)/1000);break;case"sty":this.SetVisStyle(a);break;case"vis":this.SetVisible(a=="1");break;case"col":this.SetNumCol(parseInt(a));break;case"csp":this.SetColSpace(parseInt(a));break;case"mas":this.SetMastroBox(a);break;case"rec":this.SetRecNumber(parseInt(a));break;case"ovr":this.SetOverlay(a=="1");break;case"cln":this.SetClassName(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};BookSection.prototype.SetXPos=function(a){if(a!=undefined){if(this.XPos!=a){this.ParentPage.ParentBook.RecalcLayout=true}this.XPos=a}};BookSection.prototype.SetYPos=function(a){if(a!=undefined){if(this.YPos!=a){this.ParentPage.ParentBook.RecalcLayout=true}this.YPos=a}};BookSection.prototype.SetWidth=function(a){if(a!=undefined){if(this.Width!=a){this.ParentPage.ParentBook.RecalcLayout=true}this.Width=a}};BookSection.prototype.SetHeight=function(a){if(a!=undefined){if(this.Height!=a){this.ParentPage.ParentBook.RecalcLayout=true}this.Height=a}};BookSection.prototype.SetVisStyle=function(a){if(a!=undefined){if(a.Identifier){this.VisStyle=a}else{this.VisStyle=RD3_DesktopManager.ObjectMap["vis:"+a]}}if(this.Realized&&this.PageOwner){this.VisStyle.ApplyStyle(this.SectionBox,this.RecNumber%2==0)}};BookSection.prototype.SetVisible=function(d){if(d!=undefined){this.Visible=d}if(this.Realized){if(this.PageOwner){this.SectionBox.style.display=(this.Visible?"":"none")}else{var e=this.BoxList.length;for(var c=0;c<e;c++){var a=this.BoxList[c];if(a.Visible!=this.Visible){a.BoxBox.style.display=(this.Visible?"":"none")}}}}};BookSection.prototype.SetNumCol=function(a){if(a!=undefined){this.NumCol=a}};BookSection.prototype.SetColSpace=function(a){if(a!=undefined){this.ColSpace=a}};BookSection.prototype.SetMastroBox=function(b){var a=this.MastroBox;if(b!=undefined){this.MastroBox=RD3_DesktopManager.ObjectMap[b]}if(this.MastroBox){this.MastroBox.MastroWithSections=true}if(this.Realized&&a!=this.MastroBox&&this.MastroBox&&this.MastroBox.Realized){this.MastroBox.BoxBox.appendChild(this.SectionBox)}};BookSection.prototype.SetRecNumber=function(j){var k=this.RecNumber;if(j!=undefined){this.RecNumber=j}if(this.Realized){var h=-1;var a=-1;var e=-1;var f=(this.ParentBox?this.ParentBox.SubSections:this.ParentPage.Sections);var c=f.length;for(var d=0;d<c;d++){if(f[d].RecNumber==this.RecNumber-1){h=d}if(f[d].RecNumber==1){a=d}if(f[d]==this){e=d}}if(h>=0){f.splice(e,1);if(e<h){h--}f.splice(h+1,0,this)}else{f.splice(e,1);f.splice(a,0,this)}if(this.Overlay){if(this.PageOwner){this.SectionBox.style.zIndex=0}var c=this.BoxList.length;for(var d=0;d<c;d++){this.BoxList[d].BoxBox.style.zIndex=this.RecNumber*1000+d}}if(this.PageOwner){if((k%2)!=(this.RecNumber%2)){this.VisStyle.ApplyStyle(this.SectionBox,this.RecNumber%2==0);for(var d=0;d<c;d++){var g=this.BoxList[d];g.Alternate=(this.RecNumber%2==0);g.SetVisStyle()}}}}};BookSection.prototype.SetOverlay=function(a){if(a!=undefined){this.Overlay=a}};BookSection.prototype.SetClassName=function(b){var a=this.ClassName;if(b){this.ClassName=b}if(this.Realized&&(a!=this.ClassName||!b)){if(a!=""){RD3_Glb.RemoveClass2(this.SectionBox,a)}if(this.ClassName&&this.ClassName!=""){RD3_Glb.AddClass(this.SectionBox,this.ClassName)}}};BookSection.prototype.Realize=function(b,c){if(this.PageOwner){this.SectionBox=document.createElement("div");this.SectionBox.setAttribute("id",this.Identifier);this.SectionBox.className="book-section"}var d=this.BoxList.length;for(var a=0;a<d;a++){this.BoxList[a].Realize(this.SectionBox)}this.Realized=true;this.SetXPos();this.SetYPos();this.SetWidth();this.SetHeight();this.SetVisStyle();this.SetVisible();this.SetClassName();if(this.PageOwner){this.SectionBox.style.display="none"}if(this.PageOwner){if(this.MastroBox){this.MastroBox.BoxBox.appendChild(this.SectionBox)}else{if(c){b.insertBefore(this.SectionBox,c)}else{b.appendChild(this.SectionBox)}}}};BookSection.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);var b=this.BoxList.length;for(var a=0;a<b;a++){this.BoxList[a].Unrealize()}if(this.PageOwner&&this.SectionBox&&this.SectionBox.parentNode){this.SectionBox.parentNode.removeChild(this.SectionBox)}};BookSection.prototype.UnrealizeDelayed=function(){var a=RD3_DesktopManager.ObjectMap[""+this.Identifier];if(a==this){RD3_DesktopManager.ObjectMap.remove(this.Identifier)}var c=this.BoxList.length;for(var b=0;b<c;b++){this.BoxList[b].UnrealizeDelayed()}if(this.PageOwner&&this.SectionBox){this.SectionBox.parentNode.removeChild(this.SectionBox)}};BookSection.prototype.AdaptSect=function(){if(this.Realized&&this.PageOwner){var j=new Rect();var g=0;var e=0;var a=this.MastroBox;while(a){g+=a.XPos;e+=a.YPos;if(a instanceof BookSection){a=a.MastroBox}else{a=a.ParentSect}}j.x=Math.round(RD3_Glb.ConvertIntoPx(this.XPos+g,this.ParentPage.UM))-Math.round(RD3_Glb.ConvertIntoPx(g,this.ParentPage.UM));j.y=Math.round(RD3_Glb.ConvertIntoPx(this.YPos+e,this.ParentPage.UM))-Math.round(RD3_Glb.ConvertIntoPx(e,this.ParentPage.UM));j.w=Math.round(RD3_Glb.ConvertIntoPx(this.XPos+g+this.Width,this.ParentPage.UM))-j.x-Math.round(RD3_Glb.ConvertIntoPx(g,this.ParentPage.UM));j.h=Math.round(RD3_Glb.ConvertIntoPx(this.YPos+e+this.Height,this.ParentPage.UM))-j.y-Math.round(RD3_Glb.ConvertIntoPx(e,this.ParentPage.UM));this.XAbsPx=Math.round(RD3_Glb.ConvertIntoPx(this.XPos+g,this.ParentPage.UM));this.YAbsPx=Math.round(RD3_Glb.ConvertIntoPx(this.YPos+e,this.ParentPage.UM));var i=this.VisStyle.GetBookOffset(true);var h=this.VisStyle.GetBookOffset();h.x-=i.x;h.y-=i.y;h.w-=i.w;h.h-=i.h;if(this.MastroBox){var f=this.MastroBox.VisStyle;if(f){var b=f.GetBookOffset(true);var d=false;var c=false;if(b.x>0&&i.x!=0&&j.x==0){j.x-=b.x;if(this.NumCol!=1){this.MastroBox.MovedX=b.x}d=true}if(b.w==0&&i.w!=0&&j.x+j.w>=this.MastroBox.WPx){this.MastroBox.StretchW=Math.max((!this.MastroBox.StretchW?0:this.MastroBox.StretchW),i.w);this.ParentPage.ParentBook.ParGrowWidth(this.MastroBox.ParentSection,this.XAbsPx+j.x+j.w,i.w)}if(b.y>0&&i.y!=0&&j.y==0){j.y-=b.y;if(this.NumCol!=1){this.MastroBox.MovedY=b.y}c=true}if(b.h==0&&i.h!=0&&j.y+j.h>=this.MastroBox.HPx){this.MastroBox.StretchH=Math.max((!this.MastroBox.StretchH?0:this.MastroBox.StretchH),i.h);this.ParentPage.ParentBook.ParGrowHeight(this.MastroBox.ParentSection,this.YAbsPx+j.y+j.h,i.h)}if(this.NumCol!=1){if(!d&&this.MastroBox.MovedX){j.x-=this.MastroBox.MovedX}if(!c&&this.MastroBox.MovedY){j.y-=this.MastroBox.MovedY}}}}j.w-=i.x+(h.x+h.w);j.h-=i.y+(h.y+h.h);if(j.w<0){j.w=0}if(j.h<0){j.h=0}this.SectionBox.style.left=j.x+"px";this.SectionBox.style.top=j.y+"px";this.SectionBox.style.width=j.w+"px";this.SectionBox.style.height=j.h+"px";this.SectionBox.style.display=(this.Visible?"":"none");this.XPx=j.x;this.YPx=j.y;this.WPx=j.w;this.HPx=j.h}};BookSection.prototype.AdaptLayout=function(){if(!this.Realized){return}this.AdaptSect();var c=this.BoxList.length;for(var a=0;a<c;a++){this.BoxList[a].AdaptLayout()}var b=this;if(!b.PageOwner){b=b.OwnerSection}if(b.StretchW||b.StretchH){if(b.StretchW){b.WPx=Math.round(b.WPx+b.StretchW);b.SectionBox.style.width=b.WPx+"px";b.StretchW=0}if(b.StretchH){b.HPx=Math.round(b.HPx+b.StretchH);b.SectionBox.style.height=b.HPx+"px";b.StretchH=0}}};BookSection.prototype.AfterProcessResponse=function(){var b=this.BoxList.length;for(var a=0;a<b;a++){this.BoxList[a].AfterProcessResponse()}};BookSection.prototype.ComputeDropList=function(c,a){if(!this.Realized){return}var d=this.BoxList.length;for(var b=0;b<d;b++){this.BoxList[b].ComputeDropList(c,a)}};BookSection.prototype.InsertChild=function(d){var g=d.getAttribute("id");if(RD3_DesktopManager.ObjectMap[g]){return}var e=d.getAttribute("previd");if(g.substring(0,3)=="box"){var b=new BookBox(this.ParentPage);b.ParentSect=this;b.Alternate=(this.RecNumber%2==0);b.LoadProperties(d);var c=RD3_Glb.FindObjById(this.BoxList,e);if(c!=-1&&c<this.BoxList.length){if(this.Realized){b.Realize(this.SectionBox,this.BoxList[c].BoxBox)}this.BoxList.splice(c,0,b)}else{if(this.Realized){b.Realize(this.SectionBox)}this.BoxList[this.BoxList.length]=b}if(this.Overlay&&this.Realized){var f=this.BoxList.length;for(var a=0;a<f;a++){this.BoxList[a].BoxBox.style.zIndex=this.RecNumber*1000+a}}}this.ParentPage.ParentBook.RecalcLayout=true};BookSection.prototype.OnDeleteObject=function(b){var h=(this.ParentBox?this.ParentBox.SubSections:this.ParentPage.Sections);var a=h.length;if(h&&this.Overlay&&this.PageOwner){for(var f=0;f<a;f++){if(h[f]==this){break}}var g=null;for(f=f+1;f<a&&!g;f++){if(h[f].MastroBox==this.MastroBox){g=h[f]}}if(g&&g.Overlay){this.PageOwner=false;this.OwnerSection=g;g.PageOwner=true;g.SectionBox=this.SectionBox;g.SectionBox.setAttribute("id",g.Identifier)}}if(h&&!this.Overlay){for(var f=0;f<a;f++){if(h[f]==this){break}}var l=null;var g=null;for(var e=f+1;e<a&&!g;e++){if(h[e].MastroBox==this.MastroBox){g=h[e]}}for(var e=f-1;e>=0&&!l;e--){if(h[e].MastroBox==this.MastroBox){l=h[e]}}if(l&&g&&l.Overlay&&g.Overlay&&g.PageOwner){g.PageOwner=false;g.OwnerSection=(l.PageOwner?l:l.OwnerSection);for(var d=0;d<a;d++){if(h[d].OwnerSection==g){h[d].OwnerSection=g.OwnerSection}}while(g.SectionBox.childNodes.length){var k=g.SectionBox.childNodes[0];g.OwnerSection.SectionBox.appendChild(k)}g.SectionBox.parentNode.removeChild(g.SectionBox);g.SectionBox=g.OwnerSection.SectionBox}}if(h){for(var f=0;f<a;f++){if(h[f]==this){h.splice(f,1);break}}}};function BookSpan(a){this.Identifier=null;this.Text="";this.Value="";this.Tooltip="";this.VisStyle=null;this.DataType=5;this.MaxLen=255;this.Scale=0;this.Visible=true;this.Enabled=false;this.Stretch=RD3_Glb.STRTC_AUTO;this.MimeType="";this.HasImage=false;this.IconImage="";this.ValueList=null;this.ValueListIdx=-1;this.BackColor="";this.ForeColor="";this.FontMod="";this.Mask="";this.Watermark="";this.ClassName;this.ParentBox=a;this.ControlType=RD3_Glb.VISCTRL_AUTO;this.Alternate=false;this.ChgEventDef=RD3_Glb.EVENT_DEFERRED;this.Realized=false;this.Realizing=false;this.SpanObj=null;this.SpanImg=null;this.SpanTxt=null;this.SpanCal=null}BookSpan.prototype.LoadFromXml=function(e){this.LoadProperties(e);var c=e.childNodes;var f=c.length;for(var d=0;d<f;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"val":this.ValueList=new ValueList();this.ValueList.LoadFromXml(b);if(this.Realized){this.RecreateDOM()}break}}};BookSpan.prototype.ChangeProperties=function(a){this.LoadFromXml(a)};BookSpan.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"txt":this.SetText(a);break;case"val":this.SetValue(a);break;case"tip":this.SetTooltip(a);break;case"sty":this.SetVisStyle(a);break;case"dat":this.SetDataType(parseInt(a));break;case"max":this.SetMaxLen(parseInt(a));break;case"sca":this.SetScale(parseInt(a));break;case"vis":this.SetVisible(a=="1");break;case"ena":this.SetEnabled(a=="1");break;case"str":this.SetStretch(parseInt(a));break;case"mim":this.SetMime(a);break;case"him":this.SetHasImage(a=="1");break;case"img":this.SetIconImage(a);break;case"idx":this.SetVLIndex(parseInt(a));break;case"bkc":this.SetBackColor(a);break;case"frc":this.SetForeColor(a);break;case"ftm":this.SetFontMod(a);break;case"msk":this.SetMask(a);break;case"wtk":this.SetWatermark(a);break;case"cln":this.SetClassName(a);break;case"chg":this.ChgEventDef=parseInt(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};BookSpan.prototype.SetText=function(a){if(a!=undefined){this.Text=a}if(this.Realized){if(!this.HasImage&&this.MimeType==""){if(this.ControlType==RD3_Glb.VISCTRL_COMBO){if(!this.HasFocus){this.SetWatermark()}if(!this.HasWatermark){this.SpanObj.SetText(this.Text,false)}}else{if(this.ControlType==RD3_Glb.VISCTRL_EDIT){if(this.Enabled){if(!this.HasFocus){this.SetWatermark()}if(!this.HasWatermark){this.SpanObj.value=this.Text}}else{if(this.Text.indexOf("<")!=-1||this.Text.indexOf("&")!=-1){this.SpanObj.innerHTML=this.Text}else{if(this.SpanObj.innerText!==undefined){this.SpanObj.innerText=this.Text}else{this.SpanObj.textContent=this.Text}}if(this.SpanImg){this.SpanObj.insertBefore(this.SpanImg,this.SpanObj.firstChild)}}}else{if(this.ControlType==RD3_Glb.VISCTRL_BUTTON){this.SpanObj.value=this.Text}}}}else{if(this.HasImage&&this.MimeType!=""){this.SetMime()}}}};BookSpan.prototype.SetValue=function(a){if(a!=undefined){this.Value=a}if(this.Realized){switch(this.ControlType){case RD3_Glb.VISCTRL_COMBO:this.SpanObj.SetText(this.Value,true);break;case RD3_Glb.VISCTRL_CHECK:if(this.Enabled||RD3_Glb.IsMobile()){this.ValueList.SetCheck(this.SpanObj,this.Value)}else{this.SpanObj.checked=(this.ValueListIdx==0)}break;case RD3_Glb.VISCTRL_OPTION:this.ValueList.SetOption(this.ParentBox.BoxBox,this.Value);break}}};BookSpan.prototype.SetVLIndex=function(a){if(a!=undefined){this.ValueListIdx=a}if(this.Realized){this.SetIconImage()}};BookSpan.prototype.SetTooltip=function(a){if(a!=undefined){this.Tooltip=a}if(this.Realized){if(this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.SetTooltip(this.Tooltip)}else{if(this.SpanObj){RD3_TooltipManager.SetObjTitle(this.SpanObj,this.Tooltip)}}}};BookSpan.prototype.SetVisStyle=function(a){if(a!=undefined){if(a==null||a.Identifier){this.VisStyle=a}else{this.VisStyle=RD3_DesktopManager.ObjectMap["vis:"+a]}}if(this.Realized){if(a!=undefined){this.ApplyVisualStyle()}}};BookSpan.prototype.SetMaxLen=function(a){if(a!=undefined){this.MaxLen=a}if(this.Realized){if(this.Enabled&&this.ControlType==RD3_Glb.VISCTRL_EDIT){this.SpanObj.maxlength=this.MaxLen}}};BookSpan.prototype.SetScale=function(a){if(a!=undefined){this.Scale=a}};BookSpan.prototype.SetDataType=function(a){if(a!=undefined){this.DataType=a}};BookSpan.prototype.SetVisible=function(a){if(a!=undefined){this.Visible=a}if(this.Realized){if(this.SpanObj){if(this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.SetVisible(this.Visible)}else{this.SpanObj.style.display=(this.Visible?"":"none")}}}};BookSpan.prototype.SetEnabled=function(b){var a=this.Enabled;if(b!=undefined){this.Enabled=b}if(this.Realized&&a!=this.Enabled){this.RecreateDOM()}};BookSpan.prototype.SetHasImage=function(b){if(b!=undefined){this.HasImage=b}if(this.Realized){if(this.HasImage){if(this.SpanImg==null){this.SpanImg=document.createElement("img");this.SpanImg.id=this.Identifier+":img";this.SpanImg.className="book-span-img";this.SpanImg.src=RD3_Glb.GetImgSrc(this.Text);this.SpanObj.appendChild(this.SpanImg);var a=this;if(!RD3_Glb.IsIE(10,false)){this.SpanImg.onload=function(c){a.OnReadyStateChange(c)}}else{this.SpanImg.onreadystatechange=function(c){a.OnReadyStateChange(c)}}if(this.SpanTxt){this.SpanTxt.nodeValue=""}}else{this.SpanImg.src=RD3_Glb.GetImgSrc(this.Text)}this.SpanObj.style.margin="0px"}else{if(this.SpanObj&&this.ControlType!=RD3_Glb.VISCTRL_COMBO){this.SpanObj.style.margin=""}}}};BookSpan.prototype.SetIconImage=function(a){if(a!=undefined){this.IconImage=a}if(this.Realized&&this.ControlType==RD3_Glb.VISCTRL_EDIT&&this.DataType!=10&&this.GetVS().ShowImage()){if(this.ValueList&&this.ValueListIdx!=-1){this.IconImage=this.ValueList.ItemList[this.ValueListIdx].Image}if(this.SpanImg==null&&this.IconImage!=""){this.SpanImg=document.createElement("img");this.SpanImg.id=this.Identifier+":img";this.SpanImg.className="book-span-img";this.SpanObj.appendChild(this.SpanImg);this.Stretch=RD3_Glb.STRTC_NONE}if(this.SpanImg){if(this.IconImage!=""){this.SpanImg.src=RD3_Glb.GetImgSrc("images/"+this.IconImage);this.SpanImg.style.display=""}else{this.SpanImg.style.display="none"}}}};BookSpan.prototype.SetStretch=function(h){if(h!=undefined){this.Stretch=h}if(this.Realized&&this.SpanImg){var i=this.SpanImg.style;switch(this.Stretch){case RD3_Glb.STRTC_ENLARGE:case RD3_Glb.STRTC_CROP:i.width="auto";i.height="auto";var f=this.SpanImg.width;var b=this.SpanImg.height;var g=this.ParentBox.BoxBox.clientWidth;var e=this.ParentBox.BoxBox.clientHeight;if(f&&b&&g&&e){var d=b/f;var c=g*d;var a=e/d;if(c>e){if(this.Stretch==RD3_Glb.STRTC_ENLARGE){i.width=a+"px";i.height=e+"px";i.top="0px";i.left=(g-a)/2+"px"}else{if(this.Stretch==RD3_Glb.STRTC_CROP){i.width=g+"px";i.height=c+"px";i.top=(e-c)/2+"px";i.left="0px"}}}else{if(this.Stretch==RD3_Glb.STRTC_ENLARGE){i.width=g+"px";i.height=c+"px";i.top=(e-c)/2+"px";i.left="0px"}else{if(this.Stretch==RD3_Glb.STRTC_CROP){i.width=a+"px";i.height=e+"px";i.top="0px";i.left=(g-a)/2+"px"}}}i.position="absolute"}break;case RD3_Glb.STRTC_FILL:i.left="0px";i.top="0px";i.width=this.ParentBox.Width+this.ParentBox.ParentPage.UM;i.height=this.ParentBox.Height+this.ParentBox.ParentPage.UM;i.position="";break;case RD3_Glb.STRTC_AUTO:case RD3_Glb.STRTC_NONE:i.left="0px";i.top="0px";i.width="";i.height="";i.position="";break}}};BookSpan.prototype.SetMime=function(a){if(a!=undefined){this.MimeType=a}if(this.Realized){if(this.MimeType!=""){if(this.MimeType.indexOf("image")!=-1){this.SetHasImage(true)}else{this.SpanTxt=document.createTextNode(RD3_ServerParams.ShowBlob.replace("(|1)",""));this.SpanObj.appendChild(this.SpanTxt);this.SpanObj.className="book-span-file";this.SpanObj.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnFileClick', ev)")}}}};BookSpan.prototype.SetBackColor=function(a){if(a!=undefined){this.BackColor=a}if(this.Realized){if(a!=undefined){this.ApplyVisualStyle()}}};BookSpan.prototype.SetForeColor=function(a){if(a!=undefined){this.ForeColor=a}if(this.Realized){if(a!=undefined){this.ApplyVisualStyle()}}};BookSpan.prototype.SetFontMod=function(a){if(a!=undefined){this.FontMod=a}if(this.Realized){if(a!=undefined){this.ApplyVisualStyle()}}};BookSpan.prototype.SetMask=function(a){if(a!=undefined){this.Mask=a}if(this.Realized){if(a!=undefined){this.ApplyVisualStyle()}}};BookSpan.prototype.SetClassName=function(b){var a=this.ClassName;if(b){this.ClassName=b}if(this.Realized&&(a!=this.ClassName||!b)){if(this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.SetClassName(this.ClassName)}else{if(a!=""){RD3_Glb.RemoveClass2(this.SpanObj,a)}if(this.ClassName&&this.ClassName!=""){RD3_Glb.AddClass(this.SpanObj,this.ClassName)}}}};BookSpan.prototype.SetWatermark=function(a){if(a!=undefined){this.Watermark=a}if(this.Realized&&this.Enabled){this.ApplyWatermark()}};BookSpan.prototype.ApplyWatermark=function(){if(this.Watermark==""||this.Text!=""){this.RemoveWatermark();return}if(this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.SetWatermark();this.SpanObj.SetText(this.Watermark)}if(this.ControlType==RD3_Glb.VISCTRL_EDIT){this.SpanObj.value=this.Watermark;RD3_Glb.AddClass(this.SpanObj,"panel-field-value-watermark")}this.HasWatermark=true};BookSpan.prototype.RemoveWatermark=function(){if(!this.HasWatermark){return}if(this.ControlType==RD3_Glb.VISCTRL_EDIT){this.SpanObj.value="";RD3_Glb.RemoveClass(this.SpanObj,"panel-field-value-watermark")}if(this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.RemoveWatermark();this.SpanObj.SetText(this.Text,false)}this.HasWatermark=false};BookSpan.prototype.Realize=function(l){var r=(this.VisStyle==null)?this.ParentBox.VisStyle:this.VisStyle;var u=r.GetBorders(1);this.ControlType=r.GetContrType();if(this.ControlType==RD3_Glb.VISCTRL_AUTO){if(this.ValueList&&this.Enabled){this.ControlType=RD3_Glb.VISCTRL_COMBO}else{this.ControlType=RD3_Glb.VISCTRL_EDIT}}if(!this.Enabled&&this.ControlType==RD3_Glb.VISCTRL_OPTION){this.ControlType=RD3_Glb.VISCTRL_EDIT}var f=(this.ParentBox.ParentPage.UM=="mm"?25.4/96:1/96);var n=false;switch(this.ControlType){case RD3_Glb.VISCTRL_EDIT:if(this.Enabled){if(this.ParentBox.NumRows>1){this.SpanObj=document.createElement("textarea");this.SpanObj.className="book-span-textarea"}else{this.SpanObj=document.createElement("input");this.SpanObj.type=r.IsPassword()?"password":"text";this.SpanObj.className="book-span-input"}this.SpanObj.style.left=(this.ParentBox.Wants4pxPadding()?"4px":"");if(!RD3_Glb.IsIE(10,false)){var j=function(w){RD3_KBManager.IDRO_GetFocus(w)};var k=function(w){RD3_KBManager.IDRO_LostFocus(w)};this.SpanObj.onfocus=j;this.SpanObj.onblur=k}var p=0;var e=0;var h=0;if(u>=2&&u<=8){if(this.ParentBox.ParentPage.UM=="mm"){p=25.4/96}else{p=1/96}if(RD3_Glb.IsIE()||RD3_Glb.IsSafari()){e=p+p;h=p+p}else{if(RD3_Glb.IsChrome()){e=0;h=p+p}}}else{e=1;h=0.5}var i=this;if((this.DataType==6||this.DataType==8)&&!RD3_Glb.IsMobile()){this.SpanCal=document.createElement("img");this.SpanCal.className="book-span-calendar";this.SpanCal.src=RD3_Glb.GetImgSrc("images/aeda.gif");this.SpanCal.onclick=function(w){i.OnCalendarClick(w)};var b=this.ParentBox.Width-e;if(this.ParentBox.Wants4pxPadding()){b-=(4*f)}if(b>(15*f)){b-=(15*f)}this.SpanObj.style.width=(b)+this.ParentBox.ParentPage.UM;this.SpanObj.style.height=(this.ParentBox.Height-h)+this.ParentBox.ParentPage.UM;var g=this.ParentBox.VisStyle.GetAlignment(1);if(this.ParentBox.Alignment!=1){g=this.ParentBox.Alignment}if(g==4){this.SpanObj.style.left="15px";this.SpanCal.style.left="0px"}else{this.SpanCal.style.left=(b)+this.ParentBox.ParentPage.UM}}else{var b=this.ParentBox.Width-e;var v=this.ParentBox.Height-h;if(this.ParentBox.Wants4pxPadding()){b-=(4*f)}this.SpanObj.style.width=b+this.ParentBox.ParentPage.UM;this.SpanObj.style.height=v+this.ParentBox.ParentPage.UM}this.SpanObj.onchange=function(w){i.OnChange(w)};this.SpanObj.onkeypress=function(w){i.OnKeyPress(w)};n=true}break;case RD3_Glb.VISCTRL_COMBO:this.SpanObj=new IDCombo(this);this.SpanObj.RightAlign=this.IsRightAligned();this.SpanObj.MultiSel=false;this.SpanObj.UsePopover=true;n=true;break;case RD3_Glb.VISCTRL_CHECK:if(RD3_Glb.IsMobile()){this.SpanObj=document.createElement("div");this.SpanObj.checked=true;if(RD3_Glb.IsQuadro()){var t=this.ValueList;var o=document.createElement("div");o.className="radio-int-div";var d=document.createElement("span");d.className="radio-int-s1";d.innerText=(t.ItemList.length>0)?t.ItemList[0].Name:"ON";var c=document.createElement("span");c.className="radio-int-s2";var a=document.createElement("span");a.className="radio-int-s3";a.innerText=(t.ItemList.length>1)?t.ItemList[1].Name:"OFF";o.appendChild(d);o.appendChild(c);o.appendChild(a);this.SpanObj.appendChild(o)}else{var m=document.createElement("span");this.SpanObj.appendChild(m)}if(!this.Enabled){this.ValueList.SetCheck(this.SpanObj,this.Value);m.style.cursor="default"}}else{this.SpanObj=document.createElement("input");this.SpanObj.type="checkbox"}this.SpanObj.className="book-span-check";this.SpanObj.disabled=!this.Enabled;var i=this;this.SpanObj.onclick=function(w){i.OnChange(w)};this.SpanObj.onkeypress=function(w){i.OnKeyPress(w)};n=true;break;case RD3_Glb.VISCTRL_OPTION:var s=RD3_Glb.IsMobile()?RD3_Glb.ConvertIntoPx(this.ParentBox.Height,this.ParentBox.ParentPage.UM)>84:this.ParentBox.NumRows>1;this.ValueList.RealizeOption(this,l,this.Value,s,false,this.Enabled);n=true;break;case RD3_Glb.VISCTRL_BUTTON:this.SpanObj=document.createElement("input");this.SpanObj.type="button";this.SpanObj.className="book-span-button";this.SpanObj.value=this.Text;this.SpanObj.disabled=!this.Enabled;var b=this.ParentBox.Width;var v=this.ParentBox.Height;this.SpanObj.style.width=b+this.ParentBox.ParentPage.UM;this.SpanObj.style.height=v+this.ParentBox.ParentPage.UM;n=true;break}if(!n){this.SpanObj=document.createElement("span");this.SpanObj.className="book-span";if(this.ParentBox.CanClick){this.SpanObj.style.cursor="pointer"}if(u>=2&&u<=8){this.SpanObj.style.margin="1px"}if(this.ParentBox.NumRows==1){this.SpanObj.style.whiteSpace="pre"}}if(this.SpanObj){if(this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.Realize(l,"book-span-combo");this.SpanObj.SetID(this.Identifier);this.SpanObj.SetEnabled(this.Enabled);this.SpanObj.SetShowValue(false);this.SpanObj.AssignValueList(this.ValueList,true);this.SpanObj.SetWidth(this.ParentBox.Width/f);this.SpanObj.SetHeight(this.ParentBox.Height/f)}else{this.SpanObj.setAttribute("id",this.Identifier);if((this.DataType==6||this.DataType==8)&&this.Enabled&&!RD3_Glb.IsMobile()){var q=r.GetAlignment();if(this.ParentBox.Alignment!=1){q=this.ParentBox.Alignment}if(q==4){l.appendChild(this.SpanCal);l.appendChild(this.SpanObj)}else{l.appendChild(this.SpanObj);l.appendChild(this.SpanCal)}}else{l.appendChild(this.SpanObj)}}}if(this.SpanObj&&this.ControlType==RD3_Glb.VISCTRL_CHECK){if(this.Enabled&&this.ValueList){this.ValueList.SetCheck(this.SpanObj,this.Value)}else{this.SpanObj.checked=(this.ValueListIdx==0)}}this.Realized=true;this.Realizing=true;this.SetEnabled();this.SetMime();this.SetIconImage();this.SetText();this.SetTooltip();this.SetDataType();this.SetMaxLen();this.SetScale();this.SetVisStyle();this.SetVisible();this.SetHasImage();this.SetStretch();this.SetBackColor();this.SetForeColor();this.SetFontMod();this.ApplyVisualStyle();this.SetClassName();if(RD3_Glb.IsMobile7()&&this.SpanObj&&this.ControlType==RD3_Glb.VISCTRL_CHECK&&this.Enabled&&this.ValueList){this.ValueList.SetCheck(this.SpanObj,this.Value)}this.Realizing=false};BookSpan.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);if(this.SpanObj){if(this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.Unrealize()}else{if(this.SpanObj.parentNode){this.SpanObj.parentNode.removeChild(this.SpanObj)}}}this.SpanObj=null;this.SpanImg=null;this.SpanTxt=null;this.Realized=false};BookSpan.prototype.UnrealizeDelayed=function(){var a=RD3_DesktopManager.ObjectMap[""+this.Identifier];if(a==this){RD3_DesktopManager.ObjectMap.remove(this.Identifier)}if(this.SpanObj){if(this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.Unrealize()}else{if(this.SpanObj.parentNode){this.SpanObj.parentNode.removeChild(this.SpanObj)}}}this.SpanObj=null;this.SpanImg=null;this.SpanTxt=null;this.Realized=false};BookSpan.prototype.AdaptLayout=function(){if(!this.Realized){return}if(this.SpanImg){this.SetStretch()}};BookSpan.prototype.IsDraggable=function(){return this.ParentBox.IsDraggable()};BookSpan.prototype.IsTransformable=function(){return this.ParentBox.IsTransformable()};BookSpan.prototype.OnDrop=function(a){return this.ParentBox.OnDrop(a)};BookSpan.prototype.DragObj=function(){return this.ParentBox};BookSpan.prototype.OnChange=function(a){if(!this.HasWatermark){this.SendChanges(a,0)}};BookSpan.prototype.OnComboChange=function(){if(!this.HasWatermark){this.SendChanges(this.SpanObj,0)}};BookSpan.prototype.OnKeyPress=function(a){if(window.event&&a==undefined){a=window.event}if(a.keyCode==13&&(this.ParentBox.NumRows==1||this.ControlType!=RD3_Glb.VISCTRL_EDIT)){this.SendChanges(a,RD3_Glb.EVENT_IMMEDIATE)}};BookSpan.prototype.SendChanges=function(e,a){if(this.Visible&&this.Enabled&&this.Realized){var c="";if(this.SpanObj){if(this.ControlType==RD3_Glb.VISCTRL_COMBO){c=this.SpanObj.GetComboValue()}else{c=this.SpanObj.value}}var b=false;switch(this.ControlType){case RD3_Glb.VISCTRL_EDIT:b=(c!=this.Text);this.Text=c;if(this.GetVS().ComputeMaskType(this.DataType)=="N"){if(RD3_DesktopManager.WebEntryPoint.UseDecimalDot){c=c.replace(/,/g,"")}else{c=c.replace(/\./g,"")}}break;case RD3_Glb.VISCTRL_COMBO:b=(c!=this.Value);this.Value=c;break;case RD3_Glb.VISCTRL_CHECK:c=this.ValueList.ItemList[(this.SpanObj.checked)?0:1].Value;b=(c!=this.Value);this.Value=c;break;case RD3_Glb.VISCTRL_OPTION:c=this.ValueList.GetOption(this.ParentBox.BoxBox);b=(c!=this.Value);this.Value=c;break}if(b){var d=new IDEvent("chg",this.Identifier,e,this.ChgEventDef|a,"",c)}else{if(a==RD3_Glb.EVENT_IMMEDIATE){RD3_DesktopManager.SendEvents()}}}};BookSpan.prototype.GetVS=function(){return(this.VisStyle)?this.VisStyle:this.ParentBox.VisStyle};BookSpan.prototype.OnFileClick=function(d){var c=window.event?window.event:d;var b=this.Text;if(b&&b!=""){b=b.replace("&amp;","&");if(c.shiftKey||c.ctrlKey){RD3_DesktopManager.OpenDocument(b,"","")}else{var a=new PopupPreview(b,RD3_ServerParams.VisualizzaDocumento);a.Open()}}};BookSpan.prototype.IsRightAligned=function(){var a=this.ParentBox.VisStyle.GetAlignment(1);if(this.ParentBox.Alignment!=1){a=this.ParentBox.Alignment}if(a!=1&&a!=4){return false}if(!RD3_Glb.IsNumericObject(this.DataType)){return false}if(this.ValueList){return false}return true};BookSpan.prototype.GotFocus=function(b,c){if(this.Enabled){var a=RD3_DesktopManager.WebEntryPoint.FocusBox;var d=null;if(a&&a.parentNode){d=a.parentNode;a.parentNode.removeChild(a)}if(this.ControlType!=RD3_Glb.VISCTRL_BUTTON){var e=this.GetVS();while(b&&b.tagName!="DIV"){b=b.parentNode}a.style.width=(b.clientWidth-2)+"px";a.style.height=(b.clientHeight-2)+"px";a.style.left="0px";a.style.top="0px";a.style.backgroundColor=e.GetColor(10);a.style.borderColor=e.GetColor(11);b.appendChild(a);RD3_DesktopManager.WebEntryPoint.ResetHideFocusBox();if(e.IsPassword()&&(d!=b)){this.SpanObj.value=""}this.RemoveWatermark();this.HasFocus=true}}};BookSpan.prototype.LostFocus=function(a,b){if(!this.Enabled){return}if(this.ControlType==RD3_Glb.VISCTRL_COMBO&&this.SpanObj.IsOpen){return}if(this.GetVS().IsPassword()&&this.SpanObj&&this.SpanObj.value.length==0){this.SpanObj.value=this.Text}if(this.ControlType==RD3_Glb.VISCTRL_EDIT&&this.Watermark!=""){this.OnChange(b)}this.ApplyWatermark();this.HasFocus=false};BookSpan.prototype.OnCalendarClick=function(c){var b=(window.event)?window.event.srcElement:c.explicitOriginalTarget;var d=b.parentNode.childNodes[0];if(!this.Enabled){return true}var a=this.DataType;if(a==6||a==7||a==8){ShowCalendar(d,d.getAttribute("idmask"));RD3_DesktopManager.WebEntryPoint.CalPopup.setAttribute("idjustopened","1");return false}return true};BookSpan.prototype.OnReadyStateChange=function(){if(!RD3_Glb.IsIE(10,false)||this.SpanImg.readyState=="complete"){this.SetStretch()}};BookSpan.prototype.OnDeleteObject=function(c){var a=this.ParentBox.Spans;var d=a.length;for(var b=0;b<d;b++){if(a[b]==this){a.splice(b,1);break}}};BookSpan.prototype.UpdateWidth=function(d,a){if(this.Realized&&this.Enabled){if(this.ControlType==RD3_Glb.VISCTRL_EDIT){this.SpanObj.style.width=(parseFloat(this.SpanObj.style.width)+(a-d))+this.ParentBox.ParentPage.UM;if((this.DataType==6||this.DataType==8)&&!RD3_Glb.IsMobile()){var c=this.ParentBox.VisStyle.GetAlignment(1);if(this.ParentBox.Alignment!=1){c=this.ParentBox.Alignment}if(c!=4){this.SpanCal.style.left=(parseFloat(this.SpanCal.style.left)+(a-d))+this.ParentBox.ParentPage.UM}}}if(this.ControlType==RD3_Glb.VISCTRL_COMBO){var b=(this.ParentBox.ParentPage.UM=="mm"?25.4/96:1/96);this.SpanObj.SetWidth((parseFloat(this.SpanObj.Width)+(a-d))/b)}if(this.ControlType==RD3_Glb.VISCTRL_BUTTON){this.SpanObj.style.width=(parseFloat(this.SpanObj.style.width)+(a-d))+this.ParentBox.ParentPage.UM}}};BookSpan.prototype.UpdateHeight=function(a,b){if(this.Realized&&this.Enabled){if(this.ControlType==RD3_Glb.VISCTRL_EDIT){this.SpanObj.style.height=(parseFloat(this.SpanObj.style.height)+(b-a))+this.ParentBox.ParentPage.UM}if(this.ControlType==RD3_Glb.VISCTRL_COMBO){var c=(this.ParentBox.ParentPage.UM=="mm"?25.4/96:1/96);this.SpanObj.SetHeight((parseFloat(this.SpanObj.Height)+(b-a))/c)}if(this.ControlType==RD3_Glb.VISCTRL_BUTTON){this.SpanObj.style.height=(parseFloat(this.SpanObj.style.height)+(b-a))+this.ParentBox.ParentPage.UM}}};BookSpan.prototype.GetTooltip=function(a,b){if(this.Tooltip==""){return this.ParentBox.GetTooltip(a,b)}a.SetObj(this.SpanObj);a.SetText(this.Tooltip);a.SetImage("");a.SetAutoAnchor(true);a.SetPosition(2);return true};BookSpan.prototype.RecreateDOM=function(){if(this.SpanObj){var a=null;if(this.ControlType==RD3_Glb.VISCTRL_COMBO){a=this.ParentBox.BoxBox;this.SpanObj.Unrealize()}else{a=this.SpanObj.parentNode;this.SpanObj.parentNode.removeChild(this.SpanObj)}this.SpanObj=null;this.SpanImg=null;this.SpanTxt=null;this.Realize(a)}};BookSpan.prototype.ApplyVisualStyle=function(){if(!this.SpanObj){return}var f=this.GetVS();var e;var d=f.GetAlignment(1);if(this.ParentBox.Alignment!=1){d=this.ParentBox.Alignment}switch(d){case 3:e="center";break;case 4:e="right";break;case 5:e="justify";break;default:e=(this.IsRightAligned()?"right":"");break}if(this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.SetVisualStyle(f,true);f.ApplyStyle(this.SpanObj.GetDOMObj(),this.Alternate,e,this.BackColor,this.ForeColor,this.FontMod,this.Mask)}else{if(!this.Realizing||this.VisStyle||this.BackColor!=""||this.ForeColor!=""||this.FontMod!=""||this.Mask!=""){f.ApplyStyle(this.SpanObj,this.Alternate,e,this.BackColor,this.ForeColor,this.FontMod,this.Mask)}var b=f.Mask;if(this.Mask!=""){f.Mask=this.Mask}var c=f.ComputeMask(this.DataType,this.MaxLen,this.Scale);var a=f.ComputeMaskType(this.DataType);if(this.Mask!=""){f.Mask=b}this.SpanObj.setAttribute("idmask",c);this.SpanObj.setAttribute("idmasktype",a);this.SpanObj.setAttribute("idenabled",this.Enabled?"1":"0")}};BookSpan.prototype.OnRadioLabelClick=function(b){var c=(window.event)?window.event.srcElement:b.target;var a=c.previousSibling;if(a){a.click()}if(RD3_Glb.IsMobile()){this.ValueList.SetOptionClass(c.parentNode,c)}};BookSpan.prototype.OnCheckBoxClick=function(a){if(this.ControlType!=RD3_Glb.VISCTRL_CHECK||!this.SpanObj||!this.Enabled||this.AlreadyChecked){return}if(RD3_Glb.IsMobile()){this.OnToggleCheck(a)}else{var b=(window.event)?window.event.srcElement:a.explicitOriginalTarget;if(b&&b.hasChildNodes()){b.childNodes[0].click()}}};BookSpan.prototype.OnTouchDown=function(a){return true};BookSpan.prototype.OnTouchUp=function(c,b){if(b&&this.ParentBox.CanClick){if(this.ControlType==RD3_Glb.VISCTRL_BUTTON){RD3_KBManager.ActiveButton=this.SpanObj}this.ParentBox.OnClick(c)}if(b&&this.Enabled&&this.ControlType==RD3_Glb.VISCTRL_CHECK){this.OnToggleCheck(c)}if(b&&this.Enabled&&this.ControlType==RD3_Glb.VISCTRL_COMBO){this.SpanObj.OnClickActivator(c)}if(b&&this.UsePopupControl()&&this.Enabled&&this.ControlType!=RD3_Glb.VISCTRL_COMBO){var d=RD3_KBManager.GetSpanCell(this);var a=new PopupControl(this.GetPopupControlType(),d);a.Open()}return true};BookSpan.prototype.OnToggleCheck=function(d){if(!this.ea){var b=this;this.ea=function(f){b.OnEndAnimation(f)}}var c=d.target;if(c.tagName=="SPAN"){c=c.parentNode}c.checked=!c.checked;if(RD3_Glb.IsQuadro()){var e=c.firstChild;RD3_Glb.SetTransitionDuration(e,"200ms");var a="translate3d("+(c.checked?0:-53)+"px, 0px, 0px)";RD3_Glb.SetTransform(e,a);RD3_Glb.AddEndTransaction(e,this.ea,false)}else{RD3_Glb.SetTransitionDuration(c,"200ms");c.style.backgroundPosition=(c.checked?"0%":"100%")+" -27px"}RD3_Glb.AddEndTransaction(c,this.ea,false);this.OnChange(d);if(RD3_Glb.IsMobile7()){this.SetValue()}};BookSpan.prototype.OnEndAnimation=function(b){var a=b.target?b.target:b.srcElement;RD3_Glb.SetTransitionDuration(a,"0ms");RD3_Glb.RemoveEndTransaction(a,this.ea,false)};BookSpan.prototype.UsePopupControl=function(){return this.Enabled&&this.ControlType!=RD3_Glb.VISCTRL_COMBO&&this.ControlType!=RD3_Glb.VISCTRL_CHECK&&(RD3_Glb.IsDateOrTimeObject(this.DataType)||RD3_Glb.IsNumericObject(this.DataType))};BookSpan.prototype.GetPopupControlType=function(){switch(this.DataType){case 6:return RD3_Glb.CTRL_DATE;case 7:return RD3_Glb.CTRL_TIME;case 8:return RD3_Glb.CTRL_DATETIME;case 1:case 2:case 3:case 4:return RD3_Glb.CTRL_KEYNUM}};function ButtonBar(a){WebFrame.call(this,a);this.CommandSet=null;this.VerticalLayout=false;this.ButtonBarContainer=null}ButtonBar.prototype=new WebFrame();ButtonBar.prototype.LoadProperties=function(e){WebFrame.prototype.LoadProperties.call(this,e);var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"bvr":this.SetVerticalLayout(f.nodeValue=="1");break;case"cms":this.SetCommandSet(f.nodeValue);break}}};ButtonBar.prototype.SetVerticalLayout=function(a){this.VerticalLayout=a};ButtonBar.prototype.SetCommandSet=function(a){this.CommandSet=RD3_DesktopManager.ObjectMap[a]};ButtonBar.prototype.Realize=function(a){WebFrame.prototype.Realize.call(this,a);this.CommandSet.RealizeButtonBar(this)};ButtonBar.prototype.AdaptLayout=function(){if(!this.ButtonBarContainer){return}WebFrame.prototype.AdaptLayout.call(this);RD3_Glb.AdaptToParent(this.ButtonBarContainer);this.CommandSet.AdaptLayout()};ButtonBar.prototype.Unrealize=function(){WebFrame.prototype.Unrealize.call(this,parent);this.CommandSet.UnrealizeButtonBar()};ButtonBar.prototype.OnTouchStart=function(a){WebFrame.prototype.OnTouchStart.call(this,a);if(a.targetTouches.length!=1){return false}a.preventDefault();this.TouchStartX=a.targetTouches[0].clientX;this.TouchStartY=a.targetTouches[0].clientY;this.TouchOrgX=a.targetTouches[0].clientX;this.TouchOrgY=a.targetTouches[0].clientY;this.TouchTimes=new Array();this.TouchPosY=new Array();this.TouchPosX=new Array();this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);this.ClearTouchScrollTimer();return false};ButtonBar.prototype.OnTouchMove=function(f){if(this.TouchStartX==-1){return false}f.preventDefault();if(f.targetTouches.length!=1){return false}var d=f.targetTouches[0].clientX-this.TouchStartX;var g=f.targetTouches[0].clientY-this.TouchStartY;var a=new Date();this.TouchStartX=f.targetTouches[0].clientX;this.TouchStartY=f.targetTouches[0].clientY;if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);if(this.TouchTimes.length>3){this.TouchTimes.shift();this.TouchPosY.shift();this.TouchPosX.shift()}if(!RD3_DDManager.IsDragging&&!RD3_DDManager.IsResizing){var c=this.ContentBox.scrollLeft;var b=this.ContentBox.scrollTop;if(this.VerticalLayout){this.ContentBox.scrollTop-=g}else{this.ContentBox.scrollLeft-=d}this.FormScroll=this.FormScroll&&c==this.ContentBox.scrollLeft&&b==this.ContentBox.scrollTop}WebFrame.prototype.OnTouchMove.call(this,f);return false};ButtonBar.prototype.OnTouchEnd=function(g){if(this.TouchStartX==-1){return false}g.preventDefault();if(g.targetTouches.length!=0&&g.changedTouches.length!=1){return false}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}if(this.TouchTimes.length==3){var f=this.TouchTimes[2]-this.TouchTimes[0];var b=this.TouchPosX[0]-this.TouchPosX[2];var a=this.TouchPosY[0]-this.TouchPosY[2];if(new Date()-this.TouchTimes[2]<100&&f>0){var c=a/f;var d=b/f;if(Math.abs(d)>0.3||Math.abs(c)>0.3){this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+d+","+c+",0])",10)}}}WebFrame.prototype.OnTouchEnd.call(this,g);this.TouchStartX=-1;this.TouchStartY=-1;this.TouchMoved=false;this.TouchMove=false;return false};ButtonBar.prototype.TouchScrollTimer=function(d,b){if(b.length==3){var c=b[0];var a=b[1];var e=b[2];if(this.VerticalLayout){this.ContentBox.scrollTop+=a*10}else{this.ContentBox.scrollLeft+=c*10}if(e<40){c=c*0.97;a=a*0.97;this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+c+","+a+","+(e+1)+"])",10)}}};ButtonBar.prototype.ClearTouchScrollTimer=function(){if(this.TouchScrollTimerId>0){window.clearTimeout(this.TouchScrollTimerId);this.TouchScrollTimerId=0;this.TouchScroll=0}};function CommandList(){this.Identifier="cmh";this.SuppressMenu=false;this.AutoSuppress=true;this.ForceVerticalMenu=false;this.MenuButton=null;this.CommandSets=new Array();this.ClickEventDef=RD3_Glb.EVENT_CLIENTSIDE;this.ToolbarHeight=0;this.MenuBarOpen=false;this.ForceMenuBar=false;this.Realized=false;this.ActiveCommand=null;this.IDScroll=null;this.Expanding=false;this.ShowGroups=false;this.ClientCommands=new HashTable(true)}CommandList.prototype.LoadFromXml=function(g,e){if(g.nodeName!=this.Identifier){return}this.LoadProperties(g);var c=g.childNodes;var h=c.length;for(var d=0;d<h;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"cms":var f=RD3_DesktopManager.ObjectMap[b.getAttribute("id")];if(f){if(e){f.Unrealize()}}else{f=new Command();this.CommandSets.push(f)}f.LoadFromXml(b);if(e){f.Realize(RD3_DesktopManager.WebEntryPoint.MenuBox,RD3_DesktopManager.WebEntryPoint.ToolBarBox)}break}}};CommandList.prototype.ChangeProperties=function(a){this.LoadProperties(a)};CommandList.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"sup":this.SetSuppressMenu(a=="1",true);break;case"clk":this.ClickEventDef=parseInt(f.nodeValue);break;case"sma":RD3_ClientParams.GFXDef.sidebar=a;break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};CommandList.prototype.SetSuppressMenu=function(i,f){if(f){this.ForceVerticalMenu=i}if(i=="auto"&&this.AutoSuppress){if(!RD3_DesktopManager.WebEntryPoint.UseZones()){i=this.ShouldSuppressMenu()}else{i=false}this.Expanding=false}var d=this.SuppressMenu;if(i!=undefined){this.SuppressMenu=i}if(this.Realized){var g=(this.SuppressMenu||RD3_DesktopManager.WebEntryPoint.WidgetMode);var c=this.HasMenu();if(!g&&!c){g=true}var h=RD3_DesktopManager.WebEntryPoint.SuppressMenuBox;if(h){if(!RD3_Glb.IsMobile()){if(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_LEFTSB){h.src=RD3_Glb.GetImgSrc((this.SuppressMenu)?"images/showmenu.gif":"images/hidemenu.gif")}else{h.src=RD3_Glb.GetImgSrc((this.SuppressMenu)?"images/hidemenu.gif":"images/showmenu.gif")}}RD3_TooltipManager.SetObjTitle(h,(this.SuppressMenu)?RD3_ServerParams.MostraMenu:RD3_ServerParams.NascondiMenu)}var a=(this.SuppressMenu==d&&!g&&RD3_Glb.IsMobile()&&!RD3_Glb.IsSmartPhone()&&RD3_DesktopManager.WebEntryPoint.SideMenuBox.style.display=="none");if(this.SuppressMenu!=d||i==undefined||a){if(RD3_Glb.IsSmartPhone()){this.SlideMenu(!g)}else{var b=(i==undefined)||!c||RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_MENUBAR||RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR;var e=new GFX("sidebar",!g,RD3_DesktopManager.WebEntryPoint.SideMenuBox,b);RD3_GFXManager.AddEffect(e);if(RD3_Glb.IsMobile()){RD3_DesktopManager.WebEntryPoint.HeaderBox.style.display=g?"none":"";this.ShowMenuButton()}}}}};CommandList.prototype.Realize=function(c,a){if(RD3_Glb.IsMobile()){this.RealizeMobileMenu(this.CommandSets,c);if(this.AutoSuppress){this.MenuButton=document.createElement("div");if(RD3_Glb.IsSmartPhone()){this.MenuButton.id="menu-button-container";this.MenuButtonArrow=document.createElement("div");this.MenuButtonButton=document.createElement("div");this.MenuButtonArrow.className="menu-back-button-arrow";this.MenuButtonButton.className="menu-back-button";this.MenuButton.appendChild(this.MenuButtonArrow);this.MenuButton.appendChild(this.MenuButtonButton)}else{this.MenuButton.id="menu-button"}if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.MenuButton.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMenuButton', ev)")}else{this.MenuButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMenuButton', ev)")}}}else{var d=this.CommandSets.length;for(var b=0;b<d;b++){this.CommandSets[b].Realize(c,a)}}this.Realized=true;this.SetSuppressMenu()};CommandList.prototype.AdaptLayout=function(){var a=false;this.ToolbarHeight=RD3_DesktopManager.WebEntryPoint.ToolBarBox.offsetHeight;this.AdaptFirstLevelSeparator();var e=this.CommandSets.length;for(var b=0;b<e;b++){var d=this.CommandSets[b];d.AdaptLayout();if(!a&&d.IsToolbar&&d.ToolCont<0){a=a||d.IsVisible()}}RD3_DesktopManager.WebEntryPoint.ToolBarBox.className=(a)?"":"toolbar-container-invisible";this.ToolbarHeight=RD3_DesktopManager.WebEntryPoint.ToolBarBox.offsetHeight};CommandList.prototype.AdaptFirstLevelSeparator=function(){var e=this.CommandSets.length;var b=true;for(var a=0;a<e;a++){var d=this.CommandSets[a];if(d.IsVisible()&&d.IsMenu&&!RD3_Glb.IsMobile()){if(d.MenuSep){d.MenuSep.className="menu-separator-"+((b)?"first":"level-"+d.Level)}if(d.MenuSepImg){d.MenuSepImg.className="menu-separator-img"+((b)?"-first":"")}b=false}}};CommandList.prototype.Unrealize=function(){if(this.IDScroll){this.IDScroll.Unrealize()}var b=this.CommandSets.length;for(var a=0;a<b;a++){this.CommandSets[a].Unrealize()}this.ClosePopup();RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.Realized=false};CommandList.prototype.ClosePopup=function(c){var d=this.CommandSets.length;for(var a=0;a<d;a++){this.CommandSets[a].ClosePopup(c)}if(RD3_DesktopManager.WebEntryPoint.CalPopup){if(RD3_DesktopManager.WebEntryPoint.CalPopup.getAttribute("idjustopened")=="1"){RD3_DesktopManager.WebEntryPoint.CalPopup.setAttribute("idjustopened","")}else{RD3_DesktopManager.WebEntryPoint.CalPopup.style.display="none"}}if(RD3_DesktopManager.WebEntryPoint.TaskbarMenuBox&&c==null){var b=new GFX("taskbar",false,RD3_DesktopManager.WebEntryPoint.TaskbarMenuBox,false);RD3_GFXManager.AddEffect(b)}d=this.ClientCommands.length;for(var a=0;a<d;a++){this.ClientCommands.GetItem(a).ClosePopup(c)}this.MenuBarOpen=false};CommandList.prototype.ActiveFormChanged=function(){var d=this.CommandSets.length;for(var a=0;a<d;a++){var b=this.CommandSets[a];b.ActiveFormChanged()}};CommandList.prototype.OnClick=function(b){var a=new IDEvent("clk",this.SuppressMenu?"cmh.exp":"cmh.con",b,this.ClickEventDef);if(a.ClientSide){this.SetSuppressMenu(!this.SuppressMenu);RD3_DesktopManager.WebEntryPoint.AfterProcessResponse(true)}};CommandList.prototype.HandleFunctionKeys=function(e,g,a){var f=(e.charCode)?e.charCode:e.keyCode;var d=false;var j=this.CommandSets.length;for(var b=0;b<j&&!d;b++){var h=this.CommandSets[b];d=h.HandleFunctionKeys(e,g,a)}return d};CommandList.prototype.HandleAccell=function(d,e){if(RD3_DesktopManager.WebEntryPoint.MenuType!=RD3_Glb.MENUTYPE_MENUBAR){return false}if(this.MenuBarOpen&&e==27){this.ClosePopup();return true}var b=false;var g=this.CommandSets.length;for(var a=0;a<g&&!b;a++){var f=this.CommandSets[a];b=f.HandleAccell(d,e)}return b};CommandList.prototype.ComputeDropList=function(c,a){var d=this.CommandSets.length;for(var b=0;b<d;b++){this.CommandSets[b].ComputeDropList(c,a)}};CommandList.prototype.CloseMultipleForm=function(a){var c=this.CommandSets.length;for(var b=c-1;b>=0;b--){if(this.CommandSets[b].FormIndex==a){this.CommandSets[b].Unrealize();this.CommandSets.splice(b,1)}}};CommandList.prototype.RealizeMobileMenu=function(d,a){this.IDScroll=new IDScroll(this.Identifier,a,RD3_DesktopManager.WebEntryPoint.SideMenuBox);var c=d.length;for(var b=0;b<c;b++){d[b].Realize(a)}};CommandList.prototype.OnMenuButton=function(f){var g=RD3_DesktopManager.WebEntryPoint;var c=g.GetDockedForm(RD3_Glb.FORMDOCK_LEFT);var a=null;if(g.UseZones()){a=g.GetScreenZone(RD3_Glb.FORMDOCK_LEFT);if(!a.HasMobileMenu){a=g.GetScreenZone(RD3_Glb.FORMDOCK_RIGHT)}if(a.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALHIDE){var h=(a.Position==RD3_Glb.FORMDOCK_LEFT||a.Position==RD3_Glb.FORMDOCK_RIGHT?a.ParentContainer.offsetWidth:a.ParentContainer.offsetHeight);a.AdaptDocked(true);a.AdaptLayout();a.PortraitShown=true;var b=(a.Position==RD3_Glb.FORMDOCK_LEFT||a.Position==RD3_Glb.FORMDOCK_RIGHT?a.ParentContainer.offsetWidth:a.ParentContainer.offsetHeight);a.SlideZone(h,b,true);return}}this.Expanding=false;this.ForceMenuBar=true;if(RD3_Glb.IsSmartPhone()){this.SetSuppressMenu(false);return}var e=new PopupFrame(null,this);e.Borders=RD3_Glb.BORDER_THIN;if(g.UseZones()){a=g.GetScreenZone(RD3_Glb.FORMDOCK_LEFT);if(!a.HasMobileMenu){a=g.GetScreenZone(RD3_Glb.FORMDOCK_RIGHT)}if(a.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALPOPOVER){e.SetWidth(a.ZoneSize);e.HasCaption=false}}else{e.SetWidth(304)}var d=748;if(this.ForceVerticalMenu){d=RD3_Glb.IsPortrait(true)?d:RD3_DesktopManager.WebEntryPoint.WepBox.offsetHeight-60}e.SetHeight(d);e.Centered=false;e.AutoClose=true;e.AttachTo(this.MenuButton);e.Realize("-popover");if((this.ShowGroups||RD3_Glb.IsQuadro())&&!RD3_Glb.IsMobile7()){if(RD3_Glb.IsIE(10,true)){e.ContentBox.style.background="linear-gradient(180deg, "+RD3_ClientParams.GetColorMenu1()+", "+RD3_ClientParams.GetColorMenu2()+")"}else{e.ContentBox.style.background="-webkit-gradient(linear, left top, left bottom, from("+RD3_ClientParams.GetColorMenu1()+"), to("+RD3_ClientParams.GetColorMenu2()+"))"}}if(!g.UseZones()){if(c&&!c.Visible){this.ConvertFormPopover(true);e.HostForm(c)}else{this.ConvertClassPopover(true);e.Host(g.HeaderBox,g.SideMenuBox);this.IDScroll.SetContainer(e.ContentBox);g.HeaderBox.style.display=""}}else{a.ConvertPopover(true);e.Host(null,a.ParentContainer)}RD3_DDManager.AddPopup(e);e.Open();this.PopupObj=e};CommandList.prototype.OnClosePopup=function(b){var c=RD3_DesktopManager.WebEntryPoint;if(!c.UseZones()){this.ConvertFormPopover(false);if(this.SuppressMenu){RD3_DesktopManager.WebEntryPoint.HeaderBox.style.display="none"}this.IDScroll.SetContainer(RD3_DesktopManager.WebEntryPoint.SideMenuBox);this.ConvertClassPopover(false)}else{var a=c.GetScreenZone(RD3_Glb.FORMDOCK_LEFT);if(!a.HasMobileMenu){a=c.GetScreenZone(RD3_Glb.FORMDOCK_RIGHT)}this.IDScroll.SetContainer(RD3_DesktopManager.WebEntryPoint.SideMenuBox);a.ConvertPopover(false)}this.PopupObj=null};CommandList.prototype.ConvertFormPopover=function(n,a){var p=RD3_DesktopManager.WebEntryPoint;if(!a){a=p.GetDockedForm(RD3_Glb.FORMDOCK_LEFT)}if(a){var f=a.GetFirstToolbar();if(f){var h=a.HasCaption()?"form-caption-container":"frame-toolbar-container";var e="popup-frame-caption-popover";RD3_Glb.SwitchClass(f,h,e,n);var g=f.firstChild;h="form-caption-image";e="popover-form-button";while(g){RD3_Glb.SwitchClass(g,h,e,n);RD3_Glb.SwitchClass(g,"menu-back-button-arrow","popover-back-button-arrow",n);RD3_Glb.SwitchClass(g,"menu-back-button","popover-back-button",n);g=g.nextSibling}}for(var k=0;k<a.Frames.length;k++){var l=a.Frames[k];if(l instanceof ButtonBar){RD3_Glb.SwitchClass(l.ButtonBarContainer,"button-bar-container","button-bar-popover-container",n);for(var d=0;d<l.CommandSet.Commands.length;d++){var c=l.CommandSet.Commands[d];RD3_Glb.SwitchClass(c.Button,"button-bar-button","button-bar-popover-button",n)}}if(l instanceof TabbedView){var o="";switch(l.Placement){case RD3_Glb.TABOR_RIGHT:o="-right";break;case RD3_Glb.TABOR_LEFT:o="-left";break}RD3_Glb.SwitchClass(l.ToolbarBox,"toolstrip-container"+o,"toolstrip-container-popover"+o,n);if(o.length>0){o="tab"+o.substring(1)+"-"}for(var d=0;d<l.Tabs.length;d++){var b=l.Tabs[d];RD3_Glb.SwitchClass(b.CaptionBox,"selected-tab-caption-container-"+o+"0","selected-tab-caption-container-popover-"+o+"0",n);RD3_Glb.SwitchClass(b.CaptionBox,"tab-caption-container-"+o+"0","tab-caption-container-popover-"+o+"0",n)}if(!n){l.Switched=true}}if(l instanceof IDPanel&&l.PagesBox){RD3_Glb.SwitchClass(l.PagesBox,"pages-container","pages-container-popover",n);for(var d=0;d<l.Pages.length;d++){var m=l.Pages[d];RD3_Glb.SwitchClass(m.CaptionContainer,"selected-page-container-0","selected-page-container-popover-0",n);RD3_Glb.SwitchClass(m.CaptionContainer,"page-container-0","page-container-popover-0",n)}}}if(!n||!a.WasAdapted){window.setTimeout("RD3_DesktopManager.CallEventHandler('"+a.Identifier+"', 'AdaptLayout', "+(!a.WasAdapted)+");",50)}}};CommandList.prototype.ConvertClassPopover=function(e){var f=RD3_DesktopManager.WebEntryPoint.HeaderBox;var d="header-container";var c="popup-frame-caption-popover";RD3_Glb.SwitchClass(f,d,c,e);f=f.firstChild;d="menu-back-button";c="popover-back-button";var b="menu-back-button-arrow";var a="popover-back-button-arrow";while(f){RD3_Glb.SwitchClass(f,b,a,e);RD3_Glb.SwitchClass(f,d,c,e);f=f.nextSibling}f=document.getElementById("header-main-caption");d="header-main-caption";c="popup-frame-caption-text";RD3_Glb.SwitchClass(f,d,c,e)};CommandList.prototype.ShouldSuppressMenu=function(){var b=RD3_DesktopManager.WebEntryPoint;if(!b.Realized){return}var a=RD3_Glb.IsPortrait();if(RD3_Glb.IsSmartPhone()){if(this.ForceMenuBar){return false}a=b.StackForm.length>0}if(!a&&b.GetDockedForm(RD3_Glb.FORMDOCK_LEFT,true)&&!b.UseZones()){a=true}return a};CommandList.prototype.ShowMenuButton=function(){if(this.MenuButton){var f=RD3_DesktopManager.WebEntryPoint;var c=RD3_Glb.IsPortrait();if(RD3_Glb.IsSmartPhone()){c=f.StackForm.length>0}var d=false;if(c){if(!f.UseZones()){var e=f.GetDockedForm(RD3_Glb.FORMDOCK_LEFT);if(e&&!e.Visible){d=true;this.SetMenuButtonCaption(e.Caption)}else{if(this.SuppressMenu){d=this.HasMenu();this.SetMenuButtonCaption(RD3_DesktopManager.WebEntryPoint.MainCaption)}}}else{var a=f.GetScreenZone(RD3_Glb.FORMDOCK_LEFT);if(!a.HasMobileMenu){a=f.GetScreenZone(RD3_Glb.FORMDOCK_RIGHT)}d=this.HasMenu()||(a.GetForms().length>0&&(a.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALPOPOVER||a.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALHIDE)&&a.ZoneState==RD3_Glb.SCRZONE_PINNEDZONE);this.SetMenuButtonCaption(RD3_DesktopManager.WebEntryPoint.MainCaption)}}this.MenuButton.style.display=d?"":"none";var b=RD3_KBManager.GetObject(this.MenuButton);if(b&&b instanceof IDPanel){b.RefreshToolbar=true;if(RD3_Glb.IsQuadro()){b.UpdateToolbar()}}if(b&&b instanceof WebForm&&RD3_Glb.IsQuadro()){b.AdaptToolbarLayout()}}};CommandList.prototype.SetMenuButtonCaption=function(a){var b=RD3_Glb.IsSmartPhone()?this.MenuButtonButton:this.MenuButton;b.textContent=a};CommandList.prototype.SlideMenu=function(g){var j=RD3_DesktopManager.WebEntryPoint.SideMenuBox;var i=RD3_DesktopManager.WebEntryPoint.HeaderBox;var c=RD3_DesktopManager.WebEntryPoint.FormsBox;var h=RD3_DesktopManager.WebEntryPoint.WepBox.offsetWidth;if(!g&&(!this.HasMenu()||RD3_DesktopManager.WebEntryPoint.WepBox.style.visibility=="hidden")){j.style.display=(this.SuppressMenu)?"none":"";i.style.display=(this.SuppressMenu)?"none":"";c.style.display=(this.SuppressMenu)?"":"none";this.ShowMenuButton();return}j.style.display="";i.style.display="";c.style.display="";var e=0;var d=0;var b=0;var a=0;if(g){e=-h;d=0;b=0;a=h}else{e=0;d=-h;b=h;a=0}RD3_Glb.SetTransform(j,"translate3d("+e+"px,0px,0px)");RD3_Glb.SetTransform(i,"translate3d("+e+"px,0px,0px)");RD3_Glb.SetTransform(c,"translate3d("+b+"px,0px,0px)");var f="RD3_Glb.SetTransitionDuration(document.getElementById('"+j.id+"'), '250ms');";f+="RD3_Glb.SetTransitionDuration(document.getElementById('"+i.id+"'), '250ms');";f+="RD3_Glb.SetTransitionDuration(document.getElementById('"+c.id+"'), '250ms');";f+="RD3_Glb.SetTransform(document.getElementById('"+j.id+"'), 'translate3d("+d+"px,0px,0px)');";f+="RD3_Glb.SetTransform(document.getElementById('"+i.id+"'), 'translate3d("+d+"px,0px,0px)');";f+="RD3_Glb.SetTransform(document.getElementById('"+c.id+"'), 'translate3d("+a+"px,0px,0px)');";if(!this.ea){this.ea=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEndAnimation', ev)")}RD3_Glb.AddEndTransaction(j,this.ea,false);window.setTimeout(f,30)};CommandList.prototype.OnEndAnimation=function(d){var a=RD3_DesktopManager.WebEntryPoint.SideMenuBox;var e=RD3_DesktopManager.WebEntryPoint.HeaderBox;var c=RD3_DesktopManager.WebEntryPoint.FormsBox;if(RD3_Glb.GetTransitionDuration(a)==""){return}RD3_Glb.RemoveEndTransaction(a,this.ea,false);RD3_Glb.SetTransitionDuration(a,"");RD3_Glb.SetTransitionDuration(e,"");RD3_Glb.SetTransitionDuration(c,"");a.style.display=(this.SuppressMenu)?"none":"";e.style.display=(this.SuppressMenu)?"none":"";c.style.display=(this.SuppressMenu)?"":"none";this.ShowMenuButton();var b=RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveCommand;if(b&&!this.SuppressMenu){RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveCommand=null;b.SetMenuClass()}RD3_DesktopManager.WebEntryPoint.AdaptLayout()};CommandList.prototype.HasMenu=function(){var d=this.CommandSets.length;for(var a=0;a<d;a++){var b=this.CommandSets[a];if(b.IsMenu&&b.ToolCont<0&&b.IsVisible()){return true}}return false};CommandList.prototype.HandleBackButton=function(){var d=this.CommandSets.length;for(var a=0;a<d;a++){var b=this.CommandSets[a];if(b.HandleBackButton()){return true}}return false};CommandList.prototype.AccentColorChanged=function(b,c){var d=this.CommandSets.length;for(var a=0;a<d;a++){this.CommandSets[a].AccentColorChanged(b,c)}};function Command(){this.Identifier="";this.FormIndex=0;this.Caption="";this.Tooltip="";this.Index=0;this.FKNum=0;this.Expanded=false;this.Level=1;this.IsMenu=true;this.IsToolbar=false;this.ShowNames=false;this.RequireConf=false;this.ConfText="";this.ToolName="";this.Image="";this.CommandCode="";this.Enabled=true;this.Visible=true;this.ToolCont=-1;this.UseHL=false;this.FormList=false;this.Accell="";this.CommandCanDrag=false;this.CommandCanDrop=false;this.Badge="";this.Commands=new Array();this.BBParent=null;this.ToolTimer=null;this.IsClosing=false;this.Gfx=null;this.ParentCmdSet=null;this.RecalcSeparatorLayout=false;this.ClickEventDef=RD3_Glb.EVENT_URGENT;this.ExpandEventDef=RD3_Glb.EVENT_CLIENTSIDE;this.Realized=false;this.MyBox=null;this.CmdBox=null;this.MenuBox=null;this.BranchImg=null;this.CommandLink=null;this.CommandImg=null;this.CommandImgDX=null;this.CommandText=null;this.MenuSep=null;this.MenuSepImg=null;this.BadgeObj=null;this.MyToolBox=null;this.ToolImg=null;this.ToolText=null;this.ButtonBox=null;this.Button=null;this.PopupContainerBox=null;this.PopupItemBox=null;this.PopupIconCell=null;this.PopupTextCell=null;this.PopupText=null;this.PopupImageBox=null;this.PopupTimer=0}Command.prototype.LoadFromXml=function(e){this.LoadProperties(e);var c=e.childNodes;var g=c.length;for(var d=0;d<g;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"cmd":var f=new Command();f.LoadFromXml(b);f.ParentCmdSet=this;f.IsToolbar=(f.IsToolbar&&this.IsToolbar);f.IsMenu=(f.IsMenu&&this.IsMenu);f.FormIndex=this.FormIndex;this.Commands.push(f);if(this.Realized){f.Realize(this.MenuBox,this.MyToolBox)}break}}};Command.prototype.ChangeProperties=function(a){this.LoadFromXml(a)};Command.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"frm":this.SetFormIndex(parseInt(f.nodeValue));break;case"cap":this.SetCaption(f.nodeValue);break;case"tip":this.SetTooltip(f.nodeValue);break;case"idx":this.SetIndex(f.nodeValue);break;case"exp":this.SetExpanded(f.nodeValue=="1");break;case"lev":this.SetLevel(parseInt(f.nodeValue));break;case"ism":this.SetMenu(f.nodeValue=="1");break;case"ist":this.SetToolbar(f.nodeValue=="1");break;case"shn":this.SetShowNames(f.nodeValue=="1");break;case"rqc":this.SetRequireConfirmation(f.nodeValue=="1");break;case"rqt":this.SetConfirmationText(f.nodeValue);break;case"tnm":this.SetToolName(f.nodeValue);break;case"img":this.SetImage(f.nodeValue);break;case"ena":this.SetEnabled(f.nodeValue=="1");break;case"vis":this.SetVisible(f.nodeValue=="1");break;case"cnt":this.SetToolCont(parseInt(f.nodeValue));break;case"fkn":this.SetFKNum(parseInt(f.nodeValue));break;case"cco":this.SetCommandCode(f.nodeValue);break;case"wid":this.SetWidth(parseInt(f.nodeValue));break;case"thl":this.SetUseHL(f.nodeValue=="1");break;case"fli":this.SetFormList(f.nodeValue=="1");break;case"acc":this.SetAccell(f.nodeValue);break;case"cdg":this.SetCanDrag(f.nodeValue=="1");break;case"cdp":this.SetCanDrop(f.nodeValue=="1");break;case"bdg":this.SetBadge(f.nodeValue);break;case"clk":this.ClickEventDef=parseInt(f.nodeValue);break;case"exe":this.ExpandEventDef=parseInt(f.nodeValue);break;case"exa":this.ExpandAnimDef=a;break;case"poa":this.PopupAnimDef=a;break;case"cmds":this.IsCmdSet=true;break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};Command.prototype.SetFormIndex=function(a){this.FormIndex=a};Command.prototype.SetIndex=function(a){this.Index=a};Command.prototype.SetFKNum=function(a){this.FKNum=a};Command.prototype.SetAccell=function(a){this.Accell=a};Command.prototype.SetFormList=function(a){this.FormList=a};Command.prototype.SetWidth=function(a){this.Width=a;if(RD3_Glb.IsTouch()&&!RD3_Glb.IsMobile()){this.Width=a*1.3}};Command.prototype.SetUseHL=function(a){this.UseHL=a};Command.prototype.SetFKNum=function(a){this.FKNum=a};Command.prototype.SetLevel=function(a){this.Level=a};Command.prototype.SetMenu=function(a){this.IsMenu=a};Command.prototype.SetToolbar=function(a){this.IsToolbar=a};Command.prototype.SetShowNames=function(a){this.ShowNames=a};Command.prototype.SetRequireConfirmation=function(a){this.RequireConf=a};Command.prototype.SetConfirmationText=function(a){this.ConfText=a};Command.prototype.SetToolCont=function(a){if(a!=undefined){this.ToolCont=a}if(this.Realized){this.ActiveFormChanged()}};Command.prototype.SetToolName=function(a){this.ToolName=a;if(this.Realized&&!this.IsSeparator()){if(this.ToolText!=null){this.ToolText.nodeValue=this.Caption}}};Command.prototype.SetCommandCode=function(a){this.CommandCode=a};Command.prototype.SetCaption=function(d){var a=this.Caption;if(d!=undefined){this.Caption=d}if(this.Realized&&!this.IsSeparator()){var b=this.Caption;if(this.ShowAccell()){var e=b.toUpperCase().indexOf(this.Accell);if(e>-1){b=b.substr(0,e)+"<u>"+b.substr(e,1)+"</u>"+b.substr(e+1)}}if(this.CommandText){this.CommandText.nodeValue=this.Caption}else{if(this.MyBox){this.MyBox.innerHTML=b}}if(this.Button){this.Button.value=this.Caption}if(this.PopupText){this.PopupText.innerHTML=b}if(this.Image==""&&this.ToolImg){this.ToolImg.value=this.Caption;if(this.ParentCmdSet&&this.ParentCmdSet.IsToolbar&&this.ParentCmdSet.ToolCont==0&&this.ParentCmdSet.FormIndex){var c=RD3_DesktopManager.ObjectMap["frm:"+this.ParentCmdSet.FormIndex];if(c){c.AdaptToolbar=true}}}if(a!=this.Caption&&this.MyBox){this.AdaptLayout()}}};Command.prototype.SetTooltip=function(b){if(b!=undefined){this.Tooltip=b}if(this.Realized&&!this.IsSeparator()){var a=RD3_KBManager.GetFKTip(this.FKNum);if(a==""&&this.CommandCode!=""){a=" ("+this.CommandCode+")"}if(this.CommandLink){RD3_TooltipManager.SetObjTitle(this.CommandLink,this.Tooltip+a)}if(this.MyToolBox){RD3_TooltipManager.SetObjTitle(this.MyToolBox,this.Tooltip+a)}if(this.Button){RD3_TooltipManager.SetObjTitle(this.Button,this.Tooltip+a)}if(this.PopupText){RD3_TooltipManager.SetObjTitle(this.PopupText,this.Tooltip+a)}if(this.Image==""&&this.ToolImg){RD3_TooltipManager.SetObjTitle(this.ToolImg,this.Tooltip+a)}}};Command.prototype.SetBadge=function(b){if(b!=undefined){this.Badge=b}if(this.Realized&&!this.IsSeparator()&&this.ShowBadge()){if(this.Badge==""){if(this.BadgeObj!=null&&this.BadgeObj.parentNode){this.BadgeObj.parentNode.removeChild(this.BadgeObj)}this.BadgeObj=null}else{if(this.BadgeObj==null){this.BadgeObj=document.createElement("DIV");this.BadgeObj.className=(RD3_Glb.IsMobile()?"badge-grey":"badge-red badge-min badge-right");this.BadgeObj.style.position=(RD3_Glb.IsMobile()?"absolute":"static");if(!RD3_Glb.IsMobile()){if(this.CmdBox.firstChild){this.CmdBox.insertBefore(this.BadgeObj,this.CmdBox.firstChild)}else{this.CmdBox.appendChild(this.BadgeObj)}}else{this.MyBox.parentNode.insertBefore(this.BadgeObj,this.MyBox)}}if(RD3_Glb.IsMobile()&&RD3_DesktopManager.WebEntryPoint.SideMenuWidth>0){var a=RD3_DesktopManager.WebEntryPoint.SideMenuWidth-10-RD3_Glb.GetBadgeWidth(this.Badge,"grey");if(this.IsCmdSet){a=a-24}if(this.Level>1){a=a-4}this.BadgeObj.style.left=a+"px";this.BadgeObj.style.marginTop="10px"}this.BadgeObj.innerHTML=this.Badge;this.BadgeObj.style.display=this.IsVisible()?"":"none"}}};Command.prototype.ShowBadge=function(b){var a=false;if(RD3_Glb.IsMobile()){a=true}if(this.IsMenu&&!RD3_Glb.IsMobile()&&!this.IsCmdSet){a=true}if(RD3_Glb.IsMobile()&&this.IsCmdSet&&this.ShowGroupedMenu()){a=false}if(!this.IsMenu){a=false}return a};Command.prototype.SetExpanded=function(c){var a=this.Expanded;if(c!=undefined){this.Expanded=c}if(this.Realized&&this.IsCmdSet&&this.IsMenu){var b=null;if(this.Expanded){if(RD3_Glb.IsMobile()){if(this.Expanded!=a||c==undefined){this.LoadNestedMenu(true)}}else{if(this.CommandImg&&this.Image==""){this.CommandImg.src=RD3_Glb.GetImgSrc((RD3_ServerParams.Theme=="seattle"||RD3_ServerParams.Theme=="zen")?"images/openedslev"+this.Level+".gif":"images/opened.gif")}if(this.CommandImgDX){this.CommandImgDX.src=RD3_Glb.GetImgSrc((RD3_ServerParams.Theme=="seattle"||RD3_ServerParams.Theme=="zen")?"images/openedslev"+this.Level+".gif":"images/opened.gif");if(!RD3_Glb.IsIE(10,false)){this.CommandImgDX.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}}if(this.MenuBox&&(a!=this.Expanded||c==undefined)){var b=new GFX("menu",true,this.MenuBox,c==undefined,null,this.ExpandAnimDef);RD3_GFXManager.AddEffect(b)}}}else{if(RD3_Glb.IsMobile()){if(this.Expanded!=a){this.LoadNestedMenu(false);RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveCommand=null;this.SetMenuClass(true)}}else{if(this.CommandImg&&this.Image==""){this.CommandImg.src=RD3_Glb.GetImgSrc((RD3_ServerParams.Theme=="seattle"||RD3_ServerParams.Theme=="zen")?"images/closedslev"+this.Level+".gif":"images/closed.gif")}if(this.CommandImgDX){this.CommandImgDX.src=RD3_Glb.GetImgSrc((RD3_ServerParams.Theme=="seattle"||RD3_ServerParams.Theme=="zen")?"images/closedslev"+this.Level+".gif":"images/closed.gif");if(!RD3_Glb.IsIE(10,false)){this.CommandImgDX.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}}if(this.MenuBox&&(a!=this.Expanded||c==undefined)){var b=new GFX("menu",false,this.MenuBox,c==undefined,null,this.ExpandAnimDef);RD3_GFXManager.AddEffect(b)}}}}};Command.prototype.GetPopover=function(){var a=this;while(a){if(a.Popover){return a.Popover}a=a.ParentCmdSet}};Command.prototype.LoadNestedMenu=function(B,k){if(k&&!this.Popover){this.Popover=new PopupFrame(null,this);this.Popover.Borders=RD3_Glb.BORDER_THIN;this.Popover.Centered=false;this.Popover.CanMove=false;this.Popover.AutoClose=true;this.Popover.WepClick=false;this.Popover.ModalAnim=RD3_Glb.IsSmartPhone();this.Popover.Owner=this;this.Popover.Realize("-popover")}var s=this.GetPopover();var l=s?s.CaptionBox:RD3_DesktopManager.WebEntryPoint.HeaderBox;if(B&&!this.MenuBox){var r=RD3_DesktopManager.WebEntryPoint.CmdObj.SuppressMenu||s;this.MenuBox=document.createElement("div");this.MenuBox.setAttribute("id",this.Identifier+":sub");this.MenuBox.className="menu-container";if(!k&&RD3_DesktopManager.WebEntryPoint.CmdObj.ShowGroups){this.MenuBox.className+=" menu-group-cont";if(RD3_Glb.IsMobile()){this.MenuBox.style.marginTop="-1px"}}if(k){this.PopupMobileBox=document.createElement("div");this.PopupMobileBox.appendChild(this.MenuBox)}else{if(s){s.ContentBox.appendChild(this.MenuBox)}else{RD3_DesktopManager.WebEntryPoint.MenuBox.parentNode.appendChild(this.MenuBox)}RD3_Glb.AddEndTransaction(this.MenuBox,new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEndAnimation', ev)"),false)}var t=this.Commands.length;for(var x=0;x<t;x++){if(s){this.Commands[x].IsMenu=true}this.Commands[x].Realize(this.MenuBox)}if(!k){this.MenuSepImg=document.createElement("div");this.MenuSepImg.setAttribute("id",this.Identifier+":spi");this.MenuSepImg.className=r?"popover-back-button-arrow":"menu-back-button-arrow";this.MenuSepImg.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnBack', ev)");l.appendChild(this.MenuSepImg);this.MenuSep=document.createElement("div");this.MenuSep.setAttribute("id",this.Identifier+":sep");this.MenuSep.className=r?"popover-back-button":"menu-back-button";this.MenuSep.innerHTML=(this.ParentCmdSet)?this.ParentCmdSet.Caption:RD3_DesktopManager.WebEntryPoint.MainCaption;this.MenuSep.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnBack', ev)");l.appendChild(this.MenuSep)}}if(!k){var m=(!this.IsFirstLevel())?this.ParentCmdSet.MenuBox:RD3_DesktopManager.WebEntryPoint.MenuBox;if(this.MenuBox&&m){RD3_DesktopManager.WebEntryPoint.CmdObj.Expanding=true;this.MenuBox.style.display="";m.style.display="";var q=s?s.Width:RD3_DesktopManager.WebEntryPoint.SideMenuWidth;if(q==0){q=320}var j=RD3_Glb.TranslateY(this.MenuBox);var g=RD3_Glb.TranslateY(m);var v=B?q:0;var u=B?0:-q;RD3_Glb.SetTransform(this.MenuBox,"translate3d("+v+"px,"+j+"px,0px)");RD3_Glb.SetTransform(m,"translate3d("+u+"px,"+g+"px,0px)");var f=B?0:q;var e=B?-q:0;var d="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.MenuBox.id+"'), '300ms');";d+="RD3_Glb.SetTransitionDuration(document.getElementById('"+m.id+"'), '300ms');";d+="RD3_Glb.SetTransform(document.getElementById('"+this.MenuBox.id+"'), 'translate3d("+f+"px,"+j+"px,0px)');";d+="RD3_Glb.SetTransform(document.getElementById('"+m.id+"'), 'translate3d("+e+"px,"+g+"px,0px)');";if(this.MenuSep){var w=(!this.IsFirstLevel())?this.ParentCmdSet.MenuSep:null;var A=(!this.IsFirstLevel())?this.ParentCmdSet.MenuSepImg:null;if(w){RD3_Glb.SetTransform(w,"translate3d("+e+"px,0px,0px)")}if(A){RD3_Glb.SetTransform(A,"translate3d("+e+"px,0px,0px) rotate(45deg)")}var b=l.offsetWidth/2-this.MenuSep.offsetWidth/2;var a=0;var E=1;if(B){RD3_Glb.SetTransform(this.MenuSep,"translate3d("+b+"px,0px,0px)");RD3_Glb.SetTransitionProperty(this.MenuSep,"-webkit-transform, opacity");RD3_Glb.SetTransform(this.MenuSepImg,"translate3d("+b+"px,0px,0px) rotate(45deg)");RD3_Glb.SetTransitionProperty(this.MenuSepImg,"-webkit-transform, opacity")}else{a=b;E=0}d+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.MenuSepImg.id+"'), '300ms');";d+="RD3_Glb.SetTransform(document.getElementById('"+this.MenuSepImg.id+"'), 'translate3d("+a+"px,0px,0px) rotate(45deg)');";d+="document.getElementById('"+this.MenuSepImg.id+"').style.opacity="+E+";";d+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.MenuSep.id+"'), '300ms');";d+="RD3_Glb.SetTransform(document.getElementById('"+this.MenuSep.id+"'), 'translate3d("+a+"px,0px,0px)');";d+="document.getElementById('"+this.MenuSep.id+"').style.opacity="+E+";";if(RD3_Glb.IsQuadro()){this.MenuSep.style.display=B?"":"none";this.MenuSepImg.style.display=B?"":"none";if(w){w.style.display=B?"none":"";A.style.display=B?"none":""}}}window.setTimeout(d,0)}if(s){var C=B?this:this.ParentCmdSet;if(C){var D=0;for(var x=0;x<C.Commands.length;x++){if(C.Commands[x].IsVisible()){D++}}if(D==0){D=1}var y=D*44+48;if(C.ParentCmdSet&&!RD3_Glb.IsQuadro()&&!RD3_Glb.IsMobile7()){y+=8}var o=RD3_DesktopManager.WebEntryPoint.WepBox.offsetHeight*(RD3_Glb.IsSmartPhone()?0.8:0.5);if(y>o){y=o}s.SetHeight(y);s.AdaptLayout()}}}if(this.Realized){var z=this.Caption;if(!B){z=(!this.IsFirstLevel())?this.ParentCmdSet.Caption:RD3_DesktopManager.WebEntryPoint.MainCaption}if(s){s.SetCaption(z)}else{RD3_DesktopManager.WebEntryPoint.MainCaptionBox.innerHTML=z}}if(s){if(s.IDScroll){s.IDScroll.SetBox(B?this.MenuBox:m)}}else{RD3_DesktopManager.WebEntryPoint.CmdObj.IDScroll.SetBox(B?this.MenuBox:m)}};Command.prototype.SetImage=function(k,d){var f=this.Image;if(k!=undefined){this.Image=k}var j=this.Realized&&(!this.IsCmdSet||d||(this.IsCmdSet&&this.Image!=""))&&!this.IsSeparator();if(RD3_Glb.IsMobile()){j=this.Realized&&(k==undefined||this.Image!=f||d)&&!this.IsSeparator()}if(j){if(RD3_Glb.IsMobile()){var g=!d;var i="";var a="";var h="";var b="";if(this.Image!=""&&this.MyBox&&this.MyBox.className!="menu-group-header"){i="url("+RD3_Glb.GetAbsolutePath()+"images/"+encodeURI(this.Image)+")";a=(RD3_Glb.IsMobile7()?"10px":"7px");h=(RD3_Glb.IsMobile7()?"50px":"48px")}if(this.IsCmdSet){if(i!=""){i+=",";a+=","}i+="url("+RD3_Glb.GetAbsolutePath()+"images/detail"+(this.IsActiveMenu()?"w":"")+".png)";a+="96%";b="24px"}if(this.IsActiveMenu()){if(i!=""){i+=",";a+=","}if(RD3_Glb.IsIE(10,true)){i+="linear-gradient(180deg, "+RD3_ClientParams.GetColorHL1()+", "+RD3_ClientParams.GetColorHL2()+")"}else{i+="-webkit-gradient(linear, 0% 0%, 0% 100%, from("+RD3_ClientParams.GetColorHL1()+"), to("+RD3_ClientParams.GetColorHL2()+"))"}a+="0px 0px";if(this.MyBox){g=g||this.MyBox.style.backgroundImage.indexOf("gradient")==-1}}else{if(this.MyBox){g=g||this.MyBox.style.backgroundImage.indexOf("gradient")>-1}}if(this.MyBox&&g){var m=this.MyBox.style;m.backgroundImage=i;m.backgroundPosition=a;m.paddingLeft=h;m.paddingRight=b;m.backgroundSize="auto";if(RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro()){if(this.IsCmdSet){m.backgroundSize=(this.Image==""?"":"auto,");m.backgroundSize+=(!this.IsActiveMenu()?" 10px 16px":" 10px 16px, 100%")}if(RD3_Glb.Adapt4Retina(this.Identifier,this.Image,43,this.IsCmdSet)){this.MyBox.style.backgroundSize="0px 0px"}m.backgroundRepeat="no-repeat"}}if(this.IsToolbar&&this.ToolImg!=null&&this.Image!=""){if(RD3_Glb.IsMobile7()){var l=!(RD3_Glb.IsAndroid()||RD3_Glb.IsIE()||RD3_Glb.IsEdge())||RD3_Glb.IsAndroid(4,4,0);if(l){this.ToolImg.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/"+this.Image)+"')";if(RD3_Glb.Adapt4Retina(this.Identifier,this.Image,43)){this.ToolImg.style.minWidth="0px";this.ToolImg.style.webkitMaskSize="0px 0px"}}else{var c=this.Image;var e=this.Image.lastIndexOf(".");if(e>=0){c=this.Image.substring(0,e)+"-i"+this.Image.substring(e)}this.ToolImg.src=RD3_Glb.GetImgSrc("images/"+c);if(RD3_Glb.Adapt4Retina(this.Identifier,c,43)){this.ToolImg.style.display="none"}}}else{this.ToolImg.src=RD3_Glb.GetImgSrc("images/"+this.Image)}if(RD3_Glb.IsQuadro()&&RD3_Glb.Adapt4Retina(this.Identifier,this.Image,43)){this.ToolImg.style.display="none"}else{this.ToolImg.style.display=""}}}else{if(this.Image==""){if(this.CommandImg){this.CommandImg.style.display="none"}if(this.CommandImgDX&&!(this.IsCmdSet&&this.Image!="")){this.CommandImgDX.style.display="none"}if(this.Button){this.Button.removeAttribute("src")}if(this.PopupImageBox){this.PopupImageBox.style.display="none";this.PopupIconCell.style.minWidth=""}}else{if(this.CommandImg){this.CommandImg.src=RD3_Glb.GetImgSrc("images/"+this.Image);this.CommandImg.style.display="inline"}if(this.CommandImgDX&&!(this.IsCmdSet&&this.Image!="")){this.CommandImgDX.src=RD3_Glb.GetImgSrc("images/"+this.Image);this.CommandImgDX.style.display="inline";if(!RD3_Glb.IsIE(10,false)){this.CommandImgDX.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}}if(this.IsToolbar&&this.ToolImg!=null){this.ToolImg.src=RD3_Glb.GetImgSrc("images/"+this.Image);this.ToolImg.style.display=""}if(this.Button){this.Button.src=RD3_Glb.GetImgSrc("images/"+this.Image)}if(this.PopupImageBox){this.PopupImageBox.src=RD3_Glb.GetImgSrc("images/"+this.Image);this.PopupImageBox.style.display="";this.PopupIconCell.style.minWidth="16px"}}}}};Command.prototype.SetEnabled=function(c){var a=this.Enabled;if(c!=undefined){this.Enabled=c}if(this.Realized&&!this.IsSeparator()){if(this.Enabled){if(this.IsMenu){if(this.CommandLink){RD3_Glb.RemoveClass(this.CmdBox,"menu-item-disabled");if(this.IsCmdSet){if(this.MenuBox&&this.Expanded){this.MenuBox.style.display=""}}}else{RD3_Glb.RemoveClass(this.MyBox,"menu-bar-disabled")}}if(this.IsToolbar&&this.MyToolBox){if(!this.IsCmdSet){var b=(this.ParentCmdSet)?this.ParentCmdSet.ToolCont:-1;if(!this.IsSeparator()){if(!this.ShowNames){if(b==0){this.MyToolBox.className="toolbar-form-command"}else{if(b==-1){this.MyToolBox.className=((RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?"taskbar-":"")+"toolbar-command"}else{this.MyToolBox.className="toolbar-frame-command"+(this.UseSmallIcon()?"-small":"")}}}else{this.MyToolBox.className="toolbar-command-showcaption"}if(b==0){if(this.Image!=""){this.ToolImg.className="toolbar-form-image"+(this.UseHL?"-hl":"")}else{this.ToolImg.className="toolbar-button toolbar-form-button"}}else{if(b==-1){if(this.Image!=""){this.ToolImg.className="toolbar-image"+(this.UseHL?"-hl":"")}else{this.ToolImg.className="toolbar-button toolbar-main-button"}}else{if(this.Image!=""){this.ToolImg.className="toolbar-frame-image"+((this.UseHL)?"-hl":"")+(this.UseSmallIcon()?"-small":"")}else{this.ToolImg.className="toolbar-button toolbar-frame-button"+(this.UseSmallIcon()?"-small":"")}}}}else{if(b==0){this.MyToolBox.className="toolbar-form-separator"}else{if(b==-1){this.MyToolBox.className="toolbar-separator"}else{this.MyToolBox.className="toolbar-frame-separator"+(this.UseSmallIcon()?"-small":"")}}}}else{if(this.ToolCont<0){this.MyToolBox.className=((RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?"taskbar-":"")+"toolbar-container"}else{if(this.ToolCont==0){this.MyToolBox.className="toolbar-form-container"}else{this.MyToolBox.className="toolbar-frame-container"+(this.UseSmallIcon()?"-small":"")}}}if(a!=this.Enabled){this.MyToolBox.style.display=""}}if(this.Button){this.Button.disabled=""}if(this.ButtonBox&&this.IsCmdSet){this.ButtonBox.style.display=""}if(this.PopupText&&!this.IsSeparator()){RD3_Glb.RemoveClass(this.PopupText,"popup-menu-disabled")}}else{if(this.IsMenu){if(this.CommandLink){if(!this.IsCmdSet){if(!this.IsSeparator()){RD3_Glb.AddClass(this.CmdBox,"menu-item-disabled")}}else{RD3_Glb.AddClass(this.CmdBox,"menu-item-disabled");if(this.MenuBox){this.MenuBox.style.display="none"}}}else{RD3_Glb.AddClass(this.MyBox,"menu-bar-disabled")}}if(this.IsToolbar&&this.MyToolBox){if(this.Image!=""){this.MyToolBox.style.display="none"}else{if(!this.IsCmdSet){var b=(this.ParentCmdSet)?this.ParentCmdSet.ToolCont:-1;if(b==-1){this.MyToolBox.className=((RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?"taskbar-":"")+"toolbar-command";this.ToolImg.className="toolbar-button toolbar-main-button"}else{if(b==0){this.MyToolBox.className="toolbar-form-command";this.ToolImg.className="toolbar-button toolbar-form-button"}else{this.MyToolBox.className="toolbar-frame-command"+(this.UseSmallIcon()?"-small":"");this.ToolImg.className="toolbar-button toolbar-frame-button"+(this.UseSmallIcon()?"-small":"")}}}}}if(this.Button){this.Button.disabled="disabled"}if(this.ButtonBox&&this.IsCmdSet){this.ButtonBox.style.display="none"}if(this.PopupText){RD3_Glb.AddClass(this.PopupText,"popup-menu-disabled")}}}};Command.prototype.SetVisible=function(e){var a=this.Visible;if(e!=undefined){this.Visible=e}if(this.Realized&&(a!=this.Visible||e==undefined)){var d=this.IsVisible();var b=d?"":"none";if(this.MyBox){if(this.MyBox.style.display!=b){this.MyBox.style.display=b;if(b==""){this.AdaptLayout()}RD3_DesktopManager.WebEntryPoint.AdaptFormListBox()}if(this.Level==1&&this.IsCmdSet&&this.MenuSep&&!RD3_Glb.IsMobile()){this.MenuSep.style.display=b;if(a!=this.Visible){RD3_DesktopManager.WebEntryPoint.CmdObj.AdaptFirstLevelSeparator()}}}if(this.MyToolBox){if(this.MyToolBox!=RD3_DesktopManager.WebEntryPoint.ToolBarBox){if(this.MyToolBox.style.display!=b){this.MyToolBox.style.display=b;if(this.ParentCmdSet&&this.ParentCmdSet.IsToolbar&&this.ParentCmdSet.ToolCont==0&&this.ParentCmdSet.FormIndex){var c=RD3_DesktopManager.ObjectMap["frm:"+this.ParentCmdSet.FormIndex];if(c&&c.Realized){c.AdaptToolbarLayout()}}}}}if(this.ButtonBox){this.ButtonBox.style.display=b}if(this.PopupItemBox){this.PopupItemBox.style.display=b}if(this.BadgeObj){this.BadgeObj.style.display=b}if(this.ParentCmdSet&&!(e==undefined&&this.Visible==true)){this.ParentCmdSet.RecalcSeparatorLayout=true}if(RD3_Glb.IsMobile()&&this.Level==1&&this.IsCmdSet){RD3_DesktopManager.WebEntryPoint.RecalcLayout=true}}};Command.prototype.SetCanDrag=function(a){if(a!=undefined){this.CommandCanDrag=a}};Command.prototype.SetCanDrop=function(a){if(a!=undefined){this.CommandCanDrop=a}};Command.prototype.Realize=function(c,a){if(RD3_Glb.IsMobile()){if(this.IsMenu){if(this.ShowGroupedMenu()){this.RealizeGroupedMenu(c)}else{this.RealizeMenuBar(c)}}}else{if(this.IsMenu){if(RD3_Glb.IsTouch()&&this.IsSeparator()){return}if(RD3_DesktopManager.WebEntryPoint.MenuType!=RD3_Glb.MENUTYPE_MENUBAR){this.RealizeSideMenu(c)}else{if(this.Level==1){this.RealizeMenuBar(c)}}}if(this.IsToolbar){this.RealizeToolbar(a)}var d=this.Commands.length;for(var b=0;b<d;b++){if(this.MyToolBox==null){this.MyToolBox=a}this.Commands[b].Realize(this.MenuBox,this.MyToolBox)}}this.Realized=true;this.SetCaption();this.SetTooltip();this.SetToolName();this.SetExpanded();this.SetImage();this.SetEnabled();this.SetVisible();this.SetBadge()};Command.prototype.RealizeMenuBar=function(a){if(!a){return}this.MyBox=document.createElement("span");this.MyBox.setAttribute("id",this.Identifier);this.MyBox.className="menu-bar-command";if(!RD3_Glb.IsMobile()){this.MyBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev)")}this.UseHL=true;a.appendChild(this.MyBox)};Command.prototype.RealizeGroupedMenu=function(b){if(!b){return}this.MyBox=document.createElement("span");this.MyBox.setAttribute("id",this.Identifier);this.MyBox.className="menu-group-header";this.UseHL=true;b.appendChild(this.MyBox);this.MenuBox=document.createElement("div");this.MenuBox.setAttribute("id",this.Identifier+":sub");this.MenuBox.className="menu-group-cont";b.appendChild(this.MenuBox);for(var a=0;a<this.Commands.length;a++){if(this.Commands[a].IsSeparator()){this.MenuBox=document.createElement("div");this.MenuBox.setAttribute("id",this.Identifier+":sub");this.MenuBox.className="menu-group-cont";b.appendChild(this.MenuBox)}else{this.Commands[a].Realize(this.MenuBox)}}};Command.prototype.RealizeSideMenu=function(b){if(!b){return}this.MyBox=document.createElement("div");this.MyBox.setAttribute("id",this.Identifier);this.MyBox.className="menu-container-level-"+this.Level;if(this.Level==1&&this.IsCmdSet){this.MenuSep=document.createElement("div");this.MenuSep.setAttribute("id",this.Identifier+":menusep");this.MenuSep.className="menu-separator-level-1";if(RD3_ServerParams.Theme!="seattle"){this.MenuSepImg=document.createElement("img");this.MenuSepImg.src=RD3_Glb.GetImgSrc("images/menusep.gif");this.MenuSepImg.className="menu-separator-img";this.MenuSep.appendChild(this.MenuSepImg)}this.MyBox.appendChild(this.MenuSep)}this.CmdBox=document.createElement("div");this.CmdBox.setAttribute("id",this.Identifier+":header");this.BranchImg=document.createElement("img");this.BranchImg.className="menu-"+(this.IsCmdSet?"commandset":"command")+"-branchimage-level-"+this.Level;if(this.Level>1){this.BranchImg.src=RD3_Glb.GetImgSrc("images/cmdmlev"+this.Level+".gif")}else{this.BranchImg.removeAttribute("src")}this.BranchImg.removeAttribute("width");this.BranchImg.removeAttribute("height");if(this.IsSeparator()){this.CmdBox.className="menu-separator-level-"+this.Level}else{var a=RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR;if(this.IsCmdSet){this.CmdBox.className="menu-commandset-level-"+this.Level+((a)?" taskbar-commandset-level-"+this.Level:"")}else{this.CmdBox.className="menu-command-level-"+this.Level+((a)?" taskbar-command-level-"+this.Level:"")}this.CommandLink=document.createElement("a");this.CommandLink.setAttribute("id",this.Identifier+":link");if(this.IsCmdSet){this.CommandLink.className="menu-commandset-link-level-"+this.Level}else{this.CommandLink.className="menu-command-link-level-"+this.Level}this.CmdBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev)");RD3_Glb.AddHLEvents(this.CmdBox,this.Identifier);this.CommandImg=document.createElement("img");this.CommandImg.setAttribute("id",this.Identifier+":image");if(this.IsCmdSet&&this.Image==""){this.CommandImg.className="menu-commandset-image-level-"+this.Level}else{this.CommandImg.className="menu-command-image-level-"+this.Level}this.CommandImgDX=document.createElement("img");this.CommandImgDX.setAttribute("id",this.Identifier+":image");if(this.IsCmdSet){this.CommandImgDX.className="menu-commandset-imagedx-level-"+this.Level}else{this.CommandImgDX.className="menu-command-imagedx-level-"+this.Level}this.CommandText=document.createTextNode("");this.MenuBox=document.createElement("div");this.MenuBox.setAttribute("id",this.Identifier+":sub");this.MenuBox.className="submenu-container-level-"+this.Level;this.CommandLink.appendChild(this.CommandText);this.CmdBox.appendChild(this.BranchImg);this.CmdBox.appendChild(this.CommandImg);this.CmdBox.appendChild(this.CommandLink);this.CmdBox.appendChild(this.CommandImgDX)}this.MyBox.appendChild(this.CmdBox);if(this.IsCmdSet){this.MyBox.appendChild(this.MenuBox)}b.appendChild(this.MyBox)};Command.prototype.RealizeToolbar=function(a){if(!a){return}if(this.IsCmdSet){if(this.Level==1){this.MyToolBox=document.createElement("span");this.MyToolBox.className=((RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?"taskbar-":"")+"toolbar-container";a.appendChild(this.MyToolBox)}}else{if(this.IsSeparator()){this.MyToolBox=document.createElement("span");this.MyToolBox.className="toolbar-separator";a.appendChild(this.MyToolBox)}else{this.MyToolBox=document.createElement("span");this.MyToolBox.setAttribute("id",this.Identifier);if(this.Image!=""){this.ToolImg=document.createElement("img")}else{this.ToolImg=document.createElement("input");this.ToolImg.type="button";this.ToolImg.disabled=!this.Enabled;this.ToolImg.value=this.Caption;if(this.Enabled){this.ToolImg.style.cursor="pointer"}this.MyToolBox.style.cursor="default"}this.ToolImg.setAttribute("id",this.Identifier+":img");this.MyToolBox.className=((RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?"taskbar-":"")+"toolbar-command";this.ToolImg.className="toolbar-image"+(this.UseHL?"-hl":"");this.MyToolBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev)");this.MyToolBox.appendChild(this.ToolImg);a.appendChild(this.MyToolBox);if(this.ShowNames){this.ToolText=document.createTextNode("");this.MyToolBox.className="toolbar-command-showcaption";this.MyToolBox.appendChild(this.ToolText)}}}};Command.prototype.RealizeButtonBar=function(b){if(this.IsCmdSet){b.ButtonBarContainer=document.createElement("div");b.ButtonBarContainer.className="button-bar-container";if(b.VerticalLayout){RD3_Glb.AddClass(b.ButtonBarContainer,"button-bar-vertical")}var c=this.Commands.length;for(var a=0;a<c;a++){this.Commands[a].RealizeButtonBar(b)}b.ContentBox.appendChild(b.ButtonBarContainer);this.ButtonBox=b.ButtonBarContainer;this.SetVisible(this.Visible);this.SetEnabled(this.Enabled)}else{if(this.IsSeparator()){this.ButtonBox=document.createElement(b.VerticalLayout?"div":"span");this.ButtonBox.className="button-bar-"+(b.VerticalLayout?"vertical":"horizontal")+"-separator";b.ButtonBarContainer.appendChild(this.ButtonBox)}else{if(b.ButtonBarContainer){this.ButtonBox=document.createElement(b.VerticalLayout?"div":"span");this.Button=document.createElement("input");this.Button.setAttribute("id",this.Identifier);this.ButtonBox.className="button-bar-button-box";this.Button.className="button-bar-button";this.Button.type="button";if(this.Width){this.Button.style.width=this.Width+"px"}this.Button.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnButtonBarClick', ev)");RD3_Glb.AddHLEvents(this.Button,this.Identifier,"OnBBMouseOver","OnBBMouseOut");this.ButtonBox.appendChild(this.Button);b.ButtonBarContainer.appendChild(this.ButtonBox);this.Realized=true;this.SetCaption(this.Caption);this.SetTooltip(this.Tooltip);this.SetImage(this.Image);this.SetEnabled(this.Enabled);this.SetVisible(this.Visible)}}}this.BBParent=b};Command.prototype.AdaptLayout=function(){if(this.Button){if(this.BBParent.VerticalLayout){var d=0;if(RD3_Glb.IsTouch()){d=4}if(RD3_Glb.IsMobile()){d=8}this.Button.style.width=(this.BBParent.ContentBox.clientWidth-d)+"px"}}var a=0;var f=this.Commands.length;var e=null;for(var b=0;b<f;b++){var c=this.Commands[b];c.AdaptLayout();if(c.IsVisible()){e=c}}if(e!=null&&e.BranchImg!=null&&this.Level>1){e.BranchImg.src=RD3_Glb.GetImgSrc("images/cmdmlev"+e.Level+"end.gif");e=null}if(this.CommandImgDX&&this.CommandImgDX.src&&!RD3_DesktopManager.WebEntryPoint.CmdObj.SuppressMenu){this.CommandImgDX.style.marginLeft=(this.CmdBox.offsetWidth-this.CommandImg.offsetWidth-this.CommandImgDX.offsetWidth-this.CommandLink.offsetWidth-4)+"px"}if(RD3_Glb.IsSmartPhone()&&this.IsCmdSet&&this.Realized){this.SetImage()}if(RD3_Glb.IsMobile()&&this.Realized){this.SetBadge()}};Command.prototype.OnReadyStateChange=function(){if(this.CommandImgDX&&this.CommandImgDX.src&&!RD3_DesktopManager.WebEntryPoint.CmdObj.SuppressMenu){this.CommandImgDX.style.marginLeft=(this.CmdBox.offsetWidth-this.CommandImg.offsetWidth-this.CommandImgDX.offsetWidth-this.CommandLink.offsetWidth-4)+"px"}};Command.prototype.Unrealize=function(b){if(this.ParentCmdSet&&!b){this.ParentCmdSet=null}if(this.MyBox){this.MyBox.parentNode.removeChild(this.MyBox)}if(this.MyToolBox&&this.MyToolBox.parentNode){this.MyToolBox.parentNode.removeChild(this.MyToolBox)}if(this.ButtonBox){this.ButtonBox.parentNode.removeChild(this.ButtonBox)}if(this.Popover){this.Popover.Unrealize()}if(!b){RD3_DesktopManager.ObjectMap[this.Identifier]=null;this.Commands=new Array()}var c=this.Commands.length;for(var a=0;a<c;a++){this.Commands[a].Unrealize(b)}this.MyBox=null;this.CmdBox=null;this.MenuBox=null;this.CommandLink=null;this.CommandImg=null;this.CommandText=null;this.MenuSep=null;this.MenuSepImg=null;this.MyToolBox=null;this.ToolImg=null;this.ToolText=null;this.ButtonBox=null;this.Button=null;this.BBParent=null;this.Expanded=false;this.BadgeObj=null;this.Realized=false};Command.prototype.UnrealizeButtonBar=function(){if(this.ButtonBox){this.ButtonBox.parentNode.removeChild(this.ButtonBox)}var b=this.Commands.length;for(var a=0;a<b;a++){this.Commands[a].UnrealizeButtonBar()}this.ButtonBox=null;this.Button=null;this.BBParent=null};Command.prototype.IsVisible=function(){var g=this.Visible;if(g){if(this.FormIndex>0&&(this.IsMenu||this.IsToolbar)){var h=false;var b=RD3_DesktopManager.WebEntryPoint.ActiveForm;if(b&&b.IdxForm==this.FormIndex){h=true}var e=h?0:RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var c=0;c<e;c++){var d=RD3_DesktopManager.WebEntryPoint.StackForm[c];if(d.Docked&&d.IdxForm==this.FormIndex){h=true;break}}if(!h){h=this.CheckSubForm()}if(!h){g=false}if(!g&&!this.IsMenu&&this.IsToolbar&&this.MyToolBox&&this.MyToolBox.parentNode&&this.MyToolBox.parentNode!=RD3_DesktopManager.WebEntryPoint.ToolBarBox){g=true}}if(this.ToolCont>0&&g){var d=RD3_DesktopManager.ObjectMap["frm:"+this.FormIndex];if(d){var a=d.Frames[this.ToolCont-1];if(a&&(a.Collapsed||!a.Visible||!a.Realized)){g=false}}}}return g};Command.prototype.IsEnabled=function(){var b=this.Enabled;if(b){if(this.FormIndex>0&&(this.IsMenu||this.IsToolbar)){var g=false;var a=RD3_DesktopManager.WebEntryPoint.ActiveForm;if(a&&a.IdxForm==this.FormIndex){g=true}var e=g?0:RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var c=0;c<e;c++){var d=RD3_DesktopManager.WebEntryPoint.StackForm[c];if(d.Docked&&d.IdxForm==this.FormIndex){g=true;break}}if(!g){g=this.CheckSubForm()}if(!g&&!this.IsMenu&&this.IsToolbar&&this.MyToolBox&&this.MyToolBox.parentNode&&this.MyToolBox.parentNode!=RD3_DesktopManager.WebEntryPoint.ToolBarBox){g=true}if(!g){b=false}if(this.BBParent){b=true}}}return b};Command.prototype.IsSeparator=function(){return this.Caption==""};Command.prototype.OnClick=function(d,f){var e=RD3_DesktopManager.WebEntryPoint;if(RD3_Glb.IsAndroid()){RD3_DDManager.ChompClick()}if(this.IsCmdSet&&RD3_Glb.IsMobile()&&this.GetPopover){RD3_DesktopManager.WebEntryPoint.DisableOnClick++}e.CmdObj.ClosePopup(this.IsCmdSet?this:null);if(!this.IsCmdSet&&this.FormIndex==0){RD3_DDManager.ClosePopup(true)}if(RD3_Glb.IsSmartPhone()&&!this.IsCmdSet&&this.FormIndex==0){if(e.CmdObj.ForceMenuBar){e.CmdObj.ForceMenuBar=false;e.RecalcLayout=true}}if(this.IsVisible()&&this.IsEnabled()){if(this.RequireConf&&!f){this.MsgBox=new MessageBox(this.Caption+": "+RD3_ServerParams.ConfirmMenu,RD3_Glb.MSG_CONFIRM,false);this.MsgBox.CallBackFunction=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev, true)");this.MsgBox.Open();return}if(this.RequireConf&&f){if(this.MsgBox.UserResponse!="Y"){return}}var a=this.IsCmdSet?this.ExpandEventDef:this.ClickEventDef;var b=new IDEvent("clk",this.Identifier,d,a);if(!this.IsCmdSet){e.SoundAction("command","play")}if(RD3_Glb.IsMobile()){e.CmdObj.ActiveCommand=this;this.SetMenuClass();if(this.IsToolbar){var c=(window.event)?d.srcElement:d.explicitOriginalTarget;if(c==this.ToolImg){RD3_KBManager.ActiveButton=c}}}if(b.ClientSide){if(this.IsCmdSet||(this.FormList&&RD3_DesktopManager.WebEntryPoint.StackForm.length>0)){if(e.MenuType!=RD3_Glb.MENUTYPE_MENUBAR&&!this.PopupTextCell&&!RD3_Glb.IsMobile()){this.SetExpanded(!this.Expanded);if(d&&e.MenuType==RD3_Glb.MENUTYPE_TASKBAR){RD3_Glb.StopEvent(d)}}else{if(RD3_Glb.IsMobile()){this.SetExpanded(!this.Expanded)}else{if(this.MyBox){RD3_Glb.AddClass(this.MyBox,"menu-bar-hover")}if(this.PopupTextCell){RD3_Glb.AddClass(this.PopupTextCell,"popup-menu-hover")}this.Popup(this);e.CmdObj.MenuBarOpen=true}if(d){RD3_Glb.StopEvent(d)}}}else{if(this.CallBackFunction){this.CallBackFunction()}}}}};Command.prototype.OnBack=function(b){if(this.GetPopover()){RD3_DesktopManager.WebEntryPoint.DisableOnClick++}var a=new IDEvent("clk",this.Identifier,b,this.ExpandEventDef);this.SetExpanded(false)};Command.prototype.OnEndAnimation=function(b){if(RD3_Glb.GetTransitionDuration(this.MenuBox)==""){return}var a=(!this.IsFirstLevel())?this.ParentCmdSet.MenuBox:RD3_DesktopManager.WebEntryPoint.MenuBox;RD3_Glb.SetTransitionDuration(this.MenuBox,"");RD3_Glb.SetTransitionDuration(a,"");this.MenuBox.style.display=this.Expanded?"":"none";a.style.display=this.Expanded?"none":"";if(!this.Expanded){RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveCommand=null;this.SetMenuClass()}RD3_DesktopManager.WebEntryPoint.CmdObj.Expanding=false};Command.prototype.SetMenuClass=function(d){var c=null;if(d){c=this.Commands}else{if(RD3_DesktopManager.WebEntryPoint.CmdObj.ShowGroups&&this.ParentCmdSet&&this.ParentCmdSet.FormIndex==0&&this.ParentCmdSet.Level==1){var g=RD3_DesktopManager.WebEntryPoint.CmdObj.CommandSets.length;c=new Array();for(var e=0;e<g;e++){var b=RD3_DesktopManager.WebEntryPoint.CmdObj.CommandSets[e];if(b.FormIndex==0){for(var a=0;a<b.Commands.length;a++){c.push(b.Commands[a])}}}}else{if(this.ParentCmdSet){c=this.ParentCmdSet.Commands}else{c=RD3_DesktopManager.WebEntryPoint.CmdObj.CommandSets}}}var g=c.length;for(var e=0;e<g;e++){var f=c[e].MyBox;if(f){if(c[e]==RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveCommand){RD3_Glb.AddClass(f,"menu-bar-hover")}else{RD3_Glb.RemoveClass(f,"menu-bar-hover")}c[e].SetImage(undefined,true)}}};Command.prototype.OnMouseOverObj=function(c,b){if(this.IsSeparator()||!this.Enabled){return}if(this.IsToolbar&&((b==this.MyToolBox||b==this.ToolImg||b==this.ToolText)&&this.UseHL)){var a=(this.ParentCmdSet)?this.ParentCmdSet.ToolCont:-1;if(a==0){RD3_Glb.AddClass(this.ToolImg,"form-caption-hover")}else{if(a==-1){RD3_Glb.AddClass(this.ToolImg,"toolbar-image-hover")}else{RD3_Glb.AddClass(this.ToolImg,"frame-caption-hover"+(this.UseSmallIcon()?"-small":""))}}}if(this.IsToolbar&&b==this.ToolImg&&this.Image==""){var a=(this.ParentCmdSet)?this.ParentCmdSet.ToolCont:-1;if(a==-1){RD3_Glb.AddClass(this.ToolImg,"main-button-hover")}else{if(a==0){RD3_Glb.AddClass(this.ToolImg,"form-button-hover")}else{RD3_Glb.AddClass(this.ToolImg,"frame-button-hover")}}}if(this.IsMenu&&this.Level==1&&b==this.MyBox&&this.Enabled&&RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_MENUBAR){RD3_Glb.AddClass(this.MyBox,"menu-bar-hover");if(RD3_DesktopManager.WebEntryPoint.CmdObj.MenuBarOpen&&!this.PopupContainerBox){this.OnClick()}}if(b==this.PopupTextCell||b==this.PopupText){RD3_Glb.AddClass(this.PopupTextCell,"popup-menu-hover");if(this.IsCmdSet&&!this.PopupContainerBox&&this.PopupTimer==0){this.PopupTimer=window.setTimeout(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev, true)"),500)}this.CloseOtherPopup()}if((RD3_Glb.IsIE(6)||RD3_Glb.IsTouch())&&this.IsMenu&&(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_LEFTSB||RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_RIGHTSB)){if(this.IsCmdSet){RD3_Glb.AddClass(this.MyBox,"menu-commandset-level-"+this.Level+"-hover")}else{RD3_Glb.AddClass(this.MyBox,"menu-command-level-"+this.Level+"-hover")}}};Command.prototype.OnMouseOutObj=function(b,a){if(this.IsSeparator()){return}if(this.IsToolbar&&(a==this.MyToolBox||a==this.ToolImg||a==this.ToolText)){RD3_Glb.RemoveClass(this.ToolImg,"form-caption-hover");RD3_Glb.RemoveClass(this.ToolImg,"form-caption-press");RD3_Glb.RemoveClass(this.ToolImg,"frame-caption-hover");RD3_Glb.RemoveClass(this.ToolImg,"frame-caption-press");RD3_Glb.RemoveClass(this.ToolImg,"frame-caption-hover-small");RD3_Glb.RemoveClass(this.ToolImg,"frame-caption-press-small");RD3_Glb.RemoveClass(this.ToolImg,"toolbar-image-hover");RD3_Glb.RemoveClass(this.ToolImg,"toolbar-image-press");RD3_Glb.RemoveClass(this.ToolImg,"main-button-hover");RD3_Glb.RemoveClass(this.ToolImg,"form-button-hover");RD3_Glb.RemoveClass(this.ToolImg,"frame-button-hover")}if(this.IsMenu&&this.Level==1&&(this.PopupContainerBox==null||this.IsClosing)&&a==this.MyBox&&RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_MENUBAR){RD3_Glb.RemoveClass(this.MyBox,"menu-bar-hover")}if(this.IsMenu&&a==this.PopupTextCell&&(this.PopupContainerBox==null||this.IsClosing)){RD3_Glb.RemoveClass(this.PopupTextCell,"popup-menu-hover");if(this.PopupTimer!=0){window.clearTimeout(this.PopupTimer);this.PopupTimer=0}}if((RD3_Glb.IsIE(6)||RD3_Glb.IsTouch())&&this.IsMenu&&(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_LEFTSB||RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_RIGHTSB)){if(this.IsCmdSet){RD3_Glb.RemoveClass(this.MyBox,"menu-commandset-level-"+this.Level+"-hover")}else{RD3_Glb.RemoveClass(this.MyBox,"menu-command-level-"+this.Level+"-hover")}}};Command.prototype.OnMouseDownObj=function(d,c){if(this.IsSeparator()){return}if(this.IsToolbar&&(c==this.MyToolBox||c==this.ToolImg||c==this.ToolText)&&this.UseHL){var b=(this.ParentCmdSet)?this.ParentCmdSet.ToolCont:-1;if(b==0){RD3_Glb.AddClass(this.ToolImg,"form-caption-press")}else{if(b==-1){RD3_Glb.AddClass(this.ToolImg,"toolbar-image-press")}else{RD3_Glb.AddClass(this.ToolImg,"frame-caption-press"+(this.UseSmallIcon()?"-small":""))}}}if(this.IsToolbar&&c==this.ToolImg&&this.Image==""&&this.Enabled){var b=(this.ParentCmdSet)?this.ParentCmdSet.ToolCont:-1;if(b==-1){RD3_Glb.AddClass(this.ToolImg,"main-button-press")}else{if(b==0){RD3_Glb.AddClass(this.ToolImg,"form-button-press")}else{RD3_Glb.AddClass(this.ToolImg,"frame-button-press")}}if(RD3_Glb.IsIE()){try{RD3_DesktopManager.WebEntryPoint.CommandInput.focus()}catch(a){}}window.setTimeout(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseUpObj')"),300)}};Command.prototype.OnMouseUpObj=function(){RD3_Glb.RemoveClass(this.ToolImg,"main-button-press");RD3_Glb.RemoveClass(this.ToolImg,"form-button-press");RD3_Glb.RemoveClass(this.ToolImg,"frame-button-press");if(RD3_Glb.IsIE()){try{RD3_DesktopManager.WebEntryPoint.CommandInput.focus()}catch(a){}}};Command.prototype.ActiveFormChanged=function(){if(this.ToolCont>=0&&this.IsToolbar){if(this.ToolCont==0){var d=RD3_DesktopManager.ObjectMap["frm:"+this.FormIndex];if(d&&d.Realized){if(!this.MyToolBox&&RD3_Glb.IsMobile()){this.RealizeToolbar(d.CaptionBox);for(var b=0;b<this.Commands.length;b++){this.Commands[b].RealizeToolbar(this.MyToolBox);this.Commands[b].Realize(this.MenuBox,this.MyToolBox)}}d.AttachToolbar(this);if(!this.IsToolBarLoaded()){this.ToolTimer=window.setTimeout(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'ToolbarLoadedUpdate', ev, true)"),100)}}}if(this.ToolCont>0){var d=RD3_DesktopManager.ObjectMap["frm:"+this.FormIndex];if(d){var a=d.Frames[this.ToolCont-1];if(a&&a.ToolbarBox&&!this.MyToolBox&&RD3_Glb.IsMobile()){this.RealizeToolbar(a.ToolbarBox);for(var b=0;b<this.Commands.length;b++){this.Commands[b].RealizeToolbar(this.MyToolBox);this.Commands[b].Realize(this.MenuBox,this.MyToolBox)}}if(a&&a.ToolbarBox&&this.MyToolBox&&this.MyToolBox.parentNode!=a.ToolbarBox){if(this.MyToolBox.parentNode){this.MyToolBox.parentNode.removeChild(this.MyToolBox)}if(a instanceof IDPanel){a.AppendCmsToToolbar(this.MyToolBox)}else{a.ToolbarBox.appendChild(this.MyToolBox)}}}}}this.SetVisible();this.SetEnabled();var c=this.Commands.length;for(var b=0;b<c;b++){this.Commands[b].ActiveFormChanged()}};Command.prototype.OnBBMouseOver=function(a){};Command.prototype.OnBBMouseOut=function(a){};Command.prototype.OnButtonBarClick=function(b){if(this.IsVisible()&&this.IsEnabled()){var a=new IDEvent("btb",this.BBParent.Identifier,b,this.ClickEventDef,this.Identifier)}};Command.prototype.Popup=function(a){if(this.PopupContainerBox!=null){this.ClosePopup()}if(this.PopupTimer){window.clearTimeout(this.PopupTimer);this.PopupTimer=0}if(RD3_Glb.IsMobile()){var l=RD3_DesktopManager.WebEntryPoint;l.CmdObj.ActiveCommand=null;this.LoadNestedMenu(true,true);var k=(RD3_Glb.IsSmartPhone()?l.WepBox:l.SideMenuBox).offsetWidth;if(k==0||(RD3_Glb.IsPortrait()&&!RD3_Glb.IsSmartPhone())){k=300}var d=0;for(var e=0;e<this.Commands.length;e++){if(this.Commands[e].IsVisible()){d++}}if(d==0){d=1}var f=d*44+48;var b=l.WepBox.offsetHeight*(RD3_Glb.IsSmartPhone()?0.8:0.5);if(f>b){f=b}this.Popover.SetWidth(k);this.Popover.SetHeight(f);var c=this.GetObjToAttach(a);if(c==null){var j=parseInt(a.getAttribute("xpos"));var g=parseInt(a.getAttribute("ypos"));c=new Object();c.offsetWidth=0;c.offsetHeight=0;c.x=j;c.y=g;c.Point=true}this.Popover.AttachTo(c);this.Popover.Host(null,this.PopupMobileBox,true);RD3_DDManager.AddPopup(this.Popover);this.Popover.Open()}else{if(this.IsClosing&&this.Gfx){this.Gfx.SetFinished()}this.Gfx=new GFX("popup",true,this,false,null,this.PopupAnimDef);this.Gfx.Node=a;RD3_GFXManager.AddEffect(this.Gfx)}};Command.prototype.RealizePopupItem=function(a){this.PopupItemBox=document.createElement("tr");this.PopupItemBox.setAttribute("id",this.Identifier+":tr");this.PopupItemBox.className="popup-menu-item";this.PopupItemBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev)");this.PopupIconCell=document.createElement("td");this.PopupIconCell.setAttribute("id",this.Identifier+":tdi");this.PopupIconCell.className="popup-cell-icon";this.PopupImageBox=document.createElement("img");this.PopupImageBox.setAttribute("id",this.Identifier+":pm");this.PopupImageBox.className="popup-menu-image";if(this.IsSeparator()){this.PopupImageBox.style.display="none"}this.PopupTextCell=document.createElement("td");this.PopupTextCell.setAttribute("id",this.Identifier+":txt");this.PopupTextCell.className="popup-cell-text"+(this.IsSeparator()?"-sep":"");if(this.IsCmdSet){RD3_Glb.AddClass(this.PopupTextCell,"popup-menu-popup")}this.PopupText=document.createElement("span");this.PopupText.setAttribute("id",this.Identifier+":cap");this.PopupText.className="popup-menu-text"+(this.IsSeparator()?"-sep":"");this.PopupIconCell.appendChild(this.PopupImageBox);this.PopupTextCell.appendChild(this.PopupText);this.PopupItemBox.appendChild(this.PopupIconCell);this.PopupItemBox.appendChild(this.PopupTextCell);a.appendChild(this.PopupItemBox);this.SetVisible();this.SetCaption();this.SetTooltip();this.SetImage(undefined,true);this.SetEnabled()};Command.prototype.ClosePopup=function(d){var c=true;var a=d;while(a&&c){if(a==this){c=false}a=a.ParentCmdSet}if(!c){return}if(this.PopupTimer){window.clearTimeout(this.PopupTimer);this.PopupTimer=0}if(this.Popover){this.Popover.Close();return}if(this.PopupContainerBox!=null&&!this.IsClosing){this.IsClosing=true;this.Gfx=new GFX("popup",false,this,false,null,this.PopupAnimDef);RD3_GFXManager.AddEffect(this.Gfx);this.OnMouseOutObj(null,this.MyBox);var e=this.Commands.length;for(var b=0;b<e;b++){this.Commands[b].ClosePopup(d)}}};Command.prototype.GetDOMObj=function(a){if(a=="toolbar"){return this.MyToolBox}if(this.CommandLink){return this.CommandLink}if(this.Level>1&&this.PopupItemBox){return this.PopupItemBox}return this.MyBox?this.MyBox:this.MyToolBox};Command.prototype.HandleFunctionKeys=function(e,h,a){var f=(e.charCode)?e.charCode:e.keyCode;var d=false;var b=(f-111)+(e.shiftKey?12:0)+(e.ctrlKey?24:0);d=b==this.FKNum;d=d&&(this.IsMenu||this.IsToolbar);if(h>-1&&a==-1){d=d&&(this.ToolCont==-1&&h==this.FormIndex)}if(h>-1&&a>-1){d=d&&(this.ToolCont==a&&h==this.FormIndex)}if(d){this.OnClick(e)}var g=this.Commands.length;for(var c=0;c<g&&!d;c++){d=this.Commands[c].HandleFunctionKeys(e,h,a)}return d};Command.prototype.IsToolBarLoaded=function(){var c=this.Commands.length;for(var a=0;a<c;a++){var b=this.Commands[a];if(b.ToolImg&&b.Image!=""&&!b.ToolImg.complete){return false}}return true};Command.prototype.ToolbarLoadedUpdate=function(){var b=RD3_DesktopManager.ObjectMap["frm:"+this.FormIndex];if(b){if(this.IsToolBarLoaded()){if(this.ToolTimer){window.clearTimeout(this.ToolTimer)}this.ToolTimer=null;b.AdaptToolbarLayout();if(this.ToolCont>0&&(RD3_Glb.IsQuadro()||RD3_Glb.IsMobile7())){var a=b.Frames[this.ToolCont-1];if(a&&a.UpdateToolbar){a.UpdateToolbar()}}}else{this.ToolTimer=window.setTimeout(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'ToolbarLoadedUpdate', ev, true)"),100)}}};Command.prototype.UseSmallIcon=function(){var c=this;if(this.ParentCmdSet){c=this.ParentCmdSet}if(c.ToolCont>0){var b=RD3_DesktopManager.ObjectMap["frm:"+c.FormIndex];if(b){var a=b.Frames[c.ToolCont-1];if(a){return a.SmallIcons}}}return false};Command.prototype.RecalcSeparator=function(){if(!this.Realized){return false}if(!this.IsCmdSet){return}if(this.RecalcSeparatorLayout){var f=false;var g=this.Commands.length;for(var b=0;b<g;b++){var e=this.Commands[b];if(e&&!e.IsSeparator()&&e.IsVisible()){f=true}if(e&&e.IsSeparator()){var a=false;for(var d=b+1;d<g;d++){var c=this.Commands[d];if(c&&!c.IsSeparator()&&c.IsVisible()){a=true;break}}if(f&&!a){f=false}e.SetVisible(f);f=false}}}var g=this.Commands.length;for(var b=0;b<g;b++){this.Commands[b].RecalcSeparator()}};Command.prototype.ShowAccell=function(){return(this.IsMenu&&!RD3_DesktopManager.WebEntryPoint.HasSideMenu()&&this.Accell!=""&&!RD3_Glb.IsTouch())};Command.prototype.HandleAccell=function(f,b,a){var j=false;if((this.Level>1||!this.IsMenu||!this.IsCmdSet)&&!a){return false}if(this.PopupContainerBox){var d=this.Commands.length;for(var e=0;e<d&&!j;e++){j=this.Commands[e].HandleAccell(f,b,true)}if(!j&&this.FormList&&b>48&&b<=57){var g=RD3_DesktopManager.WebEntryPoint.StackForm;var l=g.length;var h=0;for(var k=0;k<l&&!j;k++){if(g[k].HasFormList()){h++}if(h==(b-48)){g[k].OnFLClick(f);RD3_DesktopManager.WebEntryPoint.CmdObj.ClosePopup();j=true}}}}if(j){return j}if(this.Accell!=""&&this.Accell.charCodeAt(0)==b){j=true}if(j){this.OnClick(f)}return j};Command.prototype.RealizePopupMenu=function(){this.PopupContainerBox=document.createElement("div");this.PopupContainerBox.setAttribute("id",this.Identifier+":pp");this.PopupContainerBox.className="popup-menu-container";if(!RD3_Glb.IsMobile()&&RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR){this.PopupContainerBox.style.zIndex=10}var b=document.createElement("table");b.setAttribute("id",this.Identifier+":pt");b.className="popup-menu-table";var d=document.createElement("tbody");b.appendChild(d);var c=this.Commands.length;for(var a=0;a<c;a++){this.Commands[a].RealizePopupItem(d)}this.PopupContainerBox.appendChild(b);return d};Command.prototype.CloseOtherPopup=function(){var d=this.ParentCmdSet.Commands.length;for(var a=0;a<d;a++){var b=this.ParentCmdSet.Commands[a];if(b!=this){b.ClosePopup();RD3_Glb.RemoveClass(b.PopupTextCell,"popup-menu-hover")}}};Command.prototype.GetTooltip=function(b,c){if(this.Tooltip==""){return false}var a=RD3_KBManager.GetFKTip(this.FKNum);if(a==""&&this.CommandCode!=""){a=" ("+this.CommandCode+")"}b.SetTitle(this.Caption);b.SetText(this.Tooltip+a);if(c==this.MyToolBox||c==this.ToolImg||c==this.ToolText){b.SetObj(this.MyToolBox);c=this.MyToolBox;b.SetAnchor(RD3_Glb.GetScreenLeft(c)+((c.offsetWidth-(this.ShowNames?0:4))/2),RD3_Glb.GetScreenTop(c));b.SetPosition(0);return true}if(c==this.CmdBox||c==this.CommandLink||c==this.CommandImg||c==this.CommandImgDX||c==this.BranchImg){b.SetObj(this.CmdBox);c=this.CmdBox;b.SetAnchor(RD3_Glb.GetScreenLeft(c)+c.offsetWidth,RD3_Glb.GetScreenTop(c)+((c.offsetHeight)/2));b.SetPosition(1);return true}if(c==this.PopupItemBox||c==this.PopupIconCell||c==this.PopupImageBox||c==this.PopupTextCell||c==this.PopupText){b.SetObj(this.PopupItemBox);c=this.PopupItemBox;b.SetAnchor(RD3_Glb.GetScreenLeft(c)+c.offsetWidth,RD3_Glb.GetScreenTop(c)+(c.offsetHeight/2));b.SetPosition(1);return true}if(this.Button){b.SetAnchor(RD3_Glb.GetScreenLeft(c)+(c.clientWidth/2),RD3_Glb.GetScreenTop(c)+c.clientHeight);b.SetPosition(2);return true}};Command.prototype.GetObjToAttach=function(b){var d="";if(b instanceof Command){d=b.Identifier}else{d=b.getAttribute("objid")}var c=RD3_DesktopManager.ObjectMap[d];var a=(c&&c.GetDOMObj)?c.GetDOMObj((c.IsToolbar)?"toolbar":""):null;if(!c){a=document.getElementById(d)}return a};Command.prototype.RealizePopup=function(t){var s=0;var e="";var q="";var j=0;var i=0;var h=false;if(!t){return}if(t instanceof Command){q=t.Identifier;s=(t.Level==1)?1:0;h=t.FormList}else{s=parseInt(t.getAttribute("dir"));e=t.getAttribute("form");q=t.getAttribute("objid");j=parseInt(t.getAttribute("xpos"));i=parseInt(t.getAttribute("ypos"))}var l=RD3_DesktopManager.ObjectMap[q];var g=(l&&l.GetDOMObj)?l.GetDOMObj((l.IsToolbar)?"toolbar":""):null;if(!l&&q&&q.substring(0,4)==="val:"){var n=q.split(":");if(n.length==5){var r=RD3_DesktopManager.ObjectMap[("pan:"+n[3]+":"+n[4])];var d=RD3_DesktopManager.ObjectMap[("fld:"+n[2]+":"+n[3]+":"+n[4])];if(r&&d){l=RD3_DesktopManager.ObjectMap[("val:"+(r.ActualPosition+parseInt(n[1])-1)+":"+n[2]+":"+n[3]+":"+n[4])];if(r.PanelMode!=RD3_Glb.PANEL_FORM&&d.ListList){g=d.PListCells[parseInt(n[1])-1].GetDOMObj()}}}}if(!l){g=document.getElementById(q);if(g){l=RD3_KBManager.GetObject(g)}}var b=this.RealizePopupMenu();if(h){var w=RD3_DesktopManager.WebEntryPoint.StackForm;var f=w.length;var v=0;for(var k=0;k<f;k++){if(w[k].HasFormList()){w[k].RealizeFormListPopup(b,++v)}}}var o=RD3_DesktopManager.WebEntryPoint.WepBox.offsetWidth;var m=RD3_DesktopManager.WebEntryPoint.WepBox.offsetHeight;this.PopupContainerBox.style.visibility="hidden";document.body.appendChild(this.PopupContainerBox);if(g){var p=true;var u=0;while(p){p=false;u++;var a=l.AccountOverFlowX?l.AccountOverFlowX():0;var z=l.AccountOverFlowY?l.AccountOverFlowY():0;j=RD3_Glb.GetScreenLeft(g)-a;i=RD3_Glb.GetScreenTop(g)-z;switch(s){case 0:j+=g.offsetWidth;break;case 1:i+=g.offsetHeight;break;case 2:j-=this.PopupContainerBox.offsetWidth;break;case 3:i-=this.PopupContainerBox.offsetHeight;break}if(u<3){if(s==1&&i+this.PopupContainerBox.offsetHeight>m){s=3;p=true}if(s==3&&i<0){s=1;p=true}if(s==0&&j+this.PopupContainerBox.offsetWidth>o){s=2;p=true}if(s==2&&j<0){s=0;p=true}}}}this.Direction=s;this.PopupContainerBox.style.left=j+"px";this.PopupContainerBox.style.top=i+"px";if(this.PopupContainerBox.firstChild){this.PopupContainerBox.style.width=this.PopupContainerBox.firstChild.clientWidth+"px"}this.PopupContainerBox.style.visibility="visible";this.RecalcSeparator();this.AdaptLayout();if(s==1||s==3){if(j+this.PopupContainerBox.offsetWidth>o){j-=j+this.PopupContainerBox.offsetWidth-o;this.PopupContainerBox.style.left=j+"px"}if(j<0){j=0;this.PopupContainerBox.style.left=j+"px"}}if(s==0||s==2){if(i+this.PopupContainerBox.offsetHeight>m){i-=i+this.PopupContainerBox.offsetHeight-m;this.PopupContainerBox.style.top=i+"px"}if(i<0){i=0;this.PopupContainerBox.style.top=i+"px"}}};Command.prototype.IsDraggable=function(b){var a=!this.IsCmdSet&&this.ParentCmdSet&&this.ParentCmdSet.CommandCanDrag;if(a){if(b.indexOf(":header")!=-1||b.indexOf(":image")!=-1||b.indexOf(":link")!=-1||(RD3_Glb.IsMobile()&&b==this.Identifier)){this.DragMenu=true}else{this.DragMenu=false}}return a};Command.prototype.DropElement=function(){if(this.DragMenu){return this.CmdBox?this.CmdBox:this.MyBox}else{if(this.MyToolBox){return this.MyToolBox}}return this.CmdBox};Command.prototype.ComputeDropList=function(c,a){if(this.IsCmdSet){var e=this.Commands.length;for(var b=0;b<e;b++){this.Commands[b].ComputeDropList(c,a)}}else{if(!this.ParentCmdSet.CommandCanDrop||!this.IsVisible()){return}c.push(this);if(this.IsMenu){var d=this.CmdBox?this.CmdBox:this.MyBox;this.AbsLeft=RD3_Glb.GetScreenLeft(d,true);this.AbsTop=RD3_Glb.GetScreenTop(d,true);this.AbsRight=this.AbsLeft+d.offsetWidth-1;this.AbsBottom=this.AbsTop+d.offsetHeight-1}if(this.IsToolbar){var d=this.MyToolBox;this.AbsLeft2=RD3_Glb.GetScreenLeft(d);this.AbsTop2=RD3_Glb.GetScreenTop(d);this.AbsRight2=this.AbsLeft2+d.offsetWidth-1;this.AbsBottom2=this.AbsTop2+d.offsetHeight-1}}};Command.prototype.IsActiveMenu=function(){return RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveCommand==this};Command.prototype.OnTouchDown=function(a){if(!RD3_DesktopManager.WebEntryPoint.CmdObj.Expanding&&!this.ShowGroupedMenu()){RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveCommand=this;this.SetMenuClass()}return true};Command.prototype.OnTouchUp=function(b,a){if(!RD3_DesktopManager.WebEntryPoint.CmdObj.Expanding&&!this.ShowGroupedMenu()){if(a){this.OnClick(b)}else{RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveCommand=null;this.SetMenuClass()}}return true};Command.prototype.OnClosePopup=function(a){if(a==this.Popover){this.Popover=null;for(var b=0;b<this.Commands.length;b++){this.Commands[b].Unrealize(true)}if(this.MenuBox){this.MenuBox.parentNode.removeChild(this.MenuBox);this.MenuBox=null}if(this.PopupMobileBox){if(this.PopupMobileBox.parentNode){this.PopupMobileBox.parentNode.removeChild(this.PopupMobileBox)}this.PopupMobileBox=null}}};Command.prototype.ShowGroupedMenu=function(){return this.ParentCmdSet==null&&RD3_DesktopManager.WebEntryPoint.CmdObj.ShowGroups&&this.IsMenu};Command.prototype.IsFirstLevel=function(){return this.ParentCmdSet==null||this.ParentCmdSet.ShowGroupedMenu()};Command.prototype.CheckSubForm=function(){if(this.FormIndex<65536){return false}var a="frm:"+this.FormIndex;var h=RD3_DesktopManager.ObjectMap[a];if(h==null){return false}var d=h.GetMasterForm();var i=false;var b=RD3_DesktopManager.WebEntryPoint.ActiveForm;if(b&&b.IdxForm==d.IdxForm){i=true}var g=i?0:RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var c=0;c<g;c++){var e=RD3_DesktopManager.WebEntryPoint.StackForm[c];if(e.Docked&&e.IdxForm==d.IdxForm){i=true;break}}return i};Command.prototype.HandleBackButton=function(){if(!this.Expanded||!this.IsCmdSet||!this.IsMenu){return false}var d=this.Commands.length;for(var a=0;a<d;a++){var b=this.Commands[a];if(b.HandleBackButton()){return true}}this.OnBack({});return true};Command.prototype.AccentColorChanged=function(d,e){if(this.Commands){var f=this.Commands.length;for(var a=0;a<f;a++){this.Commands[a].AccentColorChanged(d,e)}}if(this.MyBox){var c=this.MyBox.style.cssText;var b=c.replace(d,e);if(c!=b){this.MyBox.style.cssText=b}}};Command.prototype.OnAdaptRetina=function(a,c,b){if(this.MyBox){this.MyBox.style.backgroundSize=a+"px "+c+"px"+(b?", 10px 16px":"")+(this.IsActiveMenu()?", 100%":"")}if(this.ToolImg){var d=!(RD3_Glb.IsAndroid()||RD3_Glb.IsIE()||RD3_Glb.IsEdge())||RD3_Glb.IsAndroid(4,4,0);if(RD3_Glb.IsMobile7()&&d){this.ToolImg.width=a;this.ToolImg.height=c;this.ToolImg.style.webkitMaskSize=a+"px "+c+"px";this.ToolImg.style.webkitMaskRepeat="no-repeat"}else{if(RD3_Glb.IsQuadro()||(RD3_Glb.IsMobile7()&&!d)){this.ToolImg.width=a;this.ToolImg.height=c;this.ToolImg.style.display=""}}if((RD3_Glb.IsQuadro()||RD3_Glb.IsMobile7())&&this.IsToolbar&&!this.IsCmdSet&&this.ParentCmdSet!=null){this.ParentCmdSet.ToolbarLoadedUpdate()}}};function Graph(a){WebFrame.call(this,a);this.Library=-1;this.File="";this.Codice="";this.Map="";this.SwfFile="";this.ImageWidth=0;this.ImageHeight=0;this.ErrText="";this.RefreshSWF=false;this.ClickEventDef=RD3_Glb.EVENT_ACTIVE;this.Img=null;this.MapObj=null;this.ObjectSwf=null}Graph.prototype=new WebFrame();Graph.prototype.LoadFromXml=function(a){WebFrame.prototype.LoadFromXml.call(this,a)};Graph.prototype.LoadProperties=function(e){WebFrame.prototype.LoadProperties.call(this,e);var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"lib":this.SetLibrary(a);break;case"fil":this.SetFileName(a);break;case"cod":this.SetCodice(a);break;case"map":this.SetMap(a);break;case"swf":this.SetFlashFileName(a);break;case"gwi":this.SetGraphWidth(parseInt(a));break;case"ghe":this.SetGraphHeight(parseInt(a));break;case"ger":this.SetGraphErrText(a);break;case"ged":this.SetGraphShowEditor(a);break;case"clk":this.ClickEventDef=parseInt(a);break;case"sha":this.ShowAnimDef=a;break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};Graph.prototype.ChangeProperties=function(a){this.LoadProperties(a)};Graph.prototype.SetLibrary=function(b){var a=this.Library;if(b!=undefined){this.Library=b}if(this.Realized){if(this.Library==RD3_Glb.JFREECHART){this.Img.style.display="";this.MapObj.style.display="none";this.ObjectSwf.style.display="none";if(this.Img.tagName=="DIV"){if(a==RD3_Glb.JQPLOT){this.RemoveJQPlot()}this.ContentBox.removeChild(this.Img);this.Img=document.createElement("img");this.Img.className="graph-img";this.ContentBox.appendChild(this.Img)}}if(this.Library==RD3_Glb.FUSIONCHART){this.ObjectSwf.style.display="";this.Img.style.display="none";this.MapObj.style.display="none"}if(this.Library==RD3_Glb.JQPLOT){this.MapObj.style.display="none";this.ObjectSwf.style.display="none";if(this.Img){this.ContentBox.removeChild(this.Img)}this.Img=document.createElement("div");this.Img.setAttribute("id",this.Identifier+":chartDiv");this.Img.style.overflow="hidden";this.ContentBox.appendChild(this.Img)}if(this.Library==RD3_Glb.CHARTJS){this.MapObj.style.display="none";this.ObjectSwf.style.display="none";this.DrawChartJs()}if(this.Library==RD3_Glb.GOOGLECHART){if(this.Img){this.ContentBox.removeChild(this.Img)}this.Img=document.createElement("div");this.Img.setAttribute("id",this.Identifier+":chartDiv");this.Img.style.overflow="hidden";this.ContentBox.appendChild(this.Img);this.SetGoogleChart()}}};Graph.prototype.SetFileName=function(b){if(b!=undefined){this.File=b}if(this.Realized){if(this.Library==RD3_Glb.JFREECHART){this.ObjectSwf.style.display="none";if(RD3_Glb.IsTouch()){this.Img.src=this.File}else{var a=new GFX("graph",this.File==""?false:true,this,false,null,this.ShowAnimDef);RD3_GFXManager.AddEffect(a)}}else{if(this.Library==RD3_Glb.JQPLOT){if(RD3_Glb.HasClass(this.Img,"jqplot-target")){this.EmbedJQPlot()}else{this.RecalcLayout=true}}else{if(this.Library==RD3_Glb.CHARTJS){this.DrawChartJs()}else{if(this.Library==RD3_Glb.GOOGLECHART){this.SetGoogleChart()}else{this.Img.style.display="none";this.ObjectSwf.style.visibility=(this.File=="")?"hidden":"";if(RD3_Glb.IsIE()){this.ObjectSwf.innerHTML=this.GetEmbedString()}else{this.RefreshSWF=true}}}}}}};Graph.prototype.SetGraphErrText=function(a){this.ErrText=a;if(this.Realized){if(this.Img){this.ContentBox.removeChild(this.Img)}this.Img=document.createElement("div");this.Img.className="graph-img-err";this.Img.innerHTML=a;this.ContentBox.appendChild(this.Img)}};Graph.prototype.SetCodice=function(a){if(a!=undefined){this.Codice=a}if(this.Realized){this.Img.useMap="#"+this.Codice}};Graph.prototype.SetMap=function(a){if(a!=undefined){this.Map=a}if(this.Realized){this.MapObj.innerHTML=this.Map;this.MapObj.style.visibility="hidden"}};Graph.prototype.SetFlashFileName=function(a){if(a!=undefined){this.SwfFile=a}if(this.Realized){if(RD3_Glb.IsIE()){this.ObjectSwf.innerHTML=this.GetEmbedString()}else{this.RefreshSWF=true}}};Graph.prototype.SetGraphWidth=function(b){if(b!=undefined){this.ImageWidth=b}if(this.Realized){this.Img.style.width=this.ImageWidth+"px";if(this.ObjectSwf.innerHTML==""){this.ObjectSwf.innerHTML=this.GetEmbedString()}else{var a=(this.ImageWidth-2);if(a<0){a=0}this.ObjectSwf.childNodes[0].style.width=a+"px"}}};Graph.prototype.SetGraphHeight=function(b){if(b!=undefined){this.ImageHeight=b}if(this.Realized){this.Img.style.height=(this.ImageHeight>0?(this.ImageHeight-1):0)+"px";if(this.ObjectSwf.innerHTML==""){this.ObjectSwf.innerHTML=this.GetEmbedString()}else{var a=(this.ImageHeight-2);if(a<0){a=0}this.ObjectSwf.childNodes[0].style.height=a+"px"}}};Graph.prototype.SetGraphShowEditor=function(f){if(this.Realized&&!this.chartEditor&&this.Library==RD3_Glb.GOOGLECHART){this.chartEditor=new google.visualization.ChartEditor();google.visualization.events.addListener(this.chartEditor,"ok",this.RedrawGoogleChart.bind(this));google.visualization.events.addListener(this.chartEditor,"cancel",this.CloseEditor.bind(this));var e=this.wrapper.getDataTable();var g=new Array(e.pg.length);var b=[];for(var d=0;d<e.pg.length;d++){if(e.pg[d].p&&e.pg[d].p.role==="style"){b.push(d)}}for(var c=b.length-1;c>=0;c--){var a=b[c];g[a]={col:e.pg.splice(a,1)[0],rows:[]};for(var d=0;d<e.qg.length;d++){g[a].rows[d]=e.qg[d].c.splice(a,1)[0]}}this.wrapper.setDataTable(e);this.chartEditor.openDialog(this.wrapper,{});for(var c=0;c<b.length;c++){var a=b[c];e.pg.splice(a,0,g[a].col);for(var d=0;d<e.qg.length;d++){e.qg[d].c.splice(a,0,g[a].rows[d])}this.wrapper.setDataTable(e)}}};Graph.prototype.Realize=function(a){if(!this.Realized){WebFrame.prototype.Realize.call(this,a)}this.Img=document.createElement("img");this.MapObj=document.createElement("span");this.MapObj.style.visibility="hidden";this.ObjectSwf=document.createElement("span");this.Img.className="graph-img";this.MapObj.className="graph-img";this.ObjectSwf.className="graph-flash";this.ContentBox.appendChild(this.Img);this.ContentBox.appendChild(this.MapObj);this.ContentBox.appendChild(this.ObjectSwf);this.Realized=true;this.SetLibrary();this.SetFileName();this.SetCodice();this.SetMap();this.SetWidth();this.SetHeight();this.SetFlashFileName()};Graph.prototype.AdaptLayout=function(){WebFrame.prototype.AdaptLayout.call(this);var a=this.ImageWidth;var c=this.ImageHeight;this.SetGraphWidth(this.ContentBox.clientWidth);this.SetGraphHeight(this.ContentBox.clientHeight);var b=a!=this.ImageWidth||c!=this.ImageHeight;if(this.Library==RD3_Glb.JQPLOT&&(b||(this.File!=""&&!RD3_Glb.HasClass(this.Img,"jqplot-target")))){this.EmbedJQPlot()}else{if(this.Library==RD3_Glb.CHARTJS&&b){this.DrawChartJs()}else{if(this.Library==RD3_Glb.GOOGLECHART&&b){this.SetGoogleChart()}}}};Graph.prototype.Unrealize=function(){WebFrame.prototype.Unrealize.call(this);this.Img=null;this.MapObj=null;this.ObjectSwf=null;if(this.Library==RD3_Glb.JQPLOT){if(this.OldPlot){this.OldPlot.destroy()}}this.Realized=false};Graph.prototype.OnGraphClick=function(c,a){if(this.Visible&&this.Enabled){var b=new IDEvent("graclk",this.Identifier,c,this.ClickEventDef,a)}};Graph.prototype.GetEmbedString=function(){if(this.Library!=RD3_Glb.FUSIONCHART){return""}var a=(this.ImageWidth-2);var b=(this.ImageHeight-2);if(a<0){a=0}if(b<0){b=0}var c="<object type='application/x-shockwave-flash' data='"+this.SwfFile+"' style='width: "+a+"px; height: "+b+"px;' id='"+this.Identifier+"' >";c+="<param name='movie' value='"+this.SwfFile+"' />";c+="<param name='FlashVars' value='&dataURL="+this.File+"' />";c+="<param name='quality' value='high' />";c+="<param name='wmode' value='transparent' /></object>";return c};Graph.prototype.IsResizeImmediate=function(){return true};Graph.prototype.AfterProcessResponse=function(){WebFrame.prototype.AfterProcessResponse.call(this);if(this.RefreshSWF){this.ObjectSwf.innerHTML=this.GetEmbedString();this.RefreshSWF=false}if(this.googleChartDraw){this.wrapper.draw();delete this.googleChartDraw}};Graph.prototype.OnFrameClick=function(b,l,c,h,g,m,e,k){var d="";if(k.tagName=="AREA"){var a=k.href;var j=a.indexOf("'OnGraphClick', null,'");if(j>0){var i=a.indexOf("'",j+22);if(i>0){d=a.substring(j+22,i)}}}var f=new IDEvent("rawclk",this.Identifier,b,l?this.MouseDoubleClickEventDef:this.MouseClickEventDef,l,c,Math.floor(m)+"-"+Math.floor(e),Math.floor(h)+"-"+Math.floor(g),d)};Graph.prototype.GetTooltip=function(a,b){return WebFrame.prototype.GetTooltip.call(this,a,b)};Graph.prototype.EmbedJQPlot=function(){if(this.Library==RD3_Glb.JQPLOT){this.RemoveJQPlot();if(this.File!=""){var divName=this.Identifier.replace(new RegExp(":","g"),"\\\\:");eval("this.OldPlot = $.jqplot('"+divName+"\\\\:chartDiv',"+this.File+");");if(this.Enabled){eval("$('#"+divName+"').bind('jqplotDataClick', function (ev, seriesIndex, pointIndex, data) {RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnGraphClick', null,'S'+((seriesIndex + 1)<=9 ? '0' : '')+(seriesIndex+1)+'I'+(pointIndex+1));});");eval("$(document).unload(function() {$('*').unbind(); });")}}}};Graph.prototype.RemoveJQPlot=function(){if(this.Img==null||this.Img.tagName!="DIV"){return}var a=$("#"+this.Identifier.replace(new RegExp(":","g"),"\\:")+"\\:chartDiv *");if(a.length>0){a.unbind()}var a=$("#"+this.Identifier.replace(new RegExp(":","g"),"\\:")+"\\:chartDiv");if(a.length>0){a.empty()}if(this.OldPlot){this.OldPlot.destroy();this.OldPlot=null}};Graph.prototype.DrawChartJs=function(){if(!this.File){this.SetGraphErrText("No data to show");return}if(this.Img){this.ContentBox.removeChild(this.Img)}this.Img=document.createElement("canvas");this.Img.width=this.ImageWidth;this.Img.height=this.ImageHeight;this.Img.setAttribute("id",this.Identifier+":chartDiv");this.Img.style.overflow="hidden";var c=JSON.parse(this.File);if(c.custom){if(c.custom.overallBackgroundColor){this.Img.style.backgroundColor=c.custom.overallBackgroundColor}if(c.custom.fontLabels){Chart.defaults.global.defaultFontSize=c.custom.fontLabels.fontSize;Chart.defaults.global.defaultFontColor=c.custom.fontLabels.textColor;Chart.defaults.global.defaultFontFamily=c.custom.fontLabels.fontFamily}this.ContentBox.appendChild(this.Img);var a=this.Img.getContext("2d");Chart.pluginService.register({beforeDraw:function(g,j){if(c.custom.chartBackgroundColor){var i=Chart.helpers;var e=g.chart.ctx;var h=g.chartArea;e.save();e.fillStyle=c.custom.chartBackgroundColor;e.fillRect(h.left,h.top,h.right-h.left,h.bottom-h.top);e.restore()}}})}if(this.Enabled){var b=this;c.options.onClick=function(i,g,h,j){var e=d.getElementAtEvent(i);if(e.length>0){RD3_DesktopManager.CallEventHandler(b.Identifier,"OnGraphClick",null,"S"+((e[0]._datasetIndex+1)<=9?"0":"")+(e[0]._datasetIndex+1)+"I"+(e[0]._index+1))}}}try{var d=new Chart(a,c)}catch(f){console.error(f)}};Graph.prototype.SetGoogleChart=function(){if(this.loadingGoogleLib){return}if(!google.visualization){this.loadingGoogleLib=true;google.charts.load("current",{packages:["corechart","calendar","table","timeline","treemap","gauge","geochart","orgchart","charteditor"]});google.charts.setOnLoadCallback(this.DrawGoogleChart.bind(this))}else{this.DrawGoogleChart()}};Graph.prototype.DrawGoogleChart=function(){delete this.loadingGoogleLib;if(!this.File){this.SetGraphErrText("No data to show");return}var j=JSON.parse(this.File);var f=new google.visualization.DataTable(j.data);j.options.width=this.ImageWidth;j.options.height=this.ImageHeight;var k={chartType:j.type,dataTable:f,options:j.options,containerId:this.Identifier+":chartDiv"};this.wrapper=new google.visualization.ChartWrapper(k);var a=this;var c=document.getElementById(this.Identifier+":chartDiv");if(!c){var l=document.getElementsByClassName("graph-img-err");if(l.length>0){for(var g=0;g<l.length;g++){var h=l[g];if(h.parentNode.id==this.ContentBox.id){this.ContentBox.removeChild(h)}}this.Img=document.createElement("div");this.Img.setAttribute("id",this.Identifier+":chartDiv");this.Img.style.overflow="hidden";this.ContentBox.appendChild(this.Img);var b=document.getElementById(this.ContentBox.id);if(b){this.wrapper.draw()}else{this.googleChartDraw=true}}else{this.googleChartDraw=true}}else{this.wrapper.draw()}var a=this;var e=function e(){var o=a.wrapper.getChart();var n=o.getSelection();if(n.length>0){for(var m=0;m<n.length;m++){var q=n[m];var r=q.row==null?0:q.row;var p=q.column==null?0:q.column;var d=f.getFormattedValue(r,p);RD3_DesktopManager.CallEventHandler(a.Identifier,"OnGraphClick",null,"S"+((p)<=9?"0":"")+(p)+"I"+(r+1))}}o.setSelection()};if(this.Enabled){google.visualization.events.addListener(this.wrapper,"select",e)}};Graph.prototype.RedrawGoogleChart=function(){if(this.googleChartDraw){return}var b;var c;var e;if(this.chartEditor){b=this.chartEditor.getChartWrapper().getOptions();c=this.chartEditor.getChartWrapper().getChartType()}else{var a=JSON.parse(this.File);b=a.options;e=a.data;c=a.type}b.width=this.ImageWidth;b.height=this.ImageHeight;this.wrapper.setOptions(b);if(e){this.wrapper.setDataTable(e)}this.wrapper.setChartType(c);if(this.chartEditor){var d=new IDEvent("graopt",this.Identifier,undefined,RD3_Glb.EVENT_ACTIVE,JSON.stringify(b),c);this.chartEditor=null}this.wrapper.draw()};Graph.prototype.CloseEditor=function(){this.chartEditor=null};function IDCombo(a){this.Identifier="";this.Owner=a;this.Left=0;this.Top=0;this.Width=0;this.Height=0;this.Enabled=true;this.Visible=true;this.RightAlign=false;this.ShowActivator=true;this.Tooltip="";this.Clickable=false;this.Badge="";this.ComboInput=null;this.ComboActivator=null;this.ComboImg=null;this.ComboPopup=null;this.UsePopover=false;this.IsOpen=false;this.ListOwner=true;this.IsOptional=false;this.AllowFreeText=false;this.ShowValue=false;this.Writable=true;this.ActImage="";this.ActWidth=RD3_ClientParams.ComboActivatorSize;this.OptionList=null;this.VisualStyle=null;this.SelItems=new Array();this.PreviousInputText="";this.OriginalText="";this.MultiSel=true;this.ValueSep=";";this.HLItem=null}IDCombo.prototype.Realize=function(c,b){if(this.Identifier==""){this.Identifier="cmb:"+Math.floor(Math.random()*1000000000);RD3_DesktopManager.ObjectMap.add(this.Identifier,this)}if(!this.ComboInput){if(RD3_Glb.IsMobile()){this.ComboInput=document.createElement("div");this.ComboInput.value=this.ComboInput.textContent}else{this.ComboInput=document.createElement("input");this.ComboInput.type="text"}this.ComboInput.className="combo-input";this.ComboInput.setAttribute("id",this.Identifier);if(this.Owner.SetZIndex){this.Owner.SetZIndex(this.ComboInput)}}c.appendChild(this.ComboInput);var a=this;this.ComboInput.onkeydown=function(d){a.OnKeyDown(d)};if(!RD3_Glb.IsIE(10,false)){this.ComboInput.onfocus=function(d){RD3_KBManager.IDRO_GetFocus(d)};this.ComboInput.onblur=function(d){RD3_KBManager.IDRO_LostFocus(d)};if(RD3_Glb.IsFirefox(3)){this.ComboInput.ondblclick=function(d){RD3_KBManager.IDRO_DoubleClick(d)}}}if(b){RD3_Glb.AddClass(this.ComboInput,b)}if(this.ShowActivator){if(!this.ComboActivator){this.ComboActivator=document.createElement("DIV");this.ComboActivator.className="combo-activator";this.ComboActivator.style.width=(this.ActWidth+3)+"px";if(this.Owner.SetZIndex){this.Owner.SetZIndex(this.ComboActivator)}this.VisualStyle=null}c.appendChild(this.ComboActivator);if(!RD3_Glb.IsMobile()){this.ComboActivator.onclick=function(d){a.OnClickActivator(d)}}}if(this.ComboImg){c.appendChild(this.ComboImg)}if(this.ComboBadge){c.appendChild(this.ComboBadge)}if(RD3_Glb.IsMobile()){this.AdaptMobileInput()}};IDCombo.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);if(this.IsOpen){this.Close()}if(this.ComboInput){if(this.ComboInput.parentNode){this.ComboInput.parentNode.removeChild(this.ComboInput)}this.ComboInput=null}if(this.ComboImg){if(this.ComboImg.parentNode){this.ComboImg.parentNode.removeChild(this.ComboImg)}this.ComboImg=null}if(this.ComboActivator){if(this.ComboActivator.parentNode){this.ComboActivator.parentNode.removeChild(this.ComboActivator)}this.ComboActivator=null}if(this.ComboPopup){if(this.ComboPopup.parentNode){this.ComboPopup.parentNode.removeChild(this.ComboPopup)}this.ComboPopup=null}if(this.ComboPopupInput){if(this.ComboPopupInput.parentNode){this.ComboPopupInput.parentNode.removeChild(this.ComboPopupInput)}this.ComboPopupInput=null}if(this.IDScroll){this.IDScroll.Unrealize();this.IDScroll=null}if(this.CloneElem){this.CloneElem.parentNode.removeChild(this.CloneElem);this.CloneElem=null}if(this.ComboBadge){if(this.ComboBadge.parentNode){this.ComboBadge.parentNode.removeChild(this.ComboBadge)}this.ComboBadge=null}};IDCombo.prototype.SetShowActivator=function(a){this.ShowActivator=a;if(!this.ShowActivator&&this.ComboActivator){RD3_Glb.SetDisplay(this.ComboActivator,"none")}};IDCombo.prototype.SetComboClickable=function(a){if(a!=this.Clickable){this.Clickable=a;if(!this.Enabled){this.UpdateCursor()}}};IDCombo.prototype.SetEnabled=function(a){if(a!=this.Enabled){this.Enabled=a;if(RD3_Glb.IsTouch()&&this.ComboInput){if(this.Enabled){this.ComboInput.removeAttribute("readonly")}else{this.ComboInput.setAttribute("readonly",true)}}if(this.Enabled){if(this.ComboActivator&&this.ShowActivator&&this.ActWidth>=0&&this.Visible){RD3_Glb.SetDisplay(this.ComboActivator,"");this.UpdateActivator()}}else{if(this.ComboActivator){RD3_Glb.SetDisplay(this.ComboActivator,(this.Visible&&this.ActWidth>=0&&this.ActImage!=""&&this.ActEnaIfComboDis?"":"none"))}}if(this.SelItems.length>0&&!this.ShowDescription(this.VisualStyle)){this.SetComboValue(this.Enabled?this.GetComboFinalName(this.ShowValue):"")}if(this.ComboActivator){this.SetLeft(this.Left);this.SetWidth(this.Width)}else{if(RD3_Glb.IsMobile()){this.AdaptMobileInput()}}this.UpdateCursor();this.UpdateImage()}};IDCombo.prototype.UpdateCursor=function(){if(this.VisualStyle&&this.VisualStyle.GetCursor()==""){if(!this.Enabled&&this.Clickable){this.ComboInput.style.cursor="pointer"}else{this.ComboInput.style.cursor=(this.Enabled?"":"default")}}};IDCombo.prototype.OnMouseDownObj=function(b,a){if(!this.Enabled&&this.Clickable){this.OnClickActivator()}};IDCombo.prototype.SetVisible=function(a){if(a!=this.Visible){this.Visible=a;this.ComboInput.style.visibility=(this.Visible?"":"hidden");if(this.ComboImg){this.ComboImg.style.visibility=(this.Visible&&this.ComboImg.src!=""?"":"hidden")}if(this.ComboActivator){RD3_Glb.SetDisplay(this.ComboActivator,this.Visible&&this.ShowActivator&&this.ActWidth>=0&&(this.Enabled||this.ActEnaIfComboDis)?"":"none")}if(this.ComboPopup){this.ComboPopup.style.visibility=(this.Visible?"":"hidden")}if(this.ComboPopupInput){this.ComboPopupInput.style.visibility=(this.Visible?"":"hidden")}}};IDCombo.prototype.SetMasked=function(b){var a=function(c){RD3_KBManager.IDRO_OnChange(c)};if(RD3_Glb.IsIE(10,false)){if(b){this.ComboInput.attachEvent("onchange",a)}else{this.ComboInput.detachEvent("onchange",a)}}else{this.ComboInput.onchange=(b?a:null)}};IDCombo.prototype.SetShowValue=function(b){this.ShowValue=b;var a=this;if(!this.ShowValue){this.ComboInput.onkeyup=function(c){a.OnKeyUp(c)}}else{this.ComboInput.onkeyup=null}};IDCombo.prototype.SetID=function(a){this.ComboInput.setAttribute("id",a);if(this.Owner.SetZIndex){this.Owner.SetZIndex(this.ComboInput);if(this.ComboActivator){this.Owner.SetZIndex(this.ComboActivator)}if(this.ComboImg){this.Owner.SetZIndex(this.ComboImg)}}};IDCombo.prototype.SetVisualStyle=function(d,a,c){if(this.VisualStyle!=d||c){var b=this.VisualStyle;this.VisualStyle=d;if(!a){d.ApplyValueStyle(this.ComboInput);this.PaddingRight=undefined;this.PaddingLeft=undefined}this.UpdateCursor();if(this.ComboActivator){this.UpdateActivator()}if(this.SelItems.length>0){if(this.ShowDescription(this.VisualStyle)&&!this.ShowDescription(b)){this.SetComboValue(this.GetComboFinalName(this.ShowValue))}else{if(!this.Enabled&&!this.ShowDescription(this.VisualStyle)&&this.ShowDescription(b)){this.SetComboValue("")}}}if(this.IsOpen){this.Open(true)}}};IDCombo.prototype.SetTooltip=function(a){if(a!=this.Tooltip){this.Tooltip=a;if(this.Tooltip==""&&this.SelItems.length>0){a=this.SelItems[0].Tooltip}RD3_TooltipManager.SetObjTitle(this.ComboInput,a)}};IDCombo.prototype.SetRightAlign=function(a){if(a!=this.RightAlign){this.RightAlign=a&&!RD3_ServerParams.RightAlignedIcons;this.ComboInput.style.textAlign=(a?"right":"left");if(this.ComboActivator){this.UpdateActivator()}this.SetLeft(this.Left);this.SetWidth(this.Width)}};IDCombo.prototype.SetHasActivator=function(d,b,c,a){if(d!=this.ActImage||(b-2)!=this.ActWidth){this.ActImage=d;this.ActWidth=b-2;this.ActEnaIfComboDis=c;if(this.ActImage!=""&&this.ActWidth>=0){this.ComboActivator.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/"+this.ActImage+")"}else{this.ComboActivator.style.backgroundImage=(a?"":"none")}RD3_Glb.SetDisplay(this.ComboActivator,(this.Visible&&this.ActWidth>=0&&(this.Enabled||(this.ActImage!=""&&this.ActEnaIfComboDis))?"":"none"));this.SetLeft(this.Left);this.SetWidth(this.Width)}};IDCombo.prototype.AssignValueList=function(c,f){if(this.IsOpen&&RD3_Glb.IsMobile()&&!this.UsePopover&&RD3_DesktopManager.WebEntryPoint.InResize){return}var a=this.OptionList;this.OptionList=c;if(this.Owner&&this.Owner.ParentField&&this.Owner.ParentField.UseWatermarkAsNull()&&this.OptionList){for(var e=0;e<this.OptionList.ItemList.length;e++){var d=this.OptionList.ItemList[e];if((d.Name==""&&d.Value=="")||d.Value=="LKENULL"){d.Name=this.Owner.ParentField.WaterMark;d.OrgNames=this.Owner.ParentField.WaterMark;break}}}var b=this.Owner.ParentField&&this.Owner.ParentField.HasValueSource&&this.Owner.ParentField.SuperActive&&this.ActClicked;if(a!=this.OptionList){if(this.OptionList){if(this.MultiSel&&!this.ListOwner){this.SelItems=this.OptionList.FindItemsLKE()}else{if(this.SelItems.length>0){this.SelItems=this.OptionList.FindItemsByArray(this.SelItems)}else{this.SelItems=this.OptionList.FindItemsByValue(this.ComboInput.value,!this.ShowValue,this.ValueSep);if(this.SelItems.length==0&&!this.ListOwner){this.SelItems=this.OptionList.FindItemsByValue("("+this.ComboInput.value+")",!this.ShowValue,this.ValueSep);if(RD3_Glb.IsMobile()&&this.SelItems.length==0){this.SelItems.push(this.OptionList.ItemList[0])}}}}}else{this.SelItems=new Array()}}if((a==null||b)&&c&&!f&&this.ActClicked){if((this.SelItems.length==0||this.MultiSel||b)&&this.ComboInput.value!=""){if(this.ListOwner){if(b){this.OptionList.FilterComboItem(this.ComboInput.value,true)}else{if(this.OptionList.FilterComboItem(this.ComboInput.value,true)==0){this.OptionList.FilterComboItem("")}}}else{this.OptionList.FilterComboItem(this.ComboInput.value,true,true)}if(b&&this.SelItems){this.SelItems.length=0}this.HLItem=this.OptionList.GetNextVisibleItem(null);if(this.SelItems.length==0&&!this.MultiSel){if(this.HLItem){this.SelItems.push(this.HLItem)}}this.Open(true)}else{this.Open()}}else{if(a&&!c){if(this.IsOpen){this.Close(true)}}else{if(a&&c&&!a.Equals(c)&&this.IsOpen){this.Open()}else{if(a&&c&&a!=c&&this.ActClicked){this.Open()}}}}if(this.OptionList){this.ActClicked=false}};IDCombo.prototype.SetText=function(a,c,b){this.DeferEmpty=false;if(this.OptionList&&!this.ListOwner&&a!=""&&b&&this.Owner==RD3_DesktopManager.WebEntryPoint.HilightedCell){return}this.SelItems=new Array();if(this.OptionList){this.SelItems=this.OptionList.FindItemsByValue(a,!c,c?this.ValueSep:RD3_ClientParams.ComboNameSeparator)}this.UpdateImage();if(this.SelItems.length>0){if(!this.Enabled&&!this.ShowDescription(this.VisualStyle)){this.SetComboValue("")}else{this.SetComboValue(this.GetComboFinalName(this.ShowValue))}}else{this.SetComboValue(a)}this.PreviousInputText=this.ComboInput.value;this.OriginalText=this.ComboInput.value;if(b&&this.IsOpen){this.Close()}};IDCombo.prototype.GetComboValue=function(){if(!this.ListOwner&&this.IsOpen){var b=(this.ComboPopupInput&&this.ComboPopupInput.style.display=="");if(RD3_Glb.IsMobile()&&b){var a=this.ComboPopupInput.value;if(a==""){a="*"}return a}else{return this.ComboInput.value}}return(this.SelItems.length>0?this.GetComboFinalName(true):this.ComboInput.value)};IDCombo.prototype.GetComboName=function(){if(!this.ListOwner&&this.IsOpen){return this.ComboInput.value}return(this.SelItems.length>0?this.GetComboFinalName(this.ShowValue):this.ComboInput.value)};IDCombo.prototype.GetComboFinalName=function(c){var d="";var b=(c?this.ValueSep:RD3_ClientParams.ComboNameSeparator);var e=this.SelItems.length;for(var a=0;a<e;a++){d+=(d.length>0?b:"")+(c?this.SelItems[a].Value:this.SelItems[a].Name)}return d};IDCombo.prototype.UpdateActivator=function(){var a=this.ComboActivator.style;var c=this.ComboInput.style;a.backgroundColor=c.backgroundColor;a.paddingTop=c.paddingTop;a.paddingBottom=c.paddingBottom;var e=(this.RightAlign?c.borderRightWidth:c.borderLeftWidth);var d=(this.RightAlign?c.borderRightColor:c.borderLeftColor);var b=(this.RightAlign?c.borderRightStyle:c.borderLeftStyle);a.borderTopWidth=c.borderTopWidth;a.borderBottomWidth=c.borderBottomWidth;a.borderLeftWidth=e;a.borderRightWidth=e;a.borderTopStyle=c.borderTopStyle;a.borderBottomStyle=c.borderBottomStyle;a.borderLeftStyle=b;a.borderRightStyle=b;a.borderTopColor=c.borderTopColor;a.borderBottomColor=c.borderBottomColor;a.borderLeftColor=d;a.borderRightColor=d;if(this.RightAlign){a.borderRight=""}else{a.borderLeft=""}};IDCombo.prototype.UpdateImage=function(){var c=(this.ComboImg?this.ComboImg.style.display:"none");if(this.SelItems.length>0){if(this.SelItems[0].Image!=""){var b=false;if(!this.ComboImg){this.ComboImg=document.createElement("IMG");this.ComboImg.className="combo-img";if(this.Owner.SetZIndex){this.Owner.SetZIndex(this.ComboImg)}if(this.ComboInput.parentNode){if(this.ComboActivator){this.ComboInput.parentNode.insertBefore(this.ComboImg,this.ComboActivator.nextSibling)}else{this.ComboInput.parentNode.insertBefore(this.ComboImg,this.ComboInput.nextSibling)}}b=true}else{if(this.ComboImg.style.display=="none"){this.ComboImg.style.display="";b=true}}if(RD3_Glb.Adapt4Retina(this.Identifier,this.SelItems[0].Image,43)){this.ComboImg.style.display="none"}if(b){this.SetLeft(this.Left);this.SetTop(this.Top);this.SetWidth(this.Width);this.SetHeight(this.Height)}this.ComboImg.src=RD3_Glb.GetImgSrc("images/"+this.SelItems[0].Image)}else{if(this.ComboImg){this.ComboImg.style.display="none"}}}else{if(this.ComboImg){this.ComboImg.style.display="none"}}var a=(this.ComboImg?this.ComboImg.style.display:"none");if(c!=a){this.SetLeft(this.Left);this.SetWidth(this.Width);this.SetTop(this.Top)}if(this.ComboImg&&this.VisualStyle&&this.VisualStyle.GetCursor()==""){if(!this.Enabled&&this.Clickable){this.ComboImg.style.cursor="pointer"}else{this.ComboImg.style.cursor=(this.Enabled?"":"default")}}};IDCombo.prototype.SetLeft=function(a){this.Left=a;if(this.RightAlign&&this.ComboActivator&&this.ComboActivator.style.display==""){this.ComboInput.style.left=this.Left+this.ActWidth+1+(RD3_ServerParams.Theme=="zen"?(this.RightAlign&&this.Owner.InList?-4:-10):0)+"px"}else{this.ComboInput.style.left=this.Left+"px"}if(this.ComboActivator){this.ComboActivator.style.left=this.Left+(this.RightAlign?0:this.Width-this.ActWidth-2-(this.Owner instanceof BookSpan?2:0)+(RD3_ServerParams.Theme=="zen"?(this.Owner.InList?7:1):0))+"px"}if(this.ComboImg&&this.ComboImg.style.display==""){this.ComboImg.style.left=(this.Left+2)+"px";if(RD3_Glb.IsMobile()){var b=0;if(this.VisualStyle&&this.VisualStyle.GetBorders(1)==9){b=this.VisualStyle.GetCustomPadding(4)/4;this.ComboImg.style.paddingLeft=b+"pt"}this.ComboInput.style.paddingLeft=(b+RD3_ClientParams.ComboImageSize+3+4+4)+"px"}else{this.ComboInput.style.paddingLeft=(2+RD3_ClientParams.ComboImageSize+1)+"px"}}else{this.ComboInput.style.paddingLeft=""}if(this.ComboBadge!=null){var c=this.Left+(this.Width-RD3_Glb.GetBadgeWidth(this.Badge,"grey")-2);if(RD3_Glb.IsMobile()){c=c+6}if(this.ComboActivator&&this.ComboActivator.style.display==""){c=c-this.ActWidth+(RD3_Glb.IsMobile()?0:-6)}else{c=c+(RD3_Glb.IsMobile()?16:-3)}this.ComboBadge.style.left=c-(this.Owner instanceof BookSpan?2:-2)+"px"}};IDCombo.prototype.SetTop=function(a){this.Top=a;this.ComboInput.style.top=this.Top+"px";if(this.ComboActivator){this.ComboActivator.style.top=this.Top+"px"}if(this.ComboImg&&this.ComboImg.style.display==""){this.SetHeight(this.Height);this.ComboImg.style.top=(this.Top+2)+"px"}if(this.ComboBadge!=null){this.ComboBadge.style.top=(this.Top+2)+"px"}};IDCombo.prototype.SetWidth=function(c){this.Width=c;var b=c;if(!RD3_Glb.IsMobile()){var d=(this.ComboActivator&&this.ComboActivator.style.display=="")?1:0;if(d&&this.Owner&&this.Owner instanceof PCell&&this.Owner.InList&&RD3_ServerParams.Theme!="zen"){var a=this.Owner.ParentField;if(a.ParentPanel.GetLastListField()==a){d=0}}this.ComboMarLeft=d;b=(this.Width-(RD3_ServerParams.Theme=="zen"?(this.Owner.InList?-2:4):4)+d);if(this.ComboImg&&this.ComboImg.style.display==""){b-=RD3_ClientParams.ComboImageSize+1}if(this.ComboActivator&&this.ComboActivator.style.display==""){b-=this.ActWidth+1+(RD3_ServerParams.Theme=="zen"?(this.Owner.InList?-3:-9):0)}}if(this.ComboImg&&this.ComboImg.style.display==""&&this.Width&&b<0){var e=(2+RD3_ClientParams.ComboImageSize+1+b);if(e<0){e=0}this.ComboInput.style.paddingLeft=e+"px"}if(b<0){b=0}this.ComboInput.style.width=b+"px";this.ComboInputW=b;if(this.ComboActivator){this.ComboActivator.style.left=this.Left+(this.RightAlign?0:this.Width-this.ActWidth-2-(this.Owner instanceof BookSpan?2:0)+(RD3_ServerParams.Theme=="zen"?(this.Owner.InList?7:1):0))+"px"}if(this.ComboBadge!=null){var f=this.Left+(this.Width-RD3_Glb.GetBadgeWidth(this.Badge,"grey")-2);if(RD3_Glb.IsMobile()){f=f+6}if(this.ComboActivator&&this.ComboActivator.style.display==""){f=f-this.ActWidth+(RD3_Glb.IsMobile()?0:-6)}else{f=f+(RD3_Glb.IsMobile()?16:-3)}this.ComboBadge.style.left=f-(this.Owner instanceof BookSpan?2:-2)+"px"}if(RD3_Glb.IsMobile()){this.AdaptMobileInput()}};IDCombo.prototype.SetHeight=function(c){this.Height=c;var a=0;if(this.VisualStyle&&!RD3_Glb.IsMobile()&&this.VisualStyle.GetBorders(this.Owner.InList?1:6)!=9){a=this.VisualStyle.GetOffset(false,1,this.Owner.InList,false)*2;if(this.VisualStyle.GetBorders(this.Owner.InList?1:6)==1&&a==0){a=4}}a=(RD3_ServerParams.Theme=="zen"?(this.Owner.InList?0:2):a);var b=c-a;if(b<0){b=0}this.ComboInput.style.height=b+"px";if(this.ComboActivator){this.ComboActivator.style.height=this.Height-(RD3_ServerParams.Theme=="zen"?(this.Owner.InList?0:2):0)+"px"}if(this.ComboImg&&this.ComboImg.style.display==""){this.ComboImg.style.top=(this.Top+(this.Height-RD3_ClientParams.ComboImageSize-a)/2+1)+"px"}if(this.ComboBadge!=null){this.ComboBadge.style.top=(this.Top+2)+"px"}};IDCombo.prototype.SetBackGroundImage=function(a){this.ComboInput.style.backgroundImage=a};IDCombo.prototype.SetActive=function(a){if(this.ComboActivator&&this.ComboActivator.style.display==""){if(a){var g=this.VisualStyle;var e=g.GetBookOffset(true,(this.Owner.InList)?1:6);var d=this.ComboActivator.style;var c=this.ComboInput.style;var b=g.GetColor(10);if(b!="transparent"){d.backgroundColor=b}else{if(RD3_ServerParams.Theme!="zen"){var f=g.GetColor(11);if(this.RightAlign){d.borderLeft="2px solid "+f;c.borderLeft="none";c.width=(parseInt(c.width)+2)+"px"}else{d.borderRight="2px solid "+f;c.borderRight="none";if(e.w==0){d.left=(parseInt(d.left)-2)+"px"}}d.borderTop="2px solid "+f;d.borderBottom="2px solid "+f;d.height=(parseInt(d.height)-(4-e.y-e.h))+"px";if(!this.RightAlign){d.left=(parseInt(d.left)-1)+"px";d.backgroundPosition="3px center"}else{d.backgroundPosition="1px center"}}}}else{this.UpdateActivator();this.ComboActivator.style.backgroundPosition="center center"}}if(!a&&this.ComboImg){this.SetLeft(this.Left)}if(!a&&this.DeferEmpty){this.SetText("",true,true)}else{if(!a&&this.IsOpen){this.Close()}}};IDCombo.prototype.GetDOMObj=function(){return this.ComboInput};IDCombo.prototype.HideContent=function(d,c){if(d){if(c){this.ComboInput.disabled="disabled"}this.SetComboValue("");if(this.ComboImg){this.ComboImg.style.display="none"}if(this.ComboActivator){RD3_Glb.SetDisplay(this.ComboActivator,"none")}if(this.ComboPopup){this.ComboPopup.style.display="none"}if(this.ComboPopupInput){this.ComboPopupInput.style.display="none"}if(this.ComboBadge){this.SetBadge("")}this.Enabled=false;this.SetComboClickable(false)}else{if(this.ComboInput.disabled&&(RD3_Glb.IsChrome()||RD3_Glb.IsSafari())){var b=this.ComboInput.parentNode;var a=this.ComboInput.nextSibling;this.ComboInput.parentNode.removeChild(this.ComboInput);if(a){b.insertBefore(this.ComboInput,a)}else{b.appendChild(this.IntCtrl)}}this.ComboInput.removeAttribute("disabled");this.SetComboValue(this.OriginalText);if(this.Visible&&this.ActWidth>=0&&(this.Enabled||(this.ActImage!=""&&this.ActEnaIfComboDis))&&this.ComboActivator){RD3_Glb.SetDisplay(this.ComboActivator,"")}this.UpdateImage()}this.SetLeft(this.Left);this.SetWidth(this.Width);this.SetTop(this.Top)};IDCombo.prototype.OnClickActivator=function(b){if(this.IsOpen){this.Close();return}if(this.Writable){this.ComboInput.focus()}if(this.Enabled&&this.OptionList&&this.ListOwner&&this.ActImage==""){if(this.HasWatermark&&this.Owner&&this.Owner.RemoveWatermark){this.Owner.RemoveWatermark()}this.Open()}else{if(this.Owner.OnComboActivatorClick){this.Owner.OnComboActivatorClick();var a=(this.Owner&&this.Owner.ParentField&&this.Owner.ParentField.CanActivate);if(!a){this.ActClicked=true}}}if(!this.Writable&&this.Owner.RestoreSelection){this.Owner.RestoreSelection()}};IDCombo.prototype.OpenComboForced=function(){if(this.Enabled&&this.OptionList&&this.ListOwner){if(this.HasWatermark&&this.Owner&&this.Owner.RemoveWatermark){this.Owner.RemoveWatermark()}this.Open()}else{if(this.Owner.OnComboActivatorClick){this.Owner.OnComboActivatorClick(true);this.ActClicked=true}}};IDCombo.prototype.Open=function(g){var p=false;if(RD3_Glb.IsMobile()&&!this.ListOwner&&this.Owner.Text!="*"&&this.ComboPopup&&this.ComboPopup.style.display=="none"){p=true;if(this.ComboPopupInput){this.ComboPopupInput.value="";RD3_Glb.RemoveClass(this.ComboPopupInput,"combo-search-deletable")}}if(!this.OptionList||p){if(this.Owner.OnComboActivatorClick){this.Owner.OnComboActivatorClick(true);this.ActClicked=true}return}var m=null;var q=this;if(!this.ComboPopup){this.ComboPopup=document.createElement("DIV");this.ComboPopup.className="combo-popup";this.ComboPopup.setAttribute("id",this.Identifier+":cap");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsMobile()&&!RD3_Glb.IsIE(10,true)){this.ComboPopup.addEventListener("touchstart",function(i){q.OnTouchStart(i)},false);this.ComboPopup.addEventListener("touchmove",function(i){q.OnTouchMove(i)},false);this.ComboPopup.addEventListener("touchend",function(i){q.OnTouchEnd(i)},false)}if(!RD3_Glb.IsMobile()&&RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR){this.ComboPopup.style.zIndex=10}var k=document.createElement("TABLE");k.className="combo-popup-table";m=document.createElement("TBODY");k.appendChild(m);this.ComboPopup.appendChild(k);this.ComboTbl=k;if(RD3_Glb.IsMobile()){var f=(this.Owner instanceof PCell||this.Owner instanceof IDEditor)?this.Owner.ParentField.ParentPanel:null;if(this.IsPopOver()){document.body.appendChild(this.ComboPopup)}else{if(this.SlideForm()){if(!this.CloneElem){this.CloneElem=f.WebForm.FramesBox.cloneNode(false);f.WebForm.FormBox.appendChild(this.CloneElem)}this.CloneElem.appendChild(this.ComboPopup)}else{f.ContentBox.appendChild(this.ComboPopup)}}}}else{this.ComboPopup.style.display="";if(this.CloneElem){this.CloneElem.style.display=""}var l=this.ComboPopup.firstChild;while(l&&l.tagName!="TABLE"){l=l.nextSibling}if(!l&&this.ComboTbl){l=this.ComboTbl}if(l){m=l.tBodies[0]}}if(!m){return}if(!RD3_Glb.IsMobile()){if(this.ComboPopup.parentNode!=document.body||this.ComboPopup.nextSibling){document.body.appendChild(this.ComboPopup)}}this.ComboPopup.style.visibility="hidden";if(this.Owner&&this.Owner instanceof PCell&&this.Owner.GetDynPropSign()!="|||-1|"){this.Owner.ApplyDynPropToVisualStyle(this.VisualStyle)}var o=this.VisualStyle.GetColor(4);if(o=="transparent"){this.VisualStyle.SetColor("white",4)}var e=this.VisualStyle.GetBorders(6);if(e!=4){this.VisualStyle.SetBorderType(4,6)}this.VisualStyle.ApplyValueStyle(this.ComboPopup,false,false,false,false,false,false,false,null,false,false,false,true);if(o=="transparent"){this.VisualStyle.SetColor("transparent",4)}if(e!=4){this.VisualStyle.SetBorderType(e,6)}if(!g){this.OptionList.SetComboItemsVisible();if(this.SelItems.length>0){this.HLItem=this.SelItems[0]}else{this.HLItem=this.OptionList.GetNextVisibleItem()}}this.OptionList.RealizeCombo(m,this.Identifier,this.VisualStyle,this.SelItems,this.MultiSel,this.HLItem,this.OptionList&&!this.ListOwner);var c=this.OptionList.ItemList.length;for(var j=0;j<c;j++){var b=this.OptionList.ItemList[j];if(b.Image!=""){if(RD3_Glb.Adapt4Retina(this.Identifier,b.Image,43,j)){var h=b.TR;if(h&&h.childNodes.length>=1){var a=h.childNodes[1].firstChild;if(a){a.style.display="none"}}}}}if(!g&&(this.ShowValue||RD3_Glb.IsMobile())){if(!this.ComboPopupInput){this.ComboPopupInput=document.createElement("INPUT");if(RD3_Glb.IsMobile()){this.ComboPopupInput.className="combo-search";this.ComboPopupInput.setAttribute("id",this.Identifier+":txt");this.ComboPopupInput.placeholder=ClientMessages.MOB_SEARCH_HINT;if(this.IsPopOver()&&!this.ListOwner){this.ComboSearchArea=document.createElement("DIV");this.ComboSearchArea.className="combo-search-area";this.ComboSearchArea.appendChild(this.ComboPopupInput);this.ComboPopup.insertBefore(this.ComboSearchArea,this.ComboPopup.firstChild)}else{this.ComboPopup.insertBefore(this.ComboPopupInput,this.ComboPopup.firstChild)}}else{this.ComboPopupInput.className="combo-input";this.ComboPopupInput.style.height=(this.Height-(RD3_ServerParams.Theme=="zen"?(this.Owner.InList?-6:3):5))+"px";document.body.appendChild(this.ComboPopupInput);this.VisualStyle.ApplyValueStyle(this.ComboPopupInput);this.ComboPopupInput.style.borderWidth="2px"}this.ComboPopupInput.onkeyup=function(i){q.OnKeyUp(i)};if(RD3_Glb.IsAndroid()){var r=function(i){q.OnSearchMouseDown(i)};if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.ComboPopupInput.addEventListener("touchstart",r,false)}else{if(document.addEventListener){this.ComboPopupInput.addEventListener("mousedown",r,false)}else{this.ComboPopupInput.attachEvent("onmousedown",r)}}}if(RD3_Glb.IsMobile()&&(RD3_Glb.IsIphone(7)||RD3_Glb.IsIpad(7))){this.ComboPopupInput.onblur=function(i){document.body.scrollTop=0}}}else{this.ComboPopupInput.style.display="";if(this.ComboSearchArea){this.ComboSearchArea.style.display=""}if(!this.IsOpen&&this.ListOwner){this.ComboPopupInput.value=""}}if(!RD3_Glb.IsMobile()){this.ComboPopupInput.value=this.GetComboFinalName(false);this.PreviousInputText=this.ComboPopupInput.value}else{if(!RD3_Glb.IsTouch()&&this.Writable){window.setTimeout("document.getElementById('"+this.ComboPopupInput.id+"').focus()",500)}}}if(this.Owner&&this.Owner instanceof PCell&&this.Owner.GetDynPropSign()!="|||-1|"){this.Owner.CleanVisualStyle(this.VisualStyle)}if(!this.AnimatingCombo&&!RD3_Glb.IsMobile()){this.AdaptPopupLayout(true)}this.EnsureItemVisible();if(this.ComboPopupInput&&this.ComboPopupInput.style.display==""&&!RD3_Glb.IsMobile()){if(this.Writable){this.ComboPopupInput.focus()}if(!RD3_Glb.IsIE(10,false)){RD3_KBManager.ActiveElement=this.ComboPopupInput}if(!g){this.SelectAllDummyInpText()}}RD3_DDManager.OpenCombo=this;if(!this.IsOpen){if(RD3_Glb.IsMobile()){if(this.IsPopOver()){this.ComboPopup.style.visibility="";this.ShowPopOverCombo(true)}else{this.ShowMobileCombo(true)}}else{this.ComboPopup.style.visibility="";var d=new GFX("combo",true,this,RD3_Glb.IsFirefox(3));RD3_GFXManager.AddEffect(d)}}else{this.ComboPopup.style.visibility=""}this.IsOpen=true};IDCombo.prototype.Close=function(a){if(RD3_Glb.IsMobile()&&this.ClosingCombo){return}if(this.ComboPopup&&this.ComboPopup.style.display==""){if(RD3_Glb.IsMobile()){if(this.ComboPopupInput){this.ComboPopupInput.blur()}if(!this.IsPopOver()){this.ClosingCombo=true;this.ShowMobileCombo(false)}else{this.ShowPopOverCombo(false)}}else{var c=new GFX("combo",false,this,RD3_Glb.IsFirefox(3));RD3_GFXManager.AddEffect(c)}}if(this.ComboPopupInput&&!RD3_Glb.IsMobile()){this.ComboPopupInput.style.display="none"}if(this.ComboPopupTimer!=0){window.clearInterval(this.ComboPopupTimer);this.ComboPopupTimer=0}if(a){if(this.OptionList&&!this.ListOwner){var d=this.OptionList.ItemList;var b=d[d.length-1];if(b&&b.Value=="LKEPREC"){this.OriginalText=(this.ShowValue?b.Value:b.Name)}}if(!this.MultiSel||!this.IsOpen){this.SetText(this.OriginalText!=undefined?this.OriginalText:"",this.ShowValue)}}else{if(this.SelItems.length>0){this.SetComboValue(this.GetComboFinalName(this.ShowValue));this.PreviousInputText=this.ComboInput.value;this.OriginalText=this.ComboInput.value}if(this.SelItems.length==0){if(this.ComboInput.value!=""&&!this.AllowFreeText){this.SetText(this.OriginalText!=undefined?this.OriginalText:"",this.ShowValue)}if(this.ComboInput.value==""&&!this.IsOptional){this.SetText(this.OriginalText!=undefined?this.OriginalText:"",this.ShowValue)}}}this.UpdateImage();if(!RD3_Glb.IsTouch()&&this.Writable){this.ComboInput.focus()}RD3_DDManager.OpenCombo=null;this.IsOpen=false;if(this.SelItems.length>0&&this.SelItems[0].VisualStyle&&this.Owner.PValue){this.Owner.PValue.SetVisualStyle(this.SelItems[0].VisualStyle);this.Owner.PValue.UpdateScreen()}if(this.Owner.OnComboChange){if(!this.ListOwner){this.Owner.OnComboChange(true,true)}else{this.Owner.OnComboChange(!a)}}if(this.Owner.OnMultipleComboChange){this.Owner.OnMultipleComboChange(this)}};IDCombo.prototype.AdaptPopupLayout=function(a){var f=this.ComboInput;if(this.RightAlign&&this.ComboActivator&&this.ComboActivator.style.display==""){f=this.ComboActivator}var h=RD3_Glb.GetScreenLeft(f);var e=RD3_Glb.GetScreenTop(f);this.ComboPopup.style.top=(e+this.Height+(RD3_ServerParams.Theme=="zen"?(this.Owner.InList?7:-2):0))+"px";this.ComboPopup.style.left=(h-2+(this.Owner instanceof BookSpan||RD3_ServerParams.Theme=="zen"?1:0))+"px";if(a){var b=this.ComboPopup.scrollTop;this.ComboPopup.style.height="";var d=this.ComboPopup.clientHeight;if(d<RD3_ClientParams.ComboPopupMinHeight){d=RD3_ClientParams.ComboPopupMinHeight}else{if(d>RD3_ClientParams.ComboPopupMaxHeight){d=RD3_ClientParams.ComboPopupMaxHeight}}this.ComboPopup.style.height=d+"px";this.ComboPopup.firstChild.width="";this.ComboPopup.style.width="";var g=this.ComboPopup.scrollWidth+(this.ComboPopup.offsetWidth-this.ComboPopup.clientWidth);if(g<this.Width){g=this.Width+(RD3_ServerParams.Theme=="zen"?(this.Owner.InList?7:1):0)}this.ComboPopup.style.width=g+"px";this.ComboPopup.firstChild.width="100%";if(RD3_Glb.IsIE()&&g>this.Width&&RD3_ServerParams.Theme!="zen"){var g=this.ComboPopup.scrollWidth+(this.ComboPopup.offsetWidth-this.ComboPopup.clientWidth);this.ComboPopup.style.width=g+"px"}this.ComboPopup.scrollTop=b;if(this.ComboPopupInput&&this.ComboPopupInput.style.display==""){this.ComboPopupInput.style.width=(this.ComboPopup.offsetWidth-8)+"px"}}if(e+this.Height+this.ComboPopup.offsetHeight>document.body.clientHeight){this.ComboPopup.style.top=(e-this.ComboPopup.offsetHeight-(RD3_ServerParams.Theme=="zen"?1:2))+"px";this.ComboUpper=true}else{this.ComboUpper=false}if(this.ComboPopup.offsetTop<0){var i=this.ComboPopup.offsetTop;this.ComboPopup.style.top="0px";var c=this.ComboPopup.offsetHeight+i;if(c<RD3_ClientParams.ComboPopupMinHeight){c=RD3_ClientParams.ComboPopupMinHeight}this.ComboPopup.style.height=c+"px"}if(this.ComboPopup.offsetLeft+this.ComboPopup.offsetWidth>RD3_DesktopManager.WebEntryPoint.WepBox.offsetWidth){this.ComboPopup.style.left=Math.max(0,RD3_DesktopManager.WebEntryPoint.WepBox.offsetWidth-this.ComboPopup.offsetWidth)+"px"}if(this.ComboPopupInput&&this.ComboPopupInput.style.display==""){this.ComboPopupInput.style.left=this.ComboPopup.style.left;this.ComboPopupInput.style.top=(e-2)+"px"}};IDCombo.prototype.OnComboImageLoaded=function(){if(!RD3_Glb.IsMobile()&&!RD3_GFXManager.Animating()){this.AdaptPopupLayout(true)}};IDCombo.prototype.OnOptionMouseOver=function(b,a){if(this.OptionList){this.HiligthItem(this.OptionList.ItemList[parseInt(a)])}};IDCombo.prototype.OnOptionMouseOut=function(b,a){if(this.OptionList&&!this.MultiSel){this.HiligthItem()}};IDCombo.prototype.HiligthItem=function(a){if(this.OptionList){if(this.HLItem){RD3_Glb.RemoveClass(this.HLItem.TR,"combo-option-hiligth")}this.HLItem=a;if(!this.HLItem&&this.MultiSel){this.HLItem=this.OptionList.ItemList[0]}if(this.HLItem){RD3_Glb.AddClass(this.HLItem.TR,"combo-option-hiligth")}}};IDCombo.prototype.OnOptionClick=function(c,a){var d=this.OptionList.ItemList[parseInt(a)];if(d&&d.Enabled){var b=(window.event)?window.event.srcElement:c.target;if(b.tagName=="TD"){b=b.childNodes[0];if(b){b.checked=!b.checked}}if(b&&b.className=="combo-option-check"){if(this.Writable){if(this.ComboPopupInput){this.ComboPopupInput.focus()}else{this.ComboInput.focus()}}this.OnOptionCheck(d,b.checked)}else{this.SelItems=new Array();this.SelItems.push(d);this.Close()}}};IDCombo.prototype.OnOptionCheck=function(c,b){if(b){if(this.SelItems.length==1&&(this.SelItems[0].Value==""||(this.OptionList&&!this.ListOwner)&&this.SelItems[0].Value=="LKEPREC")){RD3_Glb.RemoveClass(this.SelItems[0].TR,"combo-option-selected");this.SelItems[0].TR.style.backgroundColor="";this.SelItems=new Array()}this.SelItems.push(c);if(!this.MultiSel||c.Value!=""){RD3_Glb.AddClass(c.TR,"combo-option-selected");c.TR.style.backgroundColor=this.VisualStyle.GetColor(9)}}else{RD3_Glb.RemoveClass(c.TR,"combo-option-selected");c.TR.style.backgroundColor="";for(var a=0;a<this.SelItems.length;a++){if(this.SelItems[a]==c){this.SelItems.splice(a,1);break}}if(this.SelItems.length==0){var d=this.OptionList.ItemList[0];if(d.Name==""){this.SelItems.push(d);if(!this.MultiSel){RD3_Glb.AddClass(d.TR,"combo-option-selected");d.TR.style.backgroundColor=this.VisualStyle.GetColor(9)}}}}if(this.ComboPopupInput){this.ComboPopupInput.value=this.GetComboFinalName(false)}this.SetComboValue(this.GetComboFinalName(this.ShowValue))};IDCombo.prototype.OnMouseDown=function(f){var i=(window.event)?window.event.clientX:f.clientX;var e=(window.event)?window.event.clientY:f.clientY;var g=this.ComboInput;if(this.RightAlign&&this.ComboActivator&&this.ComboActivator.style.display==""){g=this.ComboActivator}var b=RD3_Glb.GetScreenLeft(g);var k=RD3_Glb.GetScreenTop(g);var j=this.Width;var c=this.Height;if(this.ComboPopupInput&&this.ComboPopupInput.style.display==""&&this.ComboPopupInput.offsetWidth>j){j=this.ComboPopupInput.offsetWidth}if((i>=b&&i<=b+j)&&(e>=k&&e<=k+c)){return}if(this.ComboPopup){b=RD3_Glb.GetScreenLeft(this.ComboPopup);k=RD3_Glb.GetScreenTop(this.ComboPopup);j=this.ComboPopup.offsetWidth;c=this.ComboPopup.clientHeight}if((i>=b&&i<=b+j)&&(e>=k&&e<=k+c)){return}if(RD3_Glb.IsMobile()){return}var a=(window.event)?window.event.srcElement:f.target;this.Close();if(a){try{a.focus()}catch(d){RD3_KBManager.CheckFocus=true}}};IDCombo.prototype.OnKeyDown=function(b){if(window.event&&b==undefined){b=window.event}var d=(b.charCode)?b.charCode:b.keyCode;if((d==38||d==40||d==33||d==34)&&!b.altKey){if(this.IsOpen){if(!this.OptionList){this.Close(true);return}var c=this.OptionList.GetNextVisibleItem((this.MultiSel?this.HLItem:this.SelItems[0]),(d==38||d==33),(d==33||d==34));if(this.MultiSel){this.HiligthItem(c)}else{if(this.Owner&&this.Owner instanceof PCell&&this.Owner.GetDynPropSign()!="|||-1|"){this.Owner.ApplyDynPropToVisualStyle(this.VisualStyle)}if(this.SelItems.length>0){this.SelItems[0].TR.style.backgroundColor=this.VisualStyle.GetColor(5);RD3_Glb.RemoveClass(this.SelItems[0].TR,"combo-option-selected")}this.SelItems=new Array();this.SelItems.push(c);if(c.Value!=""){this.SelItems[0].TR.style.backgroundColor=this.VisualStyle.GetColor(9);RD3_Glb.AddClass(this.SelItems[0].TR,"combo-option-selected")}if(this.Owner&&this.Owner instanceof PCell&&this.Owner.GetDynPropSign()!="|||-1|"){this.Owner.CleanVisualStyle(this.VisualStyle)}if(this.SelItems.length>0&&this.ComboPopupInput&&this.ComboPopupInput.style.display==""){this.ComboPopupInput.value=this.SelItems[0].Name;this.PreviousInputText=this.ComboPopupInput.value;this.SelectAllDummyInpText()}}this.EnsureItemVisible();RD3_Glb.StopEvent(b);return}}if(d==13||d==9||d==27){if(this.IsOpen){RD3_Glb.StopEvent(b)}if(this.IsOpen&&d==13&&this.MultiSel&&this.HLItem&&(this.SelItems.length==0||(this.SelItems.length==1&&this.SelItems[0].Value==""))){this.OnOptionCheck(this.HLItem,true)}this.Close(d==27);return}if((d==113||(b.altKey&&d==40))&&!this.IsOpen&&this.Enabled){if(d==113){this.OnClickActivator()}else{this.Open()}RD3_Glb.StopEvent(b);return}if(((d>=114&&d<=123)||(d==112))&&this.IsOpen){this.Close();return}if(d==32&&this.IsOpen&&this.MultiSel){if(!this.HLItem){return}var a=this.HLItem.TR.childNodes[0].childNodes[0];if(!a){return}a.checked=!a.checked;this.OnOptionCheck(this.HLItem,a.checked);RD3_Glb.StopEvent(b);return}};IDCombo.prototype.OnKeyUp=function(d){if(window.event&&d==undefined){d=window.event}var e=(d.charCode)?d.charCode:d.keyCode;var a=this.Owner.ParentField;if(e==38||e==40||e==33||e==34){return}if(e==13||e==9||e==27){return}if(e>=112&&e<=123){return}if(e==32&&this.IsOpen&&this.MultiSel){return}var g=this.ComboInput.value;var f=(this.ComboPopupInput&&this.ComboPopupInput.style.display=="");if(f){g=this.ComboPopupInput.value}if(g==this.PreviousInputText){return}if(RD3_Glb.IsMobile()){if(this.ComboPopupInput.value!=""){RD3_Glb.AddClass(this.ComboPopupInput,"combo-search-deletable")}else{RD3_Glb.RemoveClass(this.ComboPopupInput,"combo-search-deletable")}}this.PreviousInputText=g;if(!this.ListOwner){if(RD3_Glb.IsMobile()&&g==""){g="*"}this.OptionList=null;if(!this.MultiSel){this.SelItems=new Array()}this.ActClicked=true;if(g==""){this.OriginalText="";if(!this.MultiSel||!this.IsOpen){this.Close(true)}return}}var b=a&&a.HasValueSource&&a.SuperActive&&this.ComboInput.value!="";if(!this.OptionList||b){if(this.Owner.OnComboChange){var c=this.ListOwner;if(b){this.ListOwner=false}this.Owner.OnComboChange(true,this.IsOpen,true);if(b){this.ListOwner=c;this.Owner.OnComboActivatorClick();this.ActClicked=true}}return}this.OptionList.FilterComboItem(g,true);if(this.SelItems.length==0||!this.SelItems[0].Visible){this.SelItems=new Array();this.HLItem=this.OptionList.GetNextVisibleItem(null);if(this.HLItem&&!this.MultiSel){this.SelItems.push(this.HLItem)}}if(g==""&&this.IsOptional){this.SelItems=new Array();if(this.OptionList.ItemList[0].Name==""){this.SelItems.push(this.OptionList.ItemList[0])}if(f){this.Open(true)}else{this.Close()}}else{this.Open(true)}if(this.Owner.OnComboChange){this.Owner.OnComboChange()}};IDCombo.prototype.EnsureItemVisible=function(a){if(a==undefined){a=this.OptionList.GetItemIndex(this.MultiSel?this.HLItem:this.SelItems[0])}this.OptionList.EnsureItemVisible(this.ComboPopup,a)};IDCombo.prototype.OnTimerTick=function(){this.AdaptPopupLayout()};IDCombo.prototype.Clone=function(a){var b=new IDCombo(a);b.Identifier="cmb:"+Math.floor(Math.random()*1000000000);RD3_DesktopManager.ObjectMap.add(b.Identifier,b);b.Left=this.Left;b.Top=this.Top;b.Width=this.Width;b.Height=this.Height;b.Enabled=this.Enabled;b.Visible=this.Visible;b.RightAlign=this.RightAlign;b.Clickable=this.Clickable;b.Tooltip=this.Tooltip;b.ListOwner=this.ListOwner;b.ShowActivator=this.ShowActivator;b.IsOptional=this.IsOptional;b.AllowFreeText=this.AllowFreeText;b.ShowValue=this.ShowValue;b.ActImage=this.ActImage;b.ActWidth=this.ActWidth;b.ActEnaIfComboDis=this.ActEnaIfComboDis;b.VisualStyle=this.VisualStyle;b.OptionList=null;b.SelItem=null;b.PreviousInputText=this.PreviousInputText;b.OriginalText=this.OriginalText;b.MultiSel=this.MultiSel;b.HasWatermark=this.HasWatermark;b.UsePopover=this.UsePopover;b.Badge=this.Badge;b.PaddingLeft=this.PaddingLeft;b.PaddingRight=this.PaddingRight;b.ComboInput=this.ComboInput.cloneNode(false);if(RD3_Glb.IsMobile()){b.ComboInput.value=this.ComboInput.value}if(this.ComboActivator){b.ComboActivator=this.ComboActivator.cloneNode(false)}if(this.ComboImg){b.ComboImg=this.ComboImg.cloneNode(false)}if(this.ComboBadge){b.ComboBadge=this.ComboBadge.cloneNode(true)}return b};IDCombo.prototype.SelectAllDummyInpText=function(){if(this.ComboPopupInput.createTextRange){this.ComboPopupInput.createTextRange().select()}else{this.ComboPopupInput.selectionStart=0;this.ComboPopupInput.selectionEnd=this.ComboPopupInput.value.length}};IDCombo.prototype.GetTooltip=function(a,b){if(b==this.ComboImg||b==this.ComboInput||b==this.ComboActivator){var c="";if(this.Tooltip!=""){c=this.Tooltip}else{if(this.SelItems.length>0){c=this.SelItems[0].Tooltip}}if(c==""){return false}if(this.Owner.GetTooltipTitle){a.SetTitle(this.Owner.GetTooltipTitle())}if(this.Owner.ErrorType==1){a.SetStyle("error")}else{if(this.Owner.ErrorType==2||this.Owner.ErrorType==3){a.SetStyle("warning")}}a.SetText(c);a.SetAutoAnchor(true);a.SetPosition(2);return true}if(this.OptionList&&this.OptionList.GetTooltipCombo(this.ComboPopup,a,b)){if(this.Owner.GetTooltipTitle){a.SetTitle(this.Owner.GetTooltipTitle())}return true}return false};IDCombo.prototype.DeferEmptyCombo=function(){this.DeferEmpty=true;if(this.IsOpen){if(this.ComboPopup&&this.ComboPopup.style.display==""){var a=new GFX("combo",false,this,RD3_Glb.IsFirefox(3));RD3_GFXManager.AddEffect(a)}if(this.ComboPopupTimer!=0){window.clearInterval(this.ComboPopupTimer);this.ComboPopupTimer=0}RD3_DDManager.OpenCombo=null;this.IsOpen=false}};IDCombo.prototype.ShowDescription=function(a){if(this.Owner.ParentField){return this.Owner.ParentField.ShowDescription(a)}if(a){return a.ShowDescription()}return true};IDCombo.prototype.SetClassName=function(a){if(a===this.ClassName){return}if(this.ClassName!=""){RD3_Glb.RemoveClass2(this.ComboInput,this.ClassName)}this.ClassName=a;if(this.ClassName&&this.ClassName!=""){RD3_Glb.AddClass(this.ComboInput,this.ClassName)}};IDCombo.prototype.SetWatermark=function(){if(this.HasWatermark){return}this.HasWatermark=true;RD3_Glb.AddClass(this.ComboInput,"panel-field-value-watermark")};IDCombo.prototype.RemoveWatermark=function(){if(!this.HasWatermark){return}this.HasWatermark=false;RD3_Glb.RemoveClass(this.ComboInput,"panel-field-value-watermark")};IDCombo.prototype.OnTouchStart=function(d){if(d.targetTouches.length!=1){return false}d.preventDefault();this.TouchStartX=d.targetTouches[0].clientX;this.TouchStartY=d.targetTouches[0].clientY;this.TouchOrgX=d.targetTouches[0].clientX;this.TouchOrgY=d.targetTouches[0].clientY;var c=RD3_Glb.ElementFromPoint(this.TouchStartX,this.TouchStartY);while(c&&c.tagName!="TR"){c=c.parentNode}if(c){var b=c.id.lastIndexOf(":");if(b>-1){var a=parseInt(c.id.substring(b+1));this.OnOptionMouseOver(d,a)}}this.TouchTimes=new Array();this.TouchPosY=new Array();this.TouchPosX=new Array();this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);this.TouchMoved=false;this.ClearTouchScrollTimer();return false};IDCombo.prototype.OnTouchMove=function(c){if(this.TouchStartX==-1){return false}c.preventDefault();if(c.targetTouches.length!=1){return false}var b=c.targetTouches[0].clientX-this.TouchStartX;var d=c.targetTouches[0].clientY-this.TouchStartY;var a=new Date();this.TouchStartX=c.targetTouches[0].clientX;this.TouchStartY=c.targetTouches[0].clientY;if(Math.abs(this.TouchStartX-this.TouchOrgX)>RD3_ClientParams.TouchMoveLimit||Math.abs(this.TouchStartY-this.TouchOrgY)>RD3_ClientParams.TouchMoveLimit){this.TouchMoved=true;this.OnOptionMouseOut(c)}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);if(this.TouchTimes.length>3){this.TouchTimes.shift();this.TouchPosY.shift();this.TouchPosX.shift()}this.ComboPopup.scrollLeft-=b;this.ComboPopup.scrollTop-=d;return false};IDCombo.prototype.OnTouchEnd=function(f){if(this.TouchStartX==-1){return false}f.preventDefault();if(f.targetTouches.length!=0&&f.changedTouches.length!=1){return false}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}if(!this.TouchMoved){var k=f.changedTouches[0].clientX;var j=f.changedTouches[0].clientY;var h=false;this.OnOptionMouseOut(f);if(new Date()-this.SingleTapTime<300&&Math.abs(k-this.SingleTapX)<16&&Math.abs(j-this.SingleTapY)<16){h=true;this.SingleTapTime=0;this.SingleTapX=-100;this.SingleTapY=-100}else{this.SingleTapTime=new Date();this.SingleTapX=k;this.SingleTapY=j}var a=document.elementFromPoint(k,j);if(a&&a.nodeType==3){a=a.parentNode}var d=null;var l=true;if(l){var c=document.createEvent("MouseEvents");c.initMouseEvent(h?"dblclick":"click",true,true,window,1,k,j,k,j);a.dispatchEvent(c)}}else{if(this.TouchTimes.length==3){var b=this.TouchTimes[2]-this.TouchTimes[0];var n=this.TouchPosX[0]-this.TouchPosX[2];var m=this.TouchPosY[0]-this.TouchPosY[2];if(new Date()-this.TouchTimes[2]<100&&b>0){var g=m/b;var i=n/b;if(Math.abs(i)>0.3||Math.abs(g)>0.3){this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+i+","+g+",0])",10)}}}}this.TouchStartX=-1;this.TouchStartY=-1;this.TouchMoved=false;return false};IDCombo.prototype.TouchScrollTimer=function(d,b){if(b.length==3){var c=b[0];var a=b[1];var e=b[2];this.ComboPopup.scrollLeft+=c*10;this.ComboPopup.scrollTop+=a*10;if(e<40){c=c*0.97;a=a*0.97;this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+c+","+a+","+(e+1)+"])",10)}}};IDCombo.prototype.ClearTouchScrollTimer=function(){if(this.TouchScrollTimerId>0){window.clearTimeout(this.TouchScrollTimerId);this.TouchScrollTimerId=0;this.TouchScroll=0}};IDCombo.prototype.SetComboValue=function(a){this.ComboInput.value=a;if(this.ComboInput.tagName=="DIV"){this.ComboInput.textContent=a}};IDCombo.prototype.ShowMobileCombo=function(p){var h=this.Owner.ParentField.ParentPanel;var f=this.GetObjToSlide();var i=this.GetToolbarToSlide();var k=this;if(!h.Realized){return}if(!this.ToolbarButtonCnt){this.ToolbarButtonCnt=document.createElement("div");this.ToolbarButtonCnt.setAttribute("id",this.Identifier+":cnt");this.ToolbarButtonCnt.className="panel-formlist-container";i.insertBefore(this.ToolbarButtonCnt,i.firstChild);this.ToolbarButton=document.createElement("div");this.ToolbarButton.setAttribute("id",this.Identifier+":btn");this.ToolbarButton.className="panel-toolbar-button panel-formlist-button";this.ToolbarButton.onclick=function(r){k.Close(r)};this.ToolbarButtonImg=document.createElement("div");this.ToolbarButtonImg.setAttribute("id",this.Identifier+":img");this.ToolbarButtonImg.className="panel-formlist-arrow";this.ToolbarButtonImg.onclick=function(r){k.Close(r)};this.ToolbarButtonCnt.appendChild(this.ToolbarButtonImg);this.ToolbarButtonCnt.appendChild(this.ToolbarButton)}if(this.ToolbarButton.textContent==""){var j=(this.SlideForm()?h.WebForm:h);this.ToolbarButton.textContent=j.Caption;j.SetCaption(this.Owner.ParentField.FormHeader)}RD3_Glb.SetTransitionProperty(f,"-webkit-transform");RD3_Glb.SetTransitionProperty(this.ComboPopup,"-webkit-transform");RD3_Glb.SetTransitionDuration(f,"0ms");RD3_Glb.SetTransitionDuration(this.ComboPopup,"0ms");RD3_Glb.SetTransitionTimingFunction(f,"ease");RD3_Glb.SetTransitionTimingFunction(this.ComboPopup,"ease");RD3_Glb.SetTransitionDuration(this.ToolbarButtonCnt,"0ms");var b=RD3_Glb.TranslateY(f);var l=RD3_Glb.TranslateY(this.ComboPopup);var o=0;var m=0;var e=0;var a=0;var g=0;var d=0;var c=0;var q=0;if(p){o=0;m=-h.ContentBox.offsetWidth;e=h.ContentBox.offsetWidth;a=0;g=200;c=0;d=0;q=1}else{o=-h.ContentBox.offsetWidth;m=0;e=0;a=h.ContentBox.offsetWidth;g=0;c=1;d=200;q=0}RD3_Glb.SetTransform(f,"translate3d("+o+"px,"+b+"px,0px)");RD3_Glb.SetTransform(this.ComboPopup,"translate3d("+e+"px,"+l+"px,0px)");RD3_Glb.SetTransform(this.ToolbarButtonCnt,"translate3d("+g+"px,"+l+"px,0px)");this.ToolbarButtonCnt.style.opacity=c;this.ToolbarButtonCnt.style.display="";this.ComboPopup.style.visibility="";if(p){if(this.SlideForm()){h.WebForm.AdaptToolbarLayout()}else{h.UpdateToolbar();if(RD3_Glb.IsQuadro()){if(h.CaptionTxt.offsetLeft<44){h.CaptionTxt.style.marginLeft="44px"}}if(h.HasScrollbar&&h.PanelMode==RD3_Glb.PANEL_LIST){h.ScrollBoxMobile.style.display="none"}}if(h&&h.IDScroll){h.IDScroll.Enabled=false}}else{if(this.IDScroll){this.IDScroll.Enabled=false}if(!this.SlideForm()&&h.HasScrollbar&&h.PanelMode==RD3_Glb.PANEL_LIST){h.ScrollBoxMobile.style.display=""}}var n="RD3_Glb.SetTransitionDuration(document.getElementById('"+f.id+"'), '250ms');";n+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.ComboPopup.id+"'), '250ms');";n+="RD3_Glb.SetTransform(document.getElementById('"+f.id+"'), 'translate3d("+m+"px,"+b+"px,0px)');";n+="RD3_Glb.SetTransform(document.getElementById('"+this.ComboPopup.id+"'), 'translate3d("+a+"px,"+l+"px,0px)');";n+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.ToolbarButtonCnt.id+"'), '250ms');";n+="RD3_Glb.SetTransform(document.getElementById('"+this.ToolbarButtonCnt.id+"'), 'translate3d("+d+"px,0px,0px)');";n+="document.getElementById('"+this.ToolbarButtonCnt.id+"').style.opacity="+q+";";if(!this.ea){this.ea=function(r){k.OnEndAnimation(r)}}RD3_Glb.AddEndTransaction(this.ComboPopup,this.ea,false);window.setTimeout(n,30)};IDCombo.prototype.OnEndAnimation=function(b){if(RD3_Glb.GetTransitionDuration(this.ComboPopup)=="0ms"){return}this.ClosingCombo=false;var c=this.Owner.ParentField.ParentPanel;var a=this.GetObjToSlide();RD3_Glb.RemoveEndTransaction(this.ComboPopup,this.ea,false);RD3_Glb.SetTransitionProperty(this.ComboPopup,"");RD3_Glb.SetTransitionProperty(a,"");RD3_Glb.SetTransitionDuration(this.ComboPopup,"");RD3_Glb.SetTransitionDuration(a,"");if(!this.IsOpen){this.ComboPopup.style.display="none";this.ToolbarButtonCnt.style.display="none";var d;if(this.SlideForm()){d=c.WebForm;c.WebForm.AdaptToolbarLayout()}else{d=c;c.UpdateToolbar()}d.SetCaption(this.ToolbarButton.textContent);this.ToolbarButton.textContent=""}if(this.IDScroll){this.IDScroll.Unrealize();this.IDScroll=null;if(c&&c.IDScroll){c.IDScroll.Enabled=true}}if(this.IsOpen){this.IDScroll=new IDScroll(this.Identifier,this.ComboPopup,this.SlideForm()?this.CloneElem:c.ContentBox,c);if(c&&c.IDScroll){c.IDScroll.Enabled=false}}if(!this.IsOpen){this.Owner.ParentField.HiliteCombo(this.ComboInput,false);if(c&&c.PanelMode==RD3_Glb.PANEL_LIST){c.HiliteRow(0)}if(this.CloneElem){this.CloneElem.style.display="none"}}};IDCombo.prototype.AdaptMobileCombo=function(){var c=this.Owner.ParentField.ParentPanel;var a=this.GetObjToSlide();var d=RD3_Glb.TranslateY(a);var b=-c.ContentBox.offsetWidth;RD3_Glb.SetTransform(a,"translate3d("+b+"px,"+d+"px,0px)")};IDCombo.prototype.OnTouchDown=function(b){var a=b.target;if(a==this.ComboPopupInput){this.ComboPopupInput.focus();this.OnSearchMouseDown(b)}while(a&&a.tagName!="TR"){a=a.parentNode}if(a){this.HiliteObj=a;RD3_Glb.AddClass(a,"open-combo-hover")}return true};IDCombo.prototype.OnTouchUp=function(d,b){if(this.HiliteObj){RD3_Glb.RemoveClass(this.HiliteObj,"open-combo-hover");this.HiliteObj=null}if(b){var c=d.target?d.target:d.srcElement;if(c==this.ComboPopupInput){return true}while(c&&c.id==""){c=c.parentNode}if(c&&c.id){var a=parseInt(c.id.substr(c.id.lastIndexOf(":")+1),10);this.OnOptionClick(d,a)}}return true};IDCombo.prototype.OnSearchMouseDown=function(d){var c=d.target;if(c==this.ComboPopupInput){if(RD3_Glb.HasClass(this.ComboPopupInput,"combo-search-deletable")){var a=(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true))?d.targetTouches[0].clientX:d.clientX;var b=a-(RD3_Glb.GetScreenLeft(this.ComboPopupInput,true)+this.ComboPopupInput.offsetWidth);if(b<0&&b>=-40){this.ComboPopupInput.value="";this.OnKeyUp(d)}}}};IDCombo.prototype.IsPopOver=function(){return this.UsePopover};IDCombo.prototype.ShowPopOverCombo=function(g){if(!g){this.ComboPopover.Close();this.ComboPopup.style.display="none"}else{var f=RD3_DesktopManager.WebEntryPoint.WepBox;var e=this.ComboPopup.firstChild;while(e&&e.tagName!="TABLE"){e=e.nextSibling}if(!e&&this.ComboTbl){e=this.ComboTbl}if(!this.ListOwner){RD3_Glb.SetTransform(e,"translate3d(0px, 0px, 0px)")}var c=e.offsetHeight+44;if(c<88){c=88}if(c>(f.offsetHeight-this.Height-44)/2){c=(f.offsetHeight-this.Height-44)/2}this.ComboPopup.style.setProperty("width","auto","important");e.style.setProperty("table-layout","auto","important");var a=e.offsetWidth+30;e.style.tableLayout="";this.ComboPopup.style.width="";if(this.ListOwner&&this.ComboSearchArea){this.ComboSearchArea.style.display="none"}if(this.ListOwner&&this.ComboPopupInput){this.ComboPopupInput.style.display="none"}if(a<54){a=54}if(a>f.offsetWidth/2){a=f.offsetWidth/2}if(RD3_Glb.IsSmartPhone()){a=f.offsetWidth-2;c=e.offsetHeight+44;if(c>(f.offsetHeight-44)*0.8){c=(f.offsetHeight-44)*0.8}}var b=this.ComboInput;if(this.Owner instanceof BookSpan){b=this.Owner.ParentBox.BoxBox}var d=new PopupFrame(null,this);d.Borders=RD3_Glb.BORDER_THIN;d.SetWidth(a);d.SetHeight(c);d.Centered=false;d.CanMove=false;d.AutoClose=true;d.ModalAnim=RD3_Glb.IsSmartPhone();d.Owner=this;d.AttachTo(b);d.Realize("-popover");if(this.Owner&&this.Owner instanceof BookSpan){d.SetCaption(this.Owner.ParentBox.Tooltip)}if(this.Owner&&this.Owner instanceof PCell){d.SetCaption(this.Owner.ParentField.Header)}d.Host(null,this.ComboPopup,true,this.ListOwner?0:46);RD3_DDManager.OpenPopup=d;d.Open();this.ComboPopover=d}};IDCombo.prototype.OnAutoClosePopup=function(a){this.Close();return false};IDCombo.prototype.GetObjToSlide=function(){var a=this.Owner.ParentField.ParentPanel;var b=a.PanelMode==RD3_Glb.PANEL_LIST?a.ListBox:a.FormBox;if(this.SlideForm()){b=a.WebForm.FramesBox}return b};IDCombo.prototype.SlideForm=function(){var b=this.Owner.ParentField.ParentPanel;var a=b.WebForm;if(a.HasCaption()){return true}else{return false}};IDCombo.prototype.GetToolbarToSlide=function(){var b=this.Owner.ParentField.ParentPanel;var a=b.WebForm;if(a.HasCaption()){return a.CaptionBox}else{return b.ToolbarBox}};IDCombo.prototype.SetBadge=function(a){this.Badge=a;if(this.Badge==""){if(this.ComboBadge!=null&&this.ComboBadge.parentNode){this.ComboBadge.parentNode.removeChild(this.ComboBadge)}this.ComboBadge=null}else{if(this.ComboBadge==null){this.ComboBadge=document.createElement("div");this.ComboBadge.className="badge-grey";this.ComboBadge.style.position="absolute";if(RD3_Glb.IsMobile()){this.ComboBadge.style.marginTop="6pt"}if(this.Owner.SetZIndex){this.Owner.SetZIndex(this.ComboBadge)}this.ComboInput.parentElement.appendChild(this.ComboBadge)}this.SetLeft(this.Left);this.SetTop(this.Top);this.ComboBadge.innerHTML=this.Badge}if(RD3_Glb.IsMobile()){this.AdaptMobileInput()}};IDCombo.prototype.AdaptMobileInput=function(){if((this.ComboActivator&&this.ComboActivator.style.display=="")||this.Badge!=""){this.ComboInput.style.textOverflow="ellipsis"}else{this.ComboInput.style.textOverflow=""}if(!this.ComboInputW){return}var c=0;var b=0;if(this.ComboActivator&&this.ComboActivator.style.display==""){if(this.RightAlign){c=this.ActWidth}else{b=this.ActWidth}}if(this.ComboBadge!=null){var d=RD3_Glb.GetBadgeWidth(this.Badge,"grey");if(this.ComboActivator&&this.ComboActivator.style.display==""){b+=d+12}else{b+=d-4}}if(RD3_Glb.IsMobile()&&this.ComboImg&&this.ComboImg.style.display==""){c+=RD3_ClientParams.ComboImageSize+8}var a=this.ComboInputW-(c+b);if(this.VisualStyle){c+=(this.VisualStyle.GetCustomPadding(2)*96/288);b+=(this.VisualStyle.GetCustomPadding(4)*96/288)}this.ComboInput.style.width=a+"px";if(c!=this.PaddingLeft){this.PaddingLeft=c;this.ComboInput.style.paddingLeft=c+"px"}if(b!=this.PaddingRight){this.PaddingRight=b;this.ComboInput.style.paddingRight=b+"px"}};IDCombo.prototype.OnAdaptRetina=function(a,e,d){if(d===undefined){if(this.ComboImg){this.ComboImg.width=a;this.ComboImg.height=e;this.ComboImg.style.display="";this.SetLeft(this.Left);this.SetTop(this.Top);this.SetWidth(this.Width);this.SetHeight(this.Height)}}else{var c=this.OptionList.ItemList[d].TR;if(c&&c.childNodes.length>=1){var b=c.childNodes[1].firstChild;if(b){b.width=a;b.height=e;b.style.display=""}}}};IDCombo.prototype.SetWritable=function(a){this.Writable=a;if(this.ComboInput){if(this.Writable){this.ComboInput.removeAttribute("readonly");if(!RD3_Glb.IsSafari()){this.ComboInput.removeAttribute("disabled")}}else{this.ComboInput.setAttribute("readonly",true);if(!RD3_Glb.IsSafari()){this.ComboInput.setAttribute("disabled",true)}}}};function IDEditor(a){this.Identifier="";this.Owner=a;this.ParentField=a.ParentField;this.Left=0;this.Top=0;this.Width=0;this.Height=0;this.Enabled=true;this.Visible=true;this.Layout=1;this.BackCol="#FFFFFF";this.ForeCol="#000000";this.HTMLContent="";this.HasToolbar=true;this.Tooltip="";this.VisualStyle=null;this.FontList=null;this.ColorList=new Array();this.TokenList=null;this.CommandsEnabled=-1;this.DefaultFormatting="";this.ToolbarContainer=null;this.EditorObj=null;this.TextObj=null;this.ToolBold=null;this.ToolItalic=null;this.ToolUnder=null;this.ToolStrike=null;this.ToolOrdList=null;this.ToolUnOrdList=null;this.ToolLeft=null;this.ToolCenter=null;this.ToolRight=null;this.ToolJust=null;this.ToolBackCol=null;this.ToolForeCol=null;this.ToolFont=null;this.ToolFontSize=null;this.ToolToken=null;this.ToolLink=null;this.ToolIMG=null;this.ToolChange=null;this.ToolSeparators=new Array();this.IMGUploadObj=null;this.BackColApplier=null;this.BackColChooser=null;this.ForeColApplier=null;this.ForeColChooser=null;this.InputMsg=null;this.LastSelection=null;this.SelectionTimer=null;this.LastTextSend=null;this.ToolStatus=new HashTable();this.ToolObjects=new Array;this.PressColor=RD3_ClientParams.EditorPressIE7Color;this.HilightColor=RD3_ClientParams.EditorHilightIE7Color;this.Realized=false;this.IsDirty=false}IDEditor.prototype.Realize=function(a,j){if(this.Identifier==""){this.Identifier="ide:"+Math.floor(Math.random()*1000000000);RD3_DesktopManager.ObjectMap.add(this.Identifier,this)}if(!this.Realized){var h=RD3_Glb.IsMobile();this.RealizeToolbar(a);if(h){this.EditorObj=document.createElement("DIV")}else{this.EditorObj=document.createElement("IFRAME")}this.EditorObj.className="ideditor-body";this.TextObj=document.createElement("TEXTAREA");this.TextObj.className="ideditor-body";a.appendChild(this.EditorObj);a.appendChild(this.TextObj);if(h){this.EditorObj.setAttribute("contentEditable","true");if(document.queryCommandSupported("styleWithCSS")){document.execCommand("styleWithCSS",false,false)}var d=this;var k=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnLoseFocus', ev);");var e=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnGetFocus', ev);");var c=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyDown', ev);");var f=function(l){d.OnMouseClick(l)};var b=function(l){d.OnMouseOverObj(l)};var i=function(l){d.OnMouseOutObj(l)};this.EditorObj.addEventListener("blur",k,true);this.EditorObj.addEventListener("keydown",c,true);this.EditorObj.addEventListener("mousedown",f,true);this.TextObj.addEventListener("blur",k,true);this.TextObj.addEventListener("keydown",c,true);if(!RD3_Glb.IsIE(10,false)){this.EditorObj.addEventListener("focus",e,true);this.TextObj.addEventListener("focus",e,true)}if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.EditorObj.addEventListener("touchstart",f,true)}}else{var g=this.GetEditorDocument();if(g&&g.body&&!RD3_Glb.IsFirefox()){g.IDOwnerObject=this.Identifier;g.designMode="on";if(g.queryCommandSupported("styleWithCSS")){g.execCommand("styleWithCSS",false,false)}var d=this;var k=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnLoseFocus', ev);");var e=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnGetFocus', ev);");var c=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyDown', ev);");var f=function(l){d.OnMouseClick(l)};var b=function(l){d.OnMouseOverObj(l)};var i=function(l){d.OnMouseOutObj(l)};if(document.addEventListener){this.EditorObj.contentWindow.addEventListener("blur",k,true);g.body.addEventListener("keydown",c,true);g.body.addEventListener("mouseup",f,true);this.TextObj.addEventListener("blur",k,true);this.TextObj.addEventListener("keydown",c,true);if(!RD3_Glb.IsIE(10,false)){this.EditorObj.contentWindow.addEventListener("focus",e,true);this.TextObj.addEventListener("focus",e,true)}this.ToolbarContainer.addEventListener("mouseover",b,true);this.ToolbarContainer.addEventListener("mouseout",i,true);if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){g.body.addEventListener("touchend",f,true)}}else{g.body.attachEvent("onblur",k);g.body.attachEvent("onkeydown",c);g.body.attachEvent("onmouseup",f);this.TextObj.attachEvent("onblur",k);this.TextObj.addEventListener("onkeydown",c);if(!RD3_Glb.IsIE(10,false)){g.body.attachEvent("onfocus",e);this.TextObj.attachEvent("onfocus",e)}this.ToolbarContainer.attachEvent("onmouseover",b);this.ToolbarContainer.attachEvent("onmouseout",i);if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){g.body.attachEvent("ontouchend",f)}}}else{if(!RD3_Glb.IsIE(10,false)){this.EditorObj.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEditorReadyStateChange', ev)")}else{this.EditorObj.onreadystatechange=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEditorReadyStateChange', ev)")}}}this.ToolStatus.add(RD3_Glb.IDE_BOLD,false);this.ToolStatus.add(RD3_Glb.IDE_ITALIC,false);this.ToolStatus.add(RD3_Glb.IDE_UNDERLINE,false);this.ToolStatus.add(RD3_Glb.IDE_STRIKE,false);this.ToolStatus.add(RD3_Glb.IDE_UL,false);this.ToolStatus.add(RD3_Glb.IDE_OL,false);this.ToolStatus.add(RD3_Glb.IDE_LEFT,false);this.ToolStatus.add(RD3_Glb.IDE_CENTER,false);this.ToolStatus.add(RD3_Glb.IDE_JUSTIFY,false);this.ToolStatus.add(RD3_Glb.IDE_RIGHT,false);this.ToolStatus.add(RD3_Glb.IDE_CHANGE,false);this.Realized=true}this.SetLayout();this.AssignColorList();this.AssignTokenList();this.AssignFontList();this.SetCommandEnabled();this.SetClassName()};IDEditor.prototype.RealizeToolbar=function(a){var g=RD3_Glb.IsMobile()?36:24;this.ToolbarContainer=document.createElement("DIV");this.ToolbarContainer.className="ideditor-toolbar";this.ToolBold=document.createElement("SPAN");this.ToolBold.className="ideditor-toolbar-img";this.ToolBold.style.backgroundPosition="0px 0px";this.ToolObjects[RD3_Glb.IDE_BOLD]=this.ToolBold;this.ToolItalic=document.createElement("SPAN");this.ToolItalic.className="ideditor-toolbar-img";this.ToolItalic.style.backgroundPosition="0px -"+g+"px";this.ToolObjects[RD3_Glb.IDE_ITALIC]=this.ToolItalic;this.ToolUnder=document.createElement("SPAN");this.ToolUnder.className="ideditor-toolbar-img";this.ToolUnder.style.backgroundPosition="0px -"+(g*2)+"px";this.ToolObjects[RD3_Glb.IDE_UNDERLINE]=this.ToolUnder;this.ToolStrike=document.createElement("SPAN");this.ToolStrike.className="ideditor-toolbar-img";this.ToolStrike.style.backgroundPosition="0px -"+(g*3)+"px";this.ToolObjects[RD3_Glb.IDE_STRIKE]=this.ToolStrike;var h=document.createElement("SPAN");h.className="ideditor-toolbar-sep";this.ToolSeparators.push(h);this.ToolOrdList=document.createElement("SPAN");this.ToolOrdList.className="ideditor-toolbar-img";this.ToolOrdList.style.backgroundPosition="0px -"+(g*4)+"px";this.ToolObjects[RD3_Glb.IDE_OL]=this.ToolOrdList;this.ToolUnOrdList=document.createElement("SPAN");this.ToolUnOrdList.className="ideditor-toolbar-img";this.ToolUnOrdList.style.backgroundPosition="0px -"+(g*5)+"px";this.ToolObjects[RD3_Glb.IDE_UL]=this.ToolUnOrdList;var f=document.createElement("SPAN");f.className="ideditor-toolbar-sep";this.ToolSeparators.push(f);this.ToolLeft=document.createElement("SPAN");this.ToolLeft.className="ideditor-toolbar-img";this.ToolLeft.style.backgroundPosition="0px -"+(g*6)+"px";this.ToolObjects[RD3_Glb.IDE_LEFT]=this.ToolLeft;this.ToolCenter=document.createElement("SPAN");this.ToolCenter.className="ideditor-toolbar-img";this.ToolCenter.style.backgroundPosition="0px -"+(g*7)+"px";this.ToolObjects[RD3_Glb.IDE_CENTER]=this.ToolCenter;this.ToolRight=document.createElement("SPAN");this.ToolRight.className="ideditor-toolbar-img";this.ToolRight.style.backgroundPosition="0px -"+(g*8)+"px";this.ToolObjects[RD3_Glb.IDE_RIGHT]=this.ToolRight;this.ToolJust=document.createElement("SPAN");this.ToolJust.className="ideditor-toolbar-img";this.ToolJust.style.backgroundPosition="0px -"+(g*9)+"px";this.ToolObjects[RD3_Glb.IDE_JUSTIFY]=this.ToolJust;var e=document.createElement("SPAN");e.className="ideditor-toolbar-sep";this.ToolSeparators.push(e);this.ToolBackCol=document.createElement("SPAN");this.ToolBackCol.className="ideditor-toolbar-img ideditor-main";this.ToolBackCol.style.backgroundPosition=(RD3_Glb.IsMobile()?8:0)+"px -"+(g*10)+"px";this.ToolObjects[RD3_Glb.IDE_BACK]=this.ToolBackCol;this.BackColApplier=document.createElement("DIV");this.BackColApplier.className="ideditor-applier";this.BackColApplier.style.backgroundColor=this.BackCol;this.ToolBackCol.appendChild(this.BackColApplier);this.BackColChooser=document.createElement("SPAN");this.BackColChooser.className="ideditor-toolbar-img ideditor-chooser";this.ToolObjects[RD3_Glb.IDE_BACKCH]=this.BackColChooser;this.ToolForeCol=document.createElement("SPAN");this.ToolForeCol.className="ideditor-toolbar-img ideditor-main";this.ToolForeCol.style.backgroundPosition=(RD3_Glb.IsMobile()?8:0)+"px -"+(g*11)+"px";this.ToolObjects[RD3_Glb.IDE_FORE]=this.ToolForeCol;this.ForeColApplier=document.createElement("DIV");this.ForeColApplier.className="ideditor-applier";this.ForeColApplier.style.backgroundColor=this.ForeCol;this.ToolForeCol.appendChild(this.ForeColApplier);this.ForeColChooser=document.createElement("SPAN");this.ForeColChooser.className="ideditor-toolbar-img ideditor-chooser";this.ToolObjects[RD3_Glb.IDE_FORECH]=this.ForeColChooser;var d=document.createElement("SPAN");d.className="ideditor-toolbar-sep";this.ToolSeparators.push(d);this.ToolLink=document.createElement("SPAN");this.ToolLink.className="ideditor-toolbar-img";this.ToolLink.style.backgroundPosition="0px -"+(g*12)+"px";this.ToolObjects[RD3_Glb.IDE_LINK]=this.ToolLink;if(!RD3_Glb.IsMobile()&&typeof FileReader!="undefined"){this.ToolIMG=document.createElement("SPAN");this.ToolIMG.className="ideditor-toolbar-img";this.ToolIMG.style.backgroundPosition="0px -"+(g*13)+"px";this.ToolObjects[RD3_Glb.IDE_IMAGE]=this.ToolIMG;this.IMGUploadObj=document.createElement("input");this.IMGUploadObj.setAttribute("type","file");this.IMGUploadObj.style.display="none";this.IMGUploadObj.onchange=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnHTML5Upload', ev)")}var c=document.createElement("SPAN");c.className="ideditor-toolbar-sep";this.ToolSeparators.push(c);this.ToolChange=document.createElement("SPAN");this.ToolChange.className="ideditor-toolbar-img";this.ToolChange.style.backgroundPosition="0px -"+(g*14)+"px";this.ToolObjects[RD3_Glb.IDE_CHANGE]=this.ToolChange;var b=document.createElement("SPAN");b.className="ideditor-toolbar-sep";this.ToolSeparators.push(b);this.ToolFont=new IDCombo(this);this.ToolFont.Realize(this.ToolbarContainer,"panel-field-value-form");this.ToolFont.MultiSel=false;this.ToolFont.SetVisible(true);this.ToolFont.SetWritable(false);this.ToolFont.UsePopover=!this.ParentField.VisSlidePad();this.ToolFontSize=new IDCombo(this);this.ToolFontSize.Realize(this.ToolbarContainer,"panel-field-value-form");this.ToolFontSize.MultiSel=false;this.ToolFontSize.SetWritable(false);this.ToolFontSize.UsePopover=!this.ParentField.VisSlidePad();this.ToolToken=new IDCombo(this);this.ToolToken.Realize(this.ToolbarContainer,"panel-field-value-form");this.ToolToken.MultiSel=false;this.ToolToken.SetWritable(false);this.ToolToken.UsePopover=!this.ParentField.VisSlidePad();if(!RD3_Glb.IsMobile()){this.ToolBold.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'B')");this.ToolItalic.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'I')");this.ToolUnder.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'U')");this.ToolStrike.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'S')");this.ToolOrdList.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'OL')");this.ToolUnOrdList.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'UL')");this.ToolLeft.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'L')");this.ToolCenter.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'C')");this.ToolRight.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'R')");this.ToolJust.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'J')");this.ToolLink.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'LINK')");if(this.ToolIMG){this.ToolIMG.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'IMG')")}this.ToolChange.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'CHG')");this.ToolBackCol.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'BKG')");this.BackColChooser.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'BKGC')");this.ToolForeCol.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'FCG')");this.ForeColChooser.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onToolCommand', ev, 'FCGC')")}this.ToolbarContainer.appendChild(this.ToolBold);this.ToolbarContainer.appendChild(this.ToolItalic);this.ToolbarContainer.appendChild(this.ToolUnder);this.ToolbarContainer.appendChild(this.ToolStrike);this.ToolbarContainer.appendChild(h);this.ToolbarContainer.appendChild(this.ToolOrdList);this.ToolbarContainer.appendChild(this.ToolUnOrdList);this.ToolbarContainer.appendChild(f);this.ToolbarContainer.appendChild(this.ToolLeft);this.ToolbarContainer.appendChild(this.ToolCenter);this.ToolbarContainer.appendChild(this.ToolRight);this.ToolbarContainer.appendChild(this.ToolJust);this.ToolbarContainer.appendChild(e);this.ToolbarContainer.appendChild(this.ToolBackCol);this.ToolbarContainer.appendChild(this.BackColChooser);this.ToolbarContainer.appendChild(this.ToolForeCol);this.ToolbarContainer.appendChild(this.ForeColChooser);this.ToolbarContainer.appendChild(d);this.ToolbarContainer.appendChild(this.ToolLink);if(this.ToolIMG){this.ToolbarContainer.appendChild(this.ToolIMG)}this.ToolbarContainer.appendChild(c);this.ToolbarContainer.appendChild(this.ToolChange);this.ToolbarContainer.appendChild(b);if(this.IMGUploadObj){this.ToolbarContainer.appendChild(this.IMGUploadObj)}a.appendChild(this.ToolbarContainer)};IDEditor.prototype.UpdateToolbar=function(j){var n=false;var h=false;var m=false;var d=false;var q=false;var g=false;var b=false;var w=false;var o=false;var x=false;var e=false;var l=false;var u="-";var i="0";if(j){var p=null;if(j.startContainer){p=j.startContainer}else{if(j.parentElement){p=j.parentElement()}}if(p){while(p!=null){if(p.tagName=="BODY"){break}switch(p.tagName){case"B":case"STRONG":n=true;break;case"I":case"EM":h=true;break;case"U":m=true;break;case"STRIKE":d=true;break;case"OL":q=true;break;case"UL":g=true;break;case"A":e=true;break}if(p.align=="left"||(p.style&&p.style.textAlign=="left")){b=true}else{if(p.align=="center"||(p.style&&p.style.textAlign=="center")){w=true}else{if(p.align=="right"||(p.style&&p.style.textAlign=="right")){o=true}else{if(p.align=="justify"||(p.style&&p.style.textAlign=="justify")){x=true}}}}try{var k=RD3_Glb.GetCurrentStyle(p);if(u=="-"){u=k.fontFamily;u=u.replace(/\'/g,"")}if(i=="0"){i=k.fontSize.replace("pt","");if(i.indexOf("px")>=0&&p.tagName=="SPAN"&&p.style.fontSize.indexOf("pt")>=0){i=p.style.fontSize.replace("pt","")}else{i="0"}}}catch(v){}var r=(RD3_Glb.IsIE(10,false)?p.parentElement:p.parentNode);if(r){p=r}else{p=null}}}if(j.text&&j.text!=""){l=true}else{if(!j.collapsed){l=true}}}if(u!="-"&&this.FontList){var f=this.FontList.FindItemsByValue(u,false,";");if(f.length>0){this.ToolFont.SetText(u,true,true)}else{this.ToolFont.SetText("",true,true)}}if(i!="0"&&this.FontSizeList){var f=this.FontSizeList.FindItemsByValue(i,false,";");if(f.length>0){this.ToolFontSize.SetText(i,true,true)}else{this.ToolFontSize.SetText("",true,true)}}this.SetToolbarCommandStatus(RD3_Glb.IDE_BOLD,n);this.SetToolbarCommandStatus(RD3_Glb.IDE_ITALIC,h);this.SetToolbarCommandStatus(RD3_Glb.IDE_UNDERLINE,m);this.SetToolbarCommandStatus(RD3_Glb.IDE_STRIKE,d);this.SetToolbarCommandStatus(RD3_Glb.IDE_UL,g);this.SetToolbarCommandStatus(RD3_Glb.IDE_OL,q);this.SetToolbarCommandStatus(RD3_Glb.IDE_LEFT,b);this.SetToolbarCommandStatus(RD3_Glb.IDE_CENTER,w);this.SetToolbarCommandStatus(RD3_Glb.IDE_JUSTIFY,x);this.SetToolbarCommandStatus(RD3_Glb.IDE_RIGHT,o);this.SetToolbarCommandStatus(RD3_Glb.IDE_LINK,e);this.ToolLink.setAttribute("id_disabled",l?"false":"true");this.ToolLink.style.cursor=(this.Layout==1&&this.Enabled&&l?"pointer":"default");if(j==undefined){var t=false;var c=this.GetToolbarLimit();var s=c.x;var a=c.y+2;if(this.Width>0&&s+154>this.Width&&this.ToolFont&&this.ToolFont.Visible){s=4;a=c.y+2+(RD3_Glb.IsMobile()?36:24);t=true}if(this.ToolFont&&this.ToolFont.Visible){this.ToolFont.SetHeight(20);this.ToolFont.SetWidth(150);this.ToolFont.SetTop(a);this.ToolFont.SetLeft(s);s+=154}if(this.Width>0&&s+40>this.Width&&this.ToolFontSize&&this.ToolFontSize.Visible){s=4;a=c.y+2+(RD3_Glb.IsMobile()?36:24);t=true}if(this.ToolFontSize&&this.ToolFontSize.Visible){this.ToolFontSize.SetHeight(20);this.ToolFontSize.SetWidth(40);this.ToolFontSize.SetTop(a);this.ToolFontSize.SetLeft(s);s+=44}if(this.Width>0&&s+100>this.Width&&this.ToolToken&&this.ToolToken.Visible){s=4;a=c.y+2+(RD3_Glb.IsMobile()?36:24);t=true}if(this.ToolToken&&this.ToolToken.Visible){this.ToolToken.SetHeight(20);this.ToolToken.SetWidth(100);this.ToolToken.SetTop(a);this.ToolToken.SetLeft(s);s+=104}if(t){this.ToolbarContainer.style.height=(a+(RD3_Glb.IsMobile()?40:20)+2)+"px";this.SetTop();this.SetHeight()}}};IDEditor.prototype.UpdateCursor=function(){this.ToolBold.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolItalic.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolUnder.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolStrike.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolOrdList.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolUnOrdList.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolLeft.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolCenter.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolRight.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolJust.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolLink.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolBackCol.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.BackColChooser.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.BackColApplier.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolForeCol.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ForeColChooser.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ForeColApplier.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default");this.ToolChange.style.cursor=(this.Enabled?"pointer":"default");if(this.ToolIMG){this.ToolIMG.style.cursor=(this.Layout==1&&this.Enabled?"pointer":"default")}this.ToolFont.SetEnabled(this.Layout==1&&this.Enabled);this.ToolFontSize.SetEnabled(this.Layout==1&&this.Enabled);this.ToolToken.SetEnabled(this.Layout==1&&this.Enabled)};IDEditor.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);if(this.ToolbarContainer&&this.ToolbarContainer.parentNode){this.ToolbarContainer.parentNode.removeChild(this.ToolbarContainer)}this.ToolbarContainer=null;if(this.EditorObj&&this.EditorObj.parentNode){this.EditorObj.parentNode.removeChild(this.EditorObj)}this.EditorObj=null;if(this.TextObj&&this.TextObj.parentNode){this.TextObj.parentNode.removeChild(this.TextObj)}this.TextObj=null;if(this.SelectionTimer){window.clearInterval(this.SelectionTimer)}this.SelectionTimer=null;if(this.InputMsg){this.InputMsg.Unrealize()}this.InputMsg=null;this.ToolBold=null;this.ToolItalic=null;this.ToolUnder=null;this.ToolStrike=null;this.ToolOrdList=null;this.ToolUnOrdList=null;this.ToolLeft=null;this.ToolCenter=null;this.ToolRight=null;this.ToolJust=null;this.ToolBackCol=null;this.ToolForeCol=null;this.ToolFontSize=null;this.ToolToken=null;this.ToolLink=null;this.ToolIMG=null;this.ToolChange=null;this.IMGUploadObj=null;this.BackColApplier=null;this.BackColChooser=null;this.ForeColApplier=null;this.ForeColChooser=null;if(this.ToolFont){this.ToolFont.Unrealize()}this.ToolFont=null;if(this.ToolFontSize){this.ToolFontSize.Unrealize()}this.ToolFontSize=null;if(this.ToolToken){this.ToolToken.Unrealize()}this.ToolToken=null;if(this.LastSelection&&this.LastSelection.detach){this.LastSelection.detach()}this.LastSelection=null;this.ToolSeparators.splice(0,this.ToolSeparators.length);this.ToolSeparators=null;this.ToolObjects.splice(0,this.ToolObjects.length);this.ToolObjects=null};IDEditor.prototype.SetHasToolbar=function(b){var a=this.HasToolbar;this.HasToolbar=b;if(this.Realized&&(a!=this.HasToolbar||b==undefined)){this.ToolbarContainer.style.display=this.HasToolbar?"":"none"}};IDEditor.prototype.SetWidth=function(b){var a=this.Width;if(b!=undefined){this.Width=b}if(this.Realized){var c=this.GetToolbarHeight();this.ToolbarContainer.style.width=(this.Width-4)+"px";this.EditorObj.style.width=this.Width+"px";this.TextObj.style.width=this.Width+"px";if(a!=this.Width&&this.Width>a){this.ToolbarContainer.style.height=""}this.SetTop();if(c!=this.GetToolbarHeight()){this.SetHeight()}}};IDEditor.prototype.SetHeight=function(b){if(b!=undefined){this.Height=b}if(this.Realized){var a=this.Height-this.GetToolbarHeight()-1;a=(a<=0?0:a);this.EditorObj.style.height=a+"px";this.TextObj.style.height=a+"px"}};IDEditor.prototype.SetTop=function(a){if(a!=undefined){this.Top=a}if(this.Realized){this.ToolbarContainer.style.top=this.Top+"px";var b=this.GetToolbarHeight()-1;this.EditorObj.style.top=(this.Top+b)+"px";this.TextObj.style.top=(this.Top+b)+"px"}};IDEditor.prototype.SetLeft=function(a){if(a!=undefined){this.Left=a}if(this.Realized){this.ToolbarContainer.style.left=this.Left+"px";this.EditorObj.style.left=this.Left+"px";this.TextObj.style.left=this.Left+"px"}};IDEditor.prototype.SetActive=function(e){if(e&&this.Owner&&this.Owner.ParentField){var f=this.Owner.ParentField;var i=this.Owner.PValue?this.Owner.PValue.GetVisualStyle():f.VisualStyle;var d=i.GetColor(10);var b=i.GetColor(11);var h=i.GetBorders((this.Owner.InList)?1:6);var a=i.GetBookOffset(true,(this.Owner.InList)?1:6);var j=this.EditorObj.style;if(d!="transparent"){j.backgroundColor=d}else{j.border="2px solid "+b;var g=parseInt(j.width)-(2-a.x-a.w);var c=parseInt(j.height)-(4-a.y-a.h);j.width=(g<0?0:g)+"px";j.height=(c<0?0:c)+"px"}j=this.TextObj.style;if(d!="transparent"){j.backgroundColor=d}else{j.border="2px solid "+b;var g=parseInt(j.width)-(2-a.x-a.w);var c=parseInt(j.height)-(4-a.y-a.h);j.width=(g<0?0:g)+"px";j.height=(c<0?0:c)+"px"}}};IDEditor.prototype.Clone=function(a){var b=new IDEditor(a);b.Identifier="ide:"+Math.floor(Math.random()*1000000000);RD3_DesktopManager.ObjectMap.add(b.Identifier,b);b.Left=this.Left;b.Top=this.Top;b.Width=this.Width;b.Height=this.Height;b.Enabled=this.Enabled;b.Visible=this.Visible;b.Layout=this.Layout;b.BackCol=this.BackCol;b.ForeCol=this.ForeCol;b.HTMLContent=this.HTMLContent;b.HasToolbar=this.HasToolbar;b.Tooltip=this.Tooltip;b.VisualStyle=this.VisualStyle;b.FontList=this.FontList;b.ColorList=this.ColorList;b.TokenList=this.TokenList;return b};IDEditor.prototype.OnMouseOverObj=function(f){if(!this.Enabled){return}var d=(window.event)?window.event:f;var g=(window.event)?d.srcElement:d.explicitOriginalTarget;if(this.Layout!=1&&g!=this.ToolChange){return}var e=new Array();if(Object.keys){e=Object.keys(this.ToolObjects)}else{for(var a in this.ToolObjects){if(this.ToolObjects.hasOwnProperty(a)){e.push(a)}}}for(var c=0;c<e.length;c++){var b=e[c];var h=this.ToolObjects[parseInt(b,10)];if(h==g&&h.getAttribute("id_disabled")!="true"){g.style.backgroundColor=this.HilightColor}}};IDEditor.prototype.OnMouseOutObj=function(f){if(!this.Enabled){return}var d=(window.event)?window.event:f;var g=(window.event)?d.srcElement:d.target;if(this.Layout!=1&&g!=this.ToolChange){return}var e=new Array();if(Object.keys){e=Object.keys(this.ToolObjects)}else{for(var a in this.ToolObjects){if(this.ToolObjects.hasOwnProperty(a)){e.push(a)}}}for(var c=0;c<e.length;c++){var b=e[c];var h=this.ToolObjects[parseInt(b,10)];if(h==g){if(h==this.ToolBackCol||h==this.ToolForeCol||h==this.BackColChooser||h==this.ForeColChooser||h==this.ToolIMG||h==this.ToolLink){g.style.backgroundColor=""}else{this.SetToolbarCommandStatus(parseInt(b,10),this.ToolStatus[parseInt(b,10)],true)}}}};IDEditor.prototype.SetVisible=function(a){if(a!=this.Visible||a==undefined){if(a!=undefined){this.Visible=a}if(this.ToolbarContainer){RD3_Glb.SetDisplay(this.ToolbarContainer,this.Visible&&this.HasToolbar?"":"none")}if(this.EditorObj){RD3_Glb.SetDisplay(this.EditorObj,this.Visible&&this.Layout==1?"":"none")}if(this.TextObj){RD3_Glb.SetDisplay(this.TextObj,this.Visible&&this.Layout!=1?"":"none")}}};IDEditor.prototype.SetEnabled=function(b){if(b!=this.Enabled||b==undefined){if(b!=undefined){this.Enabled=b}if(this.Enabled){if(RD3_Glb.IsMobile()){this.EditorObj.setAttribute("contentEditable","true");this.EditorObj.style.overflow="scroll";this.TextObj.style.overflow="scroll"}else{var c=this.GetEditorDocument();if(c){c.designMode="on";try{if(c.queryCommandSupported("styleWithCSS")){c.execCommand("styleWithCSS",false,false)}}catch(a){}}}this.TextObj.removeAttribute("readonly");this.ToolbarContainer.style.opacity=""}else{if(RD3_Glb.IsMobile()){this.EditorObj.removeAttribute("contentEditable");this.EditorObj.style.overflow="";this.TextObj.style.overflow=""}else{var c=this.GetEditorDocument();if(c){c.designMode="off"}}this.TextObj.setAttribute("readonly",true);this.ToolbarContainer.style.opacity="0.6"}this.UpdateCursor()}};IDEditor.prototype.SetVisualStyle=function(j,f){if(this.VisualStyle!=j||f){this.VisualStyle=j;if(this.ToolFont){this.ToolFont.SetVisualStyle(this.VisualStyle,false,f)}if(this.ToolFontSize){this.ToolFontSize.SetVisualStyle(this.VisualStyle,false,f)}if(this.ToolToken){this.ToolToken.SetVisualStyle(this.VisualStyle,false,f)}if(this.ToolbarContainer){this.VisualStyle.ApplyBorderStyle(this.ToolbarContainer,(this.Owner.InList?1:9));var h=this.VisualStyle.GetColor(11);if(h.indexOf("#")!=-1&&h.length==7){var e=parseInt(h.substring(1,3),16);var d=parseInt(h.substring(3,5),16);var a=parseInt(h.substring(5,7),16);if(RD3_Glb.IsIE(10,false)){this.ToolbarContainer.style.backgroundColor=RD3_ClientParams.EditorToolbarIE7Color}else{this.ToolbarContainer.style.backgroundColor="rgba("+e+", "+d+", "+a+", 0.15)";this.PressColor="rgba("+e+", "+d+", "+a+", 0.75)";this.HilightColor="rgba("+e+", "+d+", "+a+", 0.50)"}for(var c=0;c<this.ToolSeparators.length;c++){this.ToolSeparators[c].style.borderRight="1px solid "+h}}}}};IDEditor.prototype.SetText=function(a){if(a!=undefined){this.HTMLContent=a}if(this.Realized){if(RD3_Glb.IsMobile()){this.EditorObj.innerHTML=this.HTMLContent}else{var b=this.GetEditorDocument();if(b&&b.body){b.body.innerHTML=this.HTMLContent}}this.TextObj.value=this.HTMLContent}this.IsDirty=false};IDEditor.prototype.HideContent=function(b,a){if(b){if(a){if(RD3_Glb.IsMobile()){this.EditorObj.removeAttribute("contentEditable")}else{var c=this.GetEditorDocument();if(c){c.designMode="off"}}this.TextObj.setAttribute("readonly",true)}if(this.ToolbarContainer){RD3_Glb.SetDisplay(this.ToolbarContainer,"none")}if(this.EditorObj){RD3_Glb.SetDisplay(this.EditorObj,"none")}if(this.TextObj){RD3_Glb.SetDisplay(this.TextObj,"none")}}else{if(RD3_Glb.IsMobile()&&this.Enabled&&this.EditorObj.getAttribute("contentEditable")!="true"){this.EditorObj.setAttribute("contentEditable","true")}else{var c=this.GetEditorDocument();if(this.Enabled&&c&&c.designMode!="on"){c.designMode="on";if(c.queryCommandSupported("styleWithCSS")){c.execCommand("styleWithCSS",false,false)}}}if(this.Enabled){this.TextObj.removeAttribute("readonly")}this.SetVisible()}};IDEditor.prototype.SetBackGroundImage=function(a){};IDEditor.prototype.SetTooltip=function(a){};IDEditor.prototype.GetDOMObj=function(){if(this.Realized){if(this.Layout==1){return this.EditorObj}else{return this.TextObj}}return null};IDEditor.prototype.GetTooltip=function(a,b){};IDEditor.prototype.RemoveWatermark=function(){};IDEditor.prototype.AssignFontList=function(b){if(b!==undefined){this.FontList=b}if(this.Realized){if(this.FontList&&this.FontList.ItemList.length>0&&this.ToolFont){if(!this.FontSizeList){this.FontSizeList=new ValueList();for(var a=8;a<24;a++){var e=a;switch(a){case 13:e=14;break;case 14:e=16;break;case 15:e=18;break;case 16:e=20;break;case 17:e=22;break;case 18:e=24;break;case 19:e=26;break;case 20:e=28;break;case 21:e=36;break;case 22:e=48;break;case 23:e=72;break}var d=new ValueListItem();d.Name=""+e;d.Value=""+e;d.OrgNames=""+e;d.HtmlNames=""+e;this.FontSizeList.ItemList.push(d)}this.ToolFontSize.AssignValueList(this.FontSizeList,true);this.ToolFontSize.SetText(this.FontSizeList.ItemList[0].Value,true,true)}this.ToolFont.AssignValueList(this.FontList,true);if(this.ToolFont.SelItems&&this.ToolFont.SelItems.length==0){this.ToolFont.SetText(this.FontList.ItemList[0].Value,true,true)}var c=false;if(this.ToolFont.Visible==false&&this.IsCommandEnabled(RD3_Glb.IDE_FONT)){this.ToolFont.SetVisible(true);c=true}if(this.ToolFontSize.Visible==false&&this.IsCommandEnabled(RD3_Glb.IDE_SIZE)){this.ToolFontSize.SetVisible(true);c=true}if(c){this.UpdateToolbar()}}else{var c=false;if(this.ToolFont.Visible){this.ToolFont.SetVisible(false);c=true}if(this.ToolFontSize.Visible){this.ToolFontSize.SetVisible(false);c=true}if(c){this.UpdateToolbar()}}}};IDEditor.prototype.AssignColorList=function(a){if(a!==undefined){this.ColorList=a;this.ColorForeList=null}if(this.Realized){if(this.ColorList==null||this.ColorList.length==0){this.ToolBackCol.style.display="none";this.BackColChooser.style.display="none";this.ToolForeCol.style.display="none";this.ForeColChooser.style.display="none"}else{this.SetCommandEnabled()}}};IDEditor.prototype.AssignTokenList=function(a){if(a!==undefined){this.TokenList=a}if(this.Realized){if(this.TokenList&&this.TokenList.ItemList.length>0&&this.ToolToken){this.ToolToken.AssignValueList(this.TokenList,true);if(this.ToolToken.Visible==false&&this.IsCommandEnabled(RD3_Glb.IDE_TOKEN)){this.ToolToken.SetVisible(true);this.UpdateToolbar()}}else{if(this.ToolToken.Visible){this.ToolToken.SetVisible(false);this.UpdateToolbar()}}}};IDEditor.prototype.SetLayout=function(c){var a=this.Layout;if(c!=undefined){this.Layout=c}if(this.Realized&&(a!=this.Layout||c==undefined)){if(this.Layout==1){RD3_Glb.SetDisplay(this.EditorObj,"");RD3_Glb.SetDisplay(this.TextObj,"none");if(RD3_Glb.IsMobile()){this.EditorObj.innerHTML=this.TextObj.value}else{var d=this.GetEditorDocument();if(d&&d.body){d.body.innerHTML=this.TextObj.value}}}else{RD3_Glb.SetDisplay(this.EditorObj,"none");RD3_Glb.SetDisplay(this.TextObj,"");this.TextObj.value=this.EditorObj.innerHTML;if(RD3_Glb.IsMobile()){this.TextObj.value=this.EditorObj.innerHTML}else{var d=this.GetEditorDocument();if(d&&d.body){this.TextObj.value=d.body.innerHTML}}}this.UpdateCursor();var b=RD3_Glb.IsMobile()?36:24;this.ToolChange.style.backgroundPosition=(this.Layout!=1?"0px -"+(b*15)+"px":"0px -"+(b*14)+"px")}};IDEditor.prototype.IsUncommited=function(){return this.IsDirty};IDEditor.prototype.SetID=function(a){this.EditorObj.setAttribute("id",a+":html");this.TextObj.setAttribute("id",a+":txt");this.ToolbarContainer.setAttribute("id",a+":tlc");this.ToolFont.SetID(a+":tcmb1");this.ToolFontSize.SetID(a+":tcmb2");this.ToolToken.SetID(a+":tcmb3");if(this.Owner.SetZIndex){this.Owner.SetZIndex(this.EditorObj);this.Owner.SetZIndex(this.TextObj)}};IDEditor.prototype.IsCommandEnabled=function(a){return((this.CommandsEnabled&a)>0)};IDEditor.prototype.AreCommandsEnabled=function(d,b){var a=true;if(d){a=false}for(var c=0;c<b.length;c++){if(d){a=a||this.IsCommandEnabled(b[c])}else{a=a&&this.IsCommandEnabled(b[c])}}return a};IDEditor.prototype.SetCommandEnabled=function(b){var a=this.CommandsEnabled;if(b!==undefined){this.CommandsEnabled=b}if(this.Realized&&(a!=this.CommandsEnabled||b===undefined)){this.ToolBold.style.display=this.IsCommandEnabled(RD3_Glb.IDE_BOLD)?"":"none";this.ToolItalic.style.display=this.IsCommandEnabled(RD3_Glb.IDE_ITALIC)?"":"none";this.ToolUnder.style.display=this.IsCommandEnabled(RD3_Glb.IDE_UNDERLINE)?"":"none";this.ToolStrike.style.display=this.IsCommandEnabled(RD3_Glb.IDE_STRIKE)?"":"none";this.ToolSeparators[0].style.display=this.AreCommandsEnabled(true,[RD3_Glb.IDE_BOLD,RD3_Glb.IDE_ITALIC,RD3_Glb.IDE_UNDERLINE,RD3_Glb.IDE_STRIKE])?"":"none";this.ToolOrdList.style.display=this.IsCommandEnabled(RD3_Glb.IDE_OL)?"":"none";this.ToolUnOrdList.style.display=this.IsCommandEnabled(RD3_Glb.IDE_UL)?"":"none";this.ToolSeparators[1].style.display=this.AreCommandsEnabled(true,[RD3_Glb.IDE_OL,RD3_Glb.IDE_UL])?"":"none";this.ToolLeft.style.display=this.IsCommandEnabled(RD3_Glb.IDE_LEFT)?"":"none";this.ToolCenter.style.display=this.IsCommandEnabled(RD3_Glb.IDE_CENTER)?"":"none";this.ToolRight.style.display=this.IsCommandEnabled(RD3_Glb.IDE_RIGHT)?"":"none";this.ToolJust.style.display=this.IsCommandEnabled(RD3_Glb.IDE_JUSTIFY)?"":"none";this.ToolSeparators[2].style.display=this.AreCommandsEnabled(true,[RD3_Glb.IDE_LEFT,RD3_Glb.IDE_CENTER,RD3_Glb.IDE_RIGHT,RD3_Glb.IDE_JUSTIFY])?"":"none";this.ToolBackCol.style.display=(this.ColorList.length>0&&this.IsCommandEnabled(RD3_Glb.IDE_BACK))?"":"none";this.BackColChooser.style.display=(this.ColorList.length>0&&this.IsCommandEnabled(RD3_Glb.IDE_BACK))?"":"none";this.ToolForeCol.style.display=(this.ColorList.length>0&&this.IsCommandEnabled(RD3_Glb.IDE_FORE))?"":"none";this.ForeColChooser.style.display=(this.ColorList.length>0&&this.IsCommandEnabled(RD3_Glb.IDE_FORE))?"":"none";this.ToolSeparators[3].style.display=this.AreCommandsEnabled(true,[RD3_Glb.IDE_BACK,RD3_Glb.IDE_FORE])?"":"none";this.ToolLink.style.display=this.IsCommandEnabled(RD3_Glb.IDE_LINK)?"":"none";if(this.ToolIMG){this.ToolIMG.style.display=this.IsCommandEnabled(RD3_Glb.IDE_IMAGE)?"":"none"}this.ToolSeparators[4].style.display=this.AreCommandsEnabled(true,[RD3_Glb.IDE_LINK,RD3_Glb.IDE_IMAGE])?"":"none";this.ToolChange.style.display=this.IsCommandEnabled(RD3_Glb.IDE_CHANGE)?"":"none";this.ToolSeparators[5].style.display=this.AreCommandsEnabled(true,[RD3_Glb.IDE_CHANGE])?"":"none";if(this.ToolFont){this.ToolFont.SetVisible(this.IsCommandEnabled(RD3_Glb.IDE_FONT)&&(this.FontList!=null&&this.FontList.ItemList.length>0))}if(this.ToolFontSize){this.ToolFontSize.SetVisible(this.IsCommandEnabled(RD3_Glb.IDE_SIZE)&&(this.FontList!=null&&this.FontList.ItemList.length>0))}if(this.ToolToken){this.ToolToken.SetVisible(this.IsCommandEnabled(RD3_Glb.IDE_TOKEN)&&(this.TokenList!=null&&this.TokenList.ItemList.length>0))}}};IDEditor.prototype.SetDefaultFormatting=function(a){this.DefaultFormatting=a};IDEditor.prototype.OnSelectionTimer=function(j,b){if(this.Layout!=1){return}if(b==undefined){b=false}var c=null;var l=this.GetEditorDocument();if(l&&l.getSelection){c=l.getSelection()}else{if(l&&l.selection){c=l.selection}}if(c){if(c.anchorNode==undefined&&document.selection){var a=c.createRange();if(!RD3_Glb.isInsideEditor(a.parentElement())){return}if(this.LastSelection){if(!a.isEqual(this.LastSelection)||b){this.UpdateToolbar(a)}}else{this.UpdateToolbar(a)}this.LastSelection=a.duplicate()}else{if(!RD3_Glb.isInsideEditor(c.anchorNode)||c.rangeCount==0){return}var a=c.getRangeAt(0);if(this.LastSelection){if(a.compareBoundaryPoints(Range.START_TO_START,this.LastSelection)!=0||a.compareBoundaryPoints(Range.END_TO_END,this.LastSelection)!=0||b){this.UpdateToolbar(a)}}else{this.UpdateToolbar(a)}this.LastSelection=a.cloneRange()}}if((this.DefaultFormatting!=""||RD3_ClientParams.AutoDefaultFormatting)&&l&&l.body){var f=l.body.childNodes.length;for(var i=0;i<f;i++){var e=l.body.childNodes.item(i);var k="";if(this.DefaultFormatting==""&&RD3_ClientParams.AutoDefaultFormatting&&e.tagName&&e.tagName=="P"){k=e.style.cssText}if(e&&(e.nodeType!=1||(e.tagName&&e.tagName!="P"&&RD3_Glb.GetStyleProp(e,"display")=="inline"))){if((e.tagName=="BR")||(e.nodeType==3&&(e.nodeValue==""||e.nodeValue=="\n"))){continue}if(this.LastSelection){var h=this.LastSelection.parentElement?this.LastSelection.parentElement:this.LastSelection.commonAncestorContainer;if(h&&h==e){continue}}var m=l.createElement("P");try{m.style.cssText=(this.DefaultFormatting!=""?this.DefaultFormatting:k)}catch(g){}var d=e.nextSibling;m.appendChild(e);if(d){l.body.insertBefore(m,d)}else{l.body.appendChild(m)}this.IsDirty=true}}}};IDEditor.prototype.OnEditorReadyStateChange=function(d){if(!RD3_Glb.IsIE(10,false)||this.EditorObj.readyState=="complete"){var g=this.GetEditorDocument();g.IDOwnerObject=this.Identifier;var c=this;var i=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnLoseFocus', ev);");var e=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnGetFocus', ev);");var b=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyDown', ev);");var f=function(j){c.OnMouseClick(j)};var a=function(j){c.OnMouseOverObj(j)};var h=function(j){c.OnMouseOutObj(j)};if(document.addEventListener){this.EditorObj.contentWindow.addEventListener("blur",i,true);this.EditorObj.contentWindow.addEventListener("blur",i,true);g.body.addEventListener("keydown",b,true);g.body.addEventListener("mouseup",f,true);this.TextObj.addEventListener("blur",i,true);this.TextObj.addEventListener("keydown",b,true);if(!RD3_Glb.IsIE(10,false)){this.EditorObj.contentWindow.addEventListener("focus",e,true);this.TextObj.addEventListener("focus",e,true)}this.ToolbarContainer.addEventListener("mouseover",a,true);this.ToolbarContainer.addEventListener("mouseout",h,true);if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){g.body.addEventListener("touchend",f,true)}}else{g.body.attachEvent("onblur",i);g.body.attachEvent("onkeydown",b);g.body.attachEvent("onmouseup",f);this.TextObj.attachEvent("onblur",i);this.TextObj.attachEvent("onkeydown",b);if(!RD3_Glb.IsIE(10,false)){g.body.attachEvent("onfocus",e);this.TextObj.attachEvent("onfocus",e)}this.ToolbarContainer.attachEvent("onmouseover",a);this.ToolbarContainer.attachEvent("onmouseout",h);if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){g.body.attachEvent("ontouchend",f)}}this.SetEnabled();this.SetText()}};IDEditor.prototype.OnLoseFocus=function(a){if(!RD3_Glb.IsIE(10,false)){RD3_KBManager.IDRO_LostFocus(a,(this.Layout==1?this.EditorObj:this.TextObj))}RD3_KBManager.IDRO_OnChange(this.Layout==1?this.EditorObj:this.TextObj,true)};IDEditor.prototype.OnGetFocus=function(a){RD3_KBManager.IDRO_GetFocus(a,(this.Layout==1?this.EditorObj:this.TextObj))};IDEditor.prototype.OnKeyDown=function(b){if(this.ParentField.ChangeEventDef==RD3_Glb.EVENT_ACTIVE&&(this.LastTextSend==null||(new Date()-this.LastTextSend>15000))&&this.Owner.PValue){this.Owner.PValue.SendChanges(this.Layout==1?this.EditorObj:this.TextObj);this.LastTextSend=new Date()}if(this.Layout==1){if(this.SelectionTimer!=null){window.clearTimeout(this.SelectionTimer);this.SelectionTimer=null}this.SelectionTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnSelectionTimer');",300);var c=(b.charCode)?b.charCode:b.keyCode;var a=null;if(this.Owner&&this.Owner.ParentField){a=this.Owner.ParentField}if(a){if(c==9){if(b.shiftKey){a.ParentPanel.FocusPrevField(a,b)}else{a.ParentPanel.FocusNextField(a,b)}}if(c>=112&&c<=123){RD3_KBManager.IDRO_OnChange(this.Layout==1?this.EditorObj:this.TextObj);a.HandleFunctionKeys(b);RD3_Glb.StopEvent(b);if(RD3_Glb.IsIE()){RD3_KBManager.FocusSomeone()}}}}var c=(b.charCode)?b.charCode:b.keyCode;if(RD3_Glb.IsTouch()||(c>=46&&c<=90)||(c>=96&&c<=105)||(c>=186&&c<=222)||c==8){this.IsDirty=true}};IDEditor.prototype.OnMouseClick=function(a){if(this.Layout!=1){return}RD3_DDManager.ClosePopup();if(this.Enabled){if(this.SelectionTimer!=null){window.clearTimeout(this.SelectionTimer);this.SelectionTimer=null}this.SelectionTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnSelectionTimer');",300)}};IDEditor.prototype.Focus=function(){if(this.Layout==1){var b=this.GetEditorDocument();b.body.focus();var a=null;if(b&&b.getSelection){a=b.getSelection()}else{if(b&&b.selection){a=b.selection}}if(a){if(a.anchorNode==undefined&&b.selection){}else{if(this.HTMLContent==""||a.anchorNode==null){a.collapse(b.body,0)}}}}else{this.TextObj.focus()}};IDEditor.prototype.getData=function(){var a="";if(this.Layout==1){if(RD3_Glb.IsMobile()){a=this.EditorObj.innerHTML}else{var b=this.GetEditorDocument();if(b&&b.body){a=b.body.innerHTML}}}else{a=this.TextObj.value}return a};IDEditor.prototype.OnTouchDown=function(b,a){if(!this.Enabled){return true}var c=true;var d=b.target?b.target:b.srcElement;if(d==this.EditorObj||d==this.TextObj||d==this.ToolbarContainer){c=false}if(RD3_Glb.isInsideEditor(d)){c=false}return c};IDEditor.prototype.OnEditorTouchUp=function(c,b){var a="";switch(b){case this.ToolBold:a="B";break;case this.ToolItalic:a="I";break;case this.ToolUnder:a="U";break;case this.ToolStrike:a="S";break;case this.ToolOrdList:a="OL";break;case this.ToolUnOrdList:a="UL";break;case this.ToolLeft:a="L";break;case this.ToolCenter:a="C";break;case this.ToolRight:a="R";break;case this.ToolJust:a="J";break;case this.ToolLink:a="LINK";break;case this.ToolIMG:a="IMG";break;case this.ToolChange:a="CHG";break;case this.ToolBackCol:a="BKG";break;case this.BackColChooser:a="BKGC";break;case this.ToolForeCol:a="FCG";break;case this.ForeColChooser:a="FCGC";break}if(a!=""){this.RestoreSelection();this.onToolCommand(c,a);return}var d=b;while(d&&(d.className=="combo-img"||d.className=="combo-activator")){d=d.previousSibling}if(d&&d.id!=""){if(d.id.indexOf(":tcmb1")!=-1){this.ToolFont.Open()}if(d.id.indexOf(":tcmb2")!=-1){this.ToolFontSize.Open()}if(d.id.indexOf(":tcmb3")!=-1){this.ToolToken.Open()}}};IDEditor.prototype.onToolCommand=function(f,g){if(this.Layout!=1&&g!="CHG"||!this.Enabled){var d=(window.event?window.event:f);if(d){RD3_Glb.StopEvent(d)}return}var h=this.GetEditorDocument();if(!h){return}var d=(window.event?window.event:f);switch(g){case"B":h.execCommand("bold",false);this.IsDirty=true;break;case"I":h.execCommand("italic",false);this.IsDirty=true;break;case"U":h.execCommand("underline",false);this.IsDirty=true;break;case"S":h.execCommand("strikeThrough",false);this.IsDirty=true;break;case"UL":h.execCommand("insertUnorderedList",false);this.IsDirty=true;break;case"OL":h.execCommand("insertOrderedList",false);this.IsDirty=true;break;case"L":h.execCommand("justifyLeft",false);this.IsDirty=true;break;case"C":h.execCommand("justifyCenter",false);this.IsDirty=true;break;case"J":h.execCommand("justifyFull",false);this.IsDirty=true;break;case"R":h.execCommand("justifyRight",false);this.IsDirty=true;break;case"IMG":if(this.IMGUploadObj){this.IMGUploadObj.value="";this.IMGUploadObj.click()}break;case"LINK":var a=false;if(this.ToolLink.getAttribute("id_disabled")!="true"){a=true}if(a){if(!this.InputMsg){this.InputMsg=new MessageBox(ClientMessages.IDE_LINK_MSG,RD3_Glb.MSG_INPUT,false);this.InputMsg.CallBackFunction=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onLinkCallback', ev)")}this.InputMsg.Open()}break;case"CHG":this.SetLayout(this.Layout==1?2:1);this.UpdateToolbar();break;case"BKG":h.execCommand("backColor",false,this.BackCol);this.IsDirty=true;break;case"BKGC":var b=new PopupControl(RD3_Glb.CTRL_CPICKER,this.Owner,this.ToolBackCol);b.Colors=this.ColorList;b.HasCaption=false;b.CallBackFunction=new Function("color","var par = ['BACK', color]; return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onColorCallback', null, par)");b.Open();b.LastActiveObject=this;b.LastActiveElement=this.EditorObj;break;case"FCG":h.execCommand("foreColor",false,this.ForeCol);this.IsDirty=true;break;case"FCGC":var b=new PopupControl(RD3_Glb.CTRL_CPICKER,this.Owner,this.ToolForeCol);if(!this.ColorForeList&&this.ColorList){this.ColorForeList=this.ColorList.slice(0);var e=-1;for(var c=0;c<this.ColorForeList.length;c++){if(this.ColorForeList[c]=="transparent"){e=c;break}}if(e>=0){this.ColorForeList.splice(e,1)}}b.Colors=this.ColorForeList;b.HasCaption=false;b.CallBackFunction=new Function("color","var par = ['FORE', color]; return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'onColorCallback', null, par)");b.Open();b.LastActiveObject=this;b.LastActiveElement=this.EditorObj;break}if(this.SelectionTimer!=null){window.clearTimeout(this.SelectionTimer);this.SelectionTimer=null}this.SelectionTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnSelectionTimer',null, true);",100);if(d){RD3_Glb.StopEvent(d)}};IDEditor.prototype.onLinkCallback=function(a){if(this.RestoreSelection(true)&&this.InputMsg){if(this.InputMsg.UserResponse!=""){var b=this.GetEditorDocument();b.execCommand("createLink",false,this.InputMsg.UserResponse);this.IsDirty=true}}};IDEditor.prototype.OnHTML5Upload=function(f){try{if(!this.Owner||!this.Owner.ParentField){return}if(this.IMGUploadObj.value==""){return}var g=RD3_DesktopManager.MessagePump.CreateRequest();g.EditorId=this.Identifier;var b=ClientMessages.SWF_FS_UPLOADING;RD3_DesktopManager.WebEntryPoint.DelayDialog.Open(b,RD3_Glb.PROGRESS,0);RD3_DesktopManager.WebEntryPoint.DelayDialog.SetProgress(0);RD3_DesktopManager.WebEntryPoint.DelayDialog.SetTotal(100);g.upload.addEventListener("progress",function(i){if(i.lengthComputable){RD3_DesktopManager.WebEntryPoint.DelayDialog.SetProgress(Math.ceil(i.loaded/i.total*100))}else{RD3_DesktopManager.WebEntryPoint.DelayDialog.SetProgress(i.loaded)}},false);g.addEventListener("load",function(i){if(this.status==200){RD3_DesktopManager.CallEventHandler(this.EditorId,"onUploadResponse",i,this.responseText)}},false);g.upload.addEventListener("error",function(k){RD3_DesktopManager.WebEntryPoint.DelayDialog.Close();var l=ClientMessages.SWF_ER_FILENOTSEND+"<br>"+g.status;var i=new MessageBox(l,RD3_Glb.MSG_BOX,false);i.Open()},false);var h="?WCI=IWFiles&WCE=EditIMG:"+this.Owner.ParentField.Identifier;g.open("post",h,true);var c=new FormData();var e=this.IMGUploadObj.files;var a=e.length;for(var d=0;d<a;d++){c.append("thefile"+d,e[d])}g.send(c)}catch(j){RD3_DesktopManager.WebEntryPoint.DelayDialog.Close()}};IDEditor.prototype.onUploadResponse=function(b,a){RD3_DesktopManager.WebEntryPoint.DelayDialog.Close();if(a!=""&&this.RestoreSelection()){var c=this.GetEditorDocument();c.execCommand("insertImage",false,a);this.IsDirty=true;this.OnLoseFocus(b);this.ImgAdded=true}};IDEditor.prototype.onColorCallback=function(j,i){if(i.length!=2){return}if(this.RestoreSelection()){if(i[0]=="BACK"){this.IsDirty=true;this.BackCol=i[1];if(this.BackColApplier){this.BackColApplier.style.backgroundColor=this.BackCol}if(this.BackCol=="transparent"){var b=null;var l=this.GetEditorDocument();if(l&&l.getSelection){b=l.getSelection()}else{if(l&&l.selection){b=l.selection}}if(b){if(b.anchorNode==undefined&&document.selection){var a=b.createRange();var h=a.htmlText;var f=new RegExp("background-color:.*;","g");h=h.replace(f,"");a.pasteHTML(h)}else{if(b.rangeCount==0){return}var a=b.getRangeAt(0);if(a.commonAncestorContainer&&a.commonAncestorContainer.nodeType==3&&a.commonAncestorContainer.parentNode){if(a.commonAncestorContainer.parentNode.tagName=="FONT"||a.commonAncestorContainer.parentNode.tagName=="SPAN"){a.commonAncestorContainer.parentNode.style.backgroundColor=""}}else{var m=new Array();var d=a.startContainer;if(a.startOffset>0&&d.nodeType!=3){d=a.startContainer.childNodes.item(a.startOffset)}var k=a.endContainer;if(a.endOffset>0&&k.nodeType!=3){k=a.endContainer.childNodes.item(a.endOffset)}var e=d;while(e){if(e.nodeType!=3){var n=e.getElementsByTagName("FONT");for(var c=0;c<n.length;c++){m.push(n.item(c))}n=e.getElementsByTagName("SPAN");for(var c=0;c<n.length;c++){m.push(n.item(c))}if(e.tagName=="SPAN"||e.tagName=="FONT"){m.push(e)}}e=e.nextSibling;if(e==k){break}}if(a.startOffset==0&&a.startContainer.parentNode&&(a.startContainer.parentNode.tagName=="SPAN"||a.startContainer.parentNode.tagName=="FONT")){m.push(a.startContainer.parentNode)}var g=m.length;for(var c=0;c<g;c++){m[c].style.backgroundColor=""}}}}}else{var l=this.GetEditorDocument();l.execCommand("backColor",false,this.BackCol)}}if(i[0]=="FORE"){this.IsDirty=true;this.ForeCol=i[1];if(this.ForeColApplier){this.ForeColApplier.style.backgroundColor=this.ForeCol}var l=this.GetEditorDocument();l.execCommand("foreColor",false,this.ForeCol)}}};IDEditor.prototype.OnMultipleComboChange=function(d){if(this.RestoreSelection()&&this.Enabled&&this.Layout==1){this.IsDirty=true;if(d==this.ToolFont){var n=this.ToolFont.GetComboValue();var m=this.GetEditorDocument();if(n!=""){m.execCommand("fontName",false,n)}}if(d==this.ToolFontSize){var q=this.ToolFontSize.GetComboValue();if(q!=""){var c=null;var m=this.GetEditorDocument();if(m&&m.getSelection){c=m.getSelection()}else{if(m&&m.selection){c=m.selection}}if(c){if(c.anchorNode==undefined&&document.selection){var a=c.createRange();var h=a.htmlText;if(h.indexOf("<span")==0){var k=h.indexOf(">");h="<span style='font-size:"+q+"pt; ' >"+h.substring(k+1)}else{h="<span style='font-size:"+q+"pt; ' >"+h+"</span>"}a.pasteHTML(h)}else{if(c.rangeCount==0){return}var a=c.getRangeAt(0);var g=false;var b=a.startContainer;if(a.startOffset!=0&&b.childNodes.length>0&&a.startOffset<b.childNodes.length){b=b.childNodes.item(a.startOffset)}if(b&&b.tagName!="SPAN"&&b.childNodes&&b.childNodes.length>0){b=b.childNodes.item(0)}if(b&&b.tagName!="SPAN"&&a.startContainer!=a.endContainer&&a.startContainer.nodeType==3&&a.startContainer.nodeValue.length==a.startOffset&&a.startContainer.nextSibling){b=a.startContainer.nextSibling}if(b&&b.tagName!="SPAN"&&a.startContainer.parentNode&&a.startContainer.parentNode.tagName=="SPAN"&&a.startOffset==0){b=a.startContainer.parentNode}if(b&&b.tagName=="SPAN"){b.style.fontSize=q+"pt";g=true}if(!g){var l=m.createElement("SPAN");l.style.fontSize=q+"pt";l.appendChild(a.extractContents());a.insertNode(l)}}}}}if(d==this.ToolToken){var f=this.ToolToken.GetComboValue();if(f!=""){if(f.indexOf("|")!=-1){var c=null;var m=this.GetEditorDocument();if(m&&m.getSelection){c=m.getSelection()}else{if(m&&m.selection){c=m.selection}}if(c){if(c.anchorNode==undefined&&m.selection){var a=c.createRange();var h=a.htmlText;a.pasteHTML(f.replace("|",h))}else{var a=c.getRangeAt(0);var l=m.createElement("SPAN");l.innerHTML=f.replace("|","<SPAN id='replace_node' ></SPAN>");var i=l.getElementsByTagName("SPAN");var e=null;for(var p=0;p<i.length;p++){e=(i.item(p).getAttribute("id")=="replace_node"?i.item(p):null)}if(e&&e.parentNode){var o=a.extractContents();e.parentNode.insertBefore(o,e);e.parentNode.removeChild(e)}var j=l.childNodes.length;var p=0;while(l.childNodes.length>0&&p<j){a.insertNode(l.childNodes.item(0));p++}}}}else{if(RD3_Glb.IsIE()){var c=null;var m=this.GetEditorDocument();if(m&&m.getSelection){c=m.getSelection()}else{if(m&&m.selection){c=m.selection}}if(c){if(c.anchorNode==undefined&&document.selection){var a=c.createRange();a.pasteHTML(f)}else{var a=c.getRangeAt(0);a.deleteContents();var l=m.createElement("SPAN");l.innerHTML=f;a.insertNode(l)}}}else{var m=this.GetEditorDocument();m.execCommand("insertHTML",false,f)}}}}}};IDEditor.prototype.RestoreSelection=function(b){if(!this.LastSelection){return false}var c=null;var d=this.GetEditorDocument();if(d&&d.getSelection){c=d.getSelection()}else{if(d&&d.selection){c=d.selection}}if(c){if(c.anchorNode==undefined&&d.selection){var a=d.body.createTextRange();a.setEndPoint("StartToStart",this.LastSelection);a.setEndPoint("EndToEnd",this.LastSelection);a.select();return true}else{c.removeAllRanges();c.addRange(this.LastSelection);if(b&&this.LastSelection.endContainer==this.LastSelection.startContainer&&this.LastSelection.startOffset==this.LastSelection.endOffset){return false}return true}}return false};IDEditor.prototype.GetToolbarHeight=function(){if(this.ToolbarContainer.offsetHeight>0){return this.ToolbarContainer.offsetHeight}var a=this.ToolbarContainer.cloneNode(true);if(this.HasToolbar){a.style.display="block";a.style.visibility="visibile"}document.body.appendChild(a);var b=a.offsetHeight;a.parentNode.removeChild(a);a=null;return b};IDEditor.prototype.GetToolbarLimit=function(){var a=this.ToolChange.offsetLeft+this.ToolChange.offsetWidth+2+6;var c=this.ToolChange.offsetTop;if(a<=8||c<=0){var b=this.ToolbarContainer.cloneNode(true);document.body.appendChild(b);var f=0;for(f=0;f<this.ToolbarContainer.childNodes.length;f++){if(this.ToolbarContainer.childNodes.item(f)==this.ToolChange){break}}if(this.ToolbarContainer.childNodes.length>0){var e=b.childNodes.item(f);a=e.offsetLeft+e.offsetWidth+2;c=e.offsetTop;if(RD3_Glb.IsIE(10,false)){a++;c++}}b.parentNode.removeChild(b);b=null}var d=new Object();d.x=a;d.y=c;return d};IDEditor.prototype.OnServerEditorCommand=function(d,c,i){if(i){this.RestoreSelection()}switch(d){case"INS":if(RD3_Glb.IsIE()){var b=null;var j=this.GetEditorDocument();if(j&&j.getSelection){b=j.getSelection()}else{if(j&&j.selection){b=j.selection}}if(b){if(b.anchorNode==undefined&&j.selection){var a=b.createRange();a.pasteHTML(tkl)}else{var a=b.getRangeAt(0);a.deleteContents();var k=j.createElement("SPAN");k.innerHTML=c;a.insertNode(k)}}}else{var j=this.GetEditorDocument();j.execCommand("insertHTML",false,c)}this.IsDirty=true;return;break;case"SUR":var b=null;var j=this.GetEditorDocument();if(j&&j.getSelection){b=j.getSelection()}else{if(j&&j.selection){b=j.selection}}if(b){if(b.anchorNode==undefined&&j.selection){var a=b.createRange();var f=a.htmlText;a.pasteHTML(tkl.replace("|",f))}else{var a=b.getRangeAt(0);var k=j.createElement("SPAN");k.innerHTML=c.replace("|","<SPAN id='replace_node' ></SPAN>");var g=k.getElementsByTagName("SPAN");var e=null;for(var m=0;m<g.length;m++){e=(g.item(m).getAttribute("id")=="replace_node"?g.item(m):null)}if(e&&e.parentNode){var l=a.extractContents();e.parentNode.insertBefore(l,e);e.parentNode.removeChild(e)}var h=k.childNodes.length;var m=0;while(k.childNodes.length>0&&m<h){a.insertNode(k.childNodes.item(0));m++}}this.IsDirty=true}break;case"BKG":this.BackCol=c;break;case"FCG":this.ForeCol=c;break}this.onToolCommand(null,d);var b=null;var j=this.GetEditorDocument();if(j&&j.getSelection){b=j.getSelection()}else{if(j&&j.selection){b=j.selection}}if(b){var a=null;if(b.anchorNode==undefined&&j.selection){a=b.createRange()}else{a=b.getRangeAt(0)}this.UpdateToolbar(a)}};IDEditor.prototype.GetEditorDocument=function(){if(RD3_Glb.IsMobile()){return document}var b=null;try{if(this.EditorObj.contentDocument){b=this.EditorObj.contentDocument}else{if(this.EditorObj.contentWindow&&this.EditorObj.contentWindow.document){b=this.EditorObj.contentWindow.document}}}catch(a){}return b};IDEditor.prototype.SetToolbarCommandStatus=function(c,a,b){if(this.ToolStatus[c]==a&&!b){return}var d=null;switch(c){case RD3_Glb.IDE_BOLD:d=this.ToolBold;break;case RD3_Glb.IDE_ITALIC:d=this.ToolItalic;break;case RD3_Glb.IDE_UNDERLINE:d=this.ToolUnder;break;case RD3_Glb.IDE_STRIKE:d=this.ToolStrike;break;case RD3_Glb.IDE_UL:d=this.ToolUnOrdList;break;case RD3_Glb.IDE_OL:d=this.ToolOrdList;break;case RD3_Glb.IDE_LEFT:d=this.ToolLeft;break;case RD3_Glb.IDE_CENTER:d=this.ToolCenter;break;case RD3_Glb.IDE_JUSTIFY:d=this.ToolJust;break;case RD3_Glb.IDE_RIGHT:d=this.ToolRight;break;case RD3_Glb.IDE_CHANGE:d=this.ToolChange;break}if(!d){return}d.style.backgroundColor=(a?this.PressColor:"");this.ToolStatus[c]=a};IDEditor.prototype.SetClassName=function(b){var a=this.ClassName;if(b){this.ClassName=b}if(this.Realized&&(a!=this.ClassName||!b)){if(a!=""){RD3_Glb.RemoveClass2(this.EditorObj,a);RD3_Glb.RemoveClass2(this.TextObj,a)}if(this.ClassName&&this.ClassName!=""){RD3_Glb.AddClass(this.EditorObj,this.ClassName);RD3_Glb.AddClass(this.TextObj,this.ClassName)}}};function IDPanel(a){WebFrame.call(this,a);this.PanelMode=0;this.Status=0;this.DOMaster=false;this.DOModified=false;this.DOSingleDoc=false;this.DOCanSave=true;this.IsDO=false;this.HasDocTemplate=false;this.NumRows=0;this.MaxHRow=0;this.PanelPage=0;this.HeaderSize=0;this.ShowRowSelector=true;this.ShowMultipleSel=false;this.EnableMultipleSel=true;this.SelAllOnlyVis=false;this.DynamicRows=0;this.DynamicHeight=true;this.HasScrollbar=true;this.HasList=true;this.HasForm=true;this.CanUpdate=true;this.CanDelete=true;this.CanInsert=true;this.CanSearch=true;this.CanSort=true;this.ListLeft=0;this.ListTop=0;this.ListWidth=0;this.ListHeight=0;this.ActualRow=0;this.ListPos=1;this.VResMode=3;this.HResMode=3;this.VisStyle=0;this.FixedColumns=0;this.QBETip="";this.EnabledCommands=-1;this.ExtEnabledCommands=-1;this.HasBook=false;this.AdvTabOrder=false;this.ActivateRightClick=false;this.InfoMessages=false;this.ConfirmDelete=true;this.HighlightDelete=true;this.BlockingCommands=0;this.CanReorderColumn=false;this.CanResizeColumn=false;this.GroupingEnabled=false;this.ShowGroups=false;this.TooltipOnEachRow=false;this.EnableInsertWhenLocked=false;this.ResOnlyVisFlds=false;this.TableName="";this.AutomaticLayout=false;this.VisualFlags=0;this.LoadingPolicy=1;this.PullToRefresh=true;this.ActualPosition=1;this.TotalRows=0;this.MoreRows=false;this.ListTabOrder=null;this.FormTabOrder=null;this.ListGroupRoot=null;this.RefreshToolbar=false;this.ResetPosition=false;this.ScrollToPos=false;this.DenyScroll=false;this.QbeScroll=false;this.UpdateListGroups=false;this.LastResizedField=0;this.LastListResizeW=0;this.LastListResizeH=0;this.LastFormResizeW=0;this.LastFormResizeH=0;this.CompactActualPosition=0;this.Pages=new Array();this.Groups=new Array();this.Fields=new Array();this.MultiSelStatus=null;this.MsgBox=null;this.RowSelectEventDef=RD3_Glb.EVENT_ACTIVE;this.ScrollEventDef=RD3_Glb.EVENT_ACTIVE;this.ToolbarEventDef=RD3_Glb.EVENT_ACTIVE;this.PageClickEventDef=RD3_Glb.EVENT_ACTIVE;this.MultiSelEventDef=RD3_Glb.EVENT_SERVERSIDE|RD3_Glb.EVENT_CLIENTSIDE;this.FocusEventDef=RD3_Glb.EVENT_CLIENTSIDE;this.TextSelEventDef=RD3_Glb.EVENT_DEFERRED;this.ListBox=null;this.FormBox=null;this.ListListBox=null;this.ScrollAreaBox=null;this.PagesBox=null;this.PagesFiller=null;this.ScrollBox=null;this.ScrollClone=null;this.ScrollBoxInt=null;this.ScrollBoxTouch=null;this.ScrollIntTouch=null;this.RowSel=null;this.UpdateRSel=false;this.StatusBar=null;this.QBETIcon=null;this.TopButton=null;this.PrevButton=null;this.NextButton=null;this.BottomButton=null;this.SearchButton=null;this.FindButton=null;this.CancelButton=null;this.FormListButton=null;this.RefreshButton=null;this.DelButton=null;this.NewButton=null;this.DuplButton=null;this.SaveButton=null;this.PrintButton=null;this.CsvButton=null;this.AttachButton=null;this.GroupButton=null;this.CustomButtons=null;this.TBZones=null;this.MultiSelectAllCmd=null;this.MultiSelectNoneCmd=null;this.ToggleMultiSelCmd=null;this.LastPositionTime=null;this.OldAttR=0;this.QBETipBox=null;this.Realizing=false;this.AnimatingPanel=false;this.ListListZIndex=-1;this.ScrollTimer=0;this.SkipScroll=-1}IDPanel.prototype=new WebFrame();IDPanel.prototype.LoadFromXml=function(d){WebFrame.prototype.LoadFromXml.call(this,d);var g=d.childNodes;var c=g.length;for(var f=0;f<c;f++){var e=g.item(f);var a=e.nodeName;switch(a){case"fld":var b=new PField(this);this.Fields.push(b);b.LoadFromXml(e);break;case"grp":var h=new PGroup(this);h.LoadFromXml(e);this.Groups.push(h);break;case"ppg":var j=new PPage(this);j.LoadFromXml(e);this.Pages.push(j);break;case"lsg":if(this.ListGroupRoot){this.ResetGroups();this.UpdateListGroups=true}var h=new PListGroup(this);h.LoadFromXml(e);this.ListGroupRoot=h;this.CompactActualPosition=this.ListGroupRoot.GetRowPos(this.ActualPosition);if(this.GetTotalRows()===0){this.CompactActualPosition=1}break}}};IDPanel.prototype.LoadProperties=function(e){WebFrame.prototype.LoadProperties.call(this,e);var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"mod":this.SetPanelMode(parseInt(f.nodeValue));break;case"sta":this.SetPanelStatus(parseInt(f.nodeValue));break;case"num":this.SetNumRows(parseInt(f.nodeValue));break;case"mhr":this.SetMaxHRow(parseInt(f.nodeValue));break;case"pag":this.SetPanelPage(parseInt(f.nodeValue));break;case"hds":this.SetHeaderSize(parseInt(f.nodeValue));break;case"srs":this.SetShowRowSelector(f.nodeValue=="1");break;case"sms":this.SetShowMultipleSel(f.nodeValue=="1");break;case"ems":this.SetEnableMultipleSel(f.nodeValue=="1");break;case"sov":this.SetSelAllOnlyVis(f.nodeValue=="1");break;case"dyr":this.SetDynamicRows(parseInt(f.nodeValue));break;case"dyh":this.SetDynamicHeight(f.nodeValue=="1");break;case"hsc":this.SetHasScrollbar(f.nodeValue=="1");break;case"hli":this.SetHasList(f.nodeValue=="1");break;case"hfo":this.SetHasForm(f.nodeValue=="1");break;case"upd":this.SetCanUpdate(f.nodeValue=="1");break;case"del":this.SetCanDelete(f.nodeValue=="1");break;case"ins":this.SetCanInsert(f.nodeValue=="1");break;case"sea":this.SetCanSearch(f.nodeValue=="1");break;case"sor":this.SetCanSort(f.nodeValue=="1");break;case"lle":this.SetListLeft(parseInt(f.nodeValue));break;case"lto":this.SetListTop(parseInt(f.nodeValue));break;case"lwi":this.SetListWidth(parseInt(f.nodeValue));break;case"lhe":this.SetListHeight(parseInt(f.nodeValue));break;case"atr":this.SetActualRow(parseInt(f.nodeValue),e.attributes.ftr!=undefined,true);break;case"vre":this.SetVResMode(parseInt(f.nodeValue));break;case"hre":this.SetHResMode(parseInt(f.nodeValue));break;case"sty":this.SetVisualStyle(parseInt(f.nodeValue));break;case"fix":this.SetFixedColumns(parseInt(f.nodeValue));break;case"qtp":this.SetQbeTip(f.nodeValue);break;case"acp":this.SetActualPosition(parseInt(f.nodeValue),true,true);break;case"tot":this.SetTotalRows(parseInt(f.nodeValue));break;case"enc":this.SetEnabledCommands(parseInt(f.nodeValue));break;case"eec":this.SetExtEnabledCommands(parseInt(f.nodeValue));break;case"bok":this.SetHasBook(f.nodeValue=="1");break;case"dom":this.SetDOModified(f.nodeValue=="1");break;case"mst":this.SetDOMaster(f.nodeValue=="1");break;case"csa":this.SetDOCanSave(f.nodeValue=="1");break;case"sdo":this.SetSingleDoc(f.nodeValue=="1");break;case"mor":this.SetMoreRows(f.nodeValue=="1");break;case"ata":this.SetAdvancedTabOrder(f.nodeValue=="1");break;case"arc":this.SetActivateRightClick(f.nodeValue=="1");break;case"inf":this.SetInfoMessages(f.nodeValue=="1");break;case"cde":this.SetConfirmDelete(f.nodeValue=="1");break;case"hde":this.SetHighlightDelete(f.nodeValue=="1");break;case"cbk":this.SetBlockingCommands(parseInt(f.nodeValue));break;case"rcl":this.SetCanReorderColum(f.nodeValue=="1");break;case"rsc":this.SetCanResizeColum(f.nodeValue=="1");break;case"grn":this.SetGroupingEnabled(f.nodeValue=="1");break;case"sgr":this.SetShowGroups(f.nodeValue=="1");break;case"tor":this.SetTooltipOnEachRow(f.nodeValue=="1");break;case"eil":this.SetEnableInsertWhenLocked(f.nodeValue=="1");break;case"rvf":this.SetResOnlyVisFlds(f.nodeValue=="1");break;case"vfl":this.SetVisualFlags(parseInt(a));break;case"dsn":this.SetTableName(a);break;case"qbf":this.SetAutomaticLayout(f.nodeValue=="1");break;case"ido":this.SetIsDO(f.nodeValue=="1");break;case"hdt":this.SetHasDocTemplate(f.nodeValue=="1");break;case"lpl":this.SetLoadingPolicy(parseInt(a));break;case"pre":this.SetPullToRefresh(f.nodeValue=="1");break;case"rck":this.RowSelectEventDef=parseInt(f.nodeValue);break;case"pck":this.PageClickEventDef=parseInt(f.nodeValue);break;case"tck":this.ToolbarEventDef=parseInt(f.nodeValue);break;case"sck":this.ScrollEventDef=parseInt(f.nodeValue);break;case"mse":this.MultiSelEventDef=parseInt(f.nodeValue);break;case"fed":this.FocusEventDef=parseInt(f.nodeValue);break;case"tsk":this.TextSelEventDef=parseInt(a);break;case"cla":this.ChangeLayoutAnimDef=a;break;case"qta":this.QBETipAnimDef=a;break}}};IDPanel.prototype.ChangeProperties=function(d){var a=d.childNodes;var h=a.length;for(var c=0;c<h;c++){var e=a.item(c);if(e.nodeName=="fvl"){this.ResetPosition=true;this.ScrollToPos=true;var g=e.getAttribute("id");var b=RD3_DesktopManager.ObjectMap[g];if(b){b.LoadFromXml(e)}}if(e.nodeName=="lsg"){if(this.ListGroupRoot){this.ResetGroups()}var f=new PListGroup(this);f.LoadFromXml(e);this.ListGroupRoot=f;this.UpdateListGroups=true;this.CompactActualPosition=this.ListGroupRoot.GetRowPos(this.ActualPosition)}}this.LoadProperties(d)};IDPanel.prototype.SetPanelMode=function(q,e){var g=this.PanelMode;if(this.PanelMode==RD3_Glb.PANEL_LIST&&q==RD3_Glb.PANEL_FORM){this.ListPos=this.ActualPosition}if(q!=undefined){this.PanelMode=q}if(this.Realized&&(g!=this.PanelMode||q==undefined)){if(this.IDScroll&&RD3_Glb.IsSmartPhone()&&this.CanSearch){this.IDScroll.MarginTop=(this.PanelMode==RD3_Glb.PANEL_LIST)?44:0}if(!this.Realizing){this.DenyScroll=true;var h=this.Groups.length;for(var m=0;m<h;m++){this.Groups[m].SetCollapsed()}if(RD3_KBManager.ActiveElement){var l=RD3_KBManager.GetObject(RD3_KBManager.ActiveElement,true);if(l&&l instanceof PValue&&l.ParentField.ParentPanel==this){var b=RD3_KBManager.ActiveElement;while(!b.id&&b.parentNode){b=b.parentNode}var c=b.id.indexOf(":lv")>=0;if((this.PanelMode==RD3_Glb.PANEL_LIST&&!c)||(this.PanelMode!=RD3_Glb.PANEL_LIST&&c)){RD3_KBManager.ActiveElement=null}}}}if(g!=this.PanelMode&&this.PanelMode==RD3_Glb.PANEL_LIST&&this.LastListResizeW>0){if(this.LastListResizeW!=this.Width||this.LastListResizeH!=this.Height){this.SendResize=true;this.DeltaW=this.Width-this.LastListResizeW;this.DeltaH=this.Height-this.LastListResizeH}}if(g!=this.PanelMode&&this.PanelMode==RD3_Glb.PANEL_FORM&&this.LastFormResizeW>0){if(this.LastFormResizeW!=this.Width||this.LastFormResizeH!=this.Height){this.SendResize=true;this.DeltaW=this.Width-this.LastFormResizeW;this.DeltaH=this.Height-this.LastFormResizeH}}if(this.IsGrouped()&&(this.PanelMode==RD3_Glb.PANEL_LIST||this.PanelMode==-1)){this.UpdateListGroups=true}if(q==RD3_Glb.PANEL_LIST&&this.NumRows==1&&!this.SendResize&&!this.DynamicRows){var o=this.ListHeight-(this.HeaderSize>0?this.HeaderSize+this.VisStyle.GetHeaderOffset():0);var d=Math.floor((o+this.VisStyle.GetRowOffset())/this.GetRowHeight());this.SetNumRows(d);this.SetActualPosition();this.ResetPosition=false}if(this.PanelMode==RD3_Glb.PANEL_LIST&&!this.Realizing&&!RD3_Glb.IsMobile()){this.ListBox.style.visibility="hidden"}if(!this.Realizing){var d=this.Fields.length;for(var m=0;m<d;m++){var p=this.Fields[m];p.UpdateFieldVisibility();if(p.MultiUpload){if(this.PanelMode==RD3_Glb.PANEL_LIST&&p.ListCaptionBox&&p.FormCaptionBox){p.ListCaptionBox.appendChild(p.FormCaptionBox.firstChild)}else{if(this.PanelMode==RD3_Glb.PANEL_FORM&&p.FormCaptionBox&&p.ListCaptionBox){p.FormCaptionBox.appendChild(p.ListCaptionBox.firstChild)}}}}}if(this.PanelMode==RD3_Glb.PANEL_LIST&&!this.Realizing&&!RD3_Glb.IsMobile()){this.ListBox.style.visibility=""}if(g!=this.PanelMode&&this.PanelMode==RD3_Glb.PANEL_LIST){this.AdaptFieldsSortImage=true}var r=(q==undefined)||(g==this.PanelMode)||(this.WebForm.Animating&&!RD3_Glb.IsMobile())||!this.HasList||!this.HasForm;if(RD3_Glb.IsMobile()){if(r){if(this.ListBox){this.ListBox.style.visibility=(this.PanelMode==RD3_Glb.PANEL_LIST)?"":"hidden"}if(this.FormBox){this.FormBox.style.visibility=(this.PanelMode==RD3_Glb.PANEL_LIST)?"hidden":""}if(this.PagesBox){this.PagesBox.style.visibility=(this.PanelMode==RD3_Glb.PANEL_LIST)?"hidden":""}}else{this.ListBox.style.visibility="";this.FormBox.style.visibility="";if(this.PagesBox){this.PagesBox.style.visibility=""}if(this.ScrollBoxMobile){this.ScrollBoxMobile.style.display="none"}if(this.CanSearch&&this.PanelMode==RD3_Glb.PANEL_LIST&&this.Locked){this.SearchBox.style.display="";if(this.SearchMargin){this.SearchMargin.style.display=""}}var k=this.Status==RD3_Glb.PS_DATA&&(RD3_ServerParams.AllowMasterPanelNavigation||!this.DOMaster||!this.DOModified);var a=this.IsCommandEnabled(RD3_Glb.PCM_FORMLIST)&&(this.Status!=RD3_Glb.PS_QBE||!this.AutomaticLayout)&&(this.Status==RD3_Glb.PS_QBE||k)&&this.HasList&&this.HasForm;a&=this.PanelMode==RD3_Glb.PANEL_FORM&&this.Locked;if(a){this.FormListButtonCnt.style.display=""}this.AnimatingToolbar=!RD3_Glb.IsQuadro();this.AnimatingPanel=true;this.AdaptLayout();if(RD3_Glb.IsQuadro()){this.UpdateToolbar()}this.OnFormListAni()}}else{var j=new GFX("list",(this.PanelMode>g),this,r,null,this.ChangeLayoutAnimDef);j.Immediate=e;RD3_GFXManager.AddEffect(j)}}};IDPanel.prototype.SetPanelStatus=function(b){var a=this.Status;if(b!=undefined){this.Status=b}if(this.Realized&&(b==undefined||a!=this.Status)){this.SetStatusBarText();if(!this.Realizing){this.SetCanSort()}this.RefreshToolbar=true;this.ResetPosition=true;if((a==RD3_Glb.PS_QBE)&&this.Status==RD3_Glb.PS_DATA&&this.ScrollBox){this.QbeScroll=true}this.ScrollToPos=false;if(a!=this.Status){this.UpdateNotNullFields()}}};IDPanel.prototype.SetDOMaster=function(a){if(a!=undefined){this.DOMaster=a}if(this.Realized){this.SetStatusBarText();this.RefreshToolbar=true}};IDPanel.prototype.SetDOCanSave=function(a){if(a!=undefined){this.DOCanSave=a}if(this.Realized){this.RefreshToolbar=true}};IDPanel.prototype.SetDOModified=function(a){if(a!=undefined){this.DOModified=a}if(this.Realized){this.SetStatusBarText();this.RefreshToolbar=true}};IDPanel.prototype.SetSingleDoc=function(a){if(a!=undefined){this.DOSingleDoc=a}if(this.Realized){this.SetStatusBarText();this.RefreshToolbar=true}};IDPanel.prototype.SetNumRows=function(c){var a=this.NumRows;if(c==1&&this.PanelMode==RD3_Glb.PANEL_FORM){return}if(c!=undefined){this.NumRows=c}if(this.NumRows<1){this.NumRows=1}if(this.Realized&&(this.NumRows!=a||c==undefined)){var d=this.Fields.length;for(var b=0;b<d;b++){this.Fields[b].SetNumRows(this.NumRows)}if(!this.Realizing){this.SetShowRowSelector()}this.RecalcLayout=true;this.ResetPosition=true}};IDPanel.prototype.SetMaxHRow=function(a){if(a!=undefined){this.MaxHRow=a}if(this.Realized){this.RecalcLayout=true}};IDPanel.prototype.SetPanelPage=function(d,b){var a=this.PanelPage;if(d!=undefined){this.PanelPage=d}if(this.Realized&&(d==undefined||a!=this.PanelPage)){var e=this.Pages.length;for(var c=0;c<e;c++){this.Pages[c].UpdateSelection()}var e=this.Groups.length;for(var c=0;c<e;c++){this.Groups[c].UpdateVisibility()}var e=this.Fields.length;for(var c=0;c<e;c++){this.Fields[c].UpdateFieldVisibility()}if(b){this.ResetPosition=true;this.AdaptLayout();if(this.ResetPosition){this.SetActualPosition()}}else{this.RecalcLayout=true;this.ResetPosition=true}}};IDPanel.prototype.SetHeaderSize=function(a){if(a!=undefined){this.HeaderSize=a}if(this.Realized){this.RecalcLayout=true}};IDPanel.prototype.SetLoadingPolicy=function(b){if(b!=undefined){this.LoadingPolicy=b}if(this.Realized){if(this.LoadingPolicy==2&&this.MoreAreaBox){this.MoreAreaBox.parentNode.removeChild(this.MoreAreaBox);this.MoreAreaBox=null;this.MoreButton=null}if(this.LoadingPolicy<2&&RD3_Glb.IsMobile()&&!this.MoreAreaBox&&this.ListBox){this.MoreAreaBox=document.createElement("div");this.MoreAreaBox.className="panel-more-area";this.MoreButton=document.createElement("div");this.MoreButton.className="panel-more-button";this.MoreButton.textContent=ClientMessages.MOB_MORE_TEXT;var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMoreButton', ev)");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.MoreButton.ontouchend=a}else{this.MoreButton.onclick=a}this.MoreAreaBox.appendChild(this.MoreButton);this.ListBox.appendChild(this.MoreAreaBox);this.ListBox.style.overflow="visible"}this.RecalcLayout=true}};IDPanel.prototype.SetPullToRefresh=function(a){if(a!=undefined){this.PullToRefresh=a}if(this.Realized){var b=this.PullToRefresh&&this.Status!=RD3_Glb.PS_QBE&&(!this.IsDO||this.HasDocTemplate);if(!b&&this.PullAreaBox){this.PullAreaBox.parentNode.removeChild(this.PullAreaBox);this.PullAreaBox=null;this.PullArrow=null;this.PullText=null;if(this.IDScroll){this.IDScroll.PullTrigger=0}}if(b&&!this.PullAreaBox&&this.ListBox&&RD3_Glb.IsMobile()){this.PullAreaBox=document.createElement("div");this.PullAreaBox.className="panel-pull-area"+(this.SearchAreaBox?" panel-pull-search":"");this.PullArrow=document.createElement("span");this.PullArrow.className="pull-arrow";this.PullAreaBox.appendChild(this.PullArrow);this.PullText=document.createElement("span");this.PullText.className="pull-text";this.PullText.textContent=ClientMessages.MOB_PULL_TEXT;this.PullAreaBox.appendChild(this.PullText);this.ListBox.appendChild(this.PullAreaBox);this.ListBox.style.overflow="visible";this.RecalcLayout=true}}};IDPanel.prototype.SetShowRowSelector=function(f){var b=this.ShowRowSelector;if(f!=undefined){this.ShowRowSelector=f}if(this.Realized){if(!this.ShowRowSelector&&this.RowSel){var g=this.RowSel.length;for(var e=0;e<g;e++){this.RowSel[e].parentNode.removeChild(this.RowSel[e])}this.RowSel=null;this.RecalcLayout=true}if(this.ShowRowSelector&&this.ListBox){if(!this.RowSel){this.RowSel=new Array()}if(this.RowSel.length!=this.NumRows){var g=this.RowSel.length;for(var e=this.NumRows;e<g;e++){this.RowSel[e].parentNode.removeChild(this.RowSel[e])}this.RowSel.length=this.NumRows;var a=RD3_Glb.GetImgSrc("images/rs.gif");for(var e=0;e<this.NumRows;e++){if(!this.RowSel[e]){var c=null;if(this.ShowMultipleSel){c=document.createElement("input");c.type="checkbox";c.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelClick', ev)")}else{c=document.createElement("img");c.src=a;c.removeAttribute("width");c.removeAttribute("height");c.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnRowSelectorClick', ev)")}c.setAttribute("id",this.Identifier+":rs"+e);c.className="panel-row-selector";c.style.zIndex=this.ListListZIndex;if(RD3_ServerParams.CompletePanelBorders){var d=document.createElement("div");d.className="panel-field-value-list";d.style.zIndex=this.ListListZIndex;if(this.VisStyle){this.VisStyle.ApplyBorderStyle(d,1)}d.appendChild(c);this.ListBox.appendChild(d);c.style.position="static";c.style.padding="0px";if(this.ShowMultipleSel&&!RD3_Glb.IsIE(10,false)){c.style.margin=(RD3_ServerParams.Theme=="zen"?"7px 8px":"1px")}if(RD3_Glb.IsIE(10,false)){c.style.position="relative";c.style.left="-1px";c.style.top="-1px"}c=d}else{this.ListBox.appendChild(c)}this.RowSel[e]=c}}this.UpdateMultipleSel();this.RecalcLayout=true;if(!this.ShowMultipleSel&&b!=this.ShowRowSelector){this.ResetPosition=true}}}}};IDPanel.prototype.SetAdvancedTabOrder=function(a){if(a!=undefined){this.AdvTabOrder=a}};IDPanel.prototype.SetActivateRightClick=function(a){if(a!=undefined){this.ActivateRightClick=a}};IDPanel.prototype.SetInfoMessages=function(a){if(a!=undefined){this.InfoMessage=a}if(this.Realized&&a!=undefined){this.WebForm.RealizeMessages()}};IDPanel.prototype.SetConfirmDelete=function(a){if(a!=undefined){this.ConfirmDelete=a}};IDPanel.prototype.SetHighlightDelete=function(a){if(a!=undefined){this.HighlightDelete=a}};IDPanel.prototype.SetBlockingCommands=function(a){if(a!=undefined){this.BlockingCommands=a}};IDPanel.prototype.SetCanReorderColum=function(a){if(a!=undefined){this.CanReorderColumn=a}};IDPanel.prototype.SetCanResizeColum=function(a){if(a!=undefined){this.CanResizeColumn=a}};IDPanel.prototype.SetGroupingEnabled=function(a){if(a!=undefined){this.GroupingEnabled=a}if(this.Realized){this.RefreshToolbar=true}};IDPanel.prototype.SetShowGroups=function(a){if(a!=undefined){this.ShowGroups=a}if(this.Realized&&this.IsGrouped()){this.CompactActualPosition=this.ListGroupRoot.GetRowPos(this.ActualPosition);this.RefreshToolbar=true}};IDPanel.prototype.SetShowMultipleSel=function(b){var a=this.ShowMultipleSel;if(b!=undefined){this.ShowMultipleSel=b}if(this.Realized&&this.EnableMultipleSel&&(a!=this.ShowMultipleSel||b==undefined)){if(this.MultiSelectAllCmd||(RD3_ServerParams.CompletePanelBorders&&this.ToggleMultiSelCmd)){if(this.MultiSelectAllCmd){if(!RD3_Glb.IsMobile()){this.ToggleMultiSelCmd.src=RD3_Glb.GetImgSrc(this.ShowMultipleSel?"images/pansel.gif":"images/pansel1.gif")}this.MultiSelectAllCmd.style.display=(this.ShowMultipleSel&&this.HeaderSize>=32)?"":"none";this.MultiSelectNoneCmd.style.display=(this.ShowMultipleSel&&this.HeaderSize>=32)?"":"none";RD3_TooltipManager.SetObjTitle(this.ToggleMultiSelCmd,((this.ShowMultipleSel)?RD3_ServerParams.TooltipShowRowSel:RD3_ServerParams.TooltipShowCheck)+RD3_KBManager.GetFKTip(RD3_ClientParams.FKSelTog))}else{if(RD3_ServerParams.CompletePanelBorders&&this.ToggleMultiSelCmd){if(!RD3_Glb.IsMobile()){this.ToggleMultiSelCmd.src=RD3_Glb.GetImgSrc("images/pansel1.gif")}}}if(this.ShowRowSelector){this.SetShowRowSelector(false);this.SetShowRowSelector(true)}else{if(RD3_Glb.IsMobile()){this.UpdateMultipleSel();this.RefreshToolbar=true}}}}};IDPanel.prototype.SetEnableMultipleSel=function(a){if(a!=undefined){if(!a){this.SetShowMultipleSel(false)}this.EnableMultipleSel=a}if(this.Realized&&this.ListBox){if(RD3_ServerParams.CompletePanelBorders&&!this.ToggleMultiSelBox){this.ToggleMultiSelBox=document.createElement("div");this.ToggleMultiSelBox.className="panel-field-caption-list";this.ToggleMultiSelBox.style.zIndex=this.ListListZIndex;this.ListBox.appendChild(this.ToggleMultiSelBox);if(this.VisStyle){this.VisStyle.ApplyValueStyle(this.ToggleMultiSelBox,true,true,false,false,false,false,false,"left",false,false)}if(RD3_ServerParams.Theme=="zen"){this.ToggleMultiSelBox.style.setProperty("border-right","none","important");if(RD3_Glb.IsIE()){this.ToggleMultiSelBox.style.borderBottomWidth="0px"}}}if(!this.EnableMultipleSel){if(this.MultiSelectAllCmd){this.MultiSelectAllCmd.parentNode.removeChild(this.MultiSelectAllCmd)}if(this.MultiSelectNoneCmd){this.MultiSelectNoneCmd.parentNode.removeChild(this.MultiSelectNoneCmd)}if(this.ToggleMultiSelCmd){this.ToggleMultiSelCmd.parentNode.removeChild(this.ToggleMultiSelCmd)}this.MultiSelStatus=null;this.MultiSelectAllCmd=null;this.MultiSelectNoneCmd=null;this.ToggleMultiSelCmd=null;if(this.ToggleMultiSelBox){this.ToggleMultiSelBox.onclick="";this.ToggleMultiSelBox.style.cursor=""}}else{if(!this.ToggleMultiSelCmd){this.ToggleMultiSelCmd=document.createElement("img");this.ToggleMultiSelCmd.setAttribute("id",this.Identifier+":ms0");this.ToggleMultiSelCmd.className="panel-multisel-command";if(!RD3_Glb.IsMobile()){this.ToggleMultiSelCmd.src=RD3_Glb.GetImgSrc("images/pansel.gif")}if(RD3_ServerParams.CompletePanelBorders){this.ToggleMultiSelCmd.onclick=new Function("ev","RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelCmd', ev, 'selms');  RD3_Glb.StopEvent(ev);")}else{this.ToggleMultiSelCmd.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelCmd', ev, 'seltog')")}this.ToggleMultiSelCmd.style.zIndex=this.ListListZIndex;if(RD3_ServerParams.CompletePanelBorders){this.ToggleMultiSelBox.appendChild(this.ToggleMultiSelCmd);this.ToggleMultiSelBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelCmd', ev, 'selms')");this.ToggleMultiSelBox.style.cursor="pointer"}else{this.ListBox.appendChild(this.ToggleMultiSelCmd)}if(!RD3_ServerParams.CompletePanelBorders){this.MultiSelectAllCmd=document.createElement("img");this.MultiSelectAllCmd.setAttribute("id",this.Identifier+":ms1");this.MultiSelectAllCmd.className="panel-multisel-command";if(!RD3_Glb.IsMobile()){this.MultiSelectAllCmd.src=RD3_Glb.GetImgSrc("images/pansel1.gif")}RD3_TooltipManager.SetObjTitle(this.MultiSelectAllCmd,RD3_ServerParams.TooltipSelectAll+RD3_KBManager.GetFKTip(RD3_ClientParams.FKSelAll));this.MultiSelectAllCmd.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelCmd', ev, 'selall')");this.MultiSelectAllCmd.style.zIndex=this.ListListZIndex;this.ListBox.appendChild(this.MultiSelectAllCmd);this.MultiSelectNoneCmd=document.createElement("img");this.MultiSelectNoneCmd.setAttribute("id",this.Identifier+":ms0");this.MultiSelectNoneCmd.className="panel-multisel-command";if(!RD3_Glb.IsMobile()){this.MultiSelectNoneCmd.src=RD3_Glb.GetImgSrc("images/pansel0.gif")}RD3_TooltipManager.SetObjTitle(this.MultiSelectNoneCmd,RD3_ServerParams.TooltipDeseleziona+RD3_KBManager.GetFKTip(RD3_ClientParams.FKSelNone));this.MultiSelectNoneCmd.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelCmd', ev, 'selnone')");this.MultiSelectNoneCmd.style.zIndex=this.ListListZIndex;this.ListBox.appendChild(this.MultiSelectNoneCmd)}this.RecalcLayout=true}if(this.MultiSelStatus==null){this.MultiSelStatus=new Array()}this.SetShowMultipleSel()}}};IDPanel.prototype.SetSelAllOnlyVis=function(a){if(a!=undefined){this.SelAllOnlyVis=a}};IDPanel.prototype.SetDynamicRows=function(a){if(a!=undefined){this.DynamicRows=a}};IDPanel.prototype.SetDynamicHeight=function(a){if(a!=undefined){this.DynamicHeight=a}};IDPanel.prototype.SetHasScrollbar=function(b){if(b!=undefined){this.HasScrollbar=b}if(this.Realized){if(!this.HasScrollbar&&this.ScrollBox){this.ScrollBox.parentNode.removeChild(this.ScrollBox);this.ScrollBox=null;this.ScrollBoxInt=null;this.ScrollBoxTouch=null;this.ScrollIntTouch=null;this.ListListBox.onmousewheel=null;this.ScrollAreaBox.onmousewheel=null;if(this.ListListBox.addEventListener){this.ListListBox.removeEventListener("DOMMouseScroll",d,true);this.ScrollAreaBox.removeEventListener("DOMMouseScroll",d,true)}if(RD3_ServerParams.CompletePanelBorders&&this.ScrollBoxCap){this.ScrollBoxCap.parentNode.removeChild(this.ScrollBoxCap);this.ScrollBoxCap=null}}if(!this.HasScrollbar){if(this.ScrollBoxMobile){this.ScrollBoxMobile.parentNode.removeChild(this.ScrollBoxMobile);this.ScrollBoxMobile=null;if(RD3_Glb.IsSmartPhone()&&this.SearchAreaBox){this.SearchAreaBox.style.paddingRight=""}}if(this.ScrollBoxHint){this.ScrollBoxHint.parentNode.removeChild(this.ScrollBoxHint);this.ScrollBoxHint=null}}if(RD3_Glb.IsMobile()&&this.HasScrollbar){this.ScrollBoxMobile=document.createElement("div");this.ScrollBoxMobile.setAttribute("id",this.Identifier+":sb");this.ScrollBoxMobile.className="panel-scroll-container";var c=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollMobile', ev)");var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollMobileUp', ev)");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.ScrollBoxMobile.addEventListener("touchstart",c,true);this.ScrollBoxMobile.addEventListener("touchmove",c,true);this.ScrollBoxMobile.addEventListener("touchend",a,true);this.ScrollBoxMobile.addEventListener("touchcancel",a,true)}else{this.ScrollBoxMobile.addEventListener("mousemove",c,true);this.ScrollBoxMobile.addEventListener("mousedown",c,true);this.ScrollBoxMobile.addEventListener("mouseup",a,true);this.ScrollBoxMobile.addEventListener("mouseout",a,true)}this.ContentBox.appendChild(this.ScrollBoxMobile);this.ScrollBoxHint=document.createElement("div");this.ScrollBoxHint.id=this.Identifier+":sbh";this.ScrollBoxHint.className="panel-scroll-hint";this.ContentBox.appendChild(this.ScrollBoxHint);if(RD3_Glb.IsSmartPhone()&&this.SearchAreaBox){this.SearchAreaBox.style.paddingRight="38px"}}else{if(this.HasScrollbar&&!this.ScrollBox&&this.ListBox){this.ScrollBox=document.createElement("div");this.ScrollBox.setAttribute("id",this.Identifier+":sb");this.ScrollBox.className="panel-scroll-container";this.ScrollBoxInt=document.createElement("div");this.ScrollBoxInt.setAttribute("id",this.Identifier+":sc");this.ScrollBoxInt.className="panel-scroll-content";this.ScrollBox.appendChild(this.ScrollBoxInt);this.ScrollBox.style.zIndex=this.ListListZIndex;this.ListBox.appendChild(this.ScrollBox);if(RD3_ServerParams.CompletePanelBorders){this.ScrollBoxCap=document.createElement("div");this.ScrollBoxCap.setAttribute("id",this.Identifier+":sbc");this.ScrollBoxCap.className="panel-field-caption-list";this.ScrollBoxCap.style.zIndex=this.ListListZIndex;this.ListBox.appendChild(this.ScrollBoxCap);if(this.VisStyle){this.VisStyle.ApplyValueStyle(this.ScrollBoxCap,true,true,false,false,false,false,false,"left",false,false);this.VisStyle.ApplyBorderStyle(this.ScrollBox,1)}if(RD3_ServerParams.Theme=="zen"){this.ScrollBoxCap.style.setProperty("border-left","none","important")}}if(RD3_Glb.IsTouch()){this.ScrollBoxTouch=document.createElement("div");this.ScrollBoxTouch.setAttribute("id",this.Identifier+":sct");this.ScrollBoxTouch.className="panel-scroll-touch-container";this.ScrollIntTouch=document.createElement("div");this.ScrollIntTouch.setAttribute("id",this.Identifier+":sbt");this.ScrollIntTouch.className="panel-scroll-touch-box";this.ScrollBoxTouch.appendChild(this.ScrollIntTouch);this.ScrollBoxTouch.style.zIndex=this.ListListZIndex;this.ListBox.appendChild(this.ScrollBoxTouch)}this.ScrollBox.onscroll=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScroll', ev)");if(RD3_Glb.IsFirefox()){this.ScrollBox.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollMouseEnter', ev)")}var d=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseWheel', ev)");this.ListListBox.onmousewheel=d;this.ScrollAreaBox.onmousewheel=d;if(this.ListListBox.addEventListener){this.ListListBox.addEventListener("DOMMouseScroll",d,true);this.ScrollAreaBox.addEventListener("DOMMouseScroll",d,true)}}}}};IDPanel.prototype.SetHasList=function(a){if(a!=undefined){this.HasList=a}};IDPanel.prototype.SetHasForm=function(a){if(a!=undefined){this.HasForm=a}};IDPanel.prototype.SetCanUpdate=function(b){var a=this.CanUpdate;if(b!=undefined){this.CanUpdate=b}if(this.Realized){if(a!=this.CanUpdate){this.ResetPosition=true;this.RefreshToolbar=true}}};IDPanel.prototype.SetCanDelete=function(b){var a=this.CanDelete;if(b!=undefined){this.CanDelete=b}if(this.Realized){if(a!=this.CanDelete){this.RefreshToolbar=true}}};IDPanel.prototype.SetCanInsert=function(b){var a=this.CanInsert;if(b!=undefined){this.CanInsert=b}if(this.Realized){if(a!=this.CanInsert){this.RefreshToolbar=true}}};IDPanel.prototype.SetCanSearch=function(a){if(a!=undefined){this.CanSearch=a}if(this.Realized){this.RefreshToolbar=true}};IDPanel.prototype.SetCanSort=function(b){if(b!=undefined){this.CanSort=b}if(this.Realized){var c=this.Fields.length;for(var a=0;a<c;a++){this.Fields[a].SetCanSort(this.CanSort&&this.Status==RD3_Glb.PS_DATA)}}};IDPanel.prototype.SetListLeft=function(a){if(a!=undefined){this.ListLeft=a}if(this.Realized){if(this.HasList){this.ListListBox.style.left=this.ListLeft+"px";this.RecalcLayout=true}}};IDPanel.prototype.SetListTop=function(a){if(a!=undefined){this.ListTop=a}if(this.Realized){if(this.HasList){this.ListListBox.style.top=this.ListTop+"px";this.RecalcLayout=true}}};IDPanel.prototype.SetListWidth=function(a){if(a!=undefined){this.ListWidth=a}if(this.Realized){if(this.HasList){this.ListListBox.style.width=(this.ListWidth+4)+"px";this.RecalcLayout=true}}};IDPanel.prototype.SetListHeight=function(c){if(this.PanelMode==RD3_Glb.PANEL_FORM&&RD3_Glb.IsMobile()&&!RD3_Glb.IsIE()){return}var a=this.ListHeight;if(c!=undefined){this.ListHeight=c}if(this.Realized&&(c==undefined||this.ListHeight!=a)){if(this.HasList){var b=this.ListHeight;if(this.GetRowHeight()){var d=b-(this.HeaderSize>0?this.HeaderSize+this.VisStyle.GetHeaderOffset():0);b-=(d+this.VisStyle.GetRowOffset())%this.GetRowHeight()}if(b<1){b=1}this.ListListBox.style.height=(b-1)+"px";this.ListHeightRounded=b;this.RecalcLayout=true}}};IDPanel.prototype.SetActualRow=function(d,c,a){this.OldAttR=this.ActualRow;if(d!=undefined){if(a&&this.IsGrouped()&&RD3_Glb.IsMobile()){var e=this.ActualPosition+d;var b=this.GetRowForIndex(e);if(b!=-1){d=b}}this.ActualRow=d}if(this.Realized&&c&&this.HasList&&RD3_Glb.IsMobile()){this.HiliteRow(0)}if(this.Realized&&(this.ActualRow!=this.OldAttR||d==undefined)&&this.HasList){this.ResetPosition=true;this.RefreshToolbar=true;this.DenyScroll=true}};IDPanel.prototype.SetVResMode=function(a){if(a!=undefined){this.VResMode=a}};IDPanel.prototype.SetHResMode=function(a){if(a!=undefined){this.HResMode=a}};IDPanel.prototype.SetVisualStyle=function(g){var a=this.VisStyle;if(g!=undefined){if(g.Identifier){this.VisStyle=g}else{this.VisStyle=RD3_DesktopManager.ObjectMap["vis:"+g]}}if(this.Realized&&this.VisStyle){var h=this.VisStyle.GetGradDir(6);if(h!=1){var d=this.VisStyle.GetColor(6);var f=this.VisStyle.GetGradColor(6);if(this.ContentBox){var e=this.ContentBox.style;if(RD3_Glb.IsIE(10,false)){e.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType="+(h==2?1:0)+",StartColorStr="+d+",EndColorStr="+f+")";e.backgroundColor=d}else{if(RD3_Glb.IsWebKit()){e.backgroundColor="transparent";e.background="-webkit-gradient(linear, "+(h==2?"left center, right center":"center top, center bottom")+", from("+d+"), to("+f+"))"}else{if(RD3_Glb.IsFirefox()){e.background="-moz-linear-gradient("+(h==2?"left":"top")+", "+d+", "+f+")"}else{if(RD3_Glb.IsIE(10,true)){e.background="linear-gradient("+(h==2?"90deg":"180deg")+", "+d+", "+f+")";e.backgroundColor=d}}}}}}else{var b=this.VisStyle.GetColor(6);if(this.HasList){this.ListBox.style.backgroundColor=b}if(this.HasForm){this.FormBox.style.backgroundColor=b}if(this.ContentBox&&!(RD3_Glb.IsMobile()&&this.WebForm.DockType==RD3_Glb.FORMDOCK_LEFT&&b=="transparent")){this.ContentBox.style.backgroundColor=b}}if(this.ListListBox){this.VisStyle.ApplyBorderStyle(this.ListListBox,0)}if(this.ScrollBoxTouch){this.VisStyle.ApplyBorderStyle(this.ScrollBoxTouch,0)}if(this.ScrollBoxCap){this.VisStyle.ApplyValueStyle(this.ScrollBoxCap,true,true,false,false,false,false,false,"left",false,false)}if(this.ScrollBox&&RD3_ServerParams.CompletePanelBorders){this.VisStyle.ApplyBorderStyle(this.ScrollBox,1)}if(this.ToggleMultiSelBox){this.VisStyle.ApplyValueStyle(this.ToggleMultiSelBox,true,true,false,false,false,false,false,"left",false,false)}if(RD3_ServerParams.CompletePanelBorders&&this.ShowRowSelector&&this.ListBox){for(var c=0;c<this.NumRows;c++){this.VisStyle.ApplyBorderStyle(this.RowSel[c],1)}}if(a&&a.GetClassName&&a.GetClassName()){RD3_Glb.RemoveClass(this.FrameBox,a.GetClassName())}if(this.VisStyle.GetClassName&&this.VisStyle.GetClassName()){RD3_Glb.AddClass(this.FrameBox,this.VisStyle.GetClassName())}}};IDPanel.prototype.SetFixedColumns=function(b){var a=this.FixedColumns;if(b!=undefined){this.FixedColumns=b}if(this.Realized&&(a!=this.FixedColumns||b==undefined)){this.RecalcLayout=true}};IDPanel.prototype.SetQbeTip=function(a){if(a!=undefined){this.QBETip=a}if(this.Realized){this.QBETip=this.QBETip.replace(/QBEF1/g,"qbe-field");this.QBETip=this.QBETip.replace(/QBEF2/g,"qbe-value");this.QBETipBox.SetWidth(0);this.QBETipBox.SetHeight(0);this.QBETipBox.SetText(this.QBETip)}};IDPanel.prototype.SetActualPosition=function(m,h,l){var d=this.ActualPosition;if(m!=undefined){this.ActualPosition=m;if(this.IsGrouped()){this.CompactActualPosition=this.ListGroupRoot.GetRowPos(this.ActualPosition,true,true)}}if(this.Realized&&(d!=this.ActualPosition||m==undefined)){if(h){if(!this.ResetPosition){this.ResetPosition=true;this.ScrollToPos=l}}else{var a=0;var e=false;if(RD3_Glb.IsFirefox(3)&&this.PanelMode==RD3_Glb.PANEL_LIST){if(this.FixedColumns!=0){a=this.ScrollAreaBox.scrollLeft}if(RD3_KBManager.ActiveElement){var b=RD3_KBManager.ActiveElement;while(b!=null){if(b==this.ListBox){e=true;break}b=b.parentNode}}this.ContentBox.removeChild(this.ListBox)}if(this.UpdateListGroups){var c=this.Fields.length;for(var g=0;g<c;g++){var j=this.Fields[g];if(j.InList&&j.ListList){this.ListGroupRoot.AddGroups(j.PValues,0)}}this.UpdateListGroups=false;if(this.IsGrouped()&&(this.PanelMode==RD3_Glb.PANEL_LIST||this.PanelMode==-1)&&this.DynamicRows>0){var k=new IDEvent("resize",this.Identifier,null,RD3_Glb.EVENT_ACTIVE,"dynrows",this.GetTotalRows(),0)}}var c=this.Fields.length;for(var g=0;g<c;g++){this.Fields[g].SetActualPosition(this.ActualPosition,undefined,undefined,l)}if(l){this.UpdateRSel=true}this.UpdateMultipleSel();if(m==undefined){this.UpdateScrollPos()}this.ResetPosition=false;this.DenyScroll=false;if(RD3_Glb.IsFirefox(3)&&this.PanelMode==RD3_Glb.PANEL_LIST){this.ContentBox.appendChild(this.ListBox);if(e&&RD3_KBManager.ActiveElement){RD3_KBManager.ActiveElement.focus()}if(RD3_Glb.IsFirefox(3)){this.UpdateScrollPos()}else{this.QbeScroll=true}if(this.FixedColumns!=0){this.ScrollAreaBox.scrollLeft=a}}}if(this.HasForm){this.RefreshToolbar=true}if(RD3_Glb.IsMobile()){for(var g=0;g<this.Groups.length;g++){this.UpdateFieldClass(this.Groups[g])}}}};IDPanel.prototype.SetTotalRows=function(b){var a=this.TotalRows;if(b!=undefined){this.TotalRows=b}if(this.Realized){this.UpdateScrollBox();this.SetStatusBarText();this.RefreshToolbar=true;if(a!=this.TotalRows){this.ResetPosition=true;this.DenyScroll=true}}};IDPanel.prototype.SetMoreRows=function(a){if(a!=undefined){this.MoreRows=a}if(this.Realized){this.SetStatusBarText()}};IDPanel.prototype.SetEnabledCommands=function(a){if(a!=undefined){this.EnabledCommands=a}if(this.Realized){this.RefreshToolbar=true}};IDPanel.prototype.SetExtEnabledCommands=function(a){if(a!=undefined){this.ExtEnabledCommands=a}if(this.Realized){this.RefreshToolbar=true}};IDPanel.prototype.SetHasBook=function(a){if(a!=undefined){this.HasBook=a}};IDPanel.prototype.ResetCache=function(c,b){var d=this.Fields.length;for(var a=0;a<d;a++){this.Fields[a].ResetCache(b)}if(this.IsGrouped()){this.UpdateListGroups=true}};IDPanel.prototype.ResetGroups=function(){if(this.ListGroupRoot){this.ListGroupRoot.Unrealize()}this.ListGroupRoot=null;this.UpdateListGroups=false};IDPanel.prototype.MultipleSelection=function(b,a){if(this.MultiSelStatus==null){this.MultiSelStatus=new Array()}var d=parseInt(a.getAttribute("row"));var c=parseInt(a.getAttribute("value"));if(d==-1){this.ChangeSelection(c,true);this.MultiSelStatus.length=(this.Status!=RD3_Glb.PS_QBE?this.TotalRows+1:1)}else{this.MultiSelStatus[d]=(c==1)}if(this.Realized){this.UpdateMultipleSel()}};IDPanel.prototype.SetTooltipOnEachRow=function(a){if(a!=undefined){this.TooltipOnEachRow=a}};IDPanel.prototype.SetEnableInsertWhenLocked=function(a){if(a!=undefined){this.EnableInsertWhenLocked=a}if(this.Realized){this.RefreshToolbar=true}};IDPanel.prototype.SetResOnlyVisFlds=function(a){if(a!=undefined){this.ResOnlyVisFlds=a}};IDPanel.prototype.SetVisualFlags=function(a){this.VisualFlags=a;if(this.Realized){if(!this.VisHiliteRow()){this.HiliteRow(0)}}};IDPanel.prototype.VisHiliteRow=function(){return this.VisualFlags&8192};IDPanel.prototype.SetTableName=function(a){if(a!=undefined){this.TableName=a}};IDPanel.prototype.SetAutomaticLayout=function(a){if(a!=undefined){this.AutomaticLayout=a}};IDPanel.prototype.SetIsDO=function(a){if(a!=undefined){this.IsDO=a}};IDPanel.prototype.SetHasDocTemplate=function(a){if(a!=undefined){this.HasDocTemplate=a}if(this.Realized){this.RefreshToolbar=true}};IDPanel.prototype.Realize=function(c){if(!this.Realized){WebFrame.prototype.Realize.call(this,c)}this.Realizing=true;this.Realized=false;this.CompileFieldList();this.ea=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEndAnimation', ev)");if(RD3_Glb.IsMobile()){this.ContentBox.onscroll=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'NoScroll', ev)")}if(this.HasForm){this.FormBox=document.createElement("div");this.FormBox.setAttribute("id",this.Identifier+":fb");this.FormBox.className="panel-form-container";if(RD3_Glb.IsMobile()){this.FormBox.onscroll=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'NoScroll', ev)")}this.ContentBox.appendChild(this.FormBox)}if(this.HasList){this.ListBox=document.createElement("div");this.ListBox.setAttribute("id",this.Identifier+":lb");this.ListBox.className="panel-list-container";if(RD3_Glb.IsMobile()){this.ListBox.onscroll=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'NoScroll', ev)")}this.ContentBox.appendChild(this.ListBox);this.ListListBox=document.createElement("div");this.ListListBox.className="panel-list-list-container";if(!RD3_Glb.IsTouch()){this.ListListBox.onscroll=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollListList', ev)")}var e=this.Fields.length;for(var b=0;b<e;b++){var d=this.Fields[b];if(d.InList&&d.ListList){this.ListListZIndex=d.Index;break}}this.ListListBox.style.zIndex=this.ListListZIndex;this.ListBox.appendChild(this.ListListBox);if(RD3_Glb.IsSmartPhone()&&this.CanSearch){this.SearchAreaBox=document.createElement("div");this.SearchAreaBox.className="panel-search-area";this.ListBox.appendChild(this.SearchAreaBox);this.ListBox.style.overflow="visible";this.SearchBox.parentNode.removeChild(this.SearchBox);this.SearchAreaBox.appendChild(this.SearchBox);RD3_Glb.AddClass(this.SearchBox,"frame-search-phone")}else{if(RD3_Glb.IsQuadro()&&this.CanSearch){this.SearchMargin=document.createElement("div");this.SearchMargin.className="frame-search-margin";this.ToolbarBox.appendChild(this.SearchMargin)}}this.ScrollAreaBox=document.createElement("div");this.ScrollAreaBox.className="panel-scroll-area";this.ScrollAreaBox.style.zIndex=this.ListListZIndex;this.ListBox.appendChild(this.ScrollAreaBox)}if(RD3_Glb.IsMobile()){this.IDScroll=new IDScroll(this.Identifier,(this.PanelMode==RD3_Glb.PANEL_LIST?this.ListBox:this.FormBox),this.ContentBox,this)}var e=this.Pages.length;if(e>0){this.PagesBox=document.createElement("div");this.PagesBox.className="pages-container";this.PagesBox.id=this.Identifier+":pgb";if(RD3_Glb.IsTouch()&&!RD3_Glb.IsMobile()&&!RD3_Glb.IsIE(10,true)){this.PagesBox.addEventListener("touchstart",new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnPageTouchStart', ev)"),false);this.PagesBox.addEventListener("touchmove",new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnPageTouchMove', ev)"),false);this.PagesBox.addEventListener("touchend",new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnPageTouchEnd', ev)"),false)}if(RD3_Glb.IsMobile()){this.FrameBox.appendChild(this.PagesBox)}else{this.FrameBox.insertBefore(this.PagesBox,this.ContentBox)}for(var b=0;b<e;b++){this.Pages[b].Realize(this.PagesBox)}this.PagesFiller=document.createElement("span");this.PagesFiller.className="pages-filler";this.PagesBox.appendChild(this.PagesFiller)}e=this.Groups.length;for(var b=0;b<e;b++){this.Groups[b].Realize()}e=this.Fields.length;for(var b=0;b<e;b++){this.Fields[b].Realize()}e=this.Groups.length;for(var b=0;b<e;b++){this.Groups[b].SetCollapsed()}this.Realized=true;this.SetPanelStatus();this.SetPanelMode();this.SetNumRows();this.SetMaxHRow();this.SetHeaderSize();this.SetShowRowSelector();this.SetEnableMultipleSel();this.SetShowMultipleSel();this.SetDynamicRows();this.SetDynamicHeight();this.SetHasScrollbar();this.SetHasList();this.SetHasForm();this.SetCanUpdate();this.SetCanDelete();this.SetCanInsert();this.SetCanSearch();this.SetCanSort();this.SetListLeft();this.SetListTop();this.SetListWidth();this.SetListHeight();this.SetActualRow();this.SetVResMode();this.SetHResMode();this.SetVisualStyle();this.SetFixedColumns();this.SetQbeTip();this.SetTotalRows();this.SetPanelPage();this.SetLoadingPolicy();var a=this.PanelMode;this.PanelMode=-1;this.SetActualPosition();this.ResetPosition=false;this.PanelMode=a;this.Realizing=false;this.UpdateToolbar();this.SetStatusBarText();this.RecalcLayout=false;this.ResetPosition=false;if(RD3_Glb.IsMobile()){for(var b=0;b<this.Groups.length;b++){this.UpdateFieldClass(this.Groups[b])}}};IDPanel.prototype.CompileFieldList=function(){if(this.AdvTabOrder){var b=-1;this.ListTabOrder=new Array();this.FormTabOrder=new Array();var d=this.Fields.length;for(var a=0;a<d;a++){var c=this.Fields[a];this.ListTabOrder[c.ListTabOrder]=c;this.FormTabOrder[c.FormTabOrder]=c}}};IDPanel.prototype.AdaptLayout=function(){var l=null;var k=(RD3_Glb.IsIE(10,false)&&!RD3_Glb.IsIE(6)&&this.PanelMode==RD3_Glb.PANEL_LIST&&this.FixedColumns==0);if(k){var b=document.activeElement;this.ContentBox.removeChild(this.ListBox);if(document.activeElement!=b){l=b}}if(this.Pages.length>0){if(this.ParentTab){RD3_Glb.AdaptToParent(this.FrameBox,0,0)}this.AdaptPagesLayout()}var j=this.SendResize;var h=false;WebFrame.prototype.AdaptLayout.call(this);if(!j){j|=(this.PanelMode==RD3_Glb.PANEL_FORM&&(this.MustResizeFormW||this.MustResizeFormH))|(this.PanelMode==RD3_Glb.PANEL_LIST&&(this.MustResizeListW||this.MustResizeListH))}if(j||(this.ResVisFld&&this.ResOnlyVisFlds)){if(!RD3_Glb.IsSafari()&&this.DeltaW<0){h=true}if(this.HasForm){if(this.PanelMode==RD3_Glb.PANEL_FORM&&this.Visible){if(!this.DeltaW&&this.MustResizeFormW){this.DeltaW=this.MustResizeFormW}if(!this.DeltaH&&this.MustResizeFormH){this.DeltaH=this.MustResizeFormH}this.ResizeForm();this.MustResizeFormW=0;this.MustResizeFormH=0}else{if(this.LastFormResizeW==0&&(this.DeltaW||this.DeltaH)){this.MustResizeFormW=(this.MustResizeFormW==undefined?0:this.MustResizeFormW)+this.DeltaW;this.MustResizeFormH=(this.MustResizeFormH==undefined?0:this.MustResizeFormH)+this.DeltaH}}}if(this.HasList){if(this.PanelMode==RD3_Glb.PANEL_LIST&&this.Visible){if(!this.DeltaW&&this.MustResizeListW){this.DeltaW=this.MustResizeListW}if(!this.DeltaH&&this.MustResizeListH){this.DeltaH=this.MustResizeListH}this.ResizeList();this.MustResizeListW=0;this.MustResizeListH=0}else{if(this.LastListResizeW==0&&(this.DeltaW||this.DeltaH)){this.MustResizeListW=(this.MustResizeListW==undefined?0:this.MustResizeListW)+this.DeltaW;this.MustResizeListH=(this.MustResizeListH==undefined?0:this.MustResizeListH)+this.DeltaH}}}this.DeltaW=0;this.DeltaH=0;this.SetActualPosition();if(RD3_Glb.IsMobile()){this.RefreshToolbar=true}}this.ResVisFld=false;if(this.PanelMode==RD3_Glb.PANEL_LIST){this.CalcListLayout(h);if(this.IsGrouped()){this.CalcListGroupLayout()}}this.CalcGroupsLayout();var e=true;var a=this.Fields.length;for(var d=0;d<a;d++){var g=this.Fields[d];if(k&&e&&g.SubFrame&&g.SubFrame.Realized&&g.IsVisible()){this.ContentBox.appendChild(this.ListBox);e=false}g.AdaptLayout()}if(RD3_Glb.IsChrome()||RD3_Glb.IsSafari()){this.ContentBox.style.overflowX="hidden";this.ContentBox.style.overflowY="hidden"}this.AdaptFormListLayout();this.SetScrollbar();if(this.MoreAreaBox){this.MoreAreaBox.style.display=(this.TotalRows>this.NumRows)?"":"none";if(this.IsMyScroll()&&this.IDScroll){this.IDScroll.MarginBottom=(this.TotalRows>this.NumRows)?40:0}this.MoreButton.className="panel-more-button"}if(k){if(e){this.ContentBox.appendChild(this.ListBox)}this.QbeScroll=true;if(l){if(l.tagName=="DIV"&&l.getAttribute("contenteditable")!="true"){RD3_KBManager.CheckFocus=true}else{l.focus()}}}if(!this.AnimatingPanel&&!this.Collapsing){var c=this.ContentBox.scrollTop;this.ContentBox.scrollTop=c+1000;this.ContentBox.scrollTop=c}if(this.IsMyScroll()&&this.PullAreaBox&&this.PanelMode==RD3_Glb.PANEL_LIST){this.IDScroll.PullTrigger=-this.PullAreaBox.offsetTop+this.PullAreaBox.offsetHeight/2;if(RD3_Glb.IsQuadro()){this.IDScroll.PullTrigger-=40}}else{if(this.IDScroll){this.IDScroll.PullTrigger=0}}if(this.IsMyScroll()&&!this.AnimatingToolbar){this.IDScroll.ChangeSize()}this.RecalcLayout=false;this.SendResize=false};IDPanel.prototype.AdaptPagesLayout=function(){var e=RD3_Glb.IsMobile();var j=false;var b=this.Pages.length;var f=0;var h;if(this.Collapsed){this.PagesBox.style.display="none";return}this.PagesFiller.style.display="none";this.PagesBox.style.display="";RD3_Glb.AdaptToParent(this.PagesBox,0,-1);f=this.PagesBox.clientWidth;h=0;for(var c=0;c<b;c++){var g=((j)?RD3_ClientParams.TabWidthThin:RD3_ClientParams.TabWidth);var a=this.Pages[c];if(a.IsVisible()){if(j){a.HeaderCont.style.width=""}if(!e){if(a.HeaderCont.offsetWidth<=g&&a.HeaderCont.offsetWidth>0){a.HeaderCont.style.width=g+"px"}}h+=e?a.CaptionContainer.offsetWidth:a.PageContainer.offsetWidth;if(h>f){if(!j){c=-1;j=true;h=0;continue}else{h=e?a.CaptionContainer.offsetWidth:a.PageContainer.offsetWidth;continue}}}}if(RD3_Glb.IsChrome()||RD3_Glb.IsSafari()){f-=10}var d=(f-h);if(this.PagesFiller.offsetWidth>d){d=(d-(this.PagesFiller.offsetWidth-d))}if(d<0){d=0}this.PagesFiller.style.width=d+"px";this.PagesFiller.style.display="";if(RD3_Glb.IsIE()&&this.PagesFiller.offsetLeft==0){this.PagesFiller.style.width=(d>0?d-1:0)+"px"}if(e){this.PagesBox.style.top=(this.Height-this.PagesBox.offsetHeight)+"px"}};IDPanel.prototype.AdaptFormListLayout=function(){var d=0;var k=0;var g=this.RowSelWidth();if(this.PanelMode==RD3_Glb.PANEL_LIST){var j=(this.ScrollBox&&!RD3_Glb.IsMobile())?18:0;k=this.ListLeft+(RD3_ServerParams.CompletePanelBorders?0:g)+this.ListWidth-1+j+2;d=this.ListTop+this.ListHeightRounded+2;if(this.FixedColumns>0&&this.ScrollAreaBox.style.display!="none"){d=this.ListTop+parseInt(this.ScrollAreaBox.style.height)}}var b=this.Fields.length;for(var c=0;c<b;c++){var h=this.Fields[c];if(h.IsVisible(true)){var l=0;var e=0;if(this.PanelMode==RD3_Glb.PANEL_FORM){if(!h.Group){l=h.FormLeft+h.FormWidth;e=h.FormTop+h.FormHeight;if(h.IsStatic()&&h.Badge!=""){l+=12}}else{var a=h.Group.VisualStyle;if(a==-1){a=this.VisualStyle}l=h.Group.FormLeft+h.Group.FormWidth+a.GetOffset(true,3,false,true);e=h.Group.FormTop+(h.Group.Collapsed?0:h.Group.FormHeight+a.GetOffset(false,3,false,true))}}else{if(!h.ListList){if(h.Group&&!h.Group.InList){var a=h.Group.VisualStyle;if(a==-1){a=this.VisualStyle}l=h.Group.ListLeft+h.Group.ListWidth+a.GetOffset(true,3,true,true);e=h.Group.ListTop+(h.Group.Collapsed?0:h.Group.ListHeight+a.GetOffset(false,3,true,true))}else{l=h.ListLeft+h.ListWidth+g;e=h.ListTop+h.ListHeight;if(h.IsStatic()&&h.Badge!=""){l+=12}}}}if(l>k){k=l}if(e>d){d=e}}}k+=2;d+=2;if(this.PanelMode==RD3_Glb.PANEL_LIST){this.ListBox.style.width=k+"px";this.ListBox.style.height=d+"px"}if(this.PanelMode==RD3_Glb.PANEL_FORM){this.FormBox.style.width=k+"px";this.FormBox.style.height=d+"px"}if(k>this.FrameBox.clientWidth){this.ToolbarBox.style.width=k+"px"}else{RD3_Glb.AdaptToParent(this.ToolbarBox,0,-1)}};IDPanel.prototype.CalcListLayout=function(G){if(!this.ListBox){return}var o=this.ListLeft+this.RowSelWidth();if(RD3_ServerParams.CompletePanelBorders){o=this.ListLeft}var c=this.FixedColumns;if(c>0){var L=0;var y=this.Fields.length;for(var E=0;E<y;E++){var I=this.Fields[E];if(I.InList&&I.ListList&&I.IsVisible()){L+=I.ListWidth}}if(L+o<this.ContentBox.clientWidth+(G?17:0)-(this.ScrollBox?this.ScrollBox.offsetWidth:0)-3){c=0}}this.ListListBox.style.left=o+"px";this.ListListBox.style.top=this.ListTop+"px";this.ScrollAreaBox.style.display=(c>0)?"":"none";var y=this.Groups.length;for(var E=0;E<y;E++){this.Groups[E].ResetListPosition()}var N=this.VisStyle.GetBorders(1);var a=(N==4||N==2);var y=this.Fields.length;var L=(a?-1:0);var q=(a?-1:0);var l=0;var x=0;if(RD3_ServerParams.CompletePanelBorders){L+=this.RowSelWidth()}for(var E=0;E<y;E++){var I=this.Fields[E];if(this.AdvTabOrder){I=this.ListTabOrder[E]}if(I.InList&&I.ListList){if(I.IsVisible()){x++;var u=(c>0&&x>c)?this.ScrollAreaBox:this.ListListBox;if(I.Group){I.Group.SetListPosition(L,q,u,I.ListWidth)}I.SetListListPosition(L,q,u);l=I.ListTop;L+=I.ListWidth;if(x==c){this.ScrollAreaBox.style.left=(o+L)+"px";this.ScrollAreaBox.style.top=this.ListListBox.style.top;var g=0;for(var D=0;D<y;D++){var z=this.Fields[D];if(z.AggregateOfField==-1||!z.IsVisible()){continue}g=Math.max(g,z.ListTop+z.ListHeight-this.ListTop-this.ListHeightRounded-2)}this.ScrollAreaBox.style.height=(this.ListHeightRounded+g+18)+"px";var O=(this.ContentBox.clientWidth-(this.ScrollBox?this.ScrollBox.offsetWidth:0)-(o+L)-3);this.ScrollAreaBox.style.width=(O>=0?O:0)+"px";L=0}}}I.UpdateFieldVisibility()}var k=this.Groups.length;for(var E=0;E<k;E++){this.Groups[E].UpdateVisibility()}if(c==0){this.ListWidth=L+1}else{this.ListWidth=this.ContentBox.clientWidth-(this.ScrollBox?this.ScrollBox.offsetWidth:0)-o-3}if(this.ListWidth<1){this.ListWidth=1}var e=this.ListWidth;if(RD3_ServerParams.CompletePanelBorders){var J=0;if(this.ScrollBox&&!RD3_Glb.IsMobile()){J=RD3_Glb.IsEdge()?13:18}e=this.ListWidth+J;if(RD3_Glb.IsIE(10,true)){e++}}this.ListListBox.style.width=(e-1)+"px";if(this.ScrollBox){this.ScrollBox.style.left=(o+this.ListWidth)+"px";this.ScrollBox.style.top=(l+(a?1:0))+((RD3_ServerParams.CompletePanelBorders&&RD3_ServerParams.Theme!="zen")?-1:0)+"px";this.ScrollBox.style.height=((this.NumRows-1)*this.GetRowHeight()+this.MaxHRow+1)+(RD3_ServerParams.CompletePanelBorders?-2:0)+"px";if(RD3_ServerParams.CompletePanelBorders&&!RD3_Glb.IsIE(10,true)){this.ScrollBox.style.width=RD3_Glb.IsEdge()?"12px":"17px"}if(this.ScrollBoxTouch){this.ScrollBoxTouch.style.left=this.ScrollBox.offsetLeft+"px";this.ScrollBoxTouch.style.top=this.ScrollBox.offsetTop+"px";this.ScrollBoxTouch.style.height=(this.ScrollBox.offsetHeight-2)+"px"}if(RD3_ServerParams.CompletePanelBorders&&this.ScrollBoxCap){var K=this.VisStyle.GetBorders(1);var M=this.VisStyle.GetBorders(2);var A=new Rect(o+this.ListWidth,q+this.ListTop,RD3_Glb.IsEdge()?13:18,this.HeaderSize);this.VisStyle.AdaptCaptionRect(A,true,true);if((K==4||K==3)&&M!=4&&M!=3){A.x++;A.w--;if(A.x+A.w==e-4){A.w--}}if(RD3_ServerParams.Theme=="zen"){A.w+=3;if(!RD3_Glb.IsIE()){A.h+=1}}if((K==4||K==2)&&M!=4&&M!=2){A.y++;A.h--}if(K==2||K==4){A.y++}if(K==1||K==2){A.x--}if(RD3_Glb.IsIE(10,true)){A.w++}var r=this.ScrollBoxCap.style;r.left=A.x+"px";r.top=A.y+"px";r.width=A.w+"px";r.height=A.h+"px";r.paddingLeft=A.pxl+"px";r.paddingRight=A.pxr+"px";r.paddingTop=A.pyt+"px";r.paddingBottom=A.pyb+"px"}}if(this.ScrollBoxMobile){var F=this.ContentBox.offsetHeight-30;var w=this.ScrollBoxMobile.offsetWidth;if(w==0){w=parseInt(RD3_Glb.GetStyleProp(this.ScrollBoxMobile,"width"))}this.ScrollBoxMobile.style.left=(this.ContentBox.offsetWidth-w-2)+"px";this.ScrollBoxMobile.style.height=F+"px";var m=1;var r="#";for(var E=65;E<91;E+=m){r+="<br>"+String.fromCharCode(E)}this.ScrollBoxMobile.innerHTML=r;this.ScrollBoxMobile.style.lineHeight=(F/2.9)+"%"}if(this.RowSel){var b=this.ListLeft;var C=l;if(RD3_ServerParams.Theme=="zen"&&!RD3_ServerParams.CompletePanelBorders){C+=3;if(this.ShowMultipleSel){b+=5;C+=5}}for(var E=0;E<this.NumRows;E++){this.RowSel[E].style.left=b+"px";this.RowSel[E].style.top=(C+((RD3_Glb.IsTouch()&&this.ShowMultipleSel)?2:0))+"px";if(RD3_ServerParams.CompletePanelBorders){var K=this.VisStyle.GetBorders(1);var M=this.VisStyle.GetBorders(2);var A=new Rect(b,(C+((RD3_Glb.IsTouch()&&this.ShowMultipleSel)?2:0)),this.RowSelWidth(),this.GetRowHeight());this.VisStyle.AdaptCaptionRect(A,true,true);if(RD3_ServerParams.Theme=="zen"){A.w+=2;A.h+=1;if(RD3_Glb.IsIE(10,true)){A.h--}}if((K==4||K==3)&&M!=4&&M!=3){A.x++;A.w--;if(A.x+A.w==e-4){A.w--}}if((K==4||K==2)&&M!=4&&M!=2){A.y++;A.h--}if(K==3){A.w++}if(RD3_Glb.IsIE(10,false)){A.w=A.w+A.pxl+A.pxr;A.h=A.h+A.pyt+A.pyb;A.pxl=0;A.pxr=0;A.pyt=0;A.pyb=0;var B=this.ShowMultipleSel?20:15;var p=Math.floor((A.w-B)/2);var H=Math.floor((A.h-B)/2);if(p>0){A.pxl=p;A.pxr=p;A.w=A.w-A.pxl-A.pxr}if(H>0){A.pyt=H;A.pyb=H;A.h=A.h-A.pyt-A.pyb}}var r=this.RowSel[E].style;r.left=A.x+"px";r.top=A.y+"px";r.width=A.w+"px";r.height=A.h+"px";r.lineHeight=A.h+A.pyt+A.pyb+"px";r.paddingLeft=A.pxl+"px";r.paddingRight=A.pxr+"px";r.paddingTop=A.pyt+"px";r.paddingBottom=A.pyb+"px"}C+=this.GetRowHeight()}}var v=this.HeaderSize>=32&&this.ShowRowSelector;if(this.ToggleMultiSelBox){var K=this.VisStyle.GetBorders(1);var M=this.VisStyle.GetBorders(2);var A=new Rect(o,q+this.ListTop,this.RowSelWidth(),this.HeaderSize);this.VisStyle.AdaptCaptionRect(A,true,true);if(RD3_ServerParams.Theme=="zen"){A.w+=3;A.h+=1}if((K==4||K==3)&&M!=4&&M!=3){A.x++;A.w--;if(A.x+A.w==e-4){A.w--}}if((K==4||K==2)&&M!=4&&M!=2){A.y++;A.h--}if(K==2||K==4){A.y++}if(K==3){A.w++}var r=this.ToggleMultiSelBox.style;r.left=A.x+"px";r.top=A.y+"px";r.width=A.w+"px";r.height=A.h+"px";r.lineHeight=A.h+"px";r.paddingLeft=A.pxl+"px";r.paddingRight=A.pxr+"px";r.paddingTop=A.pyt+"px";r.paddingBottom=A.pyb+"px";r.visibility=v?"":"hidden"}if(this.ToggleMultiSelCmd){if(RD3_ServerParams.CompletePanelBorders){this.ToggleMultiSelCmd.style.position="static";this.ToggleMultiSelCmd.style.paddingLeft=(RD3_ServerParams.Theme=="zen"?0:A.pxl)+"px"}else{this.ToggleMultiSelCmd.style.left=(this.ListLeft+(RD3_ServerParams.Theme=="zen"?9:5))+"px";this.ToggleMultiSelCmd.style.top=this.ListTop+"px";this.ToggleMultiSelCmd.style.visibility=v?"":"hidden";if(RD3_ServerParams.Theme=="zen"){this.ToggleMultiSelCmd.style.position="absolute";this.ToggleMultiSelCmd.style.width="12px";this.ToggleMultiSelCmd.style.height="12px"}}}if(this.MultiSelectAllCmd){this.MultiSelectAllCmd.style.left=(this.ListLeft+(RD3_ServerParams.Theme=="zen"?9:5))+"px";this.MultiSelectAllCmd.style.top=(this.ListTop+(RD3_Glb.IsTouch()?14:(RD3_ServerParams.Theme=="zen"?13:11)))+"px";this.MultiSelectAllCmd.style.visibility=v?"":"hidden";if(RD3_ServerParams.Theme=="zen"){this.MultiSelectAllCmd.style.position="absolute";this.MultiSelectAllCmd.style.width="12px";this.MultiSelectAllCmd.style.height="12px"}}if(this.MultiSelectNoneCmd){this.MultiSelectNoneCmd.style.left=(this.ListLeft+(RD3_ServerParams.Theme=="zen"?9:5))+"px";this.MultiSelectNoneCmd.style.top=(this.ListTop+(RD3_Glb.IsTouch()?28:(RD3_ServerParams.Theme=="zen"?26:22)))+"px";this.MultiSelectNoneCmd.style.visibility=v?"":"hidden";if(RD3_ServerParams.Theme=="zen"){this.MultiSelectNoneCmd.style.position="absolute";this.MultiSelectNoneCmd.style.width="12px";this.MultiSelectNoneCmd.style.height="12px"}}};IDPanel.prototype.CalcGroupsLayout=function(){var a=false;var c=this.Groups.length;for(var b=0;b<c;b++){a|=this.Groups[b].CalcLayout()}if(a&&RD3_Glb.IsMobile()){this.AdaptFormListLayout()}if(RD3_Glb.IsMobile()&&!RD3_Glb.IsMobile7()&&!RD3_Glb.IsQuadro()){for(var b=0;b<this.Groups.length;b++){this.UpdateFieldClass(this.Groups[b])}}};IDPanel.prototype.GetFirstListField=function(){var c=this.Fields.length;for(var a=0;a<c;a++){var b=this.Fields[a];if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_LIST){b=this.ListTabOrder[a]}if(b.InList&&b.ListList){return b}}return null};IDPanel.prototype.OnScroll=function(d){if(RD3_Glb.IsFirefox()&&this.PanelMode==RD3_Glb.PANEL_FORM){return}this.ScrollBoxInt.setAttribute("idtop",this.ScrollBox.scrollTop);if(((new Date())-this.LastPositionTime)<(RD3_Glb.IsFirefox(3)?100:50)){if(this.SkipScroll!=-1){this.SkipScroll=-1;if(this.SkipScroll==(this.ScrollClone)?this.ScrollClone.scrollTop:this.ScrollBox.scrollTop){return}}if(this.ScrollTimer){window.clearTimeout(this.ScrollTimer)}this.ScrollTimer=window.setTimeout(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"','OnScroll', ev)"),100);return}var a=(this.ScrollClone)?this.ScrollClone.scrollTop:this.ScrollBox.scrollTop;var f=Math.floor(a/this.GetRowHeight())+1;defaultStatus=f+"-"+(f+this.NumRows-1)+" su "+this.GetTotalRows();if(this.IsGrouped()){if(f+this.NumRows>=this.GetTotalRows()+1){var b=this.ListGroupRoot.GetServerIndex(f);var e=this.ListGroupRoot.GetRowPos(b);if(e+this.NumRows<this.GetTotalRows()+1){b=b+1}f=b}else{f=this.ListGroupRoot.GetServerIndex(f)}}this.ScrollTo(f,d);return true};IDPanel.prototype.OnScrollMouseEnter=function(a){if(this.ScrollClone){document.body.removeChild(this.ScrollClone)}this.ScrollClone=this.ScrollBox.cloneNode(true);this.ScrollClone.style.zIndex=100;this.ScrollClone.onscroll=this.ScrollBox.onscroll;if(RD3_Glb.IsIE()){this.ScrollClone.onmouseleave=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollMouseLeave', ev)")}if(RD3_Glb.IsFirefox()){this.ScrollClone.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollMouseLeave', ev)")}this.ScrollClone.style.left=RD3_Glb.GetScreenLeft(this.ScrollBox)+"px";this.ScrollClone.style.top=RD3_Glb.GetScreenTop(this.ScrollBox)+"px";document.body.insertBefore(this.ScrollClone,document.body.childNodes[0]);this.LastPositionTime=new Date();this.SkipScroll=this.ScrollBox.scrollTop;this.ScrollClone.scrollTop=this.ScrollBox.scrollTop;return true};IDPanel.prototype.OnScrollMouseLeave=function(a){if(RD3_Glb.IsIE()){if(this.ScrollClone&&this.ScrollClone!=document.elementFromPoint(window.event.clientX,window.event.clientY)){this.LastPositionTime=new Date();this.SkipScroll=this.ScrollClone.scrollTop;this.ScrollBox.scrollTop=this.ScrollClone.scrollTop;document.body.removeChild(this.ScrollClone);this.ScrollClone=null}}if(RD3_Glb.IsFirefox()&&this.ScrollClone){this.LastPositionTime=new Date();this.SkipScroll=this.ScrollClone.scrollTop;this.ScrollBox.scrollTop=this.ScrollClone.scrollTop;document.body.removeChild(this.ScrollClone);this.ScrollClone=null}};IDPanel.prototype.OnMouseWheel=function(c){if(RD3_Glb.IsFirefox()){this.OnScrollMouseLeave()}var b=window.event?window.event:c;var a=b.srcElement?b.srcElement:b.target;var d=window.event?b.wheelDelta:(b.detail!=0?-b.detail*40:b.wheelDelta);if(b.detail&&b.axis==1){return true}if(b.wheelDeltaX&&b.wheelDeltaX!=0){return true}if(!RD3_DDManager.OpenCombo){this.ScrollBox.scrollTop-=d/2}RD3_TooltipManager.DeactivateAll();RD3_Glb.StopEvent(c);return false};IDPanel.prototype.ScrollTo=function(c,a,k){var j=(this.PanelMode==RD3_Glb.PANEL_LIST)?this.NumRows:1;var d=this.Status==RD3_Glb.PS_DATA&&(this.GetTotalRows()>j||this.ActualPosition>1);d&=(RD3_ServerParams.AllowMasterPanelNavigation||!this.DOMaster||!this.DOModified);if(!d){return}var m=RD3_KBManager.ActiveElement;if(m){var e=RD3_KBManager.GetCell(m);if(e&&e instanceof PCell&&e.PValue&&e.IsUncommitted()){e.PValue.SendChanges(m)}}var l=this.ScrollEventDef;var b=c;if(this.IsGrouped()&&this.PanelMode==RD3_Glb.PANEL_LIST){var o=this.ListGroupRoot.GetRowPos(b,true,true);b=this.ListGroupRoot.GetServerIndex(o+this.ActualRow,true)}var h=this.GetFirstListField();if(h!=null&&h.HasValues(b)){l|=RD3_Glb.EVENT_IMMEDIATE}var i=new IDEvent("panscr",this.Identifier,a,l,null,b,undefined,undefined,undefined,k);var g=RD3_DesktopManager.MessagePump.GetEvent("","chg");if(g){RD3_DesktopManager.SendEvents(true)}if(i.ClientSide){if(RD3_Glb.IsSafari()&&!RD3_Glb.IsTouch()){window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'DelayScroll', null, "+c+")",5)}else{this.SetActualPosition(c,false,true)}}};IDPanel.prototype.DelayScroll=function(a,b){this.SetActualPosition(b,false,true)};IDPanel.prototype.Unrealize=function(){this.DelayedListUpdate=false;WebFrame.prototype.Unrealize.call(this);if(this.ScrollClone){document.body.removeChild(this.ScrollClone)}var b=this.Fields.length;for(var a=0;a<b;a++){this.Fields[a].Unrealize()}var b=this.Groups.length;for(var a=0;a<b;a++){this.Groups[a].Unrealize()}var b=this.Pages.length;for(var a=0;a<b;a++){this.Pages[a].Unrealize()}if(this.QBETipBox){this.QBETipBox.Unrealize()}if(this.MultiSelCommand){RD3_DesktopManager.WebEntryPoint.CmdObj.ClientCommands.remove(this.Identifier+":cms:0");this.MultiSelCommand.Unrealize();this.MultiSelCommand=null}this.Realized=false};IDPanel.prototype.RealizeToolbar=function(){WebFrame.prototype.RealizeToolbar.call(this);this.TBZones=new Array();for(var e=0;e<=10;e++){if(RD3_Glb.IsMobile()){this.TBZones[e]=this.ToolbarBox}else{this.TBZones[e]=document.createElement("span");this.TBZones[e].className=(this.SmallIcons)?"panel-toolbarsmall-zone":"panel-toolbar-zone";this.ToolbarBox.appendChild(this.TBZones[e])}}if(!RD3_Glb.IsMobile()){this.TBZones[0].style.display="none"}this.ToolbarBox.removeChild(this.CollapseButton);e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_COLLAPSE];this.TBZones[e].appendChild(this.CollapseButton);this.CollapseButton.style.marginLeft="";this.ToolbarBox.removeChild(this.LockButton);e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_LOCK];this.TBZones[e].appendChild(this.LockButton);if(RD3_Glb.IsMobile()){this.ToolbarBox.removeChild(this.SearchBox);e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_LOCK];this.TBZones[e].appendChild(this.SearchBox)}this.ToolbarBox.removeChild(this.IconImg);e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_STATUSBAR];this.TBZones[e].appendChild(this.IconImg);this.ToolbarBox.removeChild(this.CaptionTxt);e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_STATUSBAR];this.TBZones[e].appendChild(this.CaptionTxt);this.StatusBar=document.createElement("span");this.StatusBar.setAttribute("id",this.Identifier+":status");this.StatusBar.className=(this.SmallIcons)?"panel-toolbarsmall-status":"panel-toolbar-status";e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_STATUSBAR];this.TBZones[e].appendChild(this.StatusBar);this.QBETIcon=document.createElement("img");if(!RD3_Glb.IsMobile()){this.QBETIcon.src=RD3_Glb.GetImgSrc("images/qbef.gif")}this.QBETIcon.setAttribute("id",this.Identifier+":qbetip");this.QBETIcon.className=(this.SmallIcons)?"panel-toolbarsmall-qbetip":"panel-toolbar-qbetip";this.QBETIcon.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseOverObj', ev)");this.QBETIcon.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseOutObj', ev)");this.QBETipBox=new MessageTooltip(this);this.QBETipBox.SetTitle(ClientMessages.TIP_TITLE_QBETIP);this.QBETipBox.SetStyle("info");this.QBETipBox.SetObj(this.QBETIcon);this.QBETipBox.SetDelay(0,0);this.QBETipBox.SetPosition(2);this.QBETipBox.SetCanClose(false);if(!this.QBETipAnimDef){this.QBETipBox.SetAnimDef(RD3_ClientParams.GFXDef.qbetip)}else{this.QBETipBox.SetAnimDef(this.QBETipAnimDef)}this.TBZones[e].appendChild(this.QBETIcon);this.TopButton=document.createElement("img");this.TopButton.setAttribute("id",this.Identifier+":top");this.TopButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-top-button";this.TopButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'top')");this.TopButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.TopButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.TopButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.TopButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.TopButton,RD3_ServerParams.PanelInizio);e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_NAVIGATE];this.TBZones[e].appendChild(this.TopButton);this.PrevButton=document.createElement("img");this.PrevButton.setAttribute("id",this.Identifier+":prev");this.PrevButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-prev-button";this.PrevButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'prev')");this.PrevButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.PrevButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.PrevButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.PrevButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.PrevButton,RD3_ServerParams.PanelPaginaPrec);this.TBZones[e].appendChild(this.PrevButton);this.NextButton=document.createElement("img");this.NextButton.setAttribute("id",this.Identifier+":next");this.NextButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-next-button";this.NextButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'next')");this.NextButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.NextButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.NextButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.NextButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.NextButton,RD3_ServerParams.PanelPaginaSucc);this.TBZones[e].appendChild(this.NextButton);this.BottomButton=document.createElement("img");this.BottomButton.setAttribute("id",this.Identifier+":bottom");this.BottomButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-bottom-button";this.BottomButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'bottom')");this.BottomButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.BottomButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.BottomButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.BottomButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.BottomButton,RD3_ServerParams.PanelFine);this.TBZones[e].appendChild(this.BottomButton);this.SearchButton=document.createElement("img");this.SearchButton.setAttribute("id",this.Identifier+":search");this.SearchButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-search-button";this.SearchButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'search')");this.SearchButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.SearchButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.SearchButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.SearchButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.SearchButton,RD3_ServerParams.TooltipCerca+RD3_KBManager.GetFKTip(RD3_ClientParams.FKEnterQBE));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_SEARCH];this.TBZones[e].appendChild(this.SearchButton);this.FindButton=document.createElement("img");this.FindButton.setAttribute("id",this.Identifier+":find");this.FindButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-find-button";this.FindButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'find')");this.FindButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.FindButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.FindButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.FindButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.FindButton,RD3_ServerParams.TooltipTrova+RD3_KBManager.GetFKTip(RD3_ClientParams.FKFindData));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_FIND];this.TBZones[e].appendChild(this.FindButton);this.FormListButton=document.createElement(RD3_Glb.IsMobile()?"div":"img");this.FormListButton.setAttribute("id",this.Identifier+":formlist");this.FormListButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-formlist-button";this.FormListButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'list')");this.FormListButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.FormListButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.FormListButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.FormListButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.FormListButton,RD3_ServerParams.TooltipFormList+RD3_KBManager.GetFKTip(RD3_ClientParams.FKFormList));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_FORMLIST];if(RD3_Glb.IsMobile()){this.FormListButtonCnt=document.createElement("div");this.FormListButtonCnt.setAttribute("id",this.Identifier+":txt");this.FormListButtonCnt.className="panel-formlist-container";this.TBZones[e].insertBefore(this.FormListButtonCnt,this.SearchBox);this.FormListButton.textContent=RD3_Glb.IsMobile7()?ClientMessages.MOB_TOOLBAR_LIST:ClientMessages.MOB_TOOLBAR_TOLIST;this.FormListButtonImg=document.createElement("div");this.FormListButtonImg.setAttribute("id",this.Identifier+":spi");this.FormListButtonImg.className="panel-formlist-arrow";this.FormListButtonImg.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'list')");this.FormListButtonCnt.appendChild(this.FormListButtonImg);this.FormListButtonCnt.appendChild(this.FormListButton)}else{this.TBZones[e].appendChild(this.FormListButton)}this.CancelButton=document.createElement("img");this.CancelButton.setAttribute("id",this.Identifier+":cancel");this.CancelButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-cancel-button";this.CancelButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'cancel')");this.CancelButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.CancelButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.CancelButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.CancelButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.CancelButton,RD3_ServerParams.TooltipCancel+RD3_KBManager.GetFKTip(RD3_ClientParams.FKCancel));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_CANCEL];if(RD3_Glb.IsMobile()){this.TBZones[e].insertBefore(this.CancelButton,this.FormListButtonCnt)}else{this.TBZones[e].appendChild(this.CancelButton)}this.RefreshButton=document.createElement("img");this.RefreshButton.setAttribute("id",this.Identifier+":refresh");this.RefreshButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-refresh-button";this.RefreshButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'refresh')");this.RefreshButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.RefreshButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.RefreshButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.RefreshButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.RefreshButton,RD3_ServerParams.TooltipRefresh+RD3_KBManager.GetFKTip(RD3_ClientParams.FKRefresh));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_REQUERY];this.TBZones[e].appendChild(this.RefreshButton);this.DelButton=document.createElement("img");this.DelButton.setAttribute("id",this.Identifier+":del");this.DelButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-delete-button";this.DelButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'delete')");this.DelButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.DelButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.DelButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.DelButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.DelButton,RD3_ServerParams.TooltipDelete+RD3_KBManager.GetFKTip(RD3_ClientParams.FKDelete));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_DELETE];this.TBZones[e].appendChild(this.DelButton);this.NewButton=document.createElement("img");this.NewButton.setAttribute("id",this.Identifier+":new");this.NewButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-insert-button";this.NewButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'insert')");this.NewButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.NewButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.NewButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.NewButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.NewButton,RD3_ServerParams.TooltipInsert+RD3_KBManager.GetFKTip(RD3_ClientParams.FKInsert));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_INSERT];this.TBZones[e].appendChild(this.NewButton);this.DuplButton=document.createElement("img");this.DuplButton.setAttribute("id",this.Identifier+":dupl");this.DuplButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-duplicate-button";this.DuplButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'dupl')");this.DuplButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.DuplButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.DuplButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.DuplButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.DuplButton,RD3_ServerParams.TooltipDuplicate+RD3_KBManager.GetFKTip(RD3_ClientParams.FKDuplicate));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_DUPLICATE];this.TBZones[e].appendChild(this.DuplButton);this.SaveButton=document.createElement("img");this.SaveButton.setAttribute("id",this.Identifier+":save");this.SaveButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-save-button";this.SaveButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'save')");this.SaveButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.SaveButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.SaveButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.SaveButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.SaveButton,RD3_ServerParams.TooltipUpdate+RD3_KBManager.GetFKTip(RD3_ClientParams.FKUpdate));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_UPDATE];this.TBZones[e].appendChild(this.SaveButton);this.PrintButton=document.createElement("img");this.PrintButton.setAttribute("id",this.Identifier+":print");this.PrintButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-print-button";this.PrintButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'print')");this.PrintButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.PrintButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.PrintButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.PrintButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.PrintButton,RD3_ServerParams.Print+RD3_KBManager.GetFKTip(RD3_ClientParams.FKPrint));e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_PRINT];this.TBZones[e].appendChild(this.PrintButton);this.CsvButton=document.createElement("img");this.CsvButton.setAttribute("id",this.Identifier+":csv");this.CsvButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-export-button";this.CsvButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'csv')");this.CsvButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.CsvButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.CsvButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.CsvButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.CsvButton,RD3_ServerParams.TooltipExport);e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_CSV];this.TBZones[e].appendChild(this.CsvButton);this.AttachButton=document.createElement("img");this.AttachButton.setAttribute("id",this.Identifier+":attach");this.AttachButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-attach-button";this.AttachButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'attach')");this.AttachButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.AttachButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.AttachButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.AttachButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.AttachButton,RD3_ServerParams.ComandoAllegati);e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_ATTACH];this.TBZones[e].appendChild(this.AttachButton);this.GroupButton=document.createElement("img");this.GroupButton.setAttribute("id",this.Identifier+":group");this.GroupButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-group-button";this.GroupButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'group')");this.GroupButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.GroupButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.GroupButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.GroupButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(this.GroupButton,RD3_ServerParams.ComandoGruppi);e=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_GROUP];this.TBZones[e].appendChild(this.GroupButton);var c=RD3_DesktopManager.WebEntryPoint.CustomCommands;var g=c.length;if(g>0){this.CustomButtons=new Array()}for(var e=0;e<g;e++){var b=document.createElement("img");b.setAttribute("id",this.Identifier+":custom"+e);b.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"");b.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'cb"+e+"')");b.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");b.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");b.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");b.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");RD3_TooltipManager.SetObjTitle(b,c[e].Tooltip+RD3_KBManager.GetFKTip(c[e].FKNum));var f=18+e;if(e>=8){f=37+e-8}var d=RD3_DesktopManager.WebEntryPoint.CommandZones[f];this.TBZones[d].appendChild(b);this.CustomButtons[e]=b}if(RD3_Glb.IsMobile()){this.MulSelButton=document.createElement("img");this.MulSelButton.setAttribute("id",this.Identifier+":ms");this.MulSelButton.className="panel-toolbar-button"+((this.SmallIcons)?"-small":"")+" panel-mulsel-button";this.MulSelButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelCmd', ev, 'seltog')");this.MulSelButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.MulSelButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.MulSelButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.MulSelButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");e=RD3_DesktopManager.WebEntryPoint.CommandZones[1];this.TBZones[e].appendChild(this.MulSelButton)}var g=this.TBZones.length;for(var e=0;e<g;e++){if(!this.TBZones[e].hasChildNodes()){this.ToolbarBox.removeChild(this.TBZones[e])}}};IDPanel.prototype.SetSmallIcon=function(g){WebFrame.prototype.SetSmallIcon.call(this,g);if(this.Realized){var e=RD3_Glb.IsMobile();var f=RD3_Glb.IsMobile7();var d=(this.SmallIcons&&!e?"_sm":"")+(e?".png":".gif");var j=!(RD3_Glb.IsAndroid()||RD3_Glb.IsIE()||RD3_Glb.IsEdge())||RD3_Glb.IsAndroid(4,4,0);if(!j&&f){d="-i"+d}if(!e){this.TopButton.src=RD3_Glb.GetImgSrc("images/top"+d)}if(!e){this.PrevButton.src=RD3_Glb.GetImgSrc("images/prev"+d)}if(!e){this.NextButton.src=RD3_Glb.GetImgSrc("images/next"+d)}if(!e){this.BottomButton.src=RD3_Glb.GetImgSrc("images/bottom"+d)}if(!e){this.SearchButton.src=RD3_Glb.GetImgSrc("images/search"+d)}if(!e){this.FindButton.src=RD3_Glb.GetImgSrc("images/find"+d)}if(!e){if(RD3_ServerParams.Theme=="seattle"||RD3_ServerParams.Theme=="zen"){this.FormListButton.src=RD3_Glb.GetImgSrc("images/"+(this.PanelMode==RD3_Glb.PANEL_LIST?"listf":"list")+d)}else{this.FormListButton.src=RD3_Glb.GetImgSrc("images/list"+d)}}if(f&&j){this.CancelButton.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/cancel"+d)+"')";this.CancelButton.style.webkitMaskRepeat="no-repeat";this.CancelButton.style.webkitMaskSize="25px 25px"}else{this.CancelButton.src=RD3_Glb.GetImgSrc("images/cancel"+d)}if(f&&j){this.RefreshButton.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/refresh"+d)+"')";this.RefreshButton.style.webkitMaskRepeat="no-repeat";this.RefreshButton.style.webkitMaskSize="25px 25px"}else{this.RefreshButton.src=RD3_Glb.GetImgSrc("images/refresh"+d)}if(f&&j){this.DelButton.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/delete"+d)+"')";this.DelButton.style.webkitMaskRepeat="no-repeat";this.DelButton.style.webkitMaskSize="25px 25px"}else{this.DelButton.src=RD3_Glb.GetImgSrc("images/delete"+d)}if(f&&j){this.NewButton.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/new"+d)+"')";this.NewButton.style.webkitMaskRepeat="no-repeat";this.NewButton.style.webkitMaskSize="25px 25px"}else{this.NewButton.src=RD3_Glb.GetImgSrc("images/new"+d)}if(!e){this.DuplButton.src=RD3_Glb.GetImgSrc("images/dupl"+d)}if(f&&j){this.SaveButton.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/update"+d)+"')";this.SaveButton.style.webkitMaskRepeat="no-repeat";this.SaveButton.style.webkitMaskSize="25px 25px"}else{this.SaveButton.src=RD3_Glb.GetImgSrc("images/update"+d)}if(!e){this.PrintButton.src=RD3_Glb.GetImgSrc("images/print"+d)}if(!e){this.CsvButton.src=RD3_Glb.GetImgSrc("images/csv"+d)}if(!e){this.AttachButton.src=RD3_Glb.GetImgSrc("images/clip"+d)}if(!e){this.GroupButton.src=RD3_Glb.GetImgSrc("images/"+(this.ShowGroups?"grpdis":"grpen")+d)}if(this.MulSelButton){if(f&&j){this.MulSelButton.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/mulsel"+d)+"')";this.MulSelButton.style.webkitMaskRepeat="no-repeat";this.MulSelButton.style.webkitMaskSize="25px 25px"}else{this.MulSelButton.src=RD3_Glb.GetImgSrc("images/mulsel"+d)}}var b=RD3_DesktopManager.WebEntryPoint.CustomCommands;var h=b.length;for(var c=0;c<h;c++){if(f&&j){this.CustomButtons[c].style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/"+b[c].Image+d)+"')"}else{this.CustomButtons[c].src=RD3_Glb.GetImgSrc("images/"+b[c].Image+d)}if(RD3_Glb.Adapt4Retina(this.Identifier,b[c].Image+d,43,c)){if(f&&j){this.CustomButtons[c].style.webkitMaskSize="0px 0px"}else{this.CustomButtons[c].style.display="none"}}}}};IDPanel.prototype.SetShowToolbar=function(a){WebFrame.prototype.SetShowToolbar.call(this,a);if(this.Realized){this.UpdateToolbar()}};IDPanel.prototype.SetShowStatusBar=function(c){WebFrame.prototype.SetShowStatusBar.call(this,c);if(this.Realized){this.StatusBar.style.display=((this.ShowStatusBar&&!this.Collapsed)?"":"none");this.QBETIcon.style.visibility=((this.ShowStatusBar&&!this.Collapsed)?"":"hidden");var b=this.CaptionTxt.innerHTML;var a=b.substr(b.length-1,1);if(this.ShowStatusBar&&!this.Collapsed){if(a!=":"&&b!=""){this.CaptionTxt.innerHTML=b+":"}}else{if(a==":"){this.CaptionTxt.innerHTML=b.substr(0,b.length-1)}}}};IDPanel.prototype.SetLocked=function(b){var a=this.Locked;WebFrame.prototype.SetLocked.call(this,b);if(this.Realized&&(b==undefined||a!=this.Locked)){this.ResetPosition=true;this.ScrollToPos=false;this.RefreshToolbar=true;if(a!=this.Locked){this.UpdateNotNullFields()}if(RD3_Glb.IsMobile()&&!this.Locked&&this.PanelMode==RD3_Glb.PANEL_LIST){this.HiliteRow(0)}}};IDPanel.prototype.SetCollapsed=function(d,b){var a=this.Collapsed;WebFrame.prototype.SetCollapsed.call(this,d,b);if(b&&this.Realized&&a!=this.Collapsed){var e=this.Fields.length;for(var c=0;c<e;c++){if(this.Fields[c].SubFrame&&this.Fields[c].SubFrame.Identifier){this.Fields[c].SubFrame.SetCollapsed(d,b)}}}};IDPanel.prototype.OnToolbarClick=function(c,j){if(RD3_Glb.IsAndroid()&&c){if(Math.abs(c.clientX-this.LastTX)<10&&Math.abs(c.clientY-this.LastTY)<10&&((new Date())-this.LastTTime)<600){return}this.LastTX=c.clientX;this.LastTY=c.clientY;this.LastTTime=new Date()}this.ClearTouchScrollTimer();this.SetSwipe(false);var m=true;var l=null;var a=RD3_Glb.IsMobile()&&c&&c.target==this.SwipeButton;if(RD3_Glb.IsIE(10,true)){a=RD3_Glb.IsMobile()&&c&&c.srcElement==this.SwipeButton}if(j=="delete"&&this.ConfirmDelete&&!a){this.DoHighlightDelete(true);var e="";if(!this.ShowMultipleSel){e=RD3_Glb.FormatMessage(ClientMessages.PAN_MSG_ConfirmDeleteRS,this.Caption)}else{var k=0;for(var h=1;h<=this.TotalRows;h++){if(this.MultiSelStatus[h]){k++}}if(k==0){e=RD3_Glb.FormatMessage(ClientMessages.PAN_MSG_ConfirmDeleteNR,this.Caption)}else{if(k==1){e=RD3_Glb.FormatMessage(ClientMessages.PAN_MSG_ConfirmDeleteRS,this.Caption)}else{if(k<this.TotalRows){e=RD3_Glb.FormatMessage(ClientMessages.PAN_MSG_ConfirmDeleteRR,this.Caption,k)}else{e=RD3_Glb.FormatMessage(ClientMessages.PAN_MSG_ConfirmDeleteAR,this.Caption)}}}}this.MsgBox=new MessageBox(e,RD3_Glb.MSG_CONFIRM,false);this.MsgBox.CallBackFunction=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnDeleteConfirm', ev, 'delete')");this.MsgBox.Open();m=false}if((j=="dupl"||j=="csv")&&!a&&this.ShowMultipleSel){var k=0;for(var h=1;h<=this.TotalRows;h++){if(this.MultiSelStatus[h]){k++}}if(k==0){var e=j=="dupl"?ClientMessages.PAN_MSG_ConfirmDuplicateNR:ClientMessages.PAN_MSG_ConfirmExportNR;e=RD3_Glb.FormatMessage(e,this.Caption);this.MsgBox=new MessageBox(e,RD3_Glb.MSG_CONFIRM,false);this.MsgBox.CallBackFunction=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnDeleteConfirm', ev, '"+j+"')");this.MsgBox.Open();m=false}}if(m){var b=0;switch(j){case"list":b=(this.BlockingCommands&RD3_Glb.PCM_FORMLIST);break;case"search":b=(this.BlockingCommands&RD3_Glb.PCM_SEARCH);break;case"find":b=(this.BlockingCommands&RD3_Glb.PCM_FIND);break;case"insert":b=(this.BlockingCommands&RD3_Glb.PCM_INSERT);break;case"delete":b=(this.BlockingCommands&RD3_Glb.PCM_DELETE);break;case"cancel":b=(this.BlockingCommands&RD3_Glb.PCM_CANCEL);break;case"refresh":b=(this.BlockingCommands&RD3_Glb.PCM_REQUERY);break;case"save":b=(this.BlockingCommands&RD3_Glb.PCM_UPDATE);break;case"dupl":b=(this.BlockingCommands&RD3_Glb.PCM_DUPLICATE);break;case"print":b=(this.BlockingCommands&RD3_Glb.PCM_PRINT);break;case"attach":b=(this.BlockingCommands&RD3_Glb.PCM_ATTACH);break;case"group":b=(this.BlockingCommands&RD3_Glb.PCM_ATTACH);break;case"csv":b=(this.BlockingCommands&RD3_Glb.PCM_CSV);break;case"cb0":b=(this.BlockingCommands&RD3_Glb.PCM_CUSTOM1);break;case"cb1":b=(this.BlockingCommands&RD3_Glb.PCM_CUSTOM2);break;case"cb2":b=(this.BlockingCommands&RD3_Glb.PCM_CUSTOM3);break;case"cb3":b=(this.BlockingCommands&RD3_Glb.PCM_CUSTOM4);break;case"cb4":b=(this.BlockingCommands&RD3_Glb.PCM_CUSTOM5);break;case"cb5":b=(this.BlockingCommands&RD3_Glb.PCM_CUSTOM6);break;case"cb6":b=(this.BlockingCommands&RD3_Glb.PCM_CUSTOM7);break;case"cb7":b=(this.BlockingCommands&RD3_Glb.PCM_CUSTOM8);break;case"top":case"prev":case"next":case"bottom":b=(this.BlockingCommands&RD3_Glb.PCM_NAVIGATION);break}l=new IDEvent("pantb",this.Identifier,c,this.ToolbarEventDef|(b?RD3_Glb.EVENT_BLOCKING:0),j)}if(m&&l.ClientSide&&!b){switch(j){case"lock":this.SetLocked(true);break;case"unlock":this.SetLocked(false);break;case"insert":if(this.Locked){this.SetLocked(false)}break;case"list":RD3_DesktopManager.SendEvents();this.SetPanelMode(this.PanelMode==RD3_Glb.PANEL_LIST?RD3_Glb.PANEL_FORM:RD3_Glb.PANEL_LIST,true);if(this.PanelMode==RD3_Glb.PANEL_FORM){var f=this.ActualRow;this.SetActualRow(0);this.SetActualPosition(this.ActualPosition+f)}else{var g=this.ActualPosition;var f=0;if(g-this.ListPos>=this.NumRows){f=this.NumRows-1;g-=f}else{if(g-this.ListPos<0){f=0}else{f=g-this.ListPos;g=this.ListPos}}if(g>this.TotalRows){g=(this.TotalRows<1)?1:this.TotalRows;f=0}var p=(f!=this.ActualRow)?f:undefined;this.SetActualRow(p);var p=(g!=this.ActualPosition)?g:undefined;this.SetActualPosition(p)}this.UpdateScrollPos();break;case"top":this.ChangeActualRow(0,null);this.SetActualPosition(1,false,false);this.UpdateScrollPos();RD3_KBManager.CheckFocus=false;break;case"bottom":this.ChangeActualRow(this.NumRows-1,null);this.SetActualPosition(this.TotalRows-this.NumRows+1,false,false);this.UpdateScrollPos();RD3_KBManager.CheckFocus=false;break;case"next":var d=(this.PanelMode==RD3_Glb.PANEL_LIST)?this.NumRows:1;var o=this.ActualPosition+d-1;if(o>this.TotalRows-d+1){o=this.TotalRows-d+1}this.SetActualPosition(o,false,true);this.UpdateScrollPos();break;case"prev":var d=(this.PanelMode==RD3_Glb.PANEL_LIST)?this.NumRows:1;var o=this.ActualPosition-d+1;if(o<1){o=1}this.SetActualPosition(o,false,true);this.UpdateScrollPos();break}}if(m&&j=="save"&&RD3_Glb.IsIE()&&RD3_KBManager.ActiveObject&&RD3_KBManager.ActiveObject instanceof PField&&RD3_KBManager.ActiveObject.EditorType==1){document.body.tabIndex=0;window.setTimeout("RD3_KBManager.ActiveObject = null; RD3_KBManager.LastActiveObject = null; RD3_KBManager.ActiveElement = null; document.body.focus();",250)}};IDPanel.prototype.OnMultiSelCmd=function(f,d){if(RD3_Glb.IsAndroid()||(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsTouch())){RD3_DDManager.ChompClick()}if(RD3_ServerParams.CompletePanelBorders&&d=="selms"){if(this.ShowMultipleSel){if(!this.MultiSelCommand){this.MultiSelCommand=new Command();this.MultiSelCommand.Identifier=this.Identifier+":msc:0";this.MultiSelCommand.IsMenu=false;RD3_DesktopManager.ObjectMap.add(this.MultiSelCommand.Identifier,this.MultiSelCommand);var a=new Command();a.Identifier=this.Identifier+":msc:1";a.IsMenu=false;a.Caption=ClientMessages.TIP_TITLE_TooltipSelectAll;a.Image="pansel1.gif";a.ParentCmdSet=this.MultiSelCommand;a.ClickEventDef=RD3_Glb.EVENT_CLIENTSIDE;a.CallBackFunction=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelCmd', ev, 'selall')");RD3_DesktopManager.ObjectMap.add(a.Identifier,a);this.MultiSelCommand.Commands.push(a);var c=new Command();c.Identifier=this.Identifier+":msc:2";c.IsMenu=false;c.Caption=ClientMessages.TIP_TITLE_TooltipDeseleziona;c.Image="pansel0.gif";c.ParentCmdSet=this.MultiSelCommand;c.ClickEventDef=RD3_Glb.EVENT_CLIENTSIDE;c.CallBackFunction=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelCmd', ev, 'selnone')");RD3_DesktopManager.ObjectMap.add(c.Identifier,c);this.MultiSelCommand.Commands.push(c);var g=new Command();g.Identifier=this.Identifier+":msc:3";g.IsMenu=false;g.Caption=ClientMessages.TIP_TITLE_SelectPopupCmd;g.Image="pansel.gif";g.ParentCmdSet=this.MultiSelCommand;g.ClickEventDef=RD3_Glb.EVENT_CLIENTSIDE;g.CallBackFunction=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMultiSelCmd', ev, 'seltog')");RD3_DesktopManager.ObjectMap.add(g.Identifier,g);this.MultiSelCommand.Commands.push(g);this.MultiSelCommand.Realize();RD3_DesktopManager.WebEntryPoint.CmdObj.ClientCommands.add(this.Identifier+":cms:0",this.MultiSelCommand)}this.MultiSelCommand.Commands[0].Visible=(this.Status!=RD3_Glb.PS_QBE);this.MultiSelCommand.Commands[1].Visible=(this.Status!=RD3_Glb.PS_QBE);var b=document.createElement("SPAN");b.setAttribute("objid",this.Identifier+":ms0");b.setAttribute("dir","1");this.MultiSelCommand.Popup(b);return}else{d="seltog"}}var e=new IDEvent("pantb",this.Identifier,f,this.ToolbarEventDef,d);if(e.ClientSide){switch(d){case"seltog":this.SetShowMultipleSel(!this.ShowMultipleSel);this.AdaptLayout();break;case"selall":this.ChangeSelection(2,false);this.UpdateMultipleSel();break;case"selnone":this.ChangeSelection(0,false);this.UpdateMultipleSel();break}}};IDPanel.prototype.SetStatusBarText=function(){if(this.Realizing){return}var b="";var f=(this.SmallIcons)?"panel-toolbarsmall-status":"panel-toolbar-status";var a=(this.DOModified&&this.DOMaster)?RD3_Glb.PS_UPDATED:this.Status;switch(a){case RD3_Glb.PS_QBE:b=RD3_ServerParams.SBP_QBE;f=(this.SmallIcons)?"panel-statussmall-qbe":"panel-status-qbe";break;case RD3_Glb.PS_DATA:if(this.IsNewRow(this.ActualPosition,this.ActualRow)){b=RD3_ServerParams.SBP_INSERT}else{if(!this.ShowMultipleSel||this.PanelMode==RD3_Glb.PANEL_FORM){b=RD3_ServerParams.RigaNM;if(this.IsGrouped()&&this.PanelMode==RD3_Glb.PANEL_LIST){b=b.replace("|1",this.ListGroupRoot.GetServerIndex(this.CompactActualPosition+this.ActualRow))}else{b=b.replace("|1",(this.ActualPosition+this.ActualRow))}b=b.replace("|2",this.TotalRows)}else{var e=0;for(var c=1;c<=this.TotalRows;c++){if(this.MultiSelStatus[c]){e++}}if(e==1){b=RD3_Glb.FormatMessage(ClientMessages.PAN_STBAR_SelRow,this.TotalRows)}else{b=RD3_Glb.FormatMessage(ClientMessages.PAN_STBAR_SelRows,this.TotalRows,e)}}if(this.MoreRows){b+="+"}}f=(this.SmallIcons)?"panel-statussmall-data":"panel-status-data";break;case RD3_Glb.PS_UPDATED:b=RD3_ServerParams.SBP_UPD;f=(this.SmallIcons)?"panel-statussmall-updated":"panel-status-updated";break}if(!this.DOSingleDoc||(this.DOMaster&&this.DOModified)){this.StatusBar.className=f;this.StatusBar.innerHTML="&nbsp;"+b;var d=this.CaptionTxt.innerHTML;if(d!=""&&d.substr(d.length-1,1)!=":"&&!this.Collapsed&&this.ShowStatusBar){this.CaptionTxt.innerHTML+=":"}}else{this.StatusBar.className="";this.StatusBar.innerHTML="";var d=this.CaptionTxt.innerHTML;if(d.substr(d.length-1,1)==":"){this.CaptionTxt.innerHTML=d.substr(0,d.length-1)}}if(this.ToolbarBox.scrollLeft&&this.TBScrollTimer==0&&!RD3_Glb.IsTouch()){this.ScrollToolbar(-1)}};IDPanel.prototype.UpdateToolbar=function(){this.SetPullToRefresh();if(this.AnimatingToolbar){return}var O=(this.PanelMode==RD3_Glb.PANEL_LIST)?this.NumRows:1;var d=this.Status==RD3_Glb.PS_DATA&&(RD3_ServerParams.AllowMasterPanelNavigation||!this.DOMaster||!this.DOModified);if(this.ScrollBox){var p=d&&(this.GetTotalRows()>O||this.ActualPosition>1);this.LastPositionTime=new Date();this.ScrollBoxInt.style.height=p?this.ScrollBoxInt.getAttribute("idheight"):"0px";if(p&&this.PanelMode==RD3_Glb.PANEL_LIST&&this.GetTotalRows()<=this.NumRows&&this.ActualPosition!=1){var l=1+(this.GetTotalRows()-this.ActualPosition);this.ScrollBoxInt.style.height=((this.GetTotalRows()-1)+(this.NumRows-l))*this.GetRowHeight()+this.MaxHRow+"px"}if(parseInt(this.ScrollBoxInt.getAttribute("idtop"))>0){this.SkipScroll=p?parseInt("0"+this.ScrollBoxInt.getAttribute("idtop"),10):0;this.ScrollBox.scrollTop=p?this.ScrollBoxInt.getAttribute("idtop"):"0px"}this.UpdateScrollTouch()}if(this.ToolbarBox.offsetWidth==0){if(RD3_Glb.IsMobile()&&this.ScrollBoxMobile){this.ScrollBoxMobile.style.display=(this.PanelMode==RD3_Glb.PANEL_LIST?"":"none")}var K=this.Fields.length;for(var N=0;N<K;N++){this.Fields[N].UpdateToolbar()}return}var s=this.IsNewRow(this.ActualPosition,this.ActualRow);var g=RD3_Glb.IsMobile();var J=(RD3_DDManager.OpenCombo&&RD3_DDManager.OpenCombo.Owner.ParentField.ParentPanel==this&&!RD3_DDManager.OpenCombo.IsPopOver());var e=d&&this.IsCommandEnabled(RD3_Glb.PCM_NAVIGATION)&&(this.GetTotalRows()>O||this.ActualPosition>1);this.TopButton.style.display=e?"":"none";this.PrevButton.style.display=e?"":"none";this.NextButton.style.display=e?"":"none";this.BottomButton.style.display=e?"":"none";var c=this.Status==RD3_Glb.PS_DATA&&this.QBETip.length>0&&this.ShowStatusBar&&!this.Collapsed;this.QBETIcon.style.display=c?"":"none";var j=this.IsCommandEnabled(RD3_Glb.PCM_SEARCH)&&d&&this.CanSearch;this.SearchButton.style.display=j?"":"none";var z=this.CanSearch&&this.PanelMode==RD3_Glb.PANEL_LIST&&this.Locked;if(g){this.SearchBox.style.display=z?"":"none";if(this.SearchMargin){this.SearchMargin.style.display=z?"":"none"}}var Q=this.IsCommandEnabled(RD3_Glb.PCM_FIND)&&this.Status==RD3_Glb.PS_QBE&&this.CanSearch;this.FindButton.style.display=Q?"":"none";var o=this.IsCommandEnabled(RD3_Glb.PCM_FORMLIST)&&(this.Status!=RD3_Glb.PS_QBE||!this.AutomaticLayout)&&(this.Status==RD3_Glb.PS_QBE||d)&&this.HasList&&this.HasForm;if(g){o&=this.PanelMode==RD3_Glb.PANEL_FORM&&this.Locked;this.FormListButtonCnt.style.display=o?"":"none"}else{this.FormListButton.style.display=o?"":"none"}if((RD3_ServerParams.Theme=="seattle"||RD3_ServerParams.Theme=="zen")&&!g){var P=(this.SmallIcons?"_sm":"")+".gif";this.FormListButton.src=RD3_Glb.GetImgSrc("images/"+(this.PanelMode==RD3_Glb.PANEL_LIST?"listf":"list")+P)}var y=this.IsCommandEnabled(RD3_Glb.PCM_CANCEL)&&((this.Status==RD3_Glb.PS_UPDATED||(g&&!this.Locked&&this.Lockable))&&(this.CanUpdate||this.CanInsert)||this.Status==RD3_Glb.PS_QBE||this.DOModified);if(g){y&=(this.PanelMode==RD3_Glb.PANEL_FORM||!this.HasForm)&&!J}this.CancelButton.style.display=y?"":"none";var B=this.IsCommandEnabled(RD3_Glb.PCM_REQUERY)&&this.Status!=RD3_Glb.PS_QBE&&(!this.IsDO||this.HasDocTemplate);if(g){B&=this.PanelMode==RD3_Glb.PANEL_LIST&&this.Locked&&!this.ShowMultipleSel}this.RefreshButton.style.display=B?"":"none";var b=this.IsCommandEnabled(RD3_Glb.PCM_DELETE)&&(!this.Locked||g)&&this.Status==RD3_Glb.PS_DATA&&this.CanDelete;if(g){b&=(this.PanelMode==RD3_Glb.PANEL_FORM||!this.HasForm||this.ShowMultipleSel)&&this.Locked;b&=!this.IsNewRow(this.ActualPosition,this.ActualRow)}this.DelButton.style.display=b?"":"none";var A=this.IsCommandEnabled(RD3_Glb.PCM_INSERT)&&(!this.Locked||this.EnableInsertWhenLocked||(this.IsDO&&this.DOSingleDoc&&s))&&(this.Status==RD3_Glb.PS_QBE||d)&&this.CanInsert;if(g){A&=this.PanelMode==RD3_Glb.PANEL_LIST&&!this.ShowMultipleSel}this.NewButton.style.display=A?"":"none";var I=this.IsCommandEnabled(RD3_Glb.PCM_DUPLICATE)&&!this.Locked&&d&&this.CanInsert&&!s;this.DuplButton.style.display=I?"":"none";var C=this.IsCommandEnabled(RD3_Glb.PCM_UPDATE)&&!this.Locked&&this.Status!=RD3_Glb.PS_QBE&&(this.CanInsert||this.CanUpdate||(this.DOModified&&this.DOCanSave));if(g){C&=!J&&((!this.Locked&&(this.PanelMode==RD3_Glb.PANEL_FORM||!this.HasForm))||this.Status==RD3_Glb.PS_UPDATED)}this.SaveButton.style.display=C?"":"none";var w=this.IsCommandEnabled(RD3_Glb.PCM_PRINT)&&d&&this.HasBook;this.PrintButton.style.display=w?"":"none";var x=this.IsCommandEnabled(RD3_Glb.PCM_GROUP)&&this.Status==RD3_Glb.PS_DATA&&this.PanelMode==RD3_Glb.PANEL_LIST&&this.GroupingEnabled&&!g;this.GroupButton.style.display=x?"":"none";var t=(this.SmallIcons?"_sm":"")+".gif";if(!g){this.GroupButton.src=RD3_Glb.GetImgSrc("images/"+(this.ShowGroups?"grpdis":"grpen")+t)}var G=this.IsCommandEnabled(RD3_Glb.PCM_CSV)&&d&&this.PanelMode==RD3_Glb.PANEL_LIST;this.CsvButton.style.display=G?"":"none";var v=this.IsCommandEnabled(RD3_Glb.PCM_ATTACH);this.AttachButton.style.display=v?"":"none";var q=this.Lockable&&this.Locked&&!this.Collapsed&&(this.PanelMode==RD3_Glb.PANEL_FORM||!this.HasForm)&&!this.ShowMultipleSel;if(g){q&=!this.IsNewRow(this.ActualPosition,this.ActualRow);this.LockButton.style.display=q?"":"none";var M=this.PanelMode==RD3_Glb.PANEL_LIST;if(this.ScrollBoxMobile){this.ScrollBoxMobile.style.display=M?"":"none"}}var k=false;if(g){k=this.PanelMode==RD3_Glb.PANEL_LIST&&this.Locked&&this.EnableMultipleSel&&this.ShowToolbar;this.MulSelButton.style.display=k?"":"none"}if(this.CustomButtons){var R=262144;var K=this.CustomButtons.length;for(var N=0;N<K;N++){if(N==8){R=-1}this.CustomButtons[N].style.display=(this.IsCommandEnabled(R)&&!J)?"":"none";R*=2}}if(!g){var K=this.TBZones.length;for(var N=3;N<K;N++){if(N!=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_CMDSET]){this.TBZones[N].style.display=(this.ShowToolbar)?"":"none"}}}if(g&&this.ToolbarBox.offsetWidth>0){var F=this.ToolbarBox.offsetWidth;var H=!this.Locked&&!this.HasForm;var h=RD3_Glb.IsQuadro();var u=RD3_Glb.IsMobile7();var E=(u)?45:50;if(this.PanelMode==RD3_Glb.PANEL_LIST&&!H){if(A){F-=E;this.NewButton.style.left=F+"px"}if(q){F-=E;this.LockButton.style.left=F+"px"}if(B){F-=E;this.RefreshButton.style.left=F+"px"}if(b){F-=E;this.DelButton.style.left=F+"px"}if(k){F-=E;this.MulSelButton.style.left=F+"px"}}else{if(this.Locked){if(q){F-=E;this.LockButton.style.left=F+"px"}if(b){F-=E;this.DelButton.style.left=F+"px"}}else{if(A){F-=E;this.NewButton.style.left=F+"px"}if(C){F-=E;this.SaveButton.style.left=F+"px"}if(y){this.CancelButton.style.left="4px"}}}if(this.CustomButtons){for(var N=this.CustomButtons.length-1;N>=0;N--){if(this.CustomButtons[N].style.display==""){F-=E;this.CustomButtons[N].style.left=F+"px"}}}if(h&&z&&!RD3_Glb.IsSmartPhone()){F-=this.SearchBox.offsetWidth+16;this.SearchBox.style.left=F+"px";if(this.SearchMargin){this.SearchMargin.style.left=(F+113)+"px"}}var D=this.GetCustomToolbar();if(D){D.style.right=(this.ToolbarBox.offsetWidth-F)+"px";D.style.visibility=J?"hidden":""}var L=RD3_DesktopManager.WebEntryPoint.CmdObj.MenuButton;var T=this.WebForm.BackButtonCnt;if((T&&T.parentNode==this.ToolbarBox)||(L&&L.parentNode==this.ToolbarBox)){var S=0;if(T&&T.parentNode==this.ToolbarBox){T.style.visibility=o||y||J?"hidden":"";if(!o){S=(T.offsetLeft+T.offsetWidth+8)}}if(L&&L.parentNode==this.ToolbarBox){if(T&&T.parentNode==this.ToolbarBox&&T.style.visibility==""){L.style.visibility="hidden"}else{var f=o||y||J?"hidden":"";if(f==""&&RD3_Glb.IsSmartPhone()){if(!this.WebForm.HasBackButton()){f="hidden"}else{if(this.WebForm.BackButtonTxt){RD3_DesktopManager.WebEntryPoint.CmdObj.SetMenuButtonCaption(this.WebForm.BackButtonTxt)}}}L.style.visibility=f;if(f==""&&L.style.display!="none"){var r=RD3_Glb.IsSmartPhone()?L.lastChild:L;S+=(r.offsetLeft+r.offsetWidth+8)}}}if(!h){this.SearchBox.style.left=S==0?"":S+"px"}}if(D){RD3_Glb.AdjustCustomToolbar(D,this.ToolbarBox)}RD3_Glb.AdjustCaptionPosition(this.ToolbarBox,this.CaptionTxt);if(this.ShowStatusBar){this.CaptionTxt.style.width=""}}var K=this.Fields.length;for(var N=0;N<K;N++){this.Fields[N].UpdateToolbar()}this.AdaptScrollBox();this.RefreshToolbar=false};IDPanel.prototype.IsCommandEnabled=function(a){if(a>0){return(this.EnabledCommands&a)&&(this.ShowToolbar||a==RD3_Glb.PCM_BLOBEDIT||a==RD3_Glb.PCM_BLOBDELETE||a==RD3_Glb.PCM_BLOBNEW||a==RD3_Glb.PCM_BLOBSAVEAS)&&!this.Collapsed}else{return(this.ExtEnabledCommands&Math.abs(a))&&this.ShowToolbar&&!this.Collapsed}};IDPanel.prototype.UpdateGroupVisibility=function(c){if(this.Realized){var a=false;var d=this.Fields.length;for(var b=0;b<d;b++){if(this.Fields[b].Group==c){if(this.PanelMode==RD3_Glb.PANEL_LIST&&this.Fields[b].ListList){this.RecalcLayout=true;break}else{if(c.IsVisible()){a=true}}this.Fields[b].UpdateFieldVisibility()}}if(a){this.AdaptFormListLayout()}}};IDPanel.prototype.UpdateGroupEnability=function(b){if(this.Realized){var c=this.Fields.length;for(var a=0;a<c;a++){if(this.Fields[a].Group==b){this.Fields[a].SetEnabled()}}}};IDPanel.prototype.UpdatePageEnability=function(b){if(this.Realized){var c=this.Fields.length;for(var a=0;a<c;a++){if(this.Fields[a].Page==b){this.Fields[a].SetEnabled()}}}};IDPanel.prototype.RowSelWidth=function(){var a=RD3_ClientParams.RowSelWidth+(RD3_ServerParams.Theme=="zen"?14:0);return(this.ShowRowSelector?a:0)};IDPanel.prototype.GetRowHeight=function(){return this.MaxHRow+this.VisStyle.GetRowOffset()};IDPanel.prototype.OnRowSelectorClick=function(f,h){var g=undefined;if(h!=undefined){g=h}else{var b=(window.event)?window.event:f;var e=(window.event)?window.event.srcElement:f.target;var d=e.id.indexOf(":rs");g=parseInt(e.id.substring(d+3))}var a=0;if(this.IsGrouped()){a=this.ListGroupRoot.GetServerIndex(this.CompactActualPosition+g,true)}var c=new IDEvent("panrs",this.Identifier,b,this.RowSelectEventDef,g,a);if(c.ClientSide){this.ChangeActualRow(g);RD3_KBManager.CheckFocus=false}return true};IDPanel.prototype.OnMultiSelClick=function(b,d){var g=(window.event)?window.event:b;var e=(window.event)?window.event.srcElement:b.target;var c=e.id.indexOf(":rs");var i=parseInt(e.id.substring(c+3));if(d!=undefined){i=d}if(this.ShowMultipleSel){var f=i;if(this.IsGrouped()){f=this.IsHeader(i);if(f==-1){return true}}var a=e.checked;if(RD3_Glb.IsMobile()){a=!this.MultiSelStatus[this.IsGrouped()?f:this.ActualPosition+i]}var h=new IDEvent("panms",this.Identifier,g,this.MultiSelEventDef,f,a?"-1":"0");if(h.ClientSide){if(this.IsGrouped()){this.MultiSelStatus[f]=a}else{this.MultiSelStatus[this.ActualPosition+i]=a}this.SetStatusBarText()}}return true};IDPanel.prototype.AfterProcessResponse=function(){WebFrame.prototype.AfterProcessResponse.call(this);if(this.ResetPosition||this.UpdateListGroups){this.SetActualPosition(undefined,undefined,this.ScrollToPos&&!this.DenyScroll);this.ResetPosition=false;this.ScrollToPos=false}if(this.QbeScroll){this.QbeScroll=false;this.UpdateScrollPos()}if(this.RefreshToolbar){this.UpdateToolbar()}if(this.UpdateRSel){this.UpdateRSel=false;this.UpdateRowSel()}if(this.AdaptFieldsSortImage){this.AdaptFieldsSortImage=false;var d=this.Fields.length;for(var b=0;b<d;b++){var c=this.Fields[b];c.AdaptSortImage()}}this.OldAttR=this.ActualRow;var d=this.Fields.length;for(var b=0;b<d;b++){this.Fields[b].AfterProcessResponse()}if(this.OrgMarginTop!=undefined){var a=this.IDScroll.PullTrigger;this.IDScroll.PullTrigger=0;this.IDScroll.MarginTop=0;this.IDScroll.ChangeSize(true);this.IDScroll.PullTrigger=a;this.IDScroll.MarginTop=this.OrgMarginTop;this.OrgMarginTop=undefined}};IDPanel.prototype.OnLockClick=function(a){this.OnToolbarClick(a,this.Locked?"unlock":"lock")};IDPanel.prototype.Focus=function(b){if(this.Collapsed||!this.Visible){return false}if(this.ParentTab&&this.ParentFrame&&this.ParentFrame.GetSelectedFrame()!=this){return false}var c=b?0:this.ActualRow;var d=this.Fields.length;for(var a=0;a<d;a++){if(this.Fields[a].CanHaveFocus(c)&&this.Fields[a].Focus(null,c)){return true}}return false};IDPanel.prototype.HandlesTabFocus=function(){if(this.ParentFrameIdentifier&&(!this.CanUpdate&&!this.CanUpdate)){return false}return true};IDPanel.prototype.ChangeActualRow=function(f,g){var e=this.ActualRow;if(f!=e){var a=this.ScrollEventDef;if(g){var b=0;if(this.IsGrouped()){b=this.ListGroupRoot.GetServerIndex(this.CompactActualPosition+f,true)}var d=new IDEvent("chgrow",this.Identifier,g,a,null,f,b)}if(!g||d.ClientSide){this.SetActualRow(f);var h=this.Fields.length;for(var c=0;c<h;c++){this.Fields[c].SetActualPosition(this.ActualPosition,e,f)}this.SetStatusBarText();this.ResetPosition=false}}};IDPanel.prototype.UpdateScrollBox=function(){if(this.ScrollBoxInt){var b=(this.TotalRows-1)*this.GetRowHeight()+this.MaxHRow;if(this.PanelMode==RD3_Glb.PANEL_LIST&&this.GetTotalRows()<=this.NumRows&&this.ActualPosition!=1){var a=1+(this.GetTotalRows()-this.ActualPosition);b=((this.GetTotalRows()-1)+(this.NumRows-a))*this.GetRowHeight()+this.MaxHRow}if(this.IsGrouped()){var c=this.ListGroupRoot.GetNumRows()-1;if(this.TotalRows>this.ListGroupRoot.EndingRecord){c+=this.TotalRows-this.ListGroupRoot.EndingRecord}b=c*this.GetRowHeight()+this.MaxHRow}if(b<0){b=0}this.ScrollBoxInt.style.height=(b+1)+"px";this.ScrollBoxInt.setAttribute("idheight",this.ScrollBoxInt.style.height);this.UpdateScrollPos()}};IDPanel.prototype.UpdateScrollTouch=function(){if(this.ScrollBoxTouch){if(this.TotalRows==0||this.Status==RD3_Glb.PS_QBE){this.ScrollIntTouch.style.display="none"}else{var d=this.ScrollBoxTouch.offsetHeight;var c=this.ScrollIntTouch.offsetHeight;var b=Math.ceil(d*this.NumRows/this.TotalRows);if(b<24){b=24}this.ScrollIntTouch.style.height=b+"px";var a=Math.ceil(d*(this.ActualPosition-1)/this.TotalRows);if(a>d-c){a=d-c}this.ScrollIntTouch.style.top=a+"px";this.ScrollIntTouch.style.display=""}}};IDPanel.prototype.MoveScrollTouch=function(b){if(this.ScrollBoxTouch&&this.TotalRows>0&&this.Status!=RD3_Glb.PS_QBE){var a=(b-RD3_Glb.GetScreenTop(this.ScrollBoxTouch))/this.ScrollBoxTouch.offsetHeight;if(a<0){a=0}if(a>1){a=1}this.LastPositionTime=0;this.ScrollBox.scrollTop=a*this.ScrollBoxInt.offsetHeight;this.UpdateScrollTouch()}};IDPanel.prototype.UpdateScrollPos=function(){if(this.Realizing){return}if(this.ScrollBox){this.LastPositionTime=new Date();var a=(this.ActualPosition-1)*this.GetRowHeight();if(this.IsGrouped()){a=(this.CompactActualPosition-1)*this.GetRowHeight()}this.SkipScroll=a;this.ScrollBoxInt.setAttribute("idtop",a);this.ScrollBox.scrollTop=a;this.UpdateScrollTouch()}};IDPanel.prototype.HandleFunctionKeys=function(e){var f=(e.charCode)?e.charCode:e.keyCode;var d=false;var g=this.Fields.length;for(var c=0;c<g&&!d;c++){d=this.Fields[c].FieldFunctionKeys(e)}if(d){return d}d=RD3_DesktopManager.WebEntryPoint.CmdObj.HandleFunctionKeys(e,this.WebForm.IdxForm,this.WebForm.GetFrameIndex(this)+1);if(d){return d}var b=(f-111)+(e.shiftKey?12:0)+(e.ctrlKey?24:0);var a=(this.ToolbarBox!=null&&this.ToolbarBox.style.display!="none");if(b==RD3_ClientParams.FKEnterQBE&&a&&this.SearchButton.style.display==""){d=true;this.OnToolbarClick(e,"search")}if(b==RD3_ClientParams.FKFindData&&a&&this.FindButton.style.display==""){d=true;this.OnToolbarClick(e,"find")}if(b==RD3_ClientParams.FKFormList&&a&&this.FormListButton.style.display==""){d=true;this.OnToolbarClick(e,"list")}if(b==RD3_ClientParams.FKRefresh&&a&&this.RefreshButton.style.display==""){d=true;this.OnToolbarClick(e,"refresh")}if(b==RD3_ClientParams.FKCancel&&a&&this.CancelButton.style.display==""){d=true;this.OnToolbarClick(e,"cancel")}if(b==RD3_ClientParams.FKInsert&&a&&this.NewButton.style.display==""){d=true;this.OnToolbarClick(e,"insert")}if(b==RD3_ClientParams.FKDelete&&a&&this.DelButton.style.display==""){d=true;this.OnToolbarClick(e,"delete")}if(b==RD3_ClientParams.FKUpdate&&a&&this.SaveButton.style.display==""){d=true;this.OnToolbarClick(e,"save")}if(b==RD3_ClientParams.FKDuplicate&&a&&this.DuplButton.style.display==""){d=true;this.OnToolbarClick(e,"dupl")}if(b==RD3_ClientParams.FKPrint&&a&&this.PrintButton.style.display==""){d=true;this.OnToolbarClick(e,"print")}if(b==RD3_ClientParams.FKSelAll&&this.MultiSelectAllCmd.style.display==""){d=true;this.OnMultiSelCmd(e,"selall")}if(b==RD3_ClientParams.FKSelNone&&this.MultiSelectNoneCmd.style.display==""){d=true;this.OnMultiSelCmd(e,"selnone")}if(b==RD3_ClientParams.FKSelTog&&this.ToggleMultiSelCmd.style.display==""){d=true;this.OnMultiSelCmd(e,"seltog")}if(b==RD3_ClientParams.FKLocked&&a&&this.LockButton.style.display==""){d=true;this.OnLockClick(e)}if(b==RD3_ClientParams.FKActRow){d=true;this.OnRowSelectorClick(e,this.ActualRow)}if(b==RD3_ClientParams.FKActField&&RD3_KBManager.ActiveObject&&RD3_KBManager.ActiveObject.ParentPanel==this){d=true;RD3_KBManager.ActiveObject.OnClickActivator(e)}if(!d){d=WebFrame.prototype.HandleFunctionKeys.call(this,e)}return d};IDPanel.prototype.FocusNextField=function(d,h){var e=false;var j=this.ActualRow;var g=false;var i=this.GetNextField(d);if(!i){e=true;i=this.GetFirstField();if(this.ActualRow<this.NumRows-1){j++}else{g=true}}while(i!=d&&i&&!i.CanHaveFocus()){i=this.GetNextField(i);if(!i){e=true;i=this.GetFirstField();if(this.ActualRow<this.NumRows-1){j++}else{g=true}}}var a=g&&this.ActualPosition+this.NumRows-1>=this.TotalRows;if(e&&(a||this.Status==RD3_Glb.PS_QBE||this.PanelMode==RD3_Glb.PANEL_FORM)){this.WebForm.Focus(this,true);return}if(this.PanelMode==RD3_Glb.PANEL_FORM){g=false}if(i){var b=i.IsEnabled();i.Focus(h,j,b);var c=RD3_KBManager.GetActiveElement();if(c&&(RD3_Glb.IsEditFld(c)||c.tagName=="TEXTAREA")&&!b){setCursorPos(c,0)}}if(g&&this.ActualPosition<this.TotalRows-this.NumRows+1){this.ScrollTo(this.ActualPosition+1,h);this.UpdateScrollPos()}};IDPanel.prototype.FocusPrevField=function(d,h){var e=false;var i=this.GetPrevField(d);var j=this.ActualRow;var g=false;if(!i){e=true;i=this.GetLastField();if(this.ActualRow>0){j--}else{g=true}}while(i!=d&&i&&!i.CanHaveFocus()){i=this.GetPrevField(i);if(!i){e=true;i=this.GetLastField();if(this.ActualRow>0){j--}else{g=true}}}var a=g&&this.ActualPosition==1;if(e&&(a||this.Status==RD3_Glb.PS_QBE||this.PanelMode==RD3_Glb.PANEL_FORM)){this.WebForm.Focus(this,false);return}if(this.PanelMode==RD3_Glb.PANEL_FORM){g=false}if(i){var b=i.IsEnabled();i.Focus(h,j,b);var c=RD3_KBManager.GetActiveElement();if(c&&(RD3_Glb.IsEditFld(c)||c.tagName=="TEXTAREA")&&!b){setCursorPos(c,c.value.length)}}if(g&&this.ActualPosition>1){this.ScrollTo(this.ActualPosition-1,h);this.UpdateScrollPos()}};IDPanel.prototype.GetFirstField=function(){var c=this.Fields.length;for(var a=0;a<c;a++){var b=this.Fields[a];if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_LIST){b=this.ListTabOrder[a]}if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_FORM){b=this.FormTabOrder[a]}if(!b.IsStatic()&&b.IsVisible()){return b}}return null};IDPanel.prototype.GetLastField=function(){var c=this.Fields.length;for(var a=c-1;a>=0;a--){var b=this.Fields[a];if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_LIST){b=this.ListTabOrder[a]}if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_FORM){b=this.FormTabOrder[a]}if(!b.IsStatic()&&b.IsVisible()){return b}}return null};IDPanel.prototype.GetLastListField=function(){var c=this.Fields.length;for(var a=c-1;a>=0;a--){var b=this.Fields[a];if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_LIST){b=this.ListTabOrder[a]}if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_FORM){b=this.FormTabOrder[a]}if(!b.IsStatic()&&b.IsVisible()&&b.InList&&b.ListList){return b}}return null};IDPanel.prototype.GetNextField=function(c){var e=this.Fields.length;for(var a=0;a<e;a++){var d=this.Fields[a];if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_LIST){d=this.ListTabOrder[a]}if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_FORM){d=this.FormTabOrder[a]}if(d.Index==c.Index){break}}for(var b=a+1;b<e;b++){var d=this.Fields[b];if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_LIST){d=this.ListTabOrder[b]}if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_FORM){d=this.FormTabOrder[b]}if(d&&(!d.IsStatic()||d.IsButton())&&d.IsVisible()&&d.HandlesTabOrder()){return d}}return null};IDPanel.prototype.GetPrevField=function(c){var e=this.Fields.length;for(var a=0;a<e;a++){var d=this.Fields[a];if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_LIST){d=this.ListTabOrder[a]}if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_FORM){d=this.FormTabOrder[a]}if(d.Index==c.Index){break}}for(var b=a-1;b>=0;b--){var d=this.Fields[b];if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_LIST){d=this.ListTabOrder[b]}if(this.AdvTabOrder&&this.PanelMode==RD3_Glb.PANEL_FORM){d=this.FormTabOrder[b]}if((!d.IsStatic()||d.IsButton())&&d.IsVisible()&&d.HandlesTabOrder()){return d}}return null};IDPanel.prototype.ChangeSelection=function(e,d){var c=(this.SelAllOnlyVis&&!d?this.ActualPosition:1);var a=(this.SelAllOnlyVis&&!d?this.ActualPosition+this.NumRows-1:this.TotalRows);for(var b=c;b<=a;b++){switch(e){case 0:this.MultiSelStatus[b]=false;break;case 1:this.MultiSelStatus[b]=!this.MultiSelStatus[b];break;case 2:this.MultiSelStatus[b]=true;break}}};IDPanel.prototype.UpdateMultipleSel=function(){if(RD3_Glb.IsMobile()&&this.EnableMultipleSel){var d=-1;for(var f=0;f<this.Fields.length;f++){var a=this.Fields[f];if(a.InList&&a.ListList){var e=true;if(a.DataType==10){e=false}if(a.VisualStyle.ShowHTML()){e=false}if(e){d=f;break}}}if(d>=0){for(var f=0;f<this.Fields.length;f++){var a=this.Fields[f];if(a.InList&&a.ListList){a.UpdateMultipleSel(this.ShowMultipleSel,this.MultiSelStatus,d!=f)}}}}else{if(this.ShowMultipleSel&&this.MultiSelStatus&&this.RowSel){var h=this.RowSel.length;for(var f=0;f<h;f++){if(this.IsGrouped()){var g=this.IsNewRow(this.ActualPosition,f);var c=this.IsHeader(f);if(c==-1){g=true}var b=RD3_ServerParams.CompletePanelBorders?this.RowSel[f].firstChild:this.RowSel[f];b.disabled=g;if(!g){b.checked=this.MultiSelStatus[c]}else{b.checked=false}}else{var g=(this.ActualPosition+f>this.TotalRows||this.Status==RD3_Glb.PS_QBE);var b=RD3_ServerParams.CompletePanelBorders?this.RowSel[f].firstChild:this.RowSel[f];b.disabled=g;if(!g){b.checked=this.MultiSelStatus[this.ActualPosition+f]}else{b.checked=false}}}}}this.SetStatusBarText()};IDPanel.prototype.OnMouseOverObj=function(a){var b=(window.event)?window.event.srcElement:a.target;if(!b){return}if(b==this.QBETIcon){if(this.QBETip.length>0){this.QBETipBox.SetAnchor(RD3_Glb.GetScreenLeft(b)+(b.offsetWidth/2),RD3_Glb.GetScreenTop(b)+b.offsetHeight);this.QBETipBox.Activate()}}};IDPanel.prototype.OnMouseOutObj=function(a){var b=(window.event)?window.event.srcElement:a.target;if(!b){return}if(b==this.QBETIcon){this.QBETipBox.Deactivate(true)}};IDPanel.prototype.OnToolMouseUse=function(f,c){var b=(window.event)?window.event:f;var e=(window.event)?window.event.srcElement:f.target;if(e){var d="panel";if(e.className.indexOf("frame")>=0){d="frame"}if(!RD3_Glb.IsMobile()){e.className=d+"-toolbar-button"+((this.SmallIcons)?"-small":"")+((c=="")?"":"-"+c)}else{if(!RD3_Glb.IsTouch()){var a=RD3_Glb.HasClass(e,"panel-formlist-button")||RD3_Glb.HasClass(e,"panel-formlist-arrow");if(a){if(c=="down"){RD3_Glb.AddClass(this.FormListButton,"panel-toolbar-active");RD3_Glb.AddClass(this.FormListButtonImg,"panel-toolbar-active")}else{RD3_Glb.RemoveClass(this.FormListButton,"panel-toolbar-active");RD3_Glb.RemoveClass(this.FormListButtonImg,"panel-toolbar-active")}}}}}};IDPanel.prototype.OnDeleteConfirm=function(b,a){if(this.MsgBox){if(a=="delete"){this.DoHighlightDelete(false)}if(this.MsgBox.UserResponse=="Y"){var b=new IDEvent("pantb",this.Identifier,b,this.ToolbarEventDef,a)}this.MsgBox=null}};IDPanel.prototype.GetContentOffset=function(){var a=this.ToolbarBox.offsetHeight;if(this.PagesBox){var b=0;if(!RD3_Glb.IsMobile()||(this.PanelMode==RD3_Glb.PANEL_FORM&&!this.AnimatingPanel)){b=this.PagesBox.offsetHeight}a+=b}return a};IDPanel.prototype.ResizeForm=function(){var a=this.DeltaW;var j=this.DeltaH;var c=0;var k=0;var h=this.WebForm.ResModeW==RD3_Glb.FRESMODE_EXTEND;var g=this.WebForm.ResModeH==RD3_Glb.FRESMODE_EXTEND;var b=this.Fields.length;for(var d=0;d<b;d++){var e=this.Fields[d];if(e.InForm){if(e.FormLeft+e.FormWidth>c){c=e.FormLeft+e.FormWidth}if(e.FormTop+e.FormHeight>k){k=e.FormTop+e.FormHeight}}}if(!RD3_Glb.IsMobile()){c+=8;k+=8}if((this.ContentBox.clientWidth-a)<c&&a>0){a-=(c-(this.ContentBox.clientWidth-a));if(a<0){a=0}}if((this.ContentBox.clientHeight-j)<k&&j>0){j-=(k-(this.ContentBox.clientHeight-j));if(j<0){j=0}}if(a!=0||j!=0){var b=this.Fields.length;for(var d=0;d<b;d++){var e=this.Fields[d];if(e.InForm){e.ResizeForm(a,j,h,g)}}}this.LastFormResizeW=this.Width;this.LastFormResizeH=this.Height};IDPanel.prototype.ResizeList=function(){var m=this.DeltaW;var C=this.DeltaH;var e=this.ListLeft+this.ListWidth;var l=this.ListTop+this.ListHeight;var h=0;var D=this.WebForm.ResModeW==RD3_Glb.FRESMODE_EXTEND;var A=this.WebForm.ResModeH==RD3_Glb.FRESMODE_EXTEND;if(this.FixedColumns>0||this.ResOnlyVisFlds){e=this.ListLeft;var u=this.Fields.length;for(var x=0;x<u;x++){var E=this.Fields[x];if(E.InList&&E.ListList&&E.IsVisible()){e+=E.ListWidth}}}e+=this.RowSelWidth();if(this.ScrollBox){e+=19}if(this.FixedColumns>0){l+=19}var y=e;var t=l;var u=this.Fields.length;for(var x=0;x<u;x++){var E=this.Fields[x];if(h==0&&E.ListList){h=E.ListTop}if(E.ListList){E.OldListWidth=E.ListWidth}if(E.InList&&!E.ListList){if(E.ListLeft+E.ListWidth>y){y=E.ListLeft+E.ListWidth}if(E.ListTop+E.ListHeight>t){t=E.ListTop+E.ListHeight}}}if(!RD3_Glb.IsMobile()){e+=8;l+=8;y+=8;t+=8}var s=m;var p=C;if(this.ResOnlyVisFlds){var B=0;var o=0;var k=this.Fields.length;for(var r=0;r<k;r++){var E=this.Fields[r];if(E.InList&&E.ListList){if(E.IsVisible()){B+=E.ListWidth;if(E.UpdFldVs){E.UpdFldVs=false;o+=E.ListWidth}}else{if(E.UpdFldVs){E.UpdFldVs=false;o-=E.ListWidth}}}}if(B<this.ListWidth){m+=this.ListWidth-B}m-=o}if((this.ContentBox.clientWidth-m)<e&&m>0){m-=(e-(this.ContentBox.clientWidth-m));if(m<0){m=0}}if((this.ContentBox.clientHeight-C)<l&&C>0&&!this.Collapsed){C-=(l-(this.ContentBox.clientHeight-C));if(C<0){C=0}}if((this.ContentBox.clientWidth-s)<y&&s>0){s-=(y-(this.ContentBox.clientWidth-s));if(s<0){s=0}}if((this.ContentBox.clientHeight-p)<t&&p>0&&!this.Collapsed){p-=(t-(this.ContentBox.clientHeight-p));if(p<0){p=0}}if(s!=0||p!=0){var u=this.Fields.length;for(var x=0;x<u;x++){var E=this.Fields[x];if(E.InList&&!E.ListList){E.ResizeList(s,p,D,A)}}}if(C!=0){if(this.VResMode==RD3_Glb.RESMODE_MOVE){this.SetListTop(this.ListTop+C);var u=this.Fields.length;for(var x=0;x<u;x++){var E=this.Fields[x];if(E.InList&&E.ListList){this.Fields[x].ListTop+=C}}var G=new IDEvent("resize",this.Identifier,null,RD3_Glb.EVENT_SERVERSIDE,"top",this.ListTop,this.NumRows)}if(this.VResMode==RD3_Glb.RESMODE_STRETCH){this.SetListHeight(this.ListHeight+C);var b=Math.floor((this.ListTop+this.ListHeight-h+this.VisStyle.GetRowOffset())/this.GetRowHeight());if(b!=this.NumRows){this.SetNumRows(b);var G=new IDEvent("resize",this.Identifier,null,RD3_Glb.EVENT_SERVERSIDE,"height",this.ListHeight,b);this.ScrollTo(this.ActualPosition);this.ResetPosition=false;this.RefreshToolbar=true;RD3_DesktopManager.SendEvents()}}}if(m!=0){if(this.HResMode==RD3_Glb.RESMODE_MOVE){this.SetListLeft(this.ListLeft+m)}if(this.HResMode==RD3_Glb.RESMODE_STRETCH){var F=0;var H=m;var a=0;var w=0;var z=this.GetMaxPage();while(F++<2){for(var c=((F==1)?z:0);c<((F==1)?z+1:this.Pages.length);c++){var q=(F==1)?true:c!=z;if(F==1){m=H}else{var u=this.Fields.length;var I=0;for(var x=0;x<u;x++){var E=this.Fields[x];if(E.ListList&&E.Visible&&E.InList&&E.Page==c){I+=E.ListWidth}}m=w-a-I}while(m!=0&&q){q=false;var u=this.Fields.length;var v=-1;var x=this.LastResizedField+1;while(x!=v&&m!=0){if(v==-1){v=this.LastResizedField+1}if(v==u){v=0}if(x==u){x=0}var E=this.Fields[x];if(E.InList&&E.ListList&&E.Visible&&((E.Page==-1&&F==1)||E.Page==c)){var g=(D)?E.OrgListWidth:48;if(E.ListHResMode==RD3_Glb.RESMODE_STRETCH&&(m>0||E.ListWidth>g)){if(m>0){E.ListWidth++;m--}else{E.ListWidth--;m++}this.LastResizedField=x;q=true}}x++;if(x==u){x=0}}}}if(F==1){if(z==-1){break}var u=this.Fields.length;for(var x=0;x<u;x++){var E=this.Fields[x];if(E.ListList&&E.Visible&&E.InList){if(E.Page==-1||E.Page==z){w+=E.ListWidth}if(E.Page==-1){a+=E.ListWidth}}}}}var d=(RD3_Glb.IsMobile()?this.ListLeft:this.RowSelWidth()+this.ListLeft);var u=this.Fields.length;for(var x=0;x<u;x++){var E=this.Fields[x];if(this.AdvTabOrder){E=this.ListTabOrder[x]}if(E.ListList){E.ListLeft=d;d+=E.ListWidth;if(E.OldListWidth!=E.ListWidth){var G=new IDEvent("resize",E.Identifier,null,this.ResVisFld?RD3_Glb.EVENT_ACTIVE:RD3_Glb.EVENT_SERVERSIDE,"list",E.ListWidth,E.ListHeight,E.ListLeft,E.ListTop)}}}}}var u=this.Fields.length;for(var x=0;x<u;x++){var E=this.Fields[x];if(E.InList&&E.AggregateOfField>=0){if(E.OffsetFromList==undefined){E.OffsetFromList=E.ListTop-this.ListHeight-this.ListTop}E.SetListTop(this.ListTop+this.ListHeightRounded+E.OffsetFromList)}}this.LastListResizeW=this.Width;this.LastListResizeH=this.Height};IDPanel.prototype.GetMaxPage=function(){if(this.Pages.length==0){return -1}var a=0;var g=0;for(var d=0;d<this.Pages.length;d++){var b=0;for(var c=0;c<this.Fields.length;c++){var e=this.Fields[c];if(e.Page==d&&e.Visible&&e.ListList&&e.InList){b+=e.ListWidth}}if(b>a){a=b;g=d}}return g};IDPanel.prototype.UpdateNotNullFields=function(){if(this.Realizing){return}var c=this.Fields.length;for(var a=0;a<c;a++){var b=this.Fields[a];if(!b.Optional&&!b.IsStatic()){b.SetVisualStyle()}}};IDPanel.prototype.OnScrollListList=function(a){if(RD3_Glb.IsIE()){this.ListListBox.scrollTop=0;this.ListListBox.scrollLeft=0}};IDPanel.prototype.NoScroll=function(a){var b=a.target?a.target:a.srcElement;b.scrollTop=0;b.scrollLeft=0};IDPanel.prototype.OnMouseDownObj=function(c,b){var a=(window.event)?window.event:c;var b=(window.event)?window.event.srcElement:c.target;if(b&&!RD3_Glb.IsIE()&&(b==this.TopButton||b==this.PrevButton||b==this.NextButton||b==this.BottomButton||b==this.SearchButton||b==this.FindButton||b==this.CancelButton||b==this.FormListButton||b==this.RefreshButton||b==this.DelButton||b==this.NewButton||b==this.DuplButton||b==this.SaveButton||b==this.PrintButton||b==this.CsvButton||b==this.AttachButton||b==this.GroupButton)){this.OnToolMouseUse(c,"down")}};IDPanel.prototype.UpdateRowSel=function(){var d=this.NumRows;for(var c=0;c<d;c++){if(!this.IsGrouped()){var b=this.Fields[0].PValues[this.ActualPosition+c];if(b){b.UpdateRowSel()}}else{var a=this.GetRowIndex(c,RD3_Glb.PANEL_LIST);var b=this.Fields[0].PValues[b];if(b){b.UpdateRowSel(c)}}}};IDPanel.prototype.Tick=function(){if(this.DelayedListUpdate){this.DelayedListUpdate=false;var c=this.Fields.length;for(var a=0;a<c;a++){var b=this.Fields[a];if(b.DelayedUpdate){this.DelayedListUpdate=true;b.HandleDelayedUpdate();break}}}};IDPanel.prototype.OnFrameClick=function(b,k,c,h,g,m,e,j){var l=-1;var d=-1;var a=RD3_Glb.GetRD3ObjectId(j);if(a==undefined){return}if(a.substr(0,4)=="fld:"){d=parseInt(a.substr(4),10);if(a.indexOf(":fv")>0){l=0}if(a.indexOf(":lv")>0){l=parseInt(a.substr(a.indexOf(":lv")+3),10)}var i=RD3_KBManager.GetCell(j);if(i){i.RemoveWatermark()}}var f=new IDEvent("rawclk",this.Identifier,b,k?this.MouseDoubleClickEventDef:this.MouseClickEventDef,k,c,Math.floor(m)+"-"+Math.floor(e),Math.floor(h)+"-"+Math.floor(g),d,null,false,l)};IDPanel.prototype.GetTooltip=function(e,f){var d=false;if(f==this.TopButton){e.SetTitle(ClientMessages.TIP_TITLE_PanelInizio);e.SetText(RD3_ServerParams.PanelInizio);d=true}else{if(f==this.PrevButton){e.SetTitle(ClientMessages.TIP_TITLE_PanelPaginaPrec);e.SetText(RD3_ServerParams.PanelPaginaPrec);d=true}else{if(f==this.NextButton){e.SetTitle(ClientMessages.TIP_TITLE_PanelPaginaSucc);e.SetText(RD3_ServerParams.PanelPaginaSucc);d=true}else{if(f==this.BottomButton){e.SetTitle(ClientMessages.TIP_TITLE_PanelFine);e.SetText(RD3_ServerParams.PanelFine);d=true}else{if(f==this.SearchButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipCerca);e.SetText(RD3_ServerParams.TooltipCerca+RD3_KBManager.GetFKTip(RD3_ClientParams.FKEnterQBE));d=true}else{if(f==this.FindButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipTrova);e.SetText(RD3_ServerParams.TooltipTrova+RD3_KBManager.GetFKTip(RD3_ClientParams.FKFindData));d=true}else{if(f==this.FormListButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipFormList);e.SetText(RD3_ServerParams.TooltipFormList+RD3_KBManager.GetFKTip(RD3_ClientParams.FKFormList));d=true}else{if(f==this.CancelButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipCancel);e.SetText(RD3_ServerParams.TooltipCancel+RD3_KBManager.GetFKTip(RD3_ClientParams.FKCancel));d=true}else{if(f==this.RefreshButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipRefresh);e.SetText(RD3_ServerParams.TooltipRefresh+RD3_KBManager.GetFKTip(RD3_ClientParams.FKRefresh));d=true}else{if(f==this.DelButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipDelete);e.SetText(RD3_ServerParams.TooltipDelete+RD3_KBManager.GetFKTip(RD3_ClientParams.FKDelete));d=true}else{if(f==this.NewButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipInsert);e.SetText(RD3_ServerParams.TooltipInsert+RD3_KBManager.GetFKTip(RD3_ClientParams.FKInsert));d=true}else{if(f==this.DuplButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipDuplicate);e.SetText(RD3_ServerParams.TooltipDuplicate+RD3_KBManager.GetFKTip(RD3_ClientParams.FKDuplicate));d=true}else{if(f==this.SaveButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipUpdate);e.SetText(RD3_ServerParams.TooltipUpdate+RD3_KBManager.GetFKTip(RD3_ClientParams.FKUpdate));d=true}else{if(f==this.PrintButton){e.SetTitle(ClientMessages.TIP_TITLE_Print);e.SetText(RD3_ServerParams.Print+RD3_KBManager.GetFKTip(RD3_ClientParams.FKPrint));d=true}else{if(f==this.CsvButton){e.SetTitle(ClientMessages.TIP_TITLE_TooltipExport);e.SetText(RD3_ServerParams.TooltipExport);d=true}else{if(f==this.AttachButton){e.SetTitle(ClientMessages.TIP_TITLE_ComandoAllegati);e.SetText(RD3_ServerParams.ComandoAllegati);d=true}else{if(f==this.GroupButton){e.SetTitle(ClientMessages.TIP_TITLE_ComandoGruppi);e.SetText(RD3_ServerParams.ComandoGruppi);d=true}else{var b=RD3_DesktopManager.WebEntryPoint.CustomCommands;var g=b.length;for(var c=0;c<g;c++){if(f==this.CustomButtons[c]){e.SetTitle(b[c].Caption);e.SetText(b[c].Tooltip+RD3_KBManager.GetFKTip(b[c].FKNum));d=true;break}}}}}}}}}}}}}}}}}}}if(f==this.ToggleMultiSelCmd){e.SetTitle(ClientMessages.TIP_TITLE_TooltipRowSel);if(RD3_ServerParams.CompletePanelBorders&&this.ShowMultipleSel){e.SetText(RD3_ServerParams.TooltipMultipleCommandset+RD3_KBManager.GetFKTip(RD3_ClientParams.FKSelTog))}else{e.SetText((this.ShowMultipleSel)?RD3_ServerParams.TooltipShowRowSel:RD3_ServerParams.TooltipShowCheck)+RD3_KBManager.GetFKTip(RD3_ClientParams.FKSelTog)}d=true}else{if(f==this.MultiSelectAllCmd){e.SetTitle(ClientMessages.TIP_TITLE_TooltipSelectAll);e.SetText(RD3_ServerParams.TooltipSelectAll+RD3_KBManager.GetFKTip(RD3_ClientParams.FKSelAll));d=true}else{if(f==this.MultiSelectNoneCmd){e.SetTitle(ClientMessages.TIP_TITLE_TooltipDeseleziona);e.SetText(RD3_ServerParams.TooltipDeseleziona+RD3_KBManager.GetFKTip(RD3_ClientParams.FKSelNone));d=true}}}if(d){e.SetAnchor(RD3_Glb.GetScreenLeft(f)+((f.offsetWidth-4)/2),RD3_Glb.GetScreenTop(f));e.SetPosition(0);return true}else{return WebFrame.prototype.GetTooltip.call(this,e,f)}};IDPanel.prototype.ChangeListConfiguration=function(k,g,b){if(k==g){return}var f,c;if(this.AdvTabOrder){if(k.ListTabOrder==g.ListTabOrder-1){return}}else{var e=-1;var d=-1;c=this.Fields.length;for(f=0;f<c;f++){if(this.Fields[f]==k){e=f}if(this.Fields[f]==g){d=f}}if(e==-1||d==-1||e==d-1){return}}if(g.Group&&k.Group!==g.Group){c=this.Fields.length;for(f=0;f<c;f++){var a=this.Fields[f];if(this.AdvTabOrder){a=this.ListTabOrder[f]}if(a.Group==g.Group){g=a;break}}}var j=[];if(k.Group&&k.Group!==g.Group){c=this.Fields.length;for(f=0;f<c;f++){var a=this.Fields[f];if(this.AdvTabOrder){a=this.ListTabOrder[f]}if(a.Group==k.Group){j.push(a)}}}else{j.push(k)}for(f=0;f<j.length;f++){var h=new IDEvent("rdcol",this.Identifier,b,RD3_Glb.EVENT_ACTIVE,"",j[f].Identifier,g.Identifier);this.ReorderList(j[f],g)}if(j.length>0){this.CalcListLayout(false);if(this.IsGrouped()&&this.PanelMode==RD3_Glb.PANEL_LIST){this.CalcListGroupLayout()}}};IDPanel.prototype.ReorderList=function(f,a){if(!this.Realized||!this.CanReorderColumn){return}var c=-1;var d=-1;if(this.AdvTabOrder){var e=this.ListTabOrder.length;for(var b=0;b<e;b++){if(f==this.ListTabOrder[b]){this.ListTabOrder.splice(b,1);c=b+1;break}}e=this.ListTabOrder.length;for(var b=0;b<e;b++){if(a==this.ListTabOrder[b]){this.ListTabOrder.splice(b,1,f,a);d=b+1;break}}e=this.ListTabOrder.length;for(var b=0;b<e;b++){this.ListTabOrder[b].ListTabOrder=b}}else{var e=this.Fields.length;for(var b=0;b<e;b++){if(f==this.Fields[b]){this.Fields.splice(b,1);c=b+1;break}}e=this.Fields.length;for(var b=0;b<e;b++){if(a==this.Fields[b]){this.Fields.splice(b,1,f,a);d=b+1;break}}}if(this.FixedColumns!=0&&c>=0&&d>=0){if(c<=this.FixedColumns){if(d>this.FixedColumns){this.FixedColumns=this.FixedColumns>1?this.FixedColumns-1:this.FixedColumns}}else{if(d<=this.FixedColumns){this.FixedColumns=this.FixedColumns>=this.Fields.length-1?this.FixedColumns:this.FixedColumns+1}}}};IDPanel.prototype.ComputeDropList=function(d,a){if(!this.Realized){return}if(!this.CanDrop&&!this.CanReorderColumn){return}var e=(this.CanReorderColumn&&(a instanceof PField));if(!e){d.push(this)}var g=this.ContentBox;this.AbsLeft=RD3_Glb.GetScreenLeft(g,true);this.AbsTop=RD3_Glb.GetScreenTop(g,true);if(!RD3_Glb.IsIE()){this.AbsLeft-=this.ContentBox.scrollLeft;this.AbsTop-=this.ContentBox.scrollTop}this.AbsRight=this.AbsLeft+g.offsetWidth-1;this.AbsBottom=this.AbsTop+g.offsetHeight-1;var h=this.Fields.length;for(var b=0;b<h;b++){var c=this.Fields[b];c.ComputeDropList(d,a)}};IDPanel.prototype.GetTotalRows=function(){if(this.ListGroupRoot==null||this.PanelMode==RD3_Glb.PANEL_FORM||this.Status==RD3_Glb.PS_QBE){return this.TotalRows}return this.ListGroupRoot.GetNumRows()};IDPanel.prototype.IsGrouped=function(){return this.ListGroupRoot!=null};IDPanel.prototype.GetRowIndex=function(d,c,b){if(!this.IsGrouped()){return this.ActualPosition+d}if(c==undefined||c==null){c=this.PanelMode}if(c==RD3_Glb.PANEL_LIST){if(b==undefined||b==null||b==this.ActualPosition){b=this.CompactActualPosition}else{b=this.ListGroupRoot.GetRowPos(b)}return this.ListGroupRoot.GetRowIndex(b,d)}if(c==RD3_Glb.PANEL_FORM){if(b==undefined||b==null){b=this.ActualPosition}var a=b+d;return this.ListGroupRoot.GetPValOffset(a)+a}};IDPanel.prototype.GetRowForIndex=function(a){if(!this.IsGrouped()){return -1}var b=this.ListGroupRoot.GetRowPos(a,false);b=b-this.CompactActualPosition;if(b<0||b>this.NumRows){return -1}return b};IDPanel.prototype.GetServerIndex=function(a){if(!this.IsGrouped()){return -1}return this.ListGroupRoot.GetServerIndex(this.CompactActualPosition+a,true)};IDPanel.prototype.IsNewRow=function(a,b){if(!this.IsGrouped()){return a+b>this.TotalRows}return this.GetServerIndex(b)>this.TotalRows};IDPanel.prototype.IsHeader=function(a){return this.ListGroupRoot.IsHeader(this.CompactActualPosition+a)};IDPanel.prototype.CalcListGroupLayout=function(){var a=this.GetFirstListField();a.setPListGroupPosition()};IDPanel.prototype.FieldFocus=function(c,a){var b=new IDEvent("fev",this.Identifier,null,this.FocusEventDef,c,a?"1":"0",null,null,null,this.FocusEventDef==RD3_Glb.EVENT_ACTIVE?250:null)};IDPanel.prototype.DoHighlightDelete=function(b){if(!this.HighlightDelete){return}if(RD3_Glb.IsMobile()){var f=0;if(this.ShowMultipleSel&&this.MultiSelStatus){for(var c=0;c<this.MultiSelStatus.length;c++){if(this.MultiSelStatus[c]){f++}}}if(this.PanelMode==RD3_Glb.PANEL_LIST&&f==0){this.HiliteRow(b?this.ActualRow+1:0)}return}if(b){this.HLDelObjects=new Array();if(this.PanelMode==RD3_Glb.PANEL_LIST){var h=this.ActualPosition+(this.ShowMultipleSel?0:this.ActualRow);var g=this.HeaderSize+this.VisStyle.GetHeaderOffset();do{var a=(this.IsGrouped()?this.IsHeader(h-1):h);if(!this.ShowMultipleSel||(a!==-1&&this.MultiSelStatus[a])){var e=document.createElement("DIV");e.className="panel-highlight-delete";e.style.top=(g-RD3_ClientParams.HLDBorderWidth/2)+((h-this.ActualPosition)*this.GetRowHeight())+"px";e.style.width=(this.ListListBox.offsetWidth-2*RD3_ClientParams.HLDBorderWidth-1)+"px";e.style.height=(this.GetRowHeight()-2*RD3_ClientParams.HLDBorderWidth+RD3_ClientParams.HLDBorderWidth)+"px";this.ListListBox.appendChild(e);this.HLDelObjects.push(e)}h++}while(this.ShowMultipleSel&&h<=this.ActualPosition+this.NumRows-1)}else{var e=document.createElement("DIV");e.className="panel-highlight-delete";e.style.width=(this.FormBox.offsetWidth-2*RD3_ClientParams.HLDBorderWidth)+"px";e.style.height=(this.FormBox.offsetHeight-2*RD3_ClientParams.HLDBorderWidth)+"px";this.FormBox.appendChild(e);this.HLDelObjects.push(e)}}else{var d=(this.PanelMode==RD3_Glb.PANEL_LIST?this.ListListBox:this.FormBox);while(this.HLDelObjects.length>0){d.removeChild(this.HLDelObjects.pop())}this.HLDelObjects=undefined}};IDPanel.prototype.OnTouchStart=function(f){WebFrame.prototype.OnTouchStart.call(this,f);if(f.targetTouches.length!=1){return false}var b=RD3_Glb.ElementFromPoint(f.targetTouches[0].clientX,f.targetTouches[0].clientY);if(b&&((b.tagName=="INPUT"&&b.type!="button")||b.tagName=="TEXTAREA"||RD3_Glb.isInsideEditor(b))){return false}f.preventDefault();this.TouchStartX=f.targetTouches[0].clientX;this.TouchStartY=f.targetTouches[0].clientY;this.TouchOrgX=f.targetTouches[0].clientX;this.TouchOrgY=f.targetTouches[0].clientY;this.HandleTouchEvent(f,"down");this.TouchTimes=new Array();this.TouchPosY=new Array();this.TouchPosX=new Array();this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);this.TouchMoved=this.TouchScrollTimerId>0;this.TouchScroll=false;this.TouchScrollArea=false;this.TouchMove=false;this.TouchList=null;this.ClearTouchDiv();this.ClearTouchScrollTimer();if(this.ScrollBoxTouch){RD3_Glb.RemoveClass(this.ScrollBoxTouch,"panel-scroll-active")}var a=this.WebForm.FramesBox;this.TouchChangeLayoutSX=this.PanelMode==RD3_Glb.PANEL_LIST&&a.scrollLeft+a.clientWidth>=a.scrollWidth;this.TouchChangeLayoutDX=this.PanelMode==RD3_Glb.PANEL_FORM&&a.scrollLeft==0;if(this.PanelMode==RD3_Glb.PANEL_LIST){if(b){if(b==this.ScrollIntTouch||b==this.ScrollBoxTouch){this.TouchMove=true;RD3_Glb.AddClass(this.ScrollBoxTouch,"panel-scroll-active");this.MoveScrollTouch(f.targetTouches[0].clientY)}var d=this.GetTouchID(b);var c=RD3_DDManager.GetObject(d,true);if(c instanceof PValue){this.TouchList=c}var g=b;while(g){if(g==this.ScrollAreaBox){this.TouchScrollArea=true;break}g=g.parentNode}}}return false};IDPanel.prototype.OnTouchMove=function(i){if(this.TouchStartX==-1){return false}i.preventDefault();if(i.targetTouches.length!=1){return false}var k=i.targetTouches[0].clientX-this.TouchStartX;var h=i.targetTouches[0].clientY-this.TouchStartY;var j=new Date();this.TouchStartX=i.targetTouches[0].clientX;this.TouchStartY=i.targetTouches[0].clientY;if(Math.abs(this.TouchStartX-this.TouchOrgX)>RD3_ClientParams.TouchMoveLimit||Math.abs(this.TouchStartY-this.TouchOrgY)>RD3_ClientParams.TouchMoveLimit){this.HandleTouchEvent(i,"move");this.TouchMoved=true}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);if(this.TouchTimes.length>3){this.TouchTimes.shift();this.TouchPosY.shift();this.TouchPosX.shift()}var a=(this.TouchStartX-this.TouchOrgX);var c=(this.TouchStartY-this.TouchOrgY);if(this.TouchMove){this.MoveScrollTouch(i.targetTouches[0].clientY);this.FormScroll=false}else{if(Math.abs(c)<40&&Math.abs(a)>120&&this.FormListButton.style.display!="none"&&!this.TouchScrollArea&&((a>0&&this.TouchChangeLayoutDX)||(a<0&&this.TouchChangeLayoutSX))){this.TouchChangeLayoutDX=false;this.TouchChangeLayoutSX=false;if(this.PanelMode==RD3_Glb.PANEL_LIST&&this.TouchList){var l=RD3_Glb.ElementFromPoint(i.targetTouches[0].clientX,(i.targetTouches[0].clientY+this.TouchOrgY)/2);if(l){var b=this.GetTouchID(l);var d=RD3_DDManager.GetObject(b,true);if(d instanceof PValue){this.TouchList=d}}this.ChangeActualRow(this.TouchList.Index-this.ActualPosition,true)}this.FormListButton.className="frame-toolbar-button"+((this.SmallIcons)?"-small":"")+"-down";window.setTimeout("document.getElementById('"+this.FormListButton.id+"').className = 'frame-toolbar-button"+((this.SmallIcons)?"-small":"")+"'",300);this.OnToolbarClick(i,"list");this.FormScroll=false}else{if(this.TouchList&&!RD3_DDManager.OpenCombo&&Math.abs(c)>5&&Math.abs(a)<Math.abs(c)){if(this.TouchDiv){this.TouchDiv.style.top=(i.targetTouches[0].clientY-RD3_Glb.GetScreenTop(this.ListListBox)-this.GetRowHeight()/2)+"px"}RD3_TooltipManager.DeactivateAll();this.LastPositionTime=0;if(this.ScrollBox){this.ScrollBox.scrollTop-=h}this.TouchScroll=true;this.UpdateScrollTouch();this.FormScroll=false}else{if(!RD3_DDManager.IsDragging&&!RD3_DDManager.IsResizing){var g=this.ContentBox.scrollLeft;var f=this.ContentBox.scrollTop;if(this.Scrollbar==RD3_Glb.FORMSCROLL_HORIZ||this.Scrollbar==RD3_Glb.FORMSCROLL_BOTH){this.ContentBox.scrollLeft-=k}if(this.Scrollbar==RD3_Glb.FORMSCROLL_VERT||this.Scrollbar==RD3_Glb.FORMSCROLL_BOTH){this.ContentBox.scrollTop-=h}if(this.Scrollbar!=RD3_Glb.FORMSCROLL_NONE){this.FormScroll=this.FormScroll&&g==this.ContentBox.scrollLeft&&f==this.ContentBox.scrollTop}else{this.FormScroll=false}}}}}if(this.TouchScrollArea){var g=this.ScrollAreaBox.scrollLeft;this.ScrollAreaBox.scrollLeft-=k;this.FormScroll=this.FormScroll&&g==this.ScrollAreaBox.scrollLeft}WebFrame.prototype.OnTouchMove.call(this,i);return false};IDPanel.prototype.OnTouchEnd=function(h){if(this.TouchStartX==-1){return false}h.preventDefault();if(h.targetTouches.length!=0&&h.changedTouches.length!=1){return false}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}this.ClearTouchDiv();if(!this.TouchMoved){this.HandleTouchEvent(h,"up")}else{if(this.TouchScroll&&this.TouchTimes.length==3){var g=this.TouchTimes[2]-this.TouchTimes[0];var a=this.TouchPosY[0]-this.TouchPosY[2];if(new Date()-this.TouchTimes[2]<100&&g>0){var c=a/g;if(Math.abs(c)>0.3){var i=1;if(Math.abs(c)>2.3){i=3}else{if(Math.abs(c)>1.3){i=2}}if(c<0){i=-i}this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+i+",0])",50)}}}else{if(!this.TouchScroll&&this.TouchTimes.length==3&&!RD3_DDManager.IsDragging&&!RD3_DDManager.IsResizing){var g=this.TouchTimes[2]-this.TouchTimes[0];var b=this.TouchPosX[0]-this.TouchPosX[2];var a=this.TouchPosY[0]-this.TouchPosY[2];if(this.Scrollbar!=RD3_Glb.FORMSCROLL_HORIZ&&this.Scrollbar!=RD3_Glb.FORMSCROLL_BOTH){b=0}if(this.Scrollbar!=RD3_Glb.FORMSCROLL_VERT&&this.Scrollbar!=RD3_Glb.FORMSCROLL_BOTH){a=0}if(new Date()-this.TouchTimes[2]<100&&g>0){var d=a/g;var f=b/g;if(Math.abs(f)>0.3||Math.abs(d)>0.3){this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+f+","+d+",0])",10)}}}}}WebFrame.prototype.OnTouchEnd.call(this,h);this.TouchStartX=-1;this.TouchStartY=-1;this.TouchMoved=false;this.TouchMove=false;if(this.ScrollBoxTouch){RD3_Glb.RemoveClass(this.ScrollBoxTouch,"panel-scroll-active")}return false};IDPanel.prototype.TouchScrollTimer=function(e,f){if(f.length==2){if(!this.TouchScroll){return}var k=f[0];var c=f[1];var g=this.GetRowHeight()*k;this.LastPositionTime=0;var h=false;if(this.ScrollBox){var d=this.ScrollBox.scrollTop;this.ScrollBox.scrollTop+=g;var h=this.ScrollBox.scrollTop!=d}this.UpdateScrollTouch();if((c==10||c==20)&&Math.abs(k)>1){if(k<0){k++}else{k--}}if(c<40&&h){var l=50;if(c>30){l=150+(c-30)*20}this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+k+","+(c+1)+"])",l)}else{this.TouchScrollTimerId=0}}if(f.length==3){var j=f[0];var i=f[1];var c=f[2];var b=this.ContentBox.scrollLeft;var a=this.ContentBox.scrollTop;this.ContentBox.scrollLeft+=j*10;this.ContentBox.scrollTop+=i*10;var h=this.ContentBox.scrollLeft!=b||this.ContentBox.scrollTop!=a;if(c<40&&h){j=j*0.97;i=i*0.97;this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+j+","+i+","+(c+1)+"])",10)}}};IDPanel.prototype.ClearTouchScrollTimer=function(){if(this.TouchScrollTimerId>0){window.clearTimeout(this.TouchScrollTimerId);this.TouchScrollTimerId=0;this.TouchScroll=0}};IDPanel.prototype.ClearTouchDiv=function(){if(this.TouchDiv){this.ListListBox.removeChild(this.TouchDiv);this.TouchDiv=null}};IDPanel.prototype.OnPageTouchStart=function(a){if(a.targetTouches.length!=1){return false}this.TouchStartX=a.targetTouches[0].clientX;this.TouchStartY=a.targetTouches[0].clientY;this.TouchOrgX=a.targetTouches[0].clientX;this.TouchOrgY=a.targetTouches[0].clientY;this.TouchMoved=false;a.preventDefault();return false};IDPanel.prototype.OnPageTouchMove=function(a){this.TouchStartX=a.targetTouches[0].clientX;this.TouchStartY=a.targetTouches[0].clientY;if(Math.abs(this.TouchStartX-this.TouchOrgX)>RD3_ClientParams.TouchMoveLimit||Math.abs(this.TouchStartY-this.TouchOrgY)>RD3_ClientParams.TouchMoveLimit){this.TouchMoved=true}a.preventDefault();return false};IDPanel.prototype.OnPageTouchEnd=function(b){b.preventDefault();if(b.targetTouches.length!=0&&b.changedTouches.length!=1){return false}if(!this.TouchMoved){var f=b.changedTouches[0].clientX;var d=b.changedTouches[0].clientY;var a=RD3_Glb.ElementFromPoint(f,d);if(a){RD3_Glb.TouchHL(a,"panel-page-active");var c=document.createEvent("MouseEvents");c.initEvent("click",true,true,window,1,f,d,f,d);a.dispatchEvent(c)}}return false};IDPanel.prototype.HandleTouchEvent=function(h,f){var m=h.changedTouches[0].clientX;var k=h.changedTouches[0].clientY;var i=false;if(f=="up"){if(new Date()-this.SingleTapTime<300&&Math.abs(m-this.SingleTapX)<16&&Math.abs(k-this.SingleTapY)<16){i=true;this.SingleTapTime=0;this.SingleTapX=-100;this.SingleTapY=-100}else{this.SingleTapTime=new Date();this.SingleTapX=m;this.SingleTapY=k}}var a=RD3_Glb.ElementFromPoint(m,k);if(a&&a.className=="book-span-radio-text"){a=a.previousSibling}if(a&&a.firstChild&&a.firstChild.className=="panel-value-check"){a=a.firstChild}if(a&&a.tagName=="SPAN"&&a.className=="combo-input"){a=a.parentNode}if(a&&a.tagName=="IMG"&&a.className=="combo-img-dis"){a=a.parentNode}if(f=="down"){this.TouchObj=a}var g=null;var n=false;if(a){var l=a.id.substr(-3)==":lc";var o=a.tagName=="A"||a.tagName=="INPUT";n=(a.tagName=="IMG"||o||l);var c=this.GetTouchID(a);g=RD3_DDManager.GetObject(c,true);if(g instanceof PField){l=l&&!g.IsStatic();n=g.CanActivate||l}if(g instanceof PValue){n=g.ParentField.CanActivate}if(a.className=="panel-value-activator"||a.className=="combo-activator"||a.className=="panel-blob-span"){n=true}if(o){n=true}}if(f!="down"&&this.TouchObj&&this.TouchObj.id!=""){if(g&&g.UseHL&&g.IsStatic()){g.OnMouseOutObj(h,a)}else{RD3_Glb.TouchHL(this.TouchObj,"panel-field-down",false)}}if(n){if(a.id!=""){if(f=="up"){if(g&&g.UseHL&&g.IsStatic()){var b="RD3_DesktopManager.CallEventHandler('"+g.Identifier+"', 'OnMouseDownObj', null, document.getElementById('"+a.id+"'))";window.setTimeout(b,10);var j="RD3_DesktopManager.CallEventHandler('"+g.Identifier+"', 'OnMouseOutObj', null, document.getElementById('"+a.id+"'))";window.setTimeout(j,RD3_ClientParams.TouchHLDelay)}else{RD3_Glb.TouchHL(a)}}if(f=="down"&&(this.TouchScrollTimerId==0||this.TouchScrollTimerId==undefined)){if(g&&g.UseHL&&g.IsStatic()){g.OnMouseOverObj(h,a)}else{RD3_Glb.TouchHL(a,"panel-field-down",true,0)}}}if(f=="up"){var d=document.createEvent("MouseEvents");d.initMouseEvent(i?"dblclick":"click",true,true,window,1,m,k,m,k);a.dispatchEvent(d)}}if(this.TouchList&&f=="up"){if(i){this.TouchList.OnDoubleClick(h)}else{this.ChangeActualRow(this.TouchList.Index-this.ActualPosition,true)}}};IDPanel.prototype.GetTouchID=function(c){var b=c.id;if(b==""&&c.tagName=="SPAN"){b=c.parentNode.id}var a=c;while(a&&b==""){a=a.parentNode;b=a.id}return b};IDPanel.prototype.HiliteRow=function(a){if(!this.VisHiliteRow()&&a>0){return}if(this.IsGrouped()&&a!=0){a=this.GetRowForIndex(a)}else{a-=this.ActualPosition}this.HiliteRow2(this.LastHiliteRow,false);this.HiliteRow2(a,true);this.LastHiliteRow=a};IDPanel.prototype.HiliteRow2=function(b,d){if(b>=0&&b<=this.NumRows){var e=this.Fields.length;for(var a=0;a<e;a++){var c=this.Fields[a];if(c.ListList&&c.PListCells.length>b){c.PListCells[b].SetHilite(d)}}}};IDPanel.prototype.OnFormListAni=function(){RD3_Glb.SetTransitionProperty(this.ListBox,"-webkit-transform");RD3_Glb.SetTransitionProperty(this.FormBox,"-webkit-transform");RD3_Glb.SetTransitionDuration(this.ListBox,"0ms");RD3_Glb.SetTransitionDuration(this.FormBox,"0ms");RD3_Glb.SetTransitionTimingFunction(this.ListBox,"ease");RD3_Glb.SetTransitionTimingFunction(this.FormBox,"ease");if(this.PagesBox){RD3_Glb.SetTransitionProperty(this.PagesBox,"-webkit-transform");RD3_Glb.SetTransitionDuration(this.PagesBox,"0ms");RD3_Glb.SetTransitionTimingFunction(this.PagesBox,"ease")}RD3_Glb.SetTransitionDuration(this.SearchBox,"0ms");RD3_Glb.SetTransitionDuration(this.FormListButtonCnt,"0ms");var a=RD3_Glb.TranslateY(this.ListBox);var k=RD3_Glb.TranslateY(this.FormBox);if(this.IDScroll){this.IDScroll.Enabled=false}var l=0;var h=0;var q=0;var o=0;var f=0;var p=0;var b=0;var n=0;var g=0;var j=0;var d=0;var e=0;if(this.PanelMode==RD3_Glb.PANEL_LIST){l=-this.ContentBox.offsetWidth;h=0;q=0;o=this.ContentBox.offsetWidth;f=-200;g=0;p=0;j=1;b=0;d=1;n=200;e=0}else{l=0;h=-this.ContentBox.offsetWidth;q=this.ContentBox.offsetWidth;o=0;f=0;g=1;p=200;j=0;b=-200;d=0;n=0;e=1}RD3_Glb.SetTransform(this.ListBox,"translate3d("+l+"px,"+a+"px,0px)");RD3_Glb.SetTransform(this.FormBox,"translate3d("+q+"px,"+k+"px,0px)");if(this.PagesBox){RD3_Glb.SetTransform(this.PagesBox,"translate3d("+q+"px,0px,0px)")}if(!RD3_Glb.IsIE()){RD3_Glb.SetTransform(this.SearchBox,"translate3d("+f+"px,0px,0px)");RD3_Glb.SetTransform(this.FormListButtonCnt,"translate3d("+p+"px,0px,0px)")}this.SearchBox.style.opacity=g;this.FormListButtonCnt.style.opacity=j;var c=RD3_Glb.IsIE()?400:250;var m="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.ListBox.id+"'), '"+c+"ms');";m+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.FormBox.id+"'), '"+c+"ms');";m+="RD3_Glb.SetTransform(document.getElementById('"+this.ListBox.id+"'), 'translate3d("+h+"px,"+a+"px,0px)');";m+="RD3_Glb.SetTransform(document.getElementById('"+this.FormBox.id+"'), 'translate3d("+o+"px,"+k+"px,0px)');";if(this.PagesBox){m+="RD3_Glb.SetTransform(document.getElementById('"+this.PagesBox.id+"'), 'translate3d("+o+"px,0px,0px)');";m+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.PagesBox.id+"'), '"+c+"ms');"}if(!RD3_Glb.IsIE()){m+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.SearchBox.id+"'), '250ms');";m+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.FormListButtonCnt.id+"'), '250ms');";m+="RD3_Glb.SetTransform(document.getElementById('"+this.SearchBox.id+"'), 'translate3d("+b+"px,0px,0px)');";m+="RD3_Glb.SetTransform(document.getElementById('"+this.FormListButtonCnt.id+"'), 'translate3d("+n+"px,0px,0px)');";m+="document.getElementById('"+this.SearchBox.id+"').style.opacity="+d+";";m+="document.getElementById('"+this.FormListButtonCnt.id+"').style.opacity="+e+";"}var i=this;if(!RD3_Glb.IsIE()){RD3_Glb.AddEndTransaction(this.ListBox,this.ea,false)}else{window.setTimeout(function(){i.ea()},830)}window.setTimeout(m,RD3_Glb.IsIE()?400:30)};IDPanel.prototype.OnEndAnimation=function(a){if(RD3_Glb.GetTransitionDuration(this.ListBox)=="0ms"){return}if(this.IDScroll){this.IDScroll.Enabled=true}this.AnimatingPanel=false;this.AnimatingToolbar=false;RD3_Glb.RemoveEndTransaction(this.ListBox,this.ea,false);this.ListBox.style.visibility=(this.PanelMode==RD3_Glb.PANEL_LIST)?"":"hidden";this.FormBox.style.visibility=(this.PanelMode==RD3_Glb.PANEL_LIST)?"hidden":"";RD3_Glb.SetTransitionProperty(this.ListBox,"");RD3_Glb.SetTransitionProperty(this.FormBox,"");RD3_Glb.SetTransitionDuration(this.ListBox,"");RD3_Glb.SetTransitionDuration(this.FormBox,"");RD3_Glb.SetTransitionDuration(this.SearchBox,"");RD3_Glb.SetTransitionDuration(this.FormListButtonCnt,"");if(RD3_Glb.IsIE()){this.SearchBox.style.opacity=(this.PanelMode==RD3_Glb.PANEL_LIST?1:0);this.FormListButtonCnt.style.opacity=(this.PanelMode==RD3_Glb.PANEL_LIST?0:1)}if(this.PagesBox){this.PagesBox.style.visibility=(this.PanelMode==RD3_Glb.PANEL_LIST)?"hidden":"";RD3_Glb.SetTransitionProperty(this.PagesBox,"");RD3_Glb.SetTransitionDuration(this.PagesBox,"")}if(this.IDScroll){this.IDScroll.SetBox(this.PanelMode==RD3_Glb.PANEL_LIST?this.ListBox:this.FormBox);if(this.PanelMode==RD3_Glb.PANEL_FORM){this.IDScroll.TA=new Array(this.IDScroll.Min[0],this.IDScroll.Min[1])}}this.AdaptLayout();this.ResetPosition=true;this.RefreshToolbar=true;this.AfterProcessResponse();if(RD3_KBManager.ActiveElement){var c=RD3_KBManager.GetObject(RD3_KBManager.ActiveElement,true);if(c&&c instanceof PValue&&c.ParentField.ParentPanel==this){var d=RD3_KBManager.ActiveElement;while(!d.id&&d.parentNode){d=d.parentNode}var b=d.id.indexOf(":lv")!=0;if((this.PanelMode==RD3_Glb.PANEL_LIST&&!b)||(this.PanelMode!=RD3_Glb.PANEL_LIST&&b)){RD3_KBManager.ActiveElement=null}}}if(this.PanelMode==RD3_Glb.PANEL_LIST){this.HiliteRow(0)}};IDPanel.prototype.UpdateFieldClass=function(m){for(var h=0;h<=1;h++){var g=new Array();var o=new Array();var b=this.Fields.length;for(var e=0;e<b;e++){var j=this.Fields[e];var c=false;if(h==0){c=j.InList&&!j.ListList&&j.PListCells&&j.PListCells[0]}else{c=j.PFormCell&&j.InForm}if(c&&j.Group==m&&j.Visible){if(g.length==0){g.push(j)}if(o.length==0){o.push(j)}var a=(h==0?g[0].ListTop:g[0].FormTop);var l=(h==0?o[0].ListTop:o[0].FormTop);var p=(h==0?j.ListTop:j.FormTop);if(p<a){g.splice(0,g.length);g.push(j)}if(p==a&&g[0]!=j){g.push(j)}if(p>l){o.splice(0,o.length);o.push(j)}if(p==l&&g[0]!=j){o.push(j)}if((h==0&&RD3_Glb.HasClass(j.ListCaptionBox,"first-group-field"))||(h==1&&RD3_Glb.HasClass(j.FormCaptionBox,"first-group-field"))){RD3_Glb.RemoveClass((h==0?j.ListCaptionBox:j.FormCaptionBox),"first-group-field");var d=(h==0?j.PListCells[0].IntCtrl:j.PFormCell.IntCtrl);if(d instanceof IDCombo){d=d.ComboInput}RD3_Glb.RemoveClass(d,"first-group-field")}if((h==0&&RD3_Glb.HasClass(j.ListCaptionBox,"last-group-field"))||(h==1&&RD3_Glb.HasClass(j.FormCaptionBox,"last-group-field"))){RD3_Glb.RemoveClass((h==0?j.ListCaptionBox:j.FormCaptionBox),"last-group-field");var d=(h==0?j.PListCells[0].IntCtrl:j.PFormCell.IntCtrl);if(d instanceof IDCombo){d=d.ComboInput}RD3_Glb.RemoveClass(d,"last-group-field")}}}if(g.length>0){var k=g.length;for(var e=0;e<k;e++){var j=g[e];RD3_Glb.AddClass((h==0?j.ListCaptionBox:j.FormCaptionBox),"first-group-field");var d=(h==0?j.PListCells[0].IntCtrl:j.PFormCell.IntCtrl);if(d instanceof IDCombo){d=d.ComboInput}if(d instanceof IDEditor){RD3_Glb.AddClass(d.EditorObj,"last-group-field");RD3_Glb.AddClass(d.TextObj,"last-group-field");d=null}if(d){RD3_Glb.AddClass(d,"first-group-field")}}}if(o.length>0){var k=o.length;for(var e=0;e<k;e++){var j=o[e];RD3_Glb.AddClass((h==0?j.ListCaptionBox:j.FormCaptionBox),"last-group-field");var d=(h==0?j.PListCells[0].IntCtrl:j.PFormCell.IntCtrl);if(d instanceof IDCombo){d=d.ComboInput}if(d instanceof IDEditor){RD3_Glb.AddClass(d.EditorObj,"last-group-field");RD3_Glb.AddClass(d.TextObj,"last-group-field");d=null}if(d){RD3_Glb.AddClass(d,"last-group-field")}}}}};IDPanel.prototype.OnTouchUp=function(d,b){WebFrame.prototype.OnTouchUp.call(this,d,b);if(this.HilitedCombo){this.HilitedCombo.HiliteCombo(null,false)}if(this.hilitedButton){var c=this.PanelMode==RD3_Glb.PANEL_LIST?this.hilitedButton.ListCaptionBox:this.hilitedButton.FormCaptionBox;RD3_Glb.RemoveClass(c,"button-hover");if(c.hasAttribute("OldBkgImage")||this.hilitedButton.Image!=""){if(this.hilitedButton.VisShowActivator()&&this.hilitedButton.IsButton()){c.style.backgroundImage="";c.style.backgroundPosition=""}var a=c.getAttribute("OldBkgImage");c.removeAttribute("OldBkgImage");a=this.hilitedButton.Image!=""?"":a;this.hilitedButton.ApplyBackgroundImage(c.style,a)}delete this.hilitedButton}return true};IDPanel.prototype.OnScrollBottom=function(){if(this.IsMyScroll()&&(this.IDScroll&&this.IDScroll.Enabled)&&this.PanelMode==RD3_Glb.PANEL_LIST){if(this.LoadingPolicy==2){var a=new IDEvent("more",this.Identifier,null,RD3_Glb.EVENT_ACTIVE)}else{this.WasToBottom=true}}};IDPanel.prototype.OnMoreButton=function(){if(this.PanelMode==RD3_Glb.PANEL_LIST){var a=new IDEvent("more",this.Identifier,null,RD3_Glb.EVENT_ACTIVE);this.MoreButton.className="panel-more-load";this.IDScroll.ResetSpeedData()}};IDPanel.prototype.OnEndScroll=function(a){if(a==1&&this.LoadingPolicy==1&&this.WasToBottom){this.OnMoreButton()}this.WasToBottom=false};IDPanel.prototype.OnPullTrigger=function(h,d,f,e){var c=180+d*2;if(d>0){c=180}if(d<-90){c=0}if(this.PullArrow.className!="pull-arrow"){this.PullArrow.className="pull-arrow"}if(RD3_Glb.IsAndroid()&&!RD3_Glb.IsAndroid(4,4,0)){c=h?180:0}var b="rotateZ("+c+"deg)";if(RD3_Glb.GetTransform(this.PullArrow)!=b){RD3_Glb.SetTransform(this.PullArrow,b)}var i=h?ClientMessages.MOB_PULL_RELEASE:ClientMessages.MOB_PULL_TEXT;if(this.PullText.textContent!=i){this.PullText.textContent=i}RD3_Glb.SetClass(this.PullText,"pull-text-refresh",h&&!f);if(h){if(this.PullActiveTime==undefined){this.PullActiveTime=new Date()}}else{this.PullActiveTime=undefined}if(f&&h){var g=new Date()-this.PullActiveTime;if(g>300){this.OrgMarginTop=this.IDScroll.MarginTop;this.IDScroll.MarginTop=-this.PullAreaBox.offsetTop;this.IDScroll.Org[1]=0;this.OnToolbarClick(e,"refresh");this.PullText.textContent=ClientMessages.MOB_PULL_REFRESH;this.PullArrow.className="pull-arrow-refresh";RD3_Glb.SetTransform(this.PullArrow,"")}}};IDPanel.prototype.OnScrollMobileUp=function(a){if(this.MobileScrollChanged){this.OnSearchChange(a)}this.MobileScrollChanged=false;this.ScrollBoxHint.style.opacity=0;window.setTimeout("document.getElementById('"+this.Identifier+":sbh').style.display = ''",250);this.ScrollBoxMobile.className="panel-scroll-container";RD3_Glb.StopEvent(a);return false};IDPanel.prototype.OnScrollMobile=function(d){var c=window.getComputedStyle(this.ScrollBoxMobile);var b=c.backgroundColor!="rgba(0, 0, 0, 0)";if((!b&&RD3_Glb.IsAndroid())||RD3_Glb.IsIE(10,true)){b=true;this.ScrollBoxMobile.className="panel-scroll-container-active"}if(b){var f=d.clientY;if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){if(d.targetTouches.length!=1){return false}f=d.targetTouches[0].clientY}var e=this.SearchBox.value;var a=Math.floor((f-RD3_Glb.GetScreenTop(this.ScrollBoxMobile))*27/this.ScrollBoxMobile.offsetHeight);if(a>=0&&a<=26){if(a==0){this.SearchBox.value="<A"}else{this.SearchBox.value=String.fromCharCode(a+64)+"*"}if(this.SearchBox.value!=e){if(RD3_ClientParams.MobileScrollbarOnTouchUp){this.MobileScrollChanged=true}else{this.OnSearchChange(d)}}this.ScrollBoxHint.textContent=(a==0)?"#":this.SearchBox.value;this.ScrollBoxHint.style.opacity=1;this.ScrollBoxHint.style.display="block";this.ScrollBoxHint.style.left=((this.ContentBox.offsetWidth-this.ScrollBoxHint.offsetWidth)/2)+"px"}RD3_Glb.StopEvent(d)}return false};IDPanel.prototype.IsMyScroll=function(){return(this.IDScroll&&(this.IDScroll.MyBox==this.FormBox||this.IDScroll.MyBox==this.ListBox))};IDPanel.prototype.AdjustSubFrame=function(a,b){if(!RD3_Glb.IsMobile()){return}if(this.HasList&&this.OnlyContent){var d=null;var f=null;for(var e=0;e<this.Fields.length;e++){var c=e;if(this.ListTabOrder!=null){c=this.ListTabOrder[e]}var a=this.Fields[c];if(a.ListList){if(f==null){f=a}d=a}}if(f!=null&&f.ListCaptionBox&&!RD3_Glb.IsMobile7()){RD3_Glb.SetBorderTopLeftRadius(f.ListCaptionBox,"8px")}if(d!=null&&d.ListCaptionBox&&!RD3_Glb.IsMobile7()){RD3_Glb.SetBorderTopRightRadius(d.ListCaptionBox,"8px")}}};IDPanel.prototype.SetSwipe=function(b,a,d,h){if(this.IsSubObj()&&this.MustReflectScrollToParent(0)){return false}if(b&&this.CanDelete&&!this.IsNewRow(this.ActualPosition,d-1)&&!this.ShowMultipleSel){if(!this.SwipeButton){this.SwipeButton=document.createElement("div");this.SwipeButton.setAttribute("id",this.Identifier+":swipe");this.SwipeButton.className="swipe-button"+(this.HasScrollbar?" swipe-button-scrollbar":"");this.SwipeButton.textContent=ClientMessages.MOB_SWIPE_TEXT;var g=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolbarClick', ev, 'delete')");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.SwipeButton.ontouchend=g}else{this.SwipeButton.onclick=g}this.ListListBox.appendChild(this.SwipeButton)}var c=a.PListCells[d-1].GetDOMObj().offsetTop+this.HeaderSize;var e=a.PListCells[d-1].GetDOMObj().offsetHeight;this.SwipeButton.style.display="";this.SwipeButton.style.top=(c+(e-this.SwipeButton.offsetHeight)/2)+"px";this.SwipeButton.style.width="80px";if(a.PListCells[d-1].Badge&&a.PListCells[d-1].Badge!=""){this.SwipeButton.style.right="85px"}a.GotFocus((h.target?h.target:h.srcElement),h)}if(!b){if(this.SwipeButton&&this.SwipeButton.style.display==""){this.SwipeButton.style.width="";window.setTimeout("document.getElementById('"+this.SwipeButton.id+"').style.display='none'",250);return true}}};IDPanel.prototype.ChangeExpose=function(a){if(a&&this.Realized){this.UpdateToolbar()}};IDPanel.prototype.AccentColorChanged=function(a,b){if(this.LastHiliteRow){this.HiliteRow2(this.LastHiliteRow,true)}};IDPanel.prototype.AppendCmsToToolbar=function(c){var b=RD3_DesktopManager.WebEntryPoint.CommandZones[RD3_Glb.CZ_CMDSET];this.TBZones[b].appendChild(c);var d=(RD3_Glb.IsIE(10,false)?this.TBZones[b].parentElement:this.TBZones[b].parentNode);if(d==null){for(var e=b+1;e<this.TBZones.length;e++){var a=(RD3_Glb.IsIE(10,false)?this.TBZones[e].parentElement:this.TBZones[e].parentNode);if(a!=null){a.insertBefore(this.TBZones[b],this.TBZones[e]);break}}d=(RD3_Glb.IsIE(10,false)?this.TBZones[b].parentElement:this.TBZones[b].parentNode);if(d==null){this.ToolbarBox.appendChild(this.TBZones[b])}}};IDPanel.prototype.OnAdaptRetina=function(a,c,b){if(b!==undefined&&this.CustomButtons&&this.CustomButtons[b]){var d=RD3_Glb.IsMobile7();var e=!(RD3_Glb.IsAndroid()||RD3_Glb.IsIE())||RD3_Glb.IsAndroid(4,4,0);if(d&&e){this.CustomButtons[b].style.webkitMaskSize=a+"px "+c+"px";this.CustomButtons[b].style.webkitMaskRepeat="no-repeat"}else{this.CustomButtons[b].width=a;this.CustomButtons[b].height=c;if(RD3_DesktopManager.WebEntryPoint.InResponse){this.RefreshToolbar=true}else{this.UpdateToolbar()}}}WebFrame.prototype.OnAdaptRetina.call(this,a,c,b)};function IndHandler(){this.Indicators=new Array();this.Identifier="inh";this.Realized=false}IndHandler.prototype.LoadFromXml=function(f){if(f.nodeName!=this.Identifier){return}var c=f.childNodes;var g=c.length;for(var d=0;d<g;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"ind":var e=new Indicator();e.LoadFromXml(b);this.Indicators.push(e)}}RD3_DesktopManager.ObjectMap.add(this.Identifier,this)};IndHandler.prototype.Realize=function(b){var d=this.Indicators.length;for(var a=0;a<d;a++){var c=this.Indicators[a];this.Indicators[a].Realize(b)}this.Realized=true};IndHandler.prototype.Unrealize=function(){var b=this.Indicators.length;for(var a=0;a<b;a++){this.Indicators[a].Unrealize()}RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.Realized=false};IndHandler.prototype.AdaptLayout=function(){if(!this.Realized){return}var d=RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR;var f=RD3_DesktopManager.WebEntryPoint.StatusBarBox.clientWidth-10;var k=0;var a=0;var h=0;var b=this.Indicators.length;for(var e=0;e<b;e++){var c=this.Indicators[e];if(c.IsVisible()){h++;if(c.FixedWidth>0){if(c.FixedWidth>1){c.SetVisualWidth(c.FixedWidth)}k+=c.MyBox.offsetWidth+((e<b-1)?2:0)}if(c.FixedWidth==0){a++}if(c.TextBox.innerHTML==""&&RD3_DesktopManager.WebEntryPoint.MenuType!=RD3_Glb.MENUTYPE_TASKBAR){c.MyBox.className="indicator-box-empty"}}}if(h==0){RD3_DesktopManager.WebEntryPoint.StatusBarBox.className="status-bar-invisible";return}else{RD3_DesktopManager.WebEntryPoint.StatusBarBox.className=""}if(f>k&&a>0){var g=Math.floor((f-k)/a);for(var e=0;e<b;e++){var c=this.Indicators[e];if(c.FixedWidth==0&&c.IsVisible()){c.SetVisualWidth(g)}}}else{}if(!d){var j=false;for(var e=b-1;e>=0;e--){var c=this.Indicators[e];if(!j&&c.IsVisible()){c.MyBox.style.marginRight="0px";j=true;if(h==1){c.MyBox.style.width=(parseInt(c.MyBox.style.width,0)+2)+"px"}}else{c.MyBox.style.marginRight=""}}}if(d){var l=4;var b=this.Indicators.length;for(var e=0;e<b;e++){var c=this.Indicators[e];if(c.IsVisible()){l+=c.MyBox.offsetWidth}}RD3_DesktopManager.WebEntryPoint.TaskbarTrayCell.style.width=l+"px"}};IndHandler.prototype.ActiveFormChanged=function(){var b=this.Indicators.length;for(var a=0;a<b;a++){this.Indicators[a].ActiveFormChanged()}};function Indicator(){this.IdxForm=0;this.FixedWidth=0;this.Tooltip="";this.Style=-1;this.Enabled=true;this.Visible=true;this.Text="";this.Image="";this.Alignment=RD3_Glb.IND_ALI_SX;this.Identifier="";this.ClickEventDef=RD3_Glb.EVENT_ACTIVE;this.TimeTimer=null;this.Realized=false;this.MyBox=null;this.IndicatorImg=null;this.TextBox=null}Indicator.prototype.LoadFromXml=function(a){this.LoadProperties(a)};Indicator.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"frm":this.SetFormIndex(parseInt(a));break;case"wid":this.SetFixedWidth(parseInt(a));break;case"tip":this.SetTooltip(a);break;case"sty":this.SetStyle(parseInt(a));break;case"ena":this.SetEnabled(a=="1");break;case"vis":this.SetVisible(a=="1");break;case"cap":this.SetText(a);break;case"img":this.SetImage(a);break;case"ali":this.SetAlign(parseInt(a));break;case"clk":this.ClickEventDef=parseInt(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};Indicator.prototype.ChangeProperties=function(a){this.LoadProperties(a)};Indicator.prototype.SetFormIndex=function(a){this.IdxForm=a};Indicator.prototype.SetAlign=function(a){if(a!=undefined){this.Alignment=a}if(this.Realized){switch(this.Alignment){case RD3_Glb.IND_ALI_SX:this.MyBox.style.textAlign="left";break;case RD3_Glb.IND_ALI_CX:this.MyBox.style.textAlign="center";break;case RD3_Glb.IND_ALI_DX:this.MyBox.style.textAlign="right";break}}};Indicator.prototype.SetFixedWidth=function(a){if(a!=undefined){this.FixedWidth=a}if(this.Realized){if(this.FixedWidth<=1){this.MyBox.style.width=""}RD3_DesktopManager.WebEntryPoint.IndObj.AdaptLayout()}};Indicator.prototype.SetTooltip=function(a){if(a!=undefined){this.Tooltip=a}if(this.Realized){RD3_TooltipManager.SetObjTitle(this.MyBox,this.Tooltip)}};Indicator.prototype.SetStyle=function(d){if(d!=undefined){this.Style=d}if(this.Realized){switch(this.Style){case RD3_Glb.STYLE_TIME:if(this.TimeTimer!=null){window.clearInterval(this.TimeTimer)}this.TimeTimer=window.setInterval(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TimeTick', ev)"),1000);var c=new Date();var b=c.getMinutes();this.TextBox.innerHTML=c.getHours()+"."+(b<10?"0"+b:b);break;case RD3_Glb.STYLE_DATE:if(this.TimeTimer!=null){window.clearInterval(this.TimeTimer)}this.TimeTimer=window.setInterval(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TimeTick', ev)"),60000);var c=new Date();var a=(c.getDate()<10?"0":"")+c.getDate();a+="/"+(c.getMonth()+1<10?"0":"")+(c.getMonth()+1);a+="/"+c.getFullYear();this.TextBox.innerHTML=a;break;default:if(this.TimeTimer!=null){window.clearInterval(this.TimeTimer);this.TimeTimer=null}this.TextBox.innerHTML=this.Text;break}RD3_DesktopManager.WebEntryPoint.IndObj.AdaptLayout()}};Indicator.prototype.SetEnabled=function(a){if(a!=undefined){this.Enabled=a}if(this.Realized){if(this.IsEnabled()){RD3_Glb.RemoveClass(this.TextBox,"indicator-disabled");RD3_Glb.RemoveClass(this.IndicatorImg,"indicator-disabled")}else{RD3_Glb.AddClass(this.TextBox,"indicator-disabled");RD3_Glb.AddClass(this.IndicatorImg,"indicator-disabled")}}};Indicator.prototype.SetVisible=function(a){if(a!=undefined){this.Visible=a}if(this.Realized){if(this.IsVisible()){this.MyBox.style.display=""}else{this.MyBox.style.display="none"}RD3_DesktopManager.WebEntryPoint.IndObj.AdaptLayout()}};Indicator.prototype.SetText=function(a){if(a!=undefined){this.Text=a}if(this.Realized){this.TextBox.innerHTML=this.Text;RD3_DesktopManager.WebEntryPoint.IndObj.AdaptLayout()}};Indicator.prototype.SetImage=function(a){if(a!=undefined){this.Image=a}if(this.Realized){if(this.Image!=""){this.IndicatorImg.src=RD3_Glb.GetImgSrc("images/"+this.Image);this.IndicatorImg.style.display=""}else{this.IndicatorImg.style.display="none"}RD3_DesktopManager.WebEntryPoint.IndObj.AdaptLayout()}};Indicator.prototype.Realize=function(a){this.MyBox=document.createElement("span");this.MyBox.setAttribute("id",this.Identifier);this.IndicatorImg=document.createElement("img");this.TextBox=document.createElement("span");this.MyBox.className=((RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?"taskbar-":"")+"indicator-box";this.MyBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev)");this.IndicatorImg.className="indicator-image";this.TextBox.className="indicator-text";this.MyBox.appendChild(this.IndicatorImg);this.MyBox.appendChild(this.TextBox);a.appendChild(this.MyBox);this.Realized=true;this.SetFixedWidth();this.SetTooltip();this.SetEnabled();this.SetVisible();this.SetStyle();this.SetImage()};Indicator.prototype.IsVisible=function(){var e=this.Visible;if(this.IdxForm>0){var g=false;var a=RD3_DesktopManager.WebEntryPoint.ActiveForm;if(a&&a.IdxForm==this.FormIndex){g=true}var d=RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var b=0;b<d;b++){var c=RD3_DesktopManager.WebEntryPoint.StackForm[b];if(c.Docked&&c.IdxForm==this.FormIndex){g=true}}if(!g){e=false}}return e};Indicator.prototype.IsEnabled=function(){var c=this.Enabled;if(this.IdxForm>0){var g=false;var a=RD3_DesktopManager.WebEntryPoint.ActiveForm;if(a&&a.IdxForm==this.FormIndex){g=true}var e=RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var b=0;b<e;b++){var d=RD3_DesktopManager.WebEntryPoint.StackForm[b];if(d.Docked&&d.IdxForm==this.FormIndex){g=true}}if(!g){c=false}}return c};Indicator.prototype.OnClick=function(b){if(this.IsVisible()&&this.IsEnabled()){var a=new IDEvent("clk",this.Identifier,b,this.ClickEventDef)}};Indicator.prototype.Unrealize=function(){if(this.Realized){if(this.TimeTimer!=null){window.clearInterval(this.TimeTimer);this.TimeTimer=null}RD3_DesktopManager.ObjectMap.remove(this.Identifier);var a=this.MyBox.parentNode;a.removeChild(this.MyBox);this.MyBox=null;this.IndicatorImg=null;this.TextBox=null;this.Realized=false}};Indicator.prototype.TimeTick=function(){var c=new Date();switch(this.Style){case RD3_Glb.STYLE_TIME:var b=c.getMinutes();this.TextBox.innerHTML=c.getHours()+"."+(b<10?"0"+b:b);break;case RD3_Glb.STYLE_DATE:var c=new Date();var a=(c.getDate()<10?"0":"")+c.getDate();a+="/"+(c.getMonth()+1<10?"0":"")+(c.getMonth()+1);a+="/"+c.getFullYear();this.TextBox.innerHTML=a;break}};Indicator.prototype.GetInternalWidth=function(){if(!this.IsVisible()){return 0}if(this.FixedWidth>1){return this.FixedWidth}var a=0;if(this.Image!=""){a+=this.IndicatorImg.offsetWidth}a+=this.TextBox.offsetWidth;return a};Indicator.prototype.SetVisualWidth=function(b){var a=b;if(this.FixedWidth>1){a=this.FixedWidth}if(a==0){this.MyBox.style.width=""}else{this.MyBox.style.width=a+"px"}if(this.MyBox.offsetWidth!=a){var c=a-(this.MyBox.offsetWidth-a);this.MyBox.style.width=((c>=0)?c:0)+"px"}};Indicator.prototype.ActiveFormChanged=function(){this.SetVisible();this.SetEnabled()};Indicator.prototype.GetTooltip=function(a,b){if(this.Tooltip==""){return false}a.SetText(this.Tooltip);a.SetImage("");a.SetAutoAnchor(true);a.SetPosition(2);return true};function Message(a){this.Code="";this.Text="";this.Image="";this.Type=3;this.Temporary=true;this.Request="";this.ParentForm=a;this.Realized=false;this.MyBox=null;this.ImgBox=null;this.SpanText=null}Message.prototype.LoadFromXml=function(a){this.LoadProperties(a)};Message.prototype.ChangeProperties=function(a){this.LoadProperties(a)};Message.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"cod":this.SetCode(f.nodeValue);break;case"txt":this.SetText(f.nodeValue);break;case"img":this.SetImage(f.nodeValue);break;case"typ":this.SetType(parseInt(f.nodeValue));break;case"tem":this.SetTemporary(f.nodeValue=="1");break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}this.Request=RD3_DesktopManager.CurrentRequest;if(this.Realized&&this.Text==""&&this.Temporary){this.Request="";if(RD3_Glb.IsMobile()){this.ParentForm.OpenMessageBar(-1)}else{this.ParentForm.RealizeMessages()}}};Message.prototype.SetCode=function(a){if(a!=undefined){this.Code=a}if(this.Realized){}};Message.prototype.SetText=function(a){if(a!=undefined){this.Text=a}if(this.Realized){this.SpanText.innerHTML=this.Text;if(RD3_Glb.IsMobile()){this.SpanText.style.verticalAlign=this.SpanText.offsetHeight<20?"-6px":""}if(RD3_Glb.IsChrome()&&this.SpanText.offsetHeight<20){this.SpanText.innerHTML=this.Text}}};Message.prototype.SetImage=function(a){if(a!=undefined){this.Image=a}if(this.Realized){if(this.Image!=""){this.ImgBox.src=RD3_Glb.GetImgSrc("images/"+this.Image)}else{this.ImgBox.removeAttribute("src")}if((RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro())&&this.Image!=""){this.ImgBox.removeAttribute("width");this.ImgBox.removeAttribute("height");if(RD3_Glb.Adapt4Retina(this.Identifier,this.Image,24)){this.ImgBox.style.display="none"}}}};Message.prototype.SetType=function(b){if(b!=undefined){this.Type=b}if(this.Realized){if(this.Image==""){var a=RD3_Glb.IsMobile();switch(this.Type){case 1:this.ImgBox.src=RD3_Glb.GetImgSrc("images/"+(a?"info_24.png":"minfo_sm.gif"));break;case 2:this.ImgBox.src=RD3_Glb.GetImgSrc("images/"+(a?"warn_24.png":"mwarn_sm.gif"));break;case 3:this.ImgBox.src=RD3_Glb.GetImgSrc("images/"+(a?"stop_24.png":"mstop_sm.gif"));break}if(RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro()){this.ImgBox.width=24;this.ImgBox.height=24}}}};Message.prototype.SetTemporary=function(a){if(a!=undefined){this.Temporary=a}};Message.prototype.Realize=function(a){this.Realized=true;this.MyBox=document.createElement("div");this.MyBox.setAttribute("id",this.Identifier);this.MyBox.className="form-message-div";this.ImgBox=document.createElement("img");this.ImgBox.setAttribute("id",this.Identifier+":img");this.ImgBox.className="form-message-icon";this.SpanText=document.createElement("span");this.SpanText.setAttribute("id",this.Identifier+":txt");this.SpanText.className="form-message-text";this.MyBox.appendChild(this.ImgBox);this.MyBox.appendChild(this.SpanText);a.appendChild(this.MyBox);this.SetImage();this.SetType();this.SetText()};Message.prototype.Unrealize=function(){this.Realized=false;if(this.MyBox&&this.MyBox.parentNode){this.MyBox.parentNode.removeChild(this.MyBox)}RD3_DesktopManager.ObjectMap.remove(this.Identifier)};Message.prototype.EqualsTo=function(a){return a.Text==this.Text&&a.Type==this.Type&&a.Temporary==this.Temporary};Message.prototype.OnAdaptRetina=function(a,c,b){if(this.ImgBox){this.ImgBox.width=a;this.ImgBox.height=c;this.ImgBox.style.display=""}};function MessageBox(d,c,a,b){this.MessageText=d;this.Type=c;this.Send=true;if(a!=undefined){this.Send=a}this.Options="";if(b!=undefined&&b!=null){this.Options=b}this.Identifier="MSGBOX"+Math.floor(Math.random()*100);this.CallBackFunction=null;this.UserResponse="";this.Blocking=false;this.MsgTxt=null;this.ButtonBox=null;this.ConfirmButton=null;this.CancelButton=null;this.MsgInputDiv=null;this.MsgInput=null;this.MsgIconDiv=null;this.MsgIcon=null}MessageBox.prototype=new PopupFrame();MessageBox.prototype.Realize=function(){var e=RD3_Glb.IsMobile();if(RD3_ServerParams.BorderType==RD3_Glb.BORDER_DEFAULT){if(RD3_ServerParams.Theme=="seattle"){this.Borders=RD3_Glb.BORDER_THICK}else{this.Borders=RD3_Glb.BORDER_THIN}}else{this.Borders=RD3_ServerParams.BorderType}PopupFrame.prototype.Realize.call(this,"-message-box");this.PopupBox.style.zIndex=300;this.MsgIconDiv=document.createElement("div");this.MsgIconDiv.className="popup-icon-div";this.MsgIcon=document.createElement("img");this.MsgIcon.className="popup-icon";this.MsgTxt=document.createElement("span");this.MsgTxt.className="popup-text";if(this.MessageText.indexOf("cls=")==0&&this.MessageText.indexOf(",")!=-1){var a=this.MessageText.split(",")[0].substring(4);this.MsgTxt.innerHTML=this.MessageText.split(",")[1];RD3_Glb.AddClass(this.PopupBox,a)}else{this.MsgTxt.innerHTML=this.MessageText}if(this.MsgTxt.childNodes.length==1&&!this.MsgTxt.childNodes[0].tagName){this.MsgTxt.innerHTML=this.MsgTxt.innerHTML.replace(/\n/g,"<br/>")}this.MsgInputDiv=document.createElement("div");this.MsgInputDiv.style.height="10px";this.ButtonBox=document.createElement("div");this.ButtonBox.className="popup-button-div";if(this.Type==RD3_Glb.MSG_CONFIRM){this.CaptionBox.innerHTML=ClientMessages.MSG_POPUP_MsgConfirmCaption;if(!e){this.MsgIcon.src=RD3_Glb.GetImgSrc("images/dlg_ask.gif")}if(this.Options==""){this.ConfirmButton=document.createElement("button");this.ConfirmButton.innerHTML=ClientMessages.MSG_POPUP_YesButton;this.ConfirmButton.className="popup-button popup-button-yes";this.ConfirmButton.id=this.Identifier+":yes";this.CancelButton=document.createElement("button");this.CancelButton.innerHTML=ClientMessages.MSG_POPUP_NoButton;this.CancelButton.className="popup-button popup-button-no";this.CancelButton.id=this.Identifier+":no";RD3_Glb.AddClass(RD3_ClientParams.DefaultButton?this.ConfirmButton:this.CancelButton,"popup-button-default");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.ConfirmButton.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnOKClick', ev)");this.CancelButton.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCancelClick', ev)")}else{this.ConfirmButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnOKClick', ev)");this.CancelButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCancelClick', ev)")}this.ButtonBox.appendChild(this.ConfirmButton);this.ButtonBox.appendChild(this.CancelButton)}else{this.OptionsButtons=new Array();var d=this.Options.split(";");for(var c=0;c<d.length;c++){var b=document.createElement("button");b.innerHTML=d[c];b.className="popup-button-opt";b.id=this.Identifier+":opt"+c;if(RD3_Glb.IsMobile7()){b.style.width=(100/d.length)+"%"}if(c==0){RD3_Glb.AddClass(b,"popup-button-default")}if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){b.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnOptionClick', ev,"+(c+1)+")")}else{b.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnOptionClick', ev,"+(c+1)+")")}this.ButtonBox.appendChild(b);this.OptionsButtons[c]=b}}}else{if(this.Type==RD3_Glb.MSG_INPUT){this.CaptionBox.innerHTML=ClientMessages.MSG_POPUP_MsgInputCaption;if(!e){this.MsgIcon.src=RD3_Glb.GetImgSrc("images/dlg_ask.gif")}this.MsgInput=document.createElement("input");this.MsgInput.type="text";this.MsgInput.id=this.Identifier+":inp";this.MsgInput.className="popup-input";this.MsgInputDiv.className="popup-input-div";this.MsgInputDiv.appendChild(this.MsgInput);this.MsgInputDiv.style.height="";if(e&&(RD3_Glb.IsIphone(7)||RD3_Glb.IsIpad(7))){this.MsgInput.onblur=new Function("ev","document.body.scrollTop = 0;")}this.ConfirmButton=document.createElement("button");this.ConfirmButton.innerHTML=ClientMessages.MSG_POPUP_OkButton;this.ConfirmButton.className="popup-button popup-button-yes";this.ConfirmButton.id=this.Identifier+":yes";this.CancelButton=document.createElement("button");this.CancelButton.innerHTML=ClientMessages.MSG_POPUP_CancelButton;this.CancelButton.className="popup-button popup-button-no";this.CancelButton.id=this.Identifier+":no";RD3_Glb.AddClass(RD3_ClientParams.DefaultButton?this.ConfirmButton:this.CancelButton,"popup-button-default");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.ConfirmButton.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnOKClick', ev)");this.CancelButton.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCancelClick', ev)")}else{this.ConfirmButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnOKClick', ev)");this.CancelButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCancelClick', ev)")}this.ButtonBox.appendChild(this.ConfirmButton);this.ButtonBox.appendChild(this.CancelButton)}else{this.CaptionBox.innerHTML=ClientMessages.MSG_POPUP_MsgBoxCaption;if(!e){this.MsgIcon.src=RD3_Glb.GetImgSrc("images/dlg_warn.gif")}this.ConfirmButton=document.createElement("button");this.ConfirmButton.innerHTML="<span>"+ClientMessages.MSG_POPUP_OkButton+"</span>";this.ConfirmButton.className="popup-button popup-button-yes";this.ConfirmButton.id=this.Identifier+":yes";if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.ConfirmButton.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnOKClick', ev)")}else{this.ConfirmButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnOKClick', ev)")}this.ButtonBox.appendChild(this.ConfirmButton)}}this.MsgIconDiv.appendChild(this.MsgIcon);this.ContentBox.appendChild(this.MsgIconDiv);this.ContentBox.appendChild(this.MsgTxt);this.ContentBox.appendChild(this.MsgInputDiv);this.ContentBox.appendChild(this.ButtonBox);this.PopupBox.onkeydown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyPress', ev)");this.ModalBox.onkeydown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyPress', ev)");if(!RD3_Glb.IsIE(10,false)){var f=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyPress', ev)");if(document.addEventListener){document.body.addEventListener("keypress",f,true)}else{document.body.attachEvent("keypress",f)}}};MessageBox.prototype.Unrealize=function(){PopupFrame.prototype.Unrealize.call(this);this.MsgTxt=null;this.ButtonBox=null;this.ConfirmButton=null;this.MsgInput=null;if(this.OptionsButtons){this.OptionsButtons=null}RD3_DesktopManager.WebEntryPoint.VoiceObj.OnCloseMessageBox(this);if(!RD3_Glb.IsIE(10,false)){var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyPress', ev)");if(document.addEventListener){document.body.removeEventListener("keyup",a,true)}}};MessageBox.prototype.AdaptLayout=function(){var f=RD3_Glb.IsMobile();var c=(this.Type==RD3_Glb.MSG_INPUT)?RD3_ClientParams.PopupInputMinW:RD3_ClientParams.PopupDlgMinW;if(this.OptionsButtons&&c<300){c=300}if(f){if(this.Type==RD3_Glb.MSG_CONFIRM&&c<300){c=300}}var e=RD3_Glb.IsTouch()?0.8:0.5;var g=RD3_DesktopManager.WebEntryPoint.WepBox.clientWidth*e;if(g<300){g=300}var b;this.ContentBox.style.width=g+"px";var a=this.MsgTxt.offsetWidth+this.MsgIconDiv.offsetWidth;this.MsgTxt.style.left=this.MsgIconDiv.offsetWidth+"px";b=(a<c)?c:a;b=(b>g)?g:b;this.SetWidth(b);RD3_Glb.AdaptToParent(this.CaptionBox,0,-1);RD3_Glb.AdaptToParent(this.ContentBox,0,-1);this.ButtonBox.style.width=this.ContentBox.offsetWidth+"px";this.MsgTxt.style.top="0px";this.MsgIconDiv.style.top=this.MsgTxt.offsetTop+"px";this.MsgInputDiv.style.top=(this.MsgTxt.offsetTop+this.MsgTxt.offsetHeight)+"px";this.MsgInputDiv.style.left=this.MsgTxt.offsetLeft+"px";this.MsgInputDiv.style.width=(this.ContentBox.offsetWidth-this.MsgTxt.offsetLeft-20)+"px";if(this.MsgInput){if(!f){this.MsgIcon.src=RD3_Glb.GetImgSrc("images/dlg_input.gif")}RD3_Glb.AdaptToParent(this.MsgInput,0,-1)}if(this.OptionsButtons){for(var d=0;d<this.OptionsButtons.length;d++){if(this.OptionsButtons[d].offsetWidth<70){this.OptionsButtons[d].style.width="70px"}}}this.ButtonBox.style.top=(this.MsgTxt.offsetTop+this.MsgTxt.offsetHeight+this.MsgInputDiv.offsetHeight+(this.Options==""?0:15))+"px";this.SetHeight(this.ButtonBox.offsetTop+this.ButtonBox.offsetHeight+this.CaptionBox.offsetHeight);PopupFrame.prototype.AdaptLayout.call(this);this.Centered=false;switch(this.Type){case RD3_Glb.MSG_BOX:this.ConfirmButton.focus();break;case RD3_Glb.MSG_CONFIRM:if(this.Options==""){if(!RD3_ClientParams.DefaultButton){this.CancelButton.focus()}else{this.ConfirmButton.focus()}}else{this.OptionsButtons[0].focus()}break;case RD3_Glb.MSG_INPUT:if(!RD3_Glb.IsTouch()){this.MsgInput.focus()}break}RD3_KBManager.CheckFocus=false;RD3_KBManager.DontCheckFocus=true};MessageBox.prototype.OnOKClick=function(b){var c="";if(this.Type==RD3_Glb.MSG_CONFIRM){c="Y"}if(this.Type==RD3_Glb.MSG_INPUT){c=this.MsgInput.value}if(this.Type!=RD3_Glb.MSG_BOX&&this.Send){var a=new IDEvent("msgcfr",this.Identifier,b,(this.Blocking?RD3_Glb.EVENT_URGENT:RD3_Glb.EVENT_ACTIVE),this.MessageText,c)}if(this.CallBackFunction){this.UserResponse=c;this.CallBackFunction()}this.Close()};MessageBox.prototype.OnCancelClick=function(b){var c="";if(this.Type==RD3_Glb.MSG_CONFIRM){c="N"}if(this.Type!=RD3_Glb.MSG_BOX&&this.Send){var a=new IDEvent("msgcfr",this.Identifier,b,(this.Blocking?RD3_Glb.EVENT_URGENT:RD3_Glb.EVENT_ACTIVE),this.MessageText,c)}if(this.CallBackFunction){this.UserResponse=c;this.CallBackFunction()}this.Close()};MessageBox.prototype.OnOptionClick=function(c,a){if(this.Type==RD3_Glb.MSG_CONFIRM&&this.Send){var b=new IDEvent("msgcfr",this.Identifier,c,(this.Blocking?RD3_Glb.EVENT_URGENT:RD3_Glb.EVENT_ACTIVE),this.MessageText,a)}if(this.CallBackFunction){this.UserResponse=a;this.CallBackFunction()}this.Close()};MessageBox.prototype.OnKeyPress=function(g){var d=(g.charCode)?g.charCode:g.keyCode;var f=(window.event)?g.srcElement:g.explicitOriginalTarget;if(d==13||(d==32&&this.Type!=RD3_Glb.MSG_INPUT)){if(this.Type!=RD3_Glb.MSG_BOX){if(this.Options==""){if(!RD3_ClientParams.DefaultButton){this.OnCancelClick(g)}else{var e=RD3_KBManager.GetActiveElement();if(e==this.CancelButton){this.OnCancelClick(g)}else{this.OnOKClick(g)}}}else{for(var c=0;c<this.OptionsButtons.length;c++){if(f==this.OptionsButtons[c]){this.OnOptionClick(g,c+1);break}}}}else{this.OnOKClick(g)}}if(d==27){if(this.Type!=RD3_Glb.MSG_BOX){if(this.Options==""){if(!RD3_ClientParams.DefaultButton){this.OnOKClick(g)}else{this.OnCancelClick(g)}}else{this.OnOptionClick(g,this.OptionsButtons.length)}}else{this.OnOKClick(g)}}if(d==9){if(RD3_Glb.IsFirefox()&&g.type=="keypress"){return false}var h=null;var e=RD3_KBManager.GetActiveElement();var b=window.event?window.event.shiftKey:g.shiftKey;if(this.Type==RD3_Glb.MSG_CONFIRM){if(this.Options==""){if(e==this.CancelButton){h=this.ConfirmButton}else{h=this.CancelButton}}else{for(var a=0;a<this.OptionsButtons.length;a++){if(this.OptionsButtons[a]==e){if(a==this.OptionsButtons.length-1&&!b){h=this.OptionsButtons[0]}else{if(a==0&&b){h=this.OptionsButtons[this.OptionsButtons.length-1]}else{h=this.OptionsButtons[(b?a-1:a+1)]}}break}}}}else{if(this.Type==RD3_Glb.MSG_INPUT){if(e==this.ConfirmButton){if(b){h=this.MsgInput}else{h=this.CancelButton}}else{if(e==this.CancelButton){if(b){h=this.ConfirmButton}else{h=this.MsgInput}}else{if(e==this.MsgInput){if(b){h=this.CancelButton}else{h=this.ConfirmButton}}}}}}if(h){h.focus();if(RD3_Glb.IsChrome()||RD3_Glb.IsSafari()){if(!this.HackDone&&this.Type==RD3_Glb.MSG_CONFIRM&&e==this.ConfirmButton){this.HackDone=true;e.style.width=(parseInt(e.clientWidth)+3)+"px"}e.style.outline="none";h.style.outline="transparent solid 0px"}}RD3_Glb.StopEvent(g);return false}return true};MessageBox.prototype.Open=function(){PopupFrame.prototype.Open.call(this);switch(this.Type){case RD3_Glb.MSG_BOX:RD3_DesktopManager.WebEntryPoint.SoundAction("info","play");break;case RD3_Glb.MSG_CONFIRM:case RD3_Glb.MSG_INPUT:RD3_DesktopManager.WebEntryPoint.SoundAction("warning","play");break}};MessageBox.prototype.Close=function(){if(this.Type==RD3_Glb.MSG_INPUT){this.MsgInput.blur();if(!RD3_Glb.IsAndroid()){this.ConfirmButton.focus()}}PopupFrame.prototype.Close.call(this)};MessageBox.prototype.OnVoiceCommand=function(e){if(this.Type==RD3_Glb.MSG_CONFIRM){var c=e.trim().charAt(0).toUpperCase()+e.trim().slice(1);if(this.Options==""){if(this.ConfirmButton&&this.ConfirmButton.value==c){this.ConfirmButton.click()}else{if(this.CancelButton&&this.CancelButton.value==c){this.CancelButton.click()}}}else{this.OptionsButtons=new Array();var d=this.Options.split(";");for(var b=0;b<d.length;b++){var a=document.createElement("input");if(a.value==c){a.click();break}}}}else{if(this.Type==RD3_Glb.MSG_INPUT){if(this.CancelButton&&this.CancelButton.value==c){this.CancelButton.click()}else{this.MsgInput.value=c;this.ConfirmButton.click()}}else{}}};function MessageTooltip(a){this.Style="info";this.Image=RD3_Glb.IsMobile()?"":RD3_Glb.GetImgSrc("images/minfo_sm.gif");this.Title="";this.MessageText="";this.RoundBorders=true;this.Position=0;this.HasWhisker=true;this.Obj=null;this.AnchorX=-1;this.AnchorY=-1;this.AutoAnchor=false;this.DelayShow=750;this.DelayHide=4000;this.ShowTimerID=0;this.HideTimerID=0;this.ReposTimerID=0;this.Owner=a;this.Opened=false;this.CanClose=false;this.ShowOnInactivity=false;this.AnimDef="fade:250";this.ReusableTooltip=false;this.BorderRoundWidth=3;this.MaxBorderLength=1000;this.WhiskerBase=RD3_Glb.IsMobile()?11:9;this.WhiskerHeight=RD3_Glb.IsMobile()?12:10;this.WhiskerOffset=RD3_Glb.IsMobile()?7:5;this.CloseImgWidth=15;this.MaxTooltipWidth=300;this.ImgObj=null;this.TitleBox=null;this.MsgBox=null;this.Whisker=null;this.CloseObj=null;this.Init()}MessageTooltip.prototype=new PopupFrame();MessageTooltip.prototype.Init=function(){this.Identifier="TOOLTIP"+Math.floor(Math.random()*1000000);RD3_DesktopManager.ObjectMap.add(this.Identifier,this);if(RD3_Glb.IsIE(6)){this.RoundBorders=false;this.HasWhisker=false}if(RD3_Glb.IsMobile()){this.RoundBorders=false}};MessageTooltip.prototype.Realize=function(){this.Centered=false;this.Modal=false;this.CanMove=false;this.CanResize=false;this.HasCaption=false;this.Borders=RD3_Glb.BORDER_NONE;PopupFrame.prototype.Realize.call(this);this.PopupBox.setAttribute("id",this.Identifier);this.ImgObj=document.createElement("img");this.ImgObj.className="messagetooltip-image";this.ContentBox.appendChild(this.ImgObj);this.SetImage();this.TitleBox=document.createElement("span");this.TitleBox.className="messagetooltip-title";this.ContentBox.appendChild(this.TitleBox);this.SetTitle();this.MsgBox=document.createElement("div");this.MsgBox.className="messagetooltip-text";this.ContentBox.appendChild(this.MsgBox);this.SetText();this.BorderTop=document.createElement("div");this.BorderTop.className="messagetooltip-border-top";this.PopupBox.appendChild(this.BorderTop);this.BorderRight=document.createElement("div");this.BorderRight.className="messagetooltip-border-right";this.PopupBox.appendChild(this.BorderRight);this.BorderBottom=document.createElement("div");this.BorderBottom.className="messagetooltip-border-bottom";this.PopupBox.appendChild(this.BorderBottom);this.BorderLeft=document.createElement("div");this.BorderLeft.className="messagetooltip-border-left";this.PopupBox.appendChild(this.BorderLeft);this.SetRoundBorders();this.Whisker=document.createElement("div");this.Whisker.className="messagetooltip-whisker";this.PopupBox.appendChild(this.Whisker);this.SetHasWhisker();this.CloseObj=document.createElement("div");this.CloseObj.className="messagetooltip-close-image";this.CloseObj.style.backgroundPosition=(this.CloseImgWidth-this.MaxBorderLength+this.BorderRoundWidth)+"px "+(-this.BorderRoundWidth)+"px";this.CloseObj.onclick=new Function("ev","RD3_DesktopManager.ObjectMap['"+this.Identifier+"'].Deactivate("+(this.ReusableTooltip?"true":"")+")");this.ContentBox.appendChild(this.CloseObj);this.SetCanClose();this.SetStyle()};MessageTooltip.prototype.Reset=function(){this.SetTitle("");this.SetText("");this.SetRoundBorders(true);this.SetHasWhisker(true);this.SetPosition(0);this.SetStyle("info");this.SetAnchor(-1,-1);this.SetAutoAnchor(false);this.SetObj(null);this.SetDelay(750,4000);this.SetWidth(0);this.SetHeight(0);this.SetAnimDef("fade:250")};MessageTooltip.prototype.Unrealize=function(){if(this.Realized){PopupFrame.prototype.Unrealize.call(this);this.ImgObj=null;this.TitleBox=null;this.MsgBox=null;this.Whisker=null;this.CloseObj=null;this.Owner=null}else{RD3_DesktopManager.ObjectMap.remove(this.Identifier)}};MessageTooltip.prototype.AdaptLayout=function(b){var d=RD3_Glb.IsMobile();var a=d&&(RD3_Glb.IsIE()||RD3_Glb.IsEdge());this.MsgBox.style.borderTopWidth=(this.Title.length>0?1:0)+"px";this.TitleBox.style.marginLeft=(this.Image.length>0?4:0)+"px";var e=(this.Image.length>0?this.ImgObj.offsetWidth+4:0);this.MsgBox.style.marginLeft=e+"px";if(this.Width==0||b){this.MsgBox.style.width=(this.MaxTooltipWidth-e)+"px";var c=this.MsgBox.childNodes[0];if(c){this.MsgBox.style.width=Math.max(c.offsetWidth,this.TitleBox.offsetWidth+(this.CanClose?this.CloseImgWidth+2:0))+"px"}this.SetWidth(this.MsgBox.offsetLeft+this.MsgBox.offsetWidth)}else{this.MsgBox.style.width=(this.Width-e)+"px"}if(this.Height==0||b){this.MsgBox.style.height=(this.MaxTooltipWidth-this.MsgBox.offsetTop)+"px";var c=this.MsgBox.childNodes[0];if(c){this.MsgBox.style.height=c.offsetHeight+"px"}this.SetHeight(this.MsgBox.offsetTop+this.MsgBox.offsetHeight)}else{this.MsgBox.style.height=(this.Height-this.TitleBox.offsetHeight)+"px"}this.CloseObj.style.left=(this.Width-this.CloseImgWidth)+"px";if(this.RoundBorders){this.BorderTop.style.top=(0-this.BorderTop.offsetHeight)+"px";this.BorderTop.style.left=(-this.BorderRoundWidth)+"px";this.BorderTop.style.width=(this.Width+this.BorderRoundWidth)+"px";this.BorderRight.style.left=(0+this.Width)+"px";this.BorderRight.style.top=(-this.BorderRoundWidth)+"px";this.BorderRight.style.height=(this.Height+this.BorderRoundWidth)+"px";this.BorderRight.style.backgroundPosition=(this.BorderRoundWidth-this.MaxBorderLength)+"px 0px";this.BorderBottom.style.top=(0+this.Height)+"px";this.BorderBottom.style.left=(0)+"px";this.BorderBottom.style.width=(this.Width+this.BorderRoundWidth)+"px";this.BorderBottom.style.backgroundPosition=(this.Width+this.BorderRoundWidth-this.MaxBorderLength)+"px "+(this.BorderRoundWidth-this.MaxBorderLength)+"px";this.BorderLeft.style.left=(0-this.BorderLeft.offsetWidth)+"px";this.BorderLeft.style.top=(0)+"px";this.BorderLeft.style.height=(this.Height+this.BorderRoundWidth)+"px";this.BorderLeft.style.backgroundPosition="0px "+(this.Height+this.BorderRoundWidth-this.MaxBorderLength)+"px"}if(this.HasWhisker){switch(this.aPosition){case 0:this.Whisker.style.left=(0+this.aWhiskerOffset)+"px";this.Whisker.style.top=(this.Height+(d?-1:0)+(a?4:0)+(this.RoundBorders?this.BorderRoundWidth-2:0))+"px";this.Whisker.style.height=this.WhiskerHeight+"px";this.Whisker.style.width=this.WhiskerBase+"px";if(d){if(a){this.Whisker.style.borderLeft="none";this.Whisker.style.borderTop="none";this.Whisker.style.background="linear-gradient(to top left, #efeff4 0%, #efeff4 50%, rgba(255,255,255,0) 50%, rgba(255,255,255,0) 100%)"}else{this.Whisker.style.webkitMaskImage="-webkit-gradient(linear, right bottom, left top, from(black), color-stop(0.50, black), color-stop(0.50, rgba(0,0,0,0)), to(rgba(0,0,0,0)))"}}else{this.Whisker.style.backgroundPosition=-this.BorderRoundWidth-(1*this.WhiskerBase)+"px "+(-this.BorderRoundWidth)+"px"}break;case 1:this.Whisker.style.left=(-this.WhiskerHeight+(d?3:0)-(this.RoundBorders?this.BorderRoundWidth-2:0))+"px";this.Whisker.style.top=(this.aWhiskerOffset)+"px";this.Whisker.style.height=this.WhiskerBase+"px";this.Whisker.style.width=this.WhiskerHeight+"px";if(d){if(a){this.Whisker.style.borderRight="none";this.Whisker.style.borderTop="none";this.Whisker.style.background="linear-gradient(to top right, white 0%, white 50%, rgba(255,255,255,0) 50%, rgba(255,255,255,0) 100%)"}else{this.Whisker.style.webkitMaskImage="-webkit-gradient(linear, left bottom, right top, from(black), color-stop(0.50, black), color-stop(0.50, rgba(0,0,0,0)), to(rgba(0,0,0,0)))"}}else{this.Whisker.style.backgroundPosition=-this.BorderRoundWidth-(3*this.WhiskerBase)+"px "+(-this.BorderRoundWidth)+"px"}break;case 2:this.Whisker.style.left=(this.aWhiskerOffset)+"px";this.Whisker.style.top=(-this.WhiskerHeight+(d?3:0)-(this.RoundBorders?this.BorderRoundWidth-2:0))+"px";this.Whisker.style.height=this.WhiskerHeight+"px";this.Whisker.style.width=this.WhiskerBase+"px";if(d){if(a){this.Whisker.style.borderRight="none";this.Whisker.style.borderBottom="none";this.Whisker.style.background="linear-gradient(to bottom right, #efeff4 0%, #efeff4 50%, rgba(255,255,255,0) 50%, rgba(255,255,255,0) 100%)"}else{this.Whisker.style.webkitMaskImage="-webkit-gradient(linear, left top, right bottom, from(black), color-stop(0.50, black), color-stop(0.50, rgba(0,0,0,0)), to(rgba(0,0,0,0)))"}}else{this.Whisker.style.backgroundPosition=-this.BorderRoundWidth-(0*this.WhiskerBase)+"px "+(-this.BorderRoundWidth)+"px"}break;case 3:this.Whisker.style.left=(this.Width+(d?-1:0)+(a?4:0)+(this.RoundBorders?this.BorderRoundWidth-2:0))+"px";this.Whisker.style.top=(this.aWhiskerOffset)+"px";this.Whisker.style.height=this.WhiskerBase+"px";this.Whisker.style.width=this.WhiskerHeight+"px";if(d){if(a){this.Whisker.style.borderLeft="none";this.Whisker.style.borderBottom="none";this.Whisker.style.background="linear-gradient(to bottom left, white 0%, white 50%, rgba(255,255,255,0) 50%, rgba(255,255,255,0) 100%)"}else{this.Whisker.style.webkitMaskImage="-webkit-gradient(linear, right top, left bottom, from(black), color-stop(0.50, black), color-stop(0.50, rgba(0,0,0,0)), to(rgba(0,0,0,0)))"}}else{this.Whisker.style.backgroundPosition=-this.BorderRoundWidth-(2*this.WhiskerBase)+"px "+(-this.BorderRoundWidth)+"px"}break}}};MessageTooltip.prototype.Activate=function(a,c){this.Deactivate(true);if(this.AutoAnchor){this.SetAnchor(a,c)}var b="var me = RD3_DesktopManager.ObjectMap['"+this.Identifier+"'];";b+="if (me && (!me.Obj || RD3_TooltipManager.IsObjVisible(me.Obj)))";b+="RD3_GFXManager.AddEffect(new GFX('tooltip', true, me), null, null, '"+this.AnimDef+"')";this.ShowTimerID=window.setTimeout(b,this.DelayShow)};MessageTooltip.prototype.Deactivate=function(a){if(this.ShowTimerID!=0){window.clearTimeout(this.ShowTimerID);this.ShowTimerID=0}if(this.HideTimerID!=0){window.clearTimeout(this.HideTimerID);this.HideTimerID=0}if(this.ReposTimerID!=0){clearInterval(this.ReposTimerID);this.ReposTimerID=0}if(!a){RD3_TooltipManager.OnDeactivate(this)}if(this.Opened){RD3_GFXManager.AddEffect(new GFX("tooltip",false,this,null,null,this.AnimDef))}};MessageTooltip.prototype.Open=function(){this.ShowTimerID=0;this.Opened=true;if(!this.Realized){this.Realize()}else{this.PopupBox.style.display=""}if(this.PopupBox.parentNode==document.body){document.body.removeChild(this.PopupBox)}document.body.appendChild(this.PopupBox);var c=0;var g=0;this.aPosition=this.Position;this.aWhiskerOffset=this.WhiskerOffset;this.aAnchorX=this.AnchorX;this.aAnchorY=this.AnchorY;if(this.Obj){this.LastObjTop=RD3_Glb.GetScreenTop(this.Obj,true);this.LastObjLeft=RD3_Glb.GetScreenLeft(this.Obj,true)}var d=0;while(d<10){this.AdaptLayout();var i=RD3_DesktopManager.WebEntryPoint.WepBox;if(!this.Obj&&(this.AnchorX==-1||this.AnchorY==-1)){this.aAnchorX=i.clientWidth/2;this.aAnchorY=i.clientHeight/2;c=-(this.Width/2);g=-(this.Height/2);break}if(this.Owner instanceof WebFrame&&this.Obj==this.Owner.FrameBox&&(this.AnchorX==-1||this.AnchorY==-1)){this.aAnchorX=RD3_Glb.GetScreenLeft(this.Obj,true)+(this.Obj.clientWidth/2);this.aAnchorY=RD3_Glb.GetScreenTop(this.Obj,true)+(this.Obj.clientHeight/2);c=-(this.Width/2);g=-(this.Height/2);break}switch(this.aPosition){case 0:g=-(this.RoundBorders?this.BorderRoundWidth:0)-(this.HasWhisker?this.WhiskerHeight:0)-this.Height;c=-(this.HasWhisker?(this.WhiskerBase/2)+this.aWhiskerOffset:0);if(this.AutoAnchor){this.aAnchorY=this.AnchorY-10}else{if(this.Obj&&this.AnchorX==-1){this.aAnchorY=this.LastObjTop;this.aAnchorX=this.LastObjLeft+(this.Obj.offsetWidth/2)}}break;case 1:g=-(this.HasWhisker?(this.WhiskerBase/2)+this.aWhiskerOffset:0);c=(this.RoundBorders?this.BorderRoundWidth:0)+(this.HasWhisker?this.WhiskerHeight:0);if(this.AutoAnchor){this.aAnchorX=this.AnchorX+10}else{if(this.Obj&&this.AnchorX==-1){this.aAnchorY=this.LastObjTop+(this.Obj.offsetHeight/2);this.aAnchorX=this.LastObjLeft+this.Obj.offsetWidth}}break;case 2:g=(this.RoundBorders?this.BorderRoundWidth:0)+(this.HasWhisker?this.WhiskerHeight:0);c=-(this.HasWhisker?(this.WhiskerBase/2)+this.aWhiskerOffset:0);if(this.AutoAnchor){this.aAnchorY=this.AnchorY+10}else{if(this.Obj&&this.AnchorX==-1){this.aAnchorY=this.LastObjTop+this.Obj.offsetHeight;this.aAnchorX=this.LastObjLeft+(this.Obj.offsetWidth/2)}}break;case 3:g=-(this.HasWhisker?(this.WhiskerBase/2)+this.aWhiskerOffset:0);c=-this.Width-(this.RoundBorders?this.BorderRoundWidth:0)-(this.HasWhisker?this.WhiskerHeight:0);if(this.AutoAnchor){this.aAnchorX=this.AnchorX-10}else{if(this.Obj&&this.AnchorX==-1){this.aAnchorY=this.LastObjTop+(this.Obj.offsetHeight/2);this.aAnchorX=this.LastObjLeft}}break}var b=this.Width;var f=this.Height;var a=this.aAnchorX+c;var e=this.aAnchorY+g;if(this.RoundBorders){b+=2*this.BorderRoundWidth;f+=2*this.BorderRoundWidth;a-=this.BorderRoundWidth;e-=this.BorderRoundWidth}if(this.HasWhisker){if(this.aPosition==0||this.aPosition==2){f+=this.WhiskerHeight;e-=this.WhiskerHeight}else{b+=this.WhiskerHeight;a-=this.WhiskerHeight}}if(a+b>i.clientWidth||a<0||e+f>i.clientHeight||e<0){if(!this.AutoAnchor){this.SetAnchor(-1,-1)}d+=(this.HasWhisker?1:2);if((d&1)>0){this.aWhiskerOffset=((this.aPosition%1)==0?this.Width:this.Height)-this.WhiskerBase-this.WhiskerOffset}else{this.aWhiskerOffset=this.WhiskerOffset}if((d&2)>0){this.aPosition=(this.aPosition+2)%4}if((d&4)>0){this.aPosition=(this.aPosition+1)%4}if(d>=8){this.aPosition=(d==8?0:2);b=this.Width+(this.RoundBorders?2:0)*this.BorderRoundWidth;this.aAnchorX=this.AnchorX;this.aWhiskerOffset=this.AnchorX-this.WhiskerBase-((i.clientWidth-b)/2)}}else{break}}this.PopupBox.style.top=(this.aAnchorY+g)+"px";this.PopupBox.style.left=(this.aAnchorX+c)+"px";if(this.DelayHide>0){this.HideTimerID=window.setTimeout("RD3_DesktopManager.ObjectMap['"+this.Identifier+"'].Deactivate()",this.DelayHide)}if(this.ReposTimerID==0&&!this.AutoAnchor){this.ReposTimerID=setInterval("RD3_DesktopManager.ObjectMap['"+this.Identifier+"'].Tick()",250)}};MessageTooltip.prototype.Close=function(){this.HideTimerID=0;this.Opened=false;if(this.Realized){this.PopupBox.style.display="none";if(RD3_TooltipManager.CustomTooltip==this){RD3_TooltipManager.CustomTooltip=null;document.body.removeChild(this.PopupBox)}if(!this.Owner){this.Unrealize()}}};MessageTooltip.prototype.SetText=function(b){if(b!=undefined){this.MessageText=b}if(this.Realized){this.MsgBox.innerHTML=this.MessageText;if(this.MsgBox.childNodes.length==1&&!this.MsgBox.childNodes[0].tagName){this.MessageText=this.MessageText.replace(/\n/g,"<br/>");this.MsgBox.innerHTML=this.MessageText}if(this.MsgBox.childNodes.length>1||(this.MsgBox.childNodes.length==1&&!this.MsgBox.childNodes[0].tagName)){var a=document.createElement("SPAN");while(this.MsgBox.childNodes.length>0){a.appendChild(this.MsgBox.childNodes[0])}this.MsgBox.appendChild(a)}}};MessageTooltip.prototype.SetTitle=function(a){if(a!=undefined){this.Title=a}if(this.Realized){this.TitleBox.innerHTML=this.Title}};MessageTooltip.prototype.SetImage=function(b){if(b!=undefined){this.Image=b}if(this.Realized){if(this.Image==""){this.ImgObj.style.display="none"}else{this.ImgObj.src=RD3_Glb.GetImgSrc(this.Image);this.ImgObj.style.display="inline";if(!RD3_Glb.IsIE(10,false)){this.ImgObj.onload=new Function("ev","RD3_DesktopManager.ObjectMap['"+this.Identifier+"'].AdaptLayout("+(RD3_Glb.IsMobile()?"":"true")+")")}else{this.ImgObj.onreadystatechange=new Function("ev","var ttp=RD3_DesktopManager.ObjectMap['"+this.Identifier+"']; if (ttp && ttp.Opened) ttp.AdaptLayout("+(RD3_Glb.IsMobile()?"":"true")+");")}}if((RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro())&&this.Image!=""){this.ImgObj.removeAttribute("width");this.ImgObj.removeAttribute("height");var a="";switch(this.Style){case"info":a="info_24.png";break;case"warning":a="warn_24.png";break;case"error":a="stop_24.png";break}if(RD3_Glb.Adapt4Retina(this.Identifier,a,24)){this.ImgObj.style.display="none"}}}};MessageTooltip.prototype.SetStyle=function(c){if(c!=undefined){this.Style=c;var b=RD3_Glb.IsMobile();switch(this.Style){case"info":this.Image=RD3_Glb.GetImgSrc(b?"images/info_24.png":"images/minfo_sm.gif");break;case"warning":this.Image=RD3_Glb.GetImgSrc(b?"images/warn_24.png":"images/mwarn_sm.gif");break;case"error":this.Image=RD3_Glb.GetImgSrc(b?"images/stop_24.png":"images/mstop_sm.gif");break;default:if(this.Style!=""){this.Image=RD3_Glb.GetImgSrc(b?"images/"+this.Style+".png":"images/"+this.Style+".gif")}else{this.Image=""}break}}if(this.Realized){this.SetImage();if(this.ImgObj&&(RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro())){if(this.Style=="info"||this.Style=="warning"||this.Style=="error"){this.ImgObj.width=24;this.ImgObj.height=24}else{var a="";switch(this.Style){case"info":a="info_24.png";break;case"warning":a="warn_24.png";break;case"error":a="stop_24.png";break}if(RD3_Glb.Adapt4Retina(this.Identifier,a,24)){this.ImgObj.style.display="none"}else{this.ImgObj.removeAttribute("width");this.ImgObj.removeAttribute("height")}}}this.PopupBox.className="messagetooltip-frame-container";this.TitleBox.className="messagetooltip-title";if(this.Style!=""){this.PopupBox.className+=" messagetooltip-frame-container-"+this.Style;this.TitleBox.className+=" messagetooltip-title-"+this.Style;if(!RD3_Glb.IsMobile()){this.BorderTop.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/tooltip_"+this.Style+".gif)";this.BorderRight.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/tooltip_"+this.Style+".gif)";this.BorderBottom.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/tooltip_"+this.Style+".gif)";this.BorderLeft.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/tooltip_"+this.Style+".gif)";this.Whisker.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/tooltip_"+this.Style+".gif)";this.CloseObj.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/tooltip_"+this.Style+".gif)"}}}};MessageTooltip.prototype.SetRoundBorders=function(a){if(a!=undefined){if(RD3_Glb.IsIE(6)){this.RoundBorders=false}else{this.RoundBorders=a}}if(this.Realized){if(this.RoundBorders){this.BorderTop.style.display="";this.BorderRight.style.display="";this.BorderBottom.style.display="";this.BorderLeft.style.display="";this.BorderTop.style.visibility="visible";this.BorderRight.style.visibility="visible";this.BorderBottom.style.visibility="visible";this.BorderLeft.style.visibility="visible"}else{this.BorderTop.style.display="none";this.BorderRight.style.display="none";this.BorderBottom.style.display="none";this.BorderLeft.style.display="none";this.BorderTop.style.visibility="hidden";this.BorderRight.style.visibility="hidden";this.BorderBottom.style.visibility="hidden";this.BorderLeft.style.visibility="hidden"}}};MessageTooltip.prototype.SetPosition=function(a){if(a!=undefined){this.Position=a}};MessageTooltip.prototype.SetHasWhisker=function(a){if(a!=undefined){if(RD3_Glb.IsIE(6)){this.HasWhisker=false}else{this.HasWhisker=a}}if(this.Realized){this.Whisker.style.display=(this.HasWhisker?"":"none");this.Whisker.style.visibility=(this.HasWhisker?"visible":"hidden")}};MessageTooltip.prototype.SetOwner=function(a){this.Owner=a};MessageTooltip.prototype.SetObj=function(a){this.Obj=a};MessageTooltip.prototype.SetAnchor=function(b,a){this.AnchorX=b;this.AnchorY=a};MessageTooltip.prototype.SetAutoAnchor=function(a){this.AutoAnchor=a};MessageTooltip.prototype.SetDelay=function(a,b){this.DelayShow=a;this.DelayHide=b;this.SetCanClose(this.DelayHide<=0)};MessageTooltip.prototype.SetCanClose=function(a){if(a!=undefined){this.CanClose=a}if(this.Realized){this.CloseObj.style.display=(this.CanClose?"":"none")}};MessageTooltip.prototype.SetShowOnInactivity=function(a){if(a!=undefined){this.ShowOnInactivity=a}};MessageTooltip.prototype.SetAnimDef=function(a){if(a!=undefined){this.AnimDef=a}};MessageTooltip.prototype.Tick=function(){if(this.Obj){var c=this.Obj.parentNode;var d=false;while(c&&!d){d=(c==document.body);c=c.parentNode}if(d&&RD3_TooltipManager.IsObjVisible(this.Obj)){var a=RD3_Glb.GetScreenTop(this.Obj,true)-this.LastObjTop;var b=RD3_Glb.GetScreenLeft(this.Obj,true)-this.LastObjLeft;if(a==0&&b==0){return}if(this.DelayHide>0){this.Deactivate();return}this.LastObjTop+=a;this.LastObjLeft+=b;this.AnchorX+=b;this.AnchorY+=a;this.Activate()}else{this.Deactivate()}}};MessageTooltip.prototype.OnAdaptRetina=function(a,c,b){if(this.ImgObj){this.ImgObj.width=a;this.ImgObj.height=c;this.ImgObj.style.display=""}};function PCell(b,a){this.ParentField=b;this.InList=a;this.PValue=null;this.IntCtrl=null;this.InitProperties()}PCell.prototype.InitProperties=function(){this.IsCellHidden=false;this.ControlType=-1;this.NumRows=1;this.IsVisible=true;this.IsCtrlVisible=true;this.IsEnabled=true;this.IsReadOnly=false;this.BackGroundImage="";this.BackGroundImageRM="";this.Tooltip="";this.VisualStyleSign="";this.DynPropSign="|||-1|";this.IsCellClickable=false;this.ErrorType=0;this.ActObj=null;this.Text="";this.ValueAlign="left";this.MaxLength=-1;this.CtrlRectX=0;this.CtrlRectY=0;this.CtrlRectW=0;this.CtrlRectH=0};PCell.prototype.Update=function(a,b){this.OldPValue=this.PValue;this.PValue=a;if(a){if(a instanceof PValue){this.Render(b)}if(a instanceof PListGroup){this.RenderPListGroup(b)}}else{this.HideCellContent(true,b);this.UpdateDims()}};PCell.prototype.Unrealize=function(){if(this.IntCtrl){if(this.ControlType!=3){if(this.ControlType==101){if(RD3_ServerParams.UseIDEditor){this.IntCtrl.Unrealize()}else{var a=this.ParentField.Identifier+(this.InList?":lcke":":fcke");var b=CKEDITOR.instances[a];if(b){try{document.body.appendChild(this.IntCtrl);b.destroy(true)}catch(c){}try{CKEDITOR.remove(a)}catch(c){}}}}if(this.IntCtrl.parentNode){this.IntCtrl.parentNode.removeChild(this.IntCtrl)}if(this.ActObj&&this.ActObj.parentNode){this.ActObj.parentNode.removeChild(this.ActObj)}this.ActObj=null;if(this.ErrorBox&&this.ErrorBox.parentNode){this.ErrorBox.parentNode.removeChild(this.ErrorBox)}this.ErrorBox=null;if(this.OptionValueList){this.OptionValueList=null}if(this.BadgeObj!=null&&this.BadgeObj.parentNode){this.BadgeObj.parentNode.removeChild(this.BadgeObj)}this.BadgeObj=null;if(this.TooltipDiv&&this.TooltipDiv.parentNode){this.TooltipDiv.parentNode.removeChild(this.TooltipDiv)}this.TooltipDiv=null}else{this.IntCtrl.Unrealize()}if(RD3_KBManager.ActiveElement&&RD3_KBManager.ActiveElement==this.IntCtrl){RD3_KBManager.ActiveElement=null}this.IntCtrl=null}this.PValue=null;this.ParentField=null;if(RD3_DesktopManager.WebEntryPoint.HilightedCell==this){RD3_DesktopManager.WebEntryPoint.HilightedCell=null}};PCell.prototype.Render=function(q){var k=this.PValue.IsVisible();if(!k&&this.FixIsVisible==undefined){if(this.IntCtrl){this.IsVisible=false;if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){RD3_Glb.SetDisplay(this.IntCtrl,"none");if(this.ActObj&&this.ActObjVisible){this.ActObj.style.display="none";this.ActObjVisible=false}if(this.ErrorBox){this.ErrorBox.style.display="none"}}else{this.IntCtrl.SetVisible(false)}return}}var v=this.PValue.GetVisualStyle();var g=this.PValue.GetControlType();if(g==3&&!this.PValue.IsEnabled()){var I=this.ParentField;var E=(I.CanActivate&&I.ActivableDisabled)&&I.VisHyperLink(v);if(!I.ShowDescription(v)||E||RD3_Glb.IsTouch()||RD3_Glb.IsMobile()){g=30}}var p=false;if(this.ControlType!=g&&g!=101&&g!=5&&!(RD3_Glb.IsIE(6)&&g==4)){var w=(RD3_KBManager.ActiveElement&&RD3_KBManager.ActiveElement==this.GetDOMObj(true));if(this.InList){var e=null;var D=1;while(D<=2){var u=this.ParentField.PListCells.length;for(var y=0;y<u;y++){var H=this.ParentField.PListCells[y];if(H==this){break}if(H.IntCtrl&&(D==2||this.IsGoodClone(H))&&H.PValue instanceof PValue){e=H;break}}if(e){break}D++}if(e){this.CloneFrom(e);p=true}}if(!p&&v.iProto){this.CloneFrom(v.iProto);p=true;var z=v.GetBorders(1);var h=v.GetBorders(6);if(z==9||h==9){if((this.InList&&z!=9)||(!this.InList&&h!=9)){var t=this.GetDOMObj();if(t&&t.style){t.style.padding=""}if(this.ActObj){this.ActObj.style.padding=""}}if(z!=h){this.VisualStyleSign="";this.DynPropSign="|||-1|"}}if(this.InList!=v.iProto.InList){var d=this.GetDOMObj().className;var s=d;if(this.InList&&this.ParentField.ListList){s=s.replace("-value-form","-value-list")}else{s=s.replace("-value-list","-value-form")}if(d!=s){this.GetDOMObj().className=s;this.VisualStyleSign="";this.DynPropSign="|||-1|"}if(this.InList&&this.ParentField.ListList){var r=this.GetDOMObj();if(RD3_Glb.IsIE(10,false)){r.style.removeAttribute("zIndex")}else{r.style.removeProperty("z-index")}if(this.ActObj){if(RD3_Glb.IsIE(10,false)){this.ActObj.style.removeAttribute("zIndex")}else{this.ActObj.style.removeProperty("z-index")}}}}}if(p&&w){RD3_KBManager.ActiveElement=this.GetDOMObj()}}var l=false;switch(g){case 2:l=this.RenderEdit(v,q,p);break;case 3:l=this.RenderCombo(v,q,p);break;case 30:l=this.RenderDisabledCombo(v,q,p);break;case 4:l=this.RenderCheck(v,q,p);break;case 5:l=this.RenderOption(v,q,p);break;case 6:l=this.RenderButton(v,q,p);break;case 10:l=this.RenderBlob(v,q,p);break;case 101:if(RD3_ServerParams.UseIDEditor){l=this.RenderIDEditor(v,q,p)}else{l=this.RenderFCK(v,q,p)}break}if(p||l){var b;if(this.InList){var C=this.ParentField.ParentPanel.ListGroupRoot;var G=this.ParentField.ParentPanel.ActualPosition;var m=this.PValue.Index-G;if(this.ParentField.InList&&!this.ParentField.ListList){m=0}if(this.ParentField.ParentPanel.IsGrouped()&&this.ParentField.InList&&this.ParentField.ListList){m=this.ParentField.ParentPanel.GetRowForIndex(this.PValue.Index)}b=this.ParentField.Identifier+":lv"+m}else{b=this.ParentField.Identifier+":fv"}if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){this.IntCtrl.setAttribute("id",b);this.SetZIndex(this.IntCtrl)}else{this.IntCtrl.SetID(b)}if(p){this.SetVisible();this.SetBackGroundImage();this.SetBackGroundImageRM()}}if(k!=this.IsVisible){this.IsVisible=k;if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){if(this.IntCtrl){RD3_Glb.SetDisplay(this.IntCtrl,(k?"":"none"))}if(this.ActObj){var x=(k&&this.PValue.ActivatorImage(v)!="");if(this.ActObjVisible!=x){this.ActObj.style.display=(x?"":"none");this.ActObjVisible=x;if(x){this.UpdateDims();this.AdaptInputForAct()}}}}else{this.IntCtrl.SetVisible(k)}}if(this.IsVisible){if(this.ParentField.Image!=""&&RD3_ServerParams.ShowFieldImageInValue){var f=this.ParentField.Image;if(!RD3_Glb.IsAbsoluteUrl(this.ParentField.Image)){f=RD3_Glb.GetAbsolutePath()+"images/"+this.ParentField.Image}this.SetBackGroundImage("url("+encodeURI(f)+")")}else{this.SetBackGroundImage("")}if(this.ParentField.ImageResizeMode!=1&&RD3_ServerParams.ShowFieldImageInValue){this.SetBackGroundImageRM(this.ParentField.ImageResizeMode)}if(this.PValue.ErrorType!=this.ErrorType){this.ErrorType=this.PValue.ErrorType;if(this.ErrorType==0&&this.ErrorBox){this.ErrorBox.parentNode.removeChild(this.ErrorBox);this.ErrorBox=null}if(this.ErrorType!=0&&!this.ErrorBox){this.ErrorBox=document.createElement("div");this.SetZIndex(this.ErrorBox);q.appendChild(this.ErrorBox)}if(this.ErrorType!=0&&this.ErrorBox){this.ErrorBox.className="panel-value-"+((this.ErrorType==1)?"error":"warning");var j=((this.ControlType==2&&!RD3_Glb.IsMobile())?5:1);if(RD3_Glb.IsMobile()){if(this.ControlType==6){j=-1}else{var v=this.PValue?this.PValue.GetVisualStyle():this.ParentField.VisualStyle;var A=(this.InList)?1:6;var F=v.GetBorders(A);switch(F){case 1:j=j-1;break;case 3:j=j-1;break;case 9:j=v.GetOffset(false,1,this.InList,false)-1;break}}}this.ErrorBox.style.left=this.CtrlRectX+"px";this.ErrorBox.style.top=(this.CtrlRectY+this.CtrlRectH+j-2)+"px";this.ErrorBox.style.width=(this.CtrlRectW+(this.ActObj&&this.ActObjVisible?this.ParentField.ActWidth+2:0)+(this.ControlType==2?5:1))+"px"}}if(this.PValue.ErrorText!=""){this.SetTooltip(this.PValue.ErrorText)}else{if(this.PValue.Tooltip!=""){this.SetTooltip(this.PValue.Tooltip)}else{if(g==30&&!RD3_Glb.IsMobile()){var B=this.PValue.GetValueList();var a=(B?B.FindItemsByValue(this.PValue.Text,false):null);if(!a||a.length==0){this.SetTooltip("")}else{this.SetTooltip(a[0].Tooltip)}}else{this.SetTooltip("")}}}if(this.ParentField.ClassName!=this.ClassName){if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){if(this.ClassName!=""){RD3_Glb.RemoveClass2(this.IntCtrl,this.ClassName)}this.ClassName=this.ParentField.ClassName;if(this.ClassName&&this.ClassName!=""){RD3_Glb.AddClass(this.IntCtrl,this.ClassName)}}else{this.ClassName=this.ParentField.ClassName;this.IntCtrl.SetClassName(this.ClassName)}}this.HideCellContent(false,q)}else{if(this.ErrorBox){this.ErrorBox.parentNode.removeChild(this.ErrorBox);this.ErrorBox=null;this.ErrorType=0}}if(g!=101&&g!=5){v.SetProto(this)}if(p&&q){if(this.ControlType==3||(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){this.IntCtrl.Realize(q,(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form"))}else{q.appendChild(this.IntCtrl);if(this.ActObj){this.SetZIndex(this.ActObj);q.appendChild(this.ActObj)}if(this.ErrorBox){this.SetZIndex(this.ErrorBox);q.appendChild(this.ErrorBox)}if(this.BadgeObj){this.SetZIndex(this.BadgeObj);q.appendChild(this.BadgeObj)}}}};PCell.prototype.RenderEdit=function(k,i,o){var p=this.ParentField;var q=this.ParentField;var j=q.ParentPanel;var m=this.PValue.InQBE();var A=RD3_Glb.IsIE(10,false);var H=(this.InList)?q.ListNumRows:q.FormNumRows;var G=this.PValue.IsEnabled();var F=false;if(H>1&&RD3_Glb.IsNumericObject(q.DataType)){H=1}if(this.InList&&q.ListList&&this.PValue.Index>1&&j.Status==RD3_Glb.PS_QBE){G=false}if(!G&&(k.ShowHTML()||this.PValue.ShowHTML()||q.EditorType==1||q.VisHyperLink(k)||RD3_Glb.IsMobile()||RD3_Glb.IsTouch())){if(this.ControlType!=2||!this.IsReadOnly){if(this.ControlType!=-1){this.ClearElement(true)}this.IntCtrl=document.createElement("span");this.IntCtrl.className=(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form");i.appendChild(this.IntCtrl);if(q.EditorType==1){this.IntCtrl.style.overflow="auto"}F=true}var b=false;var c=false;if(k.ShowHTML()||this.PValue.ShowHTML()||q.EditorType==1||q.VisHyperLink(k)){b=true}if(H>1&&(!b||((RD3_Glb.IsMobile()||RD3_Glb.IsTouch())&&!this.PValue.ShowHTML()))){c=true}if(H==1&&!b&&(RD3_Glb.IsMobile()||RD3_Glb.IsTouch())){b=true}if(c){RD3_Glb.AddClass(this.IntCtrl,"panel-value-textarea")}else{RD3_Glb.RemoveClass(this.IntCtrl,"panel-value-textarea")}if(b){RD3_Glb.AddClass(this.IntCtrl,"panel-value-html")}else{RD3_Glb.RemoveClass(this.IntCtrl,"panel-value-html")}var y=this.ParentField.IsCellClickable(this.PValue.Index,k)&&(this.PValue.Text&&this.PValue.Text.length>0);if(y!=this.IsCellClickable||F||o){this.IsCellClickable=y;if(this.IsCellClickable&&!RD3_Glb.IsMobile()){this.IntCtrl.style.cursor="pointer";this.IntCtrl.onclick=function(a){p.OnClickActivator(a)}}else{this.IntCtrl.style.cursor="default";this.IntCtrl.onclick=null}}this.IsReadOnly=true}else{var M=false;if(H==1){if(this.ControlType!=2||this.IsReadOnly||this.NumRows>1){if(this.ControlType!=-1){M=(RD3_KBManager.ActiveElement&&RD3_KBManager.ActiveElement==this.GetDOMObj());this.ClearElement(true)}this.IntCtrl=document.createElement("input");this.IntCtrl.type=k.IsPassword()?"password":"text";this.IntCtrl.className="panel-value-input "+(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form");i.appendChild(this.IntCtrl);this.Mask="";this.MaskType="";this.MaskDataSign="";this.MaxLength=-1;F=true}if(RD3_Glb.IsTouch()){var I=k.IsPassword()?"password":"text";if(RD3_Glb.IsTouch()){if(RD3_Glb.IsNumericObject(q.DataType)||RD3_Glb.IsDateOrTimeObject(q.DataType)){I="tel"}}if(this.IntCtrl.type!=I){this.IntCtrl.type=I}}if(RD3_Glb.IsMobile()){var l=((RD3_Glb.IsIpad()||RD3_Glb.IsIphone()||RD3_Glb.IsIE())&&this.ParentField&&this.ParentField.UsePopupControl());if(l&&!this.PopupControlReadOnly){this.IntCtrl.setAttribute("readonly",true);this.PopupControlReadOnly=true}if(!l&&this.PopupControlReadOnly){this.IntCtrl.removeAttribute("readonly");this.PopupControlReadOnly=false}}}else{if(this.ControlType!=2||this.IsReadOnly||this.NumRows==1){if(this.ControlType!=-1){M=(RD3_KBManager.ActiveElement&&RD3_KBManager.ActiveElement==this.GetDOMObj());this.ClearElement(true)}this.IntCtrl=document.createElement("textarea");this.IntCtrl.className="panel-value-textarea "+(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form");i.appendChild(this.IntCtrl);this.Mask="";this.MaskType="";this.MaskDataSign="";this.MaxLength=-1;if(RD3_Glb.IsMobile()){this.IntCtrl.style.overflowY="scroll"}F=true}}if(M){RD3_KBManager.ActiveElement=this.GetDOMObj()}this.IsReadOnly=false}this.ControlType=2;this.NumRows=H;if(!this.IsReadOnly){if(this.NumRows==1){if(m){this.Mask="";this.MaskType="";this.MaskDataSign=""}else{var r=this.GetDynPropSign().split("|")[4];var N=q.DataType+"|"+q.MaxLength+"|"+q.Scale+"|"+k.GetMask()+"|"+r;if(this.MaskDataSign!=N){if(r!=""){this.ApplyDynPropToVisualStyle(k)}var v=k.ComputeMask(q.DataType,q.MaxLength,q.Scale);var t=false;if(RD3_DesktopManager.WebEntryPoint.HilightedCell==this&&v!=this.Mask){if(r!=""){this.CleanVisualStyle(k)}t=true;this.SetInactive();if(r!=""){this.ApplyDynPropToVisualStyle(k)}}this.Mask=v;this.MaskType=k.ComputeMaskType(q.DataType);this.MaskDataSign=N;if(r!=""){this.CleanVisualStyle(k)}if(t){this.SetActive()}}}}if(this.IsEnabled!=G||F){this.IsEnabled=G;if(k.GetCursor()==""){this.IntCtrl.style.cursor=(this.IsEnabled?"":"default")}}var h=this.PValue.Text;var x=false;if(h==""&&this.ParentField.CellMustHaveWaterMark(G,m,this.InList,this.PValue.Index,this)){h=this.ParentField.WaterMark;x=true}var z=(m||(x&&(RD3_Glb.IsChrome()||RD3_Glb.IsSafari()))?-1:q.MaxLength);if(this.MaxLength!=z){this.MaxLength=z;if(this.NumRows==1){if(this.MaxLength<=0){this.IntCtrl.removeAttribute("maxLength")}else{this.IntCtrl.setAttribute("maxLength",this.MaxLength)}}}if(x!=this.HasWatermark){if(x){RD3_Glb.AddClass(this.IntCtrl,"panel-field-value-watermark")}else{RD3_Glb.RemoveClass(this.IntCtrl,"panel-field-value-watermark")}this.HasWatermark=x}if(k.IsPassword()&&RD3_KBManager.ActiveElement==this.IntCtrl&&this.Text!=""){var g=true;for(var J=0;J<h.length;J++){if(h.substr(J,1)!="*"){g=false;break}}if(g){h=this.Text}}if(this.Text!=h){var L=F||o||!this.IsUncommitted();this.Text=h;if(L){this.IntCtrl.value=h}if(h==""&&!F&&this.IsReadOnly&&this.Mask&&RD3_KBManager.ActiveElement&&RD3_KBManager.ActiveElement==this.IntCtrl){mc(this.Mask,this.MaskType,null,this.IntCtrl)}if(RD3_Glb.IsDateTimeObject(q.DataType)&&RD3_KBManager.ActiveElement==this.IntCtrl&&!RD3_Glb.IsMobile()){if(document.getElementById("calpopup").style.display!="none"){ShowCalendar(this.IntCtrl,this.Mask)}}}}else{if(this.Text!=this.PValue.Text){this.Text=this.PValue.Text;this.IntCtrl.innerHTML=this.PValue.Text;if(RD3_Glb.IsIE(10,false)){this.IntCtrl.style.whiteSpace=(H==1?"nowrap":"normal")}else{this.IntCtrl.style.whiteSpace=(H==1?"nowrap":"pre-wrap")}if(q.EditorType==1){this.IntCtrl.style.whiteSpace="normal"}}this.IsEnabled=false}var D=this.PValue.ActivatorImage(k);if(D==""){if(this.ActObj!=null&&this.ActObjVisible){this.ActObj.style.display="none";this.ActObjVisible=false;this.AdaptInputForAct()}}else{if(this.ActObj==null){this.ActObj=document.createElement("DIV");this.ActObj.className="panel-value-activator";this.SetZIndex(this.ActObj);this.ActObj.style.width=(q.ActWidth+2)+"px";this.CtrlRectH=0;i.insertBefore(this.ActObj,this.IntCtrl.nextSibling);this.ActObjVisible=true;this.ActObjSrc="";this.ActPos=1;this.ActObjX=0;this.ActObjY=0;this.ActObjW=q.ActWidth+2;this.ActObjCurs="";this.AdaptInputForAct()}if(!this.ActObj.onclick){this.ActObj.onclick=function(a){p.OnClickActivator(a)}}if(this.ActObjSrc!=D){this.ActObjSrc=D;var C="url("+RD3_Glb.GetAbsolutePath()+"images/"+encodeURI(this.ActObjSrc)+")";if(RD3_Glb.IsMobile()&&q.ActImage!=""){this.ActObj.style.setProperty("background-image",C,"important")}else{this.ActObj.style.backgroundImage=C}}var E=null;if(this.ActObjVisible!=this.PValue.IsVisible()){this.ActObjVisible=this.PValue.IsVisible();if(!E){E=this.ActObj.style}E.display=(this.ActObjVisible?"":"none");this.AdaptInputForAct()}var d=(G||(q.CanActivate&&q.ActivableDisabled))?"pointer":"";if(this.ActObjCurs!=d){this.ActObjCurs=d;if(!E){E=this.ActObj.style}E.cursor=this.ActObjCurs}var e=this.PValue.ActivatorPosition(k);if(e!=this.ActPos){this.ActPos=e;this.ActObjX=-1;this.AdaptInputForAct()}}if(this.UpdateVisualStyle(k,this.ActObj)){if(this.ActObj){if(this.ActPos==1){this.ActObj.style.borderRight=""}else{this.ActObj.style.borderLeft=""}if(this.ActObjVisible&&this.IntCtrl.style.backgroundColor=="transparent"){if(this.ActPos==1){this.IntCtrl.style.borderLeft="none"}else{this.IntCtrl.style.borderRight="none"}}}}if(this.PValue.Badge!=this.Badge){this.Badge=this.PValue.Badge;if(this.Badge==""){if(this.BadgeObj!=null&&this.BadgeObj.parentNode){this.BadgeObj.parentNode.removeChild(this.BadgeObj)}this.BadgeObj=null;this.BadgeObjX=null;this.BadgeObjY=null}else{if(this.BadgeObj==null){this.BadgeObj=document.createElement("div");this.BadgeObj.className="badge-grey";this.BadgeObj.style.position="absolute";if(RD3_Glb.IsMobile()){this.BadgeObj.style.marginTop="6pt"}this.SetZIndex(this.BadgeObj);i.appendChild(this.BadgeObj)}this.BadgeObj.innerHTML=this.Badge}}var K=null;if(this.PValue&&this.PValue.Alignment!=-1){K=this.PValue.Alignment}else{if(this.ParentField.Alignment!=-1){K=this.ParentField.Alignment}else{K=k.GetAlignment(1)}}if(K==1){var f=q.IsRightAligned()?"right":"left";if(this.ValueAlign!=f){this.ValueAlign=f;this.IntCtrl.style.textAlign=f}}if(F||(o&&!A)){var B=function(a){RD3_KBManager.IDRO_OnChange(a)};if(A){this.IntCtrl.attachEvent("onchange",B)}else{this.IntCtrl.onchange=B}if(!A){var u=function(a){RD3_KBManager.IDRO_GetFocus(a)};var w=function(a){RD3_KBManager.IDRO_LostFocus(a)};if(this.IsReadOnly&&!this.IsCellClickable){this.IntCtrl.onclick=u}else{this.IntCtrl.onfocus=u;if((RD3_Glb.IsFirefox()||RD3_Glb.IsChrome()||RD3_Glb.IsSafari())&&this.IsCellClickable){this.IntCtrl.onmousedown=u}this.IntCtrl.onblur=w}if(RD3_Glb.IsFirefox(3)){var n=function(a){RD3_KBManager.IDRO_DoubleClick(a)};this.IntCtrl.ondblclick=n}}if(RD3_Glb.IsMobile()&&!RD3_Glb.IsIE()){if(this.NumRows>1){this.IntCtrl.addEventListener("keyup",new Function("ev","return RD3_KBManager.TextAreaMobileKeyUp(ev)"),false)}}}this.UpdateDims();return F};PCell.prototype.RenderCombo=function(m,i,h){var s=this.ParentField;var p=s.ParentPanel;var r=this.PValue.InQBE();var l=RD3_Glb.IsIE();var b=this.PValue.IsEnabled();var f=false;var n=false;if(this.ControlType!=3){if(this.ControlType!=-1){n=(RD3_KBManager.ActiveElement&&RD3_KBManager.ActiveElement==this.GetDOMObj());this.ClearElement(true)}}if(this.ControlType!=3){this.IntCtrl=new IDCombo(this);this.IntCtrl.Realize(i,(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form"));this.IsEnabled=true;if(n){RD3_KBManager.ActiveElement=this.IntCtrl.GetDOMObj()}this.ControlType=3;f=true}if(this.UpdateVisualStyle(m)){this.IntCtrl.SetVisualStyle(m,true,true)}var q=this.PValue.GetValueList();this.IntCtrl.ListOwner=!s.LKE;this.IntCtrl.AllowFreeText=s.LKE||s.HasValueSource;this.IntCtrl.SetShowValue(s.HasValueSource&&!s.SuperActive);this.IntCtrl.IsOptional=this.PValue.IsComboOptional();this.IntCtrl.SetRightAlign(s.IsRightAligned());this.IntCtrl.SetHasActivator(this.PValue.ActivatorImage(m),s.ActWidth,s.ActivableDisabled,h);this.IsCellClickable=s.IsComboClickable(this.PValue.Index,m)&&(this.PValue.Text&&this.PValue.Text.length>0);this.IntCtrl.SetComboClickable(this.IsCellClickable);this.IntCtrl.MultiSel=s.ComboMultiSel&&r;this.IntCtrl.ValueSep=s.ComboValueSep;this.IntCtrl.UsePopover=!s.VisSlidePad();this.IntCtrl.SetBadge(this.PValue.Badge);var a=false;if(s.HasValueSource&&!this.IntCtrl.MultiSel){var j=s.DataType+":"+s.MaxLength+":"+s.Scale;var k=this.GetDynPropSign().split("|")[4];if(this.MaskDataSign!=j||k!=""){if(k!=""){this.ApplyDynPropToVisualStyle(m)}this.Mask=m.ComputeMask(s.DataType,s.MaxLength,s.Scale);this.MaskType=m.ComputeMaskType(s.DataType);this.MaskDataSign=j;if(k!=""){this.CleanVisualStyle(m)}}if(this.Mask==""){a=true}}else{this.Mask="";this.MaskType="";this.MaskDataSign="";if(s.HasValueSource&&this.IntCtrl.MultiSel){a=true}}this.IntCtrl.SetMasked(this.Mask!=""||a);if(this.IsEnabled!=b){this.IntCtrl.SetEnabled(b);this.IsEnabled=b}if((r||s.Optional)&&q&&!this.PValue.ValueList&&q.ItemList[0]&&q.ItemList[0].Value!=""){q.ItemList.splice(0,0,new ValueListItem());q.AddedEmptyQBEItem=true}else{if(!r&&!s.Optional&&q&&q.AddedEmptyQBEItem){q.ItemList.splice(0,1);q.AddedEmptyQBEItem=false}}var g=this.IntCtrl.IsOpen;var e=true;if(g&&!q&&s.HasValueSource){e=false}if(e){this.IntCtrl.AssignValueList(q,f||h)}var t=this.PValue.Text;if(t==""&&!this.IntCtrl.IsOpen&&this.ParentField.CellMustHaveWaterMark(b,r,this.InList,this.PValue.Index,this)){t=this.ParentField.WaterMark;this.HasWatermark=true}else{this.HasWatermark=false}var d=!RD3_Glb.IsMobile();if(this.HasWatermark!=this.IntCtrl.HasWatermark){if(this.HasWatermark){this.IntCtrl.SetWatermark()}else{if(this.IntCtrl.HasWatermark){this.IntCtrl.RemoveWatermark();if(!g&&this.IntCtrl.IsOpen){d=false}}}}var o=false;if(t==this.Text&&!h&&!this.HasWatermark&&!s.LKE&&!s.HasValueSource){o=this.IntCtrl.OriginalText!=this.IntCtrl.GetComboFinalName(this.IntCtrl.ShowValue)}if(t!=this.Text||h||o){var c=f||h||!this.IntCtrl.IsOpen||!s.SuperActive;this.Text=t;if(this.ComboEditing&&this.Text==""&&RD3_DesktopManager.WebEntryPoint.HilightedCell==this){this.IntCtrl.DeferEmptyCombo()}else{if(c){this.IntCtrl.SetText(this.Text,true,d)}}this.ComboEditing=false}this.UpdateDims();if(RD3_ServerParams.Theme=="zen"&&h){this.IntCtrl.SetWidth(this.IntCtrl.Width);this.IntCtrl.SetHeight(this.IntCtrl.Height)}return f};PCell.prototype.RenderDisabledCombo=function(m,j,i){var u=this.ParentField;var n=u.ParentPanel;var t=this.PValue.InQBE();var l=RD3_Glb.IsIE();var f=false;if(this.ControlType!=30){if(this.ControlType!=-1){this.ClearElement(true)}}var v=null;var o=null;if(this.ControlType!=30){this.IntCtrl=document.createElement("div");this.IntCtrl.className=(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form");j.appendChild(this.IntCtrl);v=document.createElement("img");this.IntCtrl.appendChild(v);v.className="combo-img-dis";if(RD3_Glb.IsMobile()&&u.VisOnlyIcon()){v.style.position="absolute"}else{v.style.position="relative"}if(RD3_Glb.IsIE(10,false)){v.style.verticalAlign="text-bottom"}o=document.createElement("span");o.className="combo-input";this.IntCtrl.appendChild(o);if((RD3_Glb.IsMobile()||RD3_Glb.IsTouch())&&!u.VisOnlyIcon()){RD3_Glb.AddClass(this.IntCtrl,"panel-value-html")}this.ControlType=30;f=true}else{v=this.IntCtrl.firstChild;o=v.nextSibling}var r=this.PValue.GetValueList();var a=(r?r.FindItemsByValue(this.PValue.Text,false):null);var c;var k;var b;if(!a||a.length==0){c=(u.ShowDescription(m)?this.PValue.Text:"");k="";b=""}else{c=(u.ShowDescription(m)?a[0].Name:"");k=(a[0].Image!=""&&m.ShowImage()?a[0].Image:"");b=a[0].Tooltip}if(k!=""){v.src=RD3_Glb.GetImgSrc("images/"+k);v.style.display="";v.style.left="";this.ForeImage=k}else{v.style.display="none";v.style.left="-999px";this.ForeImage=""}if(this.Text!=c){this.Text=c;if(RD3_Glb.IsIE(10,false)){o.innerText=c}else{o.textContent=c}if(RD3_Glb.IsMobile()){o.value=c}}this.SetTooltip(b);var s=this.ParentField.ParentPanel.ActualPosition;var g=this.PValue.Index-s;if(this.ParentField.ParentPanel.IsGrouped()&&this.ParentField.InList&&this.ParentField.ListList){g=this.ParentField.ParentPanel.GetRowForIndex(this.PValue.Index)}var d=this.ParentField.ParentPanel.IsNewRow(s,g);var q=(u.CanActivate&&u.ActivableDisabled)&&u.VisHyperLink(m)&&!d;if(q!=this.IsCellClickable||f||i){this.IsCellClickable=q;var p;if(q){var e=this.ParentField;var h=function(w){e.OnClickActivator(w)};this.IntCtrl.onclick=h;p="pointer"}else{this.IntCtrl.onclick=null;p="default"}if(RD3_Glb.IsMobile()){if(q){RD3_Glb.AddClass(this.IntCtrl,"panel-value-clickable")}else{RD3_Glb.RemoveClass(this.IntCtrl,"panel-value-clickable")}}this.IntCtrl.style.cursor=p;if((a&&a.length>0)||(c&&c.length>0)||i){v.style.cursor=p;o.style.cursor=p}}if(this.PValue.Badge!=this.Badge){this.Badge=this.PValue.Badge;if(this.Badge==""){if(this.BadgeObj!=null&&this.BadgeObj.parentNode){this.BadgeObj.parentNode.removeChild(this.BadgeObj)}this.BadgeObj=null;this.BadgeObjX=null;this.BadgeObjY=null}else{if(this.BadgeObj==null){this.BadgeObj=document.createElement("div");this.BadgeObj.className="badge-grey";this.BadgeObj.style.position="absolute";if(RD3_Glb.IsMobile()){this.BadgeObj.style.marginTop="6pt"}this.SetZIndex(this.BadgeObj);j.appendChild(this.BadgeObj)}this.BadgeObj.innerHTML=this.Badge}}this.IsEnabled=false;this.UpdateVisualStyle(m);if(RD3_Glb.IsMobile()&&k==""){o.style.paddingLeft="0px"}this.UpdateDims();return f};PCell.prototype.RenderCheck=function(q,k,i){var x=this.ParentField;var r=x.ParentPanel;var u=this.PValue.InQBE();var o=RD3_Glb.IsIE(10,false);var b=(this.InList)?x.ListNumRows:x.FormNumRows;var c=this.PValue.IsEnabled();var n=(this.InList&&x.ListList&&this.PValue.Index>1&&r.Status==RD3_Glb.PS_QBE?false:true);var g=false;if(this.ControlType!=4){if(this.ControlType!=-1){this.ClearElement(true)}}if(this.ControlType!=4){this.IntCtrl=document.createElement("div");this.IntCtrl.className=(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form");k.appendChild(this.IntCtrl);if(RD3_Glb.IsMobile()){this.SubIntCtrl=document.createElement("div");this.SubIntCtrl.checked=true;if(RD3_Glb.IsQuadro()){var t=this.PValue.GetValueList();var l=document.createElement("div");l.className="radio-int-div";var f=document.createElement("span");f.className="radio-int-s1";f.innerText=(t.ItemList.length>0)?t.ItemList[0].Name:"ON";var e=document.createElement("span");e.className="radio-int-s2";var d=document.createElement("span");d.className="radio-int-s3";d.innerText=(t.ItemList.length>1)?t.ItemList[1].Name:"OFF";l.appendChild(f);l.appendChild(e);l.appendChild(d);this.SubIntCtrl.appendChild(l)}else{this.SubIntCtrl.appendChild(document.createElement("span"))}}else{this.SubIntCtrl=document.createElement("input");this.SubIntCtrl.type="checkbox"}this.IntCtrl.appendChild(this.SubIntCtrl);this.SubIntCtrl.className="panel-value-check";this.ControlType=4;this.SubCtrlRectX=0;this.SubCtrlRectY=0;this.SubCtrlRectW=0;this.SubCtrlRectH=0;g=true;this.IsEnabled=true}if(this.IsEnabled!=c){this.SubIntCtrl.disabled=!c;this.IsEnabled=c;if(RD3_Glb.IsMobile()){this.SubIntCtrl.style.cursor=c?"":"default"}}if(this.IsCtrlVisible!=n){this.SubIntCtrl.style.visibility=(n?"":"hidden");this.IsCtrlVisible=n}var s=false;if(this.PValue.Text!=this.Text){this.Text=this.PValue.Text;var t=this.PValue.GetValueList();if(t){if(t.AddedEmptyQBEItem&&t.ItemList[0]&&t.ItemList[0].Value==""){t.ItemList.splice(0,1);t.AddedEmptyQBEItem=false}t.SetCheck(this.SubIntCtrl,this.Text,u);if(this.Text==="---"&&!u){this.Text=""}if(RD3_Glb.IsIE(6)&&this.Text==t.ItemList[0].Value){var m=this.SubIntCtrl.outerHTML;this.SubIntCtrl.outerHTML=m.substring(0,m.length-1)+" checked>";this.SubIntCtrl=this.IntCtrl.firstChild;s=true}}}this.UpdateVisualStyle(q);if(g||(i&&!o)||s){var w=this.ParentField;var p=function(y){w.OnThreeStateCheck(y);RD3_KBManager.IDRO_OnChange(y)};var a=function(y){var z=(window.event)?window.event.srcElement:y.explicitOriginalTarget;if(z.hasChildNodes()){z.childNodes[0].focus();window.setTimeout(function(){z.childNodes[0].click()},0)}};if(o){this.SubIntCtrl.attachEvent("onclick",p);this.IntCtrl.attachEvent("onclick",a)}else{if(RD3_Glb.IsMobile()){this.IntCtrl.onclick=function(y){w.OnToggleCheck(y)}}else{this.SubIntCtrl.onclick=p;this.IntCtrl.onclick=a}}if(!o){var h=function(y){RD3_KBManager.IDRO_GetFocus(y)};var j=function(y){RD3_KBManager.IDRO_LostFocus(y)};this.SubIntCtrl.onfocus=h;this.SubIntCtrl.onblur=j;if(RD3_Glb.IsFirefox(3)){var v=function(y){RD3_KBManager.IDRO_DoubleClick(y)};this.SubIntCtrl.ondblclick=v}}}this.UpdateDims();return g};PCell.prototype.RenderBlob=function(l,i,g){var s=this.ParentField;var n=s.ParentPanel;var p=this.PValue.InQBE();var j=RD3_Glb.IsIE();var a=(this.InList)?s.ListNumRows:s.FormNumRows;var b=this.PValue.IsEnabled();var c=null;var j=RD3_Glb.IsIE(10,false);var e=false;if(this.ControlType!=10){if(this.ControlType!=-1){this.ClearElement(true)}}else{if(this.BlobCellType!=this.PValue.BlobMime){if(this.SubIntCtrl){this.SubIntCtrl.parentNode.removeChild(this.SubIntCtrl);this.SubIntCtrl=null;this.SubCtrlRectIMG=null;this.SubCtrlRectW=null;this.SubCtrlRectH=null}this.BlobCellType=undefined}}if(!this.IntCtrl){this.IntCtrl=document.createElement("div");this.IntCtrl.className=(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form");i.appendChild(this.IntCtrl);this.IntCtrl.style.overflow=(a>1)?"auto":"hidden";e=true}var d=this.PValue.BlobMime;switch(d){case"upload":if(this.BlobCellType!=d){this.SubIntCtrl=document.createElement("form");this.SubIntCtrl.className="panel-blob-form";this.SubIntCtrl.encoding="multipart/form-data";this.SubIntCtrl.method="post";this.SubIntCtrl.action="?WCI=IWUpload&WCE=F"+n.WebForm.IdxForm;this.SubIntCtrl.target="blobframe";this.IntCtrl.appendChild(this.SubIntCtrl);var o=document.createElement("div");o.innerHTML=this.PValue.Text;this.Text=this.PValue.Text;this.SubIntCtrl.appendChild(o);if(j){c=document.createElement("<input type=file name='blob'>");c.style.position="absolute"}else{c=document.createElement("input");c.name="blob";c.type="file"}c.style.height="19px";c.style.width=(s.GetValueWidth(this.InList)-10);if(window.RD4_Enabled){var k=function(t){s.HandleFileSelect(t)};c.addEventListener("change",k,false)}this.SubIntCtrl.appendChild(c)}break;case"text":if(this.BlobCellType!=d){this.SubIntCtrl=document.createElement("p");this.SubIntCtrl.className="panel-blob-text";this.SubIntCtrl.tabIndex=0;this.IntCtrl.appendChild(this.SubIntCtrl)}if(this.Text!=this.PValue.Text){this.Text=this.PValue.Text;this.SubIntCtrl.innerHTML=this.Text}break;case"image":if(this.BlobCellType!=d){this.SubIntCtrl=document.createElement("img");this.SubIntCtrl.className="panel-blob-image";this.SubIntCtrl.tabIndex=0;this.IntCtrl.appendChild(this.SubIntCtrl)}if(this.Text!=this.PValue.Text){this.Text=this.PValue.Text;this.SubIntCtrl.src=RD3_Glb.GetImgSrc(this.Text);if(!RD3_Glb.IsIE(10,false)){this.SubIntCtrl.onload=function(t){s.BLOBImageReadyStateChanged(t)}}else{this.SubIntCtrl.onreadystatechange=function(t){s.BLOBImageReadyStateChanged(t)}}}break;case"size":if(this.BlobCellType!=d){this.SubIntCtrl=document.createElement("span");this.SubIntCtrl.className="panel-blob-span";this.SubIntCtrl.tabIndex=0;this.IntCtrl.appendChild(this.SubIntCtrl)}if(this.BlobCellType!=d||g){this.SubIntCtrl.onclick=function(t){s.OnBlobCommand(t,"link")}}if(this.Text!=this.PValue.Text){this.Text=this.PValue.Text;this.SubIntCtrl.innerHTML=this.Text}break;case"empty":this.Text="";break;default:if(this.BlobCellType!=d){this.SubIntCtrl=document.createElement("iframe");this.SubIntCtrl.className="panel-blob-object";this.SubIntCtrl.style.width="100%";this.SubIntCtrl.style.height="100%";this.SubIntCtrl.frameBorder="no";this.IntCtrl.appendChild(this.SubIntCtrl)}if(this.Text!=this.PValue.Text){this.Text=this.PValue.Text;this.SubIntCtrl.src=this.Text}break}this.ControlType=10;this.BlobCellType=d;this.IsEnabled=b;this.UpdateVisualStyle(l,c);if((e||(g&&!j))&&(this.PValue.BlobMime=="text"||this.PValue.BlobMime=="image"||this.PValue.BlobMime=="size")){var f=function(t){RD3_KBManager.IDRO_GetFocus(t)};var h=function(t){RD3_KBManager.IDRO_LostFocus(t)};this.SubIntCtrl.onfocus=f;this.SubIntCtrl.onblur=h;if(RD3_Glb.IsFirefox(3)){var r=function(t){RD3_KBManager.IDRO_DoubleClick(t)};this.SubIntCtrl.ondblclick=r}}if((e||g)&&this.ParentField.UseHTML5ForUpload()){var m=function(t){s.OnHTML5Drop(t)};var q=function(t){s.OnHTML5Drag(t)};this.IntCtrl.ondrop=m;this.IntCtrl.ondragover=q}s.UpdateToolbar();this.UpdateDims();return e};PCell.prototype.RenderIDEditor=function(j,i,f){var g=this.ParentField;var b=g.ParentPanel;var a=null;var d=false;var c=false;if(this.ControlType!=101){if(this.ControlType!=-1){c=(RD3_KBManager.ActiveElement&&RD3_KBManager.ActiveElement==this.GetDOMObj());this.ClearElement(true)}}this.IsEnabled=this.PValue.IsEnabled();if(this.ControlType!=101){this.IntCtrl=new IDEditor(this);this.IntCtrl.Realize(i,(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form"));if(c){RD3_KBManager.ActiveElement=this.IntCtrl.GetDOMObj()}this.ControlType=101;d=true}var h=this.IntCtrl.Layout==1?this.IntCtrl.TextObj:this.IntCtrl.EditorObj;if(this.UpdateVisualStyle(j,h)){this.IntCtrl.SetVisualStyle(j,true)}this.IntCtrl.SetHasToolbar(g.ShowEditorTool);this.IntCtrl.SetEnabled(this.IsEnabled);this.IntCtrl.AssignFontList(g.FontList);this.IntCtrl.AssignColorList(g.ColorList);this.IntCtrl.AssignTokenList(g.TokenList);this.IntCtrl.SetCommandEnabled(g.EdToolCommands);this.IntCtrl.SetDefaultFormatting(g.DefaultFormatting);var e=this.PValue.Text;if(e!=this.Text||f){this.Text=e;if(!this.IntCtrl.IsUncommited()){this.IntCtrl.SetText(this.Text)}}this.UpdateDims();this.IntCtrl.UpdateToolbar();return d};PCell.prototype.RenderFCK=function(m,k,f){var i=this.ParentField;var c=i.ParentPanel;this.IsEnabled=this.PValue.IsEnabled();var b=null;var d=false;if(this.ControlType!=101){if(this.ControlType!=-1){this.ClearElement(true)}}if(this.ControlType!=101){this.IntCtrl=document.createElement("div");this.IntCtrl.className=(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form");k.appendChild(this.IntCtrl);RD3_Glb.AddClass(this.IntCtrl,"panel-field-value-htmleditor");var o=this.ParentField.Identifier+(this.InList?":lcke":":fcke");this.SubIntCtrl=document.createElement("textarea");this.SubIntCtrl.name=o;this.SubIntCtrl.id=o;this.SubIntCtrl.style.visibility="hidden";this.IntCtrl.appendChild(this.SubIntCtrl);document.body.appendChild(this.IntCtrl);CKEDITOR.replace(o,this.CustomizeCK());k.appendChild(this.IntCtrl);var e=CKEDITOR.instances[o];var a=function(p){i.OnFCKSelectionChange(p)};var l=function(p){RD3_KBManager.IDRO_GotFocusCK(p)};var g=function(p){RD3_KBManager.CKinstanceReady(p)};e.on("instanceReady",g);e.on("blur",a);if(!RD3_Glb.IsIE(10,false)){e.on("focus",l)}var j=this.ParentField.ParentPanel.ListGroupRoot;var h=this.ParentField.ParentPanel.ActualPosition;var n=this.PValue.Index-h;if(this.ParentField.ParentPanel.IsGrouped()&&this.ParentField.InList&&this.ParentField.ListList){n=this.ParentField.ParentPanel.GetRowForIndex(this.PValue.Index)}e.RowNumber=n;this.Text=this.PValue.Text;e.setData(this.Text);this.ControlType=101;d=true}else{if(this.ParentField.FCKTimerID>0){window.clearTimeout(this.ParentField.FCKTimerID)}this.ParentField.FCKTimerID=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.PValue.Identifier+"', 'SetFCK', null, "+this.InList+")",200)}this.UpdateVisualStyle(m);this.UpdateDims();return d};PCell.prototype.CustomizeCK=function(){var a=new Object();var b=this.ParentField.GetValueHeight(this.InList)-105;b=b<50?50:b;a.height=b+"px";a.resize_enabled=false;return a};PCell.prototype.RenderOption=function(m,l,h){var i=this.ParentField;var d=i.ParentPanel;var f=this.PValue.InQBE();var b=RD3_Glb.IsIE(10,false);var k=(this.InList)?i.ListNumRows:i.FormNumRows;var a=this.PValue.IsEnabled();var c=(this.InList&&i.ListList&&this.PValue.Index>1&&d.Status==RD3_Glb.PS_QBE?false:true);var g=false;if(this.ControlType!=5||(!a&&this.PValue.IsNewRow())){if(this.ControlType!=-1){this.ClearElement(true)}}var e=this.PValue.GetValueList();if(!e){return}if(e.AddedEmptyQBEItem&&e.ItemList[0]&&e.ItemList[0].Value==""){e.ItemList.splice(0,1);e.AddedEmptyQBEItem=false}if(this.ControlType!=5){this.IntCtrl=document.createElement("div");this.IntCtrl.className=(this.InList&&this.ParentField.ListList?"panel-field-value-list":"panel-field-value-form");l.appendChild(this.IntCtrl);if(a||!this.PValue.IsNewRow()){e.RealizeOption(this.PValue,this.IntCtrl,this.PValue.Text,k>1,this.InList,a);this.Text=this.PValue.Text;this.OptionValueList=e}this.ControlType=5;g=true}else{if(this.IntCtrl.childNodes.length==0){if(a||!this.PValue.IsNewRow()){e.RealizeOption(this.PValue,this.IntCtrl,this.PValue.Text,k>1,this.InList,a);this.Text=this.PValue.Text;this.OptionValueList=e}}else{if(this.OptionValueList&&!this.OptionValueList.Equals(e)){this.IntCtrl.innerHTML="";if(a||!this.PValue.IsNewRow()){e.RealizeOption(this.PValue,this.IntCtrl,this.PValue.Text,k>1,this.InList,a);this.Text=this.PValue.Text;this.OptionValueList=e}}else{if(this.PValue.Text!=this.Text){this.Text=this.PValue.Text;e.SetOption(this.IntCtrl,this.Text)}}}}if(this.IsEnabled!=a||this.IsCtrlVisible!=c){e.EnableOption(this.IntCtrl,a,c);this.IsEnabled=a;this.IsCtrlVisible=c}this.UpdateVisualStyle(m);if(!b&&!a&&(g||h)){var j=function(n){RD3_KBManager.IDRO_GetFocus(n)};this.IntCtrl.onclick=j}this.UpdateDims();return g};PCell.prototype.RenderButton=function(h,e,b){var a=this.ParentField;var c=a.ParentPanel;var f=RD3_Glb.IsIE();var d=a.IsCellClickable(this.PValue.Index,h);var g=false;if(this.ControlType!=6){if(this.ControlType!=-1){this.ClearElement(true)}this.IntCtrl=document.createElement("input");this.IntCtrl.type="button";this.IntCtrl.className="panel-value-button";e.appendChild(this.IntCtrl);this.ControlType=6;g=true;this.IsEnabled=true}if(g||b||this.IsEnabled!=d){if(d){this.IntCtrl.style.cursor="pointer";this.IntCtrl.onclick=function(i){a.OnClickActivator(i)}}else{this.IntCtrl.style.cursor="default";this.IntCtrl.onclick=null}}if(this.IsEnabled!=d){this.IntCtrl.disabled=!d;this.IsEnabled=d}if(this.PValue.Text!=this.Text){this.Text=this.PValue.Text;this.IntCtrl.value=this.Text}this.UpdateVisualStyle(h);this.UpdateDims();return g};PCell.prototype.ClearElement=function(d){if(this.IntCtrl){if(this.ControlType==999||(d&&(this.CtrlRectX||this.CtrlRectY||this.Positioned)&&this.FixRectX==undefined)){this.FixRectX=this.CtrlRectX;this.FixRectY=this.CtrlRectY}if(this.ControlType!=3){if(this.ControlType==101){if(RD3_ServerParams.UseIDEditor){this.IntCtrl.Unrealize()}else{var a=this.ParentField.Identifier+(this.InList?":lcke":":fcke");var b=CKEDITOR.instances[a];if(b){try{document.body.appendChild(this.IntCtrl);b.destroy(true)}catch(c){}try{CKEDITOR.remove(a)}catch(c){}}}}if(this.IntCtrl.parentNode){this.IntCtrl.parentNode.removeChild(this.IntCtrl)}if(this.ActObj){if(this.ActObj.parentNode){this.ActObj.parentNode.removeChild(this.ActObj)}this.ActObj=null}if(this.ErrorBox){if(this.ErrorBox.parentNode){this.ErrorBox.parentNode.removeChild(this.ErrorBox)}this.ErrorBox=null}if(this.GroupCollapseButton){this.GroupCollapseButton=null;this.GroupCollapseSrc=""}if(this.GroupLabel){this.GroupLabel=null;this.leftPadding=0}if(this.GroupId){this.GroupId=null}if(this.OptionValueList){this.OptionValueList=null}if(this.BadgeObj){if(this.BadgeObj!=null&&this.BadgeObj.parentNode){this.BadgeObj.parentNode.removeChild(this.BadgeObj)}this.BadgeObj=null;this.BadgeObjX=null;this.BadgeObjY=null;this.Badge=""}if(this.TooltipDiv){if(this.TooltipDiv.parentNode){this.TooltipDiv.parentNode.removeChild(this.TooltipDiv)}this.TooltipDiv=null;this.Tooltip=""}if(this.PopupControlReadOnly){this.PopupControlReadOnly=false}}else{this.IntCtrl.Unrealize()}this.IntCtrl=null;this.SubIntCtrl=null}if(this.ClassName){delete this.ClassName}this.InitProperties();this.HasWatermark=false};PCell.prototype.UpdateDims=function(E,D){if(!this.IntCtrl){if(E!=undefined){this.FixRectX=E;this.FixRectY=D}}else{if(E==0&&D==0){this.Positioned=true}var q=this.ParentField;var F=q.GetValueWidth(this.InList);if(this.ControlType==111&&this.EnlargeCell){F=this.ParentField.ParentPanel.ListWidth-1-this.leftPadding;var b=this.ParentField.ParentPanel.Fields.length;for(var L=0;L<b;L++){var A=this.ParentField.ParentPanel.Fields[L];if(this.ParentField.ParentPanel.AdvTabOrder){A=this.ParentField.ParentPanel.ListTabOrder[L]}if(A&&A.InList&&A.ListList&&A.PGroupListLeft){if(this.PValue.Aggregations[A.Index]!=null){F=A.PGroupListLeft-this.leftPadding;if(F<=0){F=q.GetValueWidth(this.InList)}break}}}if(RD3_ServerParams.Theme=="zen"){F-=10}var B=F-(RD3_ServerParams.Theme=="zen"?22:18);if(B<=0){B=0}this.GroupLabel.style.width=B+"px";this.EnlargeCell=false}var M=q.GetValueHeight(this.InList);var J=false;if(this.FixRectX!=undefined){E=this.FixRectX;D=this.FixRectY;J=true}var j=null;if(E!=undefined&&(J||this.CtrlRectX!=E)){this.CtrlRectX=E;if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){if(!j){j=this.IntCtrl.style}if(this.ActObj&&this.ActObjVisible&&this.ActPos==1){j.left=(E+this.ParentField.ActWidth+2)+"px"}else{j.left=E+"px"}}else{this.IntCtrl.SetLeft(E)}}if(D!=undefined&&(J||this.CtrlRectY!=D)){this.CtrlRectY=D;if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){if(!j){j=this.IntCtrl.style}j.top=D+"px"}else{this.IntCtrl.SetTop(D)}}var S=0;var g=0;if(this.ActObj&&this.ActObjVisible){if(!RD3_Glb.IsMobile()){F-=q.ActWidth+(this.ActPos==1?2:(RD3_ServerParams.Theme=="zen"&&this.InList?8:1))}else{if(this.ActPos==1){S+=q.ActWidth+2}else{g+=q.ActWidth+1}}if(this.ActObjX!=this.CtrlRectX+(this.ActPos==1?0:F-1)){this.ActObjX=this.CtrlRectX+(this.ActPos==1?0:F-1);this.ActObj.style.left=this.ActObjX+"px"}if(this.ActObjY!=this.CtrlRectY){this.ActObjY=this.CtrlRectY;this.ActObj.style.top=this.ActObjY+"px"}if(this.ActObjW!=q.ActWidth+2){this.ActObjW=q.ActWidth+2;this.ActObj.style.width=this.ActObjW+"px"}}if(this.ControlType==2||this.ControlType==30){if(this.Badge&&this.BadgeObj){var m=RD3_Glb.GetBadgeWidth(this.Badge,"grey")+4;var u=this.CtrlRectX+F-m;var t=this.CtrlRectY+2;if(RD3_Glb.IsMobile()){if(this.ActObj&&this.ActObjVisible&&this.ActPos!=1){u-=this.ActObjW+12;g+=m+4}else{g+=m-8}if(this.InList&&this.ParentField){var a=this.ParentField.ParentPanel;if(a.GetLastListField()==this.ParentField&&a.HasScrollbar){u-=30;g+=30}}}if(this.BadgeObjX!=u){this.BadgeObjX=u;this.BadgeObj.style.left=this.BadgeObjX+"px"}if(this.BadgeObjY!=t){this.BadgeObjY=t;this.BadgeObj.style.top=this.BadgeObjY+"px"}}if(RD3_Glb.IsMobile()&&(S||g)){F-=S+g;var k=this.PValue?this.PValue.GetVisualStyle():this.ParentField.VisualStyle;S+=(k.GetCustomPadding(2)*96/288);g+=(k.GetCustomPadding(4)*96/288);if(S!=this.PaddingLeft){this.PaddingLeft=S;this.IntCtrl.style.paddingLeft=S+"px"}if(g!=this.PaddingRight){this.PaddingRight=g;this.IntCtrl.style.paddingRight=g+"px"}}}var P=((this.ControlType==2&&!RD3_Glb.IsMobile())?5:1);var N=((this.ControlType==2&&!RD3_Glb.IsMobile())?5:1);var c=1;if(this.ControlType==111){P=0}if(this.ControlType==6){P=-1;N=-1}else{var k=this.PValue?this.PValue.GetVisualStyle():this.ParentField.VisualStyle;var n=(this.InList)?1:6;var I=k.GetBorders(n);switch(I){case 1:P=P-1;N=N-1;break;case 2:P=P-1;break;case 3:N=N-1;break;case 9:P=k.GetOffset(true,1,this.InList,false)-1;N=k.GetOffset(false,1,this.InList,false)-1;if(!RD3_Glb.IsMobile()){c=N}if(RD3_ServerParams.Theme=="zen"){P=Math.floor(P);N=Math.floor(N);c=Math.floor(c);if(this.ControlType==111){N=c=1}}break}}if(this.CtrlRectH==-1&&this.ActObj){this.ActObj.style.height=(this.ParentField.GetValueHeight(this.InList)-N)+"px"}if(this.ErrorBox&&this.CtrlRectH>0){this.ErrorBox.style.left=this.CtrlRectX+"px";this.ErrorBox.style.top=(this.CtrlRectY+this.CtrlRectH+N-2)+"px";this.ErrorBox.style.width=(this.CtrlRectW+(this.ActObj&&this.ActObjVisible?q.ActWidth+2:0)+(this.ControlType==2?5:1))+"px"}if(E!=undefined&&!J){if(RD3_Glb.IsMobile()&&this.Tooltip!=""){var H=this.Tooltip;this.Tooltip="";this.SetTooltip(H,true)}return}var G=false;if(this.ControlType==3&&this.InList){var e=1;if(this.InList&&this.ParentField.ParentPanel.GetLastListField()==this.ParentField){e=0}G=(e!=this.IntCtrl.ComboMarLeft)}if(this.CtrlRectW!=F-P||G){this.CtrlRectW=F-P;if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){if(!j){j=this.IntCtrl.style}j.width=(this.CtrlRectW<0?0:this.CtrlRectW)+"px";if(this.ErrorBox){this.ErrorBox.style.width=(this.CtrlRectW+(this.ActObj&&this.ActObjVisible?q.ActWidth+2:0)+(this.ControlType==2?5:1))+"px"}}else{this.IntCtrl.SetWidth(this.CtrlRectW)}}if(this.CtrlRectH!=M-N){this.CtrlRectH=M-N;if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){if(!j){j=this.IntCtrl.style}j.height=this.CtrlRectH+"px";if(this.ActObj){this.ActObj.style.height=(M-c-(RD3_ServerParams.Theme=="zen"&&!this.InList?2:0))+"px"}}else{this.IntCtrl.SetHeight(this.CtrlRectH)}}if(this.ControlType==30){if(RD3_Glb.IsMobile()&&q.VisOnlyIcon()){var f=this.IntCtrl.firstChild;var z=f.offsetWidth;var v=f.offsetHeight;if(this.PValue&&RD3_Glb.Adapt4Retina(this.PValue.Identifier,this.ForeImage,43,"FORE")){f.style.display="none"}else{if(z==0||v==0){z=(z==0?26:z);v=(v==0?26:v);var p=this.ParentField;f.onload=function(d){p.COMBOImageReadyStateChanged(d)}}f.style.left=((this.CtrlRectW-z)/2)+"px";f.style.top=((this.CtrlRectH+N-v)/2)+"px"}}}if(this.ControlType==4){j=null;if(RD3_Glb.IsMobile()){this.SubCtrlRectW=RD3_Glb.IsMobile7()?49:93;this.SubCtrlRectH=27;var r=this.GetDynAlignment();if(r==""&&this.PValue){r=this.PValue.GetVisualStyle().GetAlignment(1)}var C=F-this.SubCtrlRectW-12;if(r==2||r=="left"){C=12}if(r==3||r=="center"){C=(F-this.SubCtrlRectW)/2}if(this.SubCtrlRectX!=C){this.SubCtrlRectX=C;if(!j){j=this.SubIntCtrl.style}j.left=this.SubCtrlRectX+"px"}var o=(M-this.SubCtrlRectH)/2;if(this.SubCtrlRectY!=o){this.SubCtrlRectY=o;if(!j){j=this.SubIntCtrl.style}j.top=this.SubCtrlRectY+"px"}}else{if(RD3_Glb.IsIE(10,false)){if(this.SubCtrlRectX!=(F/2-9)){this.SubCtrlRectX=(F/2-9);if(!j){j=this.SubIntCtrl.style}j.left=this.SubCtrlRectX+"px"}if(this.SubCtrlRectY!=(M/2-9)){this.SubCtrlRectY=(M/2-9);if(!j){j=this.SubIntCtrl.style}j.top=this.SubCtrlRectY+"px"}if(this.SubCtrlRectW!=18){this.SubCtrlRectW=18;if(!j){j=this.SubIntCtrl.style}j.width="18px"}if(this.SubCtrlRectH!=18){this.SubCtrlRectH=18;if(!j){j=this.SubIntCtrl.style}j.height="18px"}}else{if(this.SubCtrlRectX!=(F/2-11)){this.SubCtrlRectX=(F/2-11);if(!j){j=this.SubIntCtrl.style}j.left=this.SubCtrlRectX+"px"}}}if((!this.InList&&!RD3_Glb.IsMobile()&&this.ParentField.HdrForm&&!this.ParentField.HdrFormAbove)||(this.InList&&!this.ParentField.ListList&&this.ParentField.HdrList&&!this.ParentField.HdrListAbove)){var r=this.GetDynAlignment();if(r==""&&this.PValue){r=this.PValue.GetVisualStyle().GetAlignment(1)}if(r==4||r=="right"){var K=this.InList?this.ParentField.ListLeft+this.ParentField.ParentPanel.RowSelWidth():this.ParentField.FormLeft;this.IntCtrl.style.left=K+"px";this.CtrlRectX=K;var i=this.InList?this.ParentField.ListCaptionBox.style:this.ParentField.FormCaptionBox.style;i.left=K+this.CtrlRectW+4+2+"px"}else{var K=this.InList?this.ParentField.ListLeft+this.ParentField.ParentPanel.RowSelWidth():this.ParentField.FormLeft;var Q=this.InList?this.ParentField.ListHeaderSize+4:this.ParentField.FormHeaderSize+4;this.IntCtrl.style.left=K+Q+"px";this.CtrlRectX=K+Q;var i=this.InList?this.ParentField.ListCaptionBox.style:this.ParentField.FormCaptionBox.style;i.left=K+"px"}}}if(this.ControlType==101&&!RD3_ServerParams.UseIDEditor){var R=this.ParentField.Identifier+(this.InList?":lcke":":fcke");if(RD3_Glb.IsSafari()||RD3_Glb.IsChrome()){M+=5;F-=13}var O="try { CKEDITOR.instances['"+R+"'].resize("+F+", "+(M-25)+", null, true); } catch (ex) {}";window.setTimeout(O,100)}if(this.ControlType==10&&this.PValue&&this.PValue.BlobMime=="image"){this.ResizeBLOBImage()}if(J){this.FixRectX=undefined;this.FixRectY=undefined}}};PCell.prototype.AdaptInputForAct=function(){if(this.ControlType!=2||this.NumRows>1||this.IsReadOnly||RD3_Glb.IsMobile()){return}if(this.ActObj&&this.ActObjVisible){if(this.ActPos==1){this.IntCtrl.style.left=(this.CtrlRectX+this.ParentField.ActWidth+2)+"px"}else{this.IntCtrl.style.left=this.CtrlRectX+"px"}}else{this.IntCtrl.style.left=this.CtrlRectX+"px";this.IntCtrl.style.width=(this.CtrlRectW<0?0:this.CtrlRectW)+"px"}};PCell.prototype.HideCellContent=function(e,k){if(this.IsCellHidden!=e){this.IsCellHidden=e;var n=this.ParentField.VisualStyle;if(n.GetContrType()==6&&e&&this.ParentField.ParentPanel.Status==RD3_Glb.PS_QBE&&this.InList&&this.ParentField.ListList){while(n.Derived){n=n.Derived}}switch(this.ControlType){case 2:if(this.IsReadOnly){this.IntCtrl.innerHTML=(e?"":this.Text)}else{if(e&&this.ParentField.ParentPanel.Status==RD3_Glb.PS_QBE){this.IntCtrl.disabled="disabled"}else{if(this.IntCtrl.disabled&&(RD3_Glb.IsChrome()||RD3_Glb.IsSafari())){var a=this.IntCtrl.parentNode;var i=this.IntCtrl.nextSibling;this.IntCtrl.parentNode.removeChild(this.IntCtrl);if(i){a.insertBefore(this.IntCtrl,i)}else{a.appendChild(this.IntCtrl)}}this.IntCtrl.removeAttribute("disabled")}this.IntCtrl.value=(e?"":this.Text)}if(e){if(this.ActObj&&this.ActObjVisible){this.ActObj.style.display="none";this.ActObjVisible=false;this.AdaptInputForAct()}if(this.ErrorBox){this.ErrorBox.style.display="none"}}else{if(this.ErrorBox){this.ErrorBox.style.display=""}}break;case 3:this.IntCtrl.HideContent(e,this.ParentField.ParentPanel.Status==RD3_Glb.PS_QBE);if(!e){this.IntCtrl.SetText(this.Text,true,true)}break;case 30:var c=this.IntCtrl.firstChild;var l=c.nextSibling;c.style.display=(e||c.style.left=="-999px"?"none":"");l.style.display=(e?"none":"");if(e&&this.IsCellClickable){this.IsCellClickable=false;this.IntCtrl.onclick=null;this.IntCtrl.style.cursor="default"}break;case 4:this.SubIntCtrl.style.display=(e?"none":"");if(e){this.SubIntCtrl.disabled=true}break;case 5:var b=null;if(this.PValue){b=this.PValue.GetValueList()}if(!b&&this.OldPValue){b=this.OldPValue.GetValueList()}if(!b){b=this.ParentField.ValueList}if(b){b.EnableOption(this.IntCtrl,this.IsEnabled,!e);this.IsCtrlVisible=!e}break;case 10:if(this.SubIntCtrl){this.SubIntCtrl.style.display=(e?"none":"")}break;case 101:if(RD3_ServerParams.UseIDEditor){this.IntCtrl.HideContent(e,this.ParentField.ParentPanel.Status==RD3_Glb.PS_QBE)}break;case 6:this.IntCtrl.style.display=(e?"none":"");break;case 111:if(this.InList&&e&&this.IntCtrl){this.ClearElement(true);this.ControlType=-1;this.IntCtrl=document.createElement("DIV");this.IntCtrl.className="panel-field-value-list";k.appendChild(this.IntCtrl);var f=this.ParentField;var j=f.GetValueWidth(this.InList);var d=f.GetValueHeight(this.InList);this.IntCtrl.style.width=(j>0?j-1:0)+"px";this.IntCtrl.style.height=(d>0?d-1:0)+"px";n.ApplyValueStyle(this.IntCtrl,this.InList,false,false,false,true,false,false,null,false,false,false,true);this.ControlType=999}break;case -1:if(this.InList&&e&&!this.IntCtrl){this.IntCtrl=document.createElement("DIV");this.IntCtrl.className="panel-field-value-list";k.appendChild(this.IntCtrl);var f=this.ParentField;var j=f.GetValueWidth(this.InList);var d=f.GetValueHeight(this.InList);this.IntCtrl.style.width=(j>0?j-1:0)+"px";this.IntCtrl.style.height=(d>0?d-1:0)+"px";n.ApplyValueStyle(this.IntCtrl,this.InList,false,false,false,true,false,false,null,false,false,false,true);this.ControlType=999}break}if(e&&this.GetDOMObj()){var m=true;if(RD3_DesktopManager.WebEntryPoint.HilightedCell==this){m=false;this.SetInactive()}n.ApplyValueStyle(this.GetDOMObj(),this.InList,false,false,false,true,false,false,null,false,false,m,true);this.VisualStyleSign=this.VisualStyleSign.substring(0,this.VisualStyleSign.indexOf("$")+1);var g=this.DynPropSign.split("|");g[0]="";this.DynPropSign=g.join("|")}if(e&&this.BackGroundImage!=""){this.SetBackGroundImage("")}if(e){this.IsEnabled=false;if(this.ControlType==2){this.IsCellClickable=false;this.IntCtrl.style.cursor="default";this.IntCtrl.onclick=null}this.Mask="";this.MaskType="";this.MaskDataSign="";if(this.MaxLength>0){this.MaxLength=-1;if(this.NumRows==1){this.IntCtrl.removeAttribute("maxLength")}}if(this.Badge!=""){if(this.BadgeObj!=null&&this.BadgeObj.parentNode){this.BadgeObj.parentNode.removeChild(this.BadgeObj)}this.BadgeObj=null;this.BadgeObjX=null;this.BadgeObjY=null;this.Badge=""}if(this.Tooltip!=""){this.SetTooltip("")}}}};PCell.prototype.UpdateVisualStyle=function(l,d){var q=this.ParentField;var m=q.ParentPanel;var a=this.PValue.IsEnabled();if(this.InList&&q.ListList&&this.PValue.Index>1&&m.Status==RD3_Glb.PS_QBE){a=false}var n=this.PValue.InQBE()&&(q.IdxPanel<=0||q.AutoLookup||q.LKE);var k=false;var r=false;if(this.InList&&q.ListList){if(m.IsGrouped()){k=(this.PValue.Index==m.GetServerIndex(m.ActualRow));r=(m.GetRowForIndex(this.PValue.Index)%2==0?false:true)}else{k=(this.PValue.Index==(m.ActualPosition+m.ActualRow));r=((this.PValue.Index-m.ActualPosition)%2==0?false:true)}}var o=this.PValue.ErrorType;var j=l.Identifier+"*"+(o==1?"1":"0")+(o==2||o==3?"1":"0")+"$"+(r?"1":"0")+(k?"1":"0")+(a?"1":"0")+(n?"1":"0")+(d?"-OBJ":"");var h=this.GetDynPropSign();var e=false;if(j!=this.VisualStyleSign||h!=this.DynPropSign){var c=false;if(h==this.DynPropSign&&this.ControlType==3){var g=j.substring(0,j.indexOf("*"))+j.substring(j.indexOf("$"));var f=this.VisualStyleSign.substring(0,this.VisualStyleSign.indexOf("*"))+this.VisualStyleSign.substring(this.VisualStyleSign.indexOf("$"));if(g==f){c=true}}var b=false;if(this==RD3_DesktopManager.WebEntryPoint.HilightedCell&&!c){b=true;this.SetInactive()}if(h!="|||-1|"){this.ApplyDynPropToVisualStyle(l)}var i=(j.substring(0,j.indexOf("$")+5)==this.VisualStyleSign.substring(0,this.VisualStyleSign.indexOf("$")+5));if(!d||!i||h!=this.DynPropSign){e=(j.substring(0,j.indexOf("$"))==this.VisualStyleSign.substring(0,this.VisualStyleSign.indexOf("$")))&&(h.substring(h.indexOf("|"))==this.DynPropSign.substring(this.DynPropSign.indexOf("|")));var p;if(!e){p=q.IsRightAligned()?"right":"left"}l.ApplyValueStyle(this.GetDOMObj(),this.InList,false,r,k,!a,o==1,(o==2||o==3),p,n,false,e,true,this.ControlType==6);if(!e){this.PaddingRight=undefined;this.PaddingLeft=undefined}if(this.IntCtrl instanceof IDCombo){this.IntCtrl.SetLeft(this.IntCtrl.Left)}}if(d){l.ApplyValueStyle(d,this.InList,false,r,k,!a,o==1,(o==2||o==3),null,n,false,false,true)}if(h!="|||-1|"){this.CleanVisualStyle(l)}this.VisualStyleSign=j;this.DynPropSign=h;if(b){this.SetActive()}return true}return false};PCell.prototype.SetQBEEnabled=function(b){var a=this.PValue.IsEnabled();if(this.ControlType!=-1&&this.IsEnabled!=a){var c=this.GetDOMObj().parentNode;var e=this.CtrlRectX;var d=this.CtrlRectY;this.ClearElement();this.Render(c);this.UpdateDims(e,d)}};PCell.prototype.SetBackGroundImage=function(a){if(a!=""&&(this.ControlType==999||this.ControlType==111)){return}if(a==undefined&&this.FixBackGroundImage!=undefined){a=this.FixBackGroundImage}if(a!=undefined&&this.BackGroundImage!=a){if(this.IntCtrl){this.BackGroundImage=a;if(this.ControlType!=3&&!(this.ControlType==101&&RD3_serverParams.UseIDEditor)){this.IntCtrl.style.backgroundImage=a;if(this.PValue&&RD3_Glb.Adapt4Retina(this.PValue.Identifier,a,43,a)){this.IntCtrl.style.backgroundSize="0px 0px";this.BackGroundImage=""}}else{this.IntCtrl.SetBackGroundImage(a)}this.FixBackGroundImage=undefined}else{this.FixBackGroundImage=a}}};PCell.prototype.SetBackGroundImageRM=function(a){if(this.BackGroundImage==""){return}if(a==undefined&&this.FixBackGroundImageRM!=undefined){a=this.FixBackGroundImageRM}if(a!=undefined&&this.BackGroundImageRM!=a){if(this.IntCtrl){this.BackGroundImageRM=a;if(this.ControlType!=3&&!(this.ControlType==101&&RD3_serverParams.UseIDEditor)){var b="";var d="";switch(this.BackGroundImageRM){case 1:case 3:b="repeat";d="";break;case 2:b="no-repeat";d="center center";break}var c=this.IntCtrl.style;c.backgroundRepeat=b;c.backgroundPosition=d}this.FixBackGroundImageRM=undefined}else{this.FixBackGroundImageRM=a}}};PCell.prototype.SetTooltip=function(h,e){var i=RD3_Glb.IsMobile();if(h==""&&this.ParentField.ParentPanel.TooltipOnEachRow&&!i){h=this.ParentField.Tooltip}if(h!=this.Tooltip){var c=this.Tooltip;this.Tooltip=h;if(i){var j=this.ControlType!=3?this.IntCtrl:this.IntCtrl.GetDOMObj();if(this.InList&&(this.IsReadOnly||!this.IsEnabled)&&this.IsVisible&&(this.TooltipDiv||e||(c==""&&j.parentNode))){if(this.Tooltip!=""){if(!this.TooltipDiv){this.TooltipDiv=document.createElement("div");this.TooltipDiv.className="panel-value-tooltip";this.TooltipDiv.id=this.IntCtrl.id;j.parentNode.appendChild(this.TooltipDiv);j.setAttribute("oldPaddingB",j.style.paddingBottom);j.setAttribute("oldPaddingT",j.style.paddingTop)}this.TooltipDiv.style.top=(this.CtrlRectY+19)+"px";j.style.paddingBottom="16pt";j.style.paddingTop="0px";this.TooltipDiv.style.display="";var l=this.PValue?this.PValue.GetVisualStyle():this.ParentField.VisualStyle;if(l){var g=null;if(this.PValue&&this.PValue.Alignment!=-1){g=this.PValue.Alignment}else{if(this.ParentField.Alignment!=-1){g=this.ParentField.Alignment}else{g=l.GetAlignment(1)}}var m="left";switch(g){case 1:m=this.ParentField.IsRightAligned()?"right":"left";break;case 2:m="left";break;case 3:m="center";break;case 4:m="right";break;case 5:m="justify";break}this.TooltipDiv.style.textAlign=m}if(RD3_Glb.HasClass(j,"panel-field-selected")||RD3_Glb.HasClass(j,"panel-field-unselected")){RD3_Glb.SetClass(this.TooltipDiv,"panel-value-tooltip-multiplesel",true)}}else{if(this.TooltipDiv){this.TooltipDiv.style.display="none"}var k=j.getAttribute("oldPaddingB");var b=j.getAttribute("oldPaddingT");if(k){j.style.paddingBottom=k}if(b){j.style.paddingTop=b}}if(this.TooltipDiv){this.TooltipDiv.innerHTML=this.Tooltip}}}else{if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){RD3_TooltipManager.SetObjTitle(this.IntCtrl,this.Tooltip)}else{this.IntCtrl.SetTooltip(this.Tooltip)}}}if(RD3_ServerParams.TooltipErrorMode>1&&!i){if(this.ErrorType==1){if(!this.TooltipErrorObj){this.TooltipErrorObj=new MessageTooltip(this)}var d=this.GetDOMObj();this.TooltipErrorObj.SetObj(d);this.GetTooltip(this.TooltipErrorObj,d);this.TooltipErrorObj.SetDelay(0,0);try{this.TooltipErrorObj.SetAnchor(RD3_Glb.GetScreenLeft(d),RD3_Glb.GetScreenTop(d)+d.offsetHeight)}catch(f){}this.TooltipErrorObj.SetAutoAnchor(false);this.TooltipErrorObj.SetPosition(2);if(RD3_ServerParams.TooltipErrorMode==2){this.TooltipErrorObj.ReusableTooltip=true}if((RD3_ServerParams.TooltipErrorMode==3||(RD3_ServerParams.TooltipErrorMode==2&&RD3_DesktopManager.WebEntryPoint.HilightedCell===this))&&!this.TooltipErrorObj.Opened){this.TooltipErrorObj.Activate()}}else{if(this.TooltipErrorObj){this.TooltipErrorObj.SetOwner(null);this.TooltipErrorObj.Deactivate();this.TooltipErrorObj=null}}}};PCell.prototype.SetVisible=function(b){if(b==undefined&&this.FixIsVisible!=undefined){b=this.FixIsVisible}if(b!=undefined&&this.IsVisible!=b){if(this.IntCtrl){this.IsVisible=b;if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){RD3_Glb.SetDisplay(this.IntCtrl,(b?"":"none"));if(this.ActObj){var a=(b&&this.PValue&&this.PValue.ActivatorImage(this.PValue.GetVisualStyle())!="");if(this.ActObjVisible!=a){this.ActObj.style.display=(a?"":"none");this.ActObjVisible=a;if(a){this.UpdateDims()}this.AdaptInputForAct()}}}else{this.IntCtrl.SetVisible(b)}if(this.ErrorBox){this.ErrorBox.style.display=(b?"":"none")}this.FixIsVisible=undefined}else{this.FixIsVisible=b}}};PCell.prototype.GetDOMObj=function(a){if(this.ControlType==111&&a){return this.GroupLabel}else{if(this.ControlType!=3&&!(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){return this.IntCtrl}else{return this.IntCtrl.GetDOMObj()}}};PCell.prototype.Focus=function(s,z){if((this.PValue==null)||(this.ControlType==999)||(this.ControlType==-1)){return}if(RD3_Glb.IsMobile()&&(this.IsReadOnly||!this.IsEnabled)){return}var L=this.ParentField.ParentPanel.WebForm.GetMasterForm();var g=(L.FramesBox&&L.FramesBox.parentNode?L.FramesBox.parentNode.style:null);if(RD3_Glb.IsMobile()&&L.Docked&&g&&g.display=="none"){RD3_KBManager.CheckFocus=true;return false}try{var w=this.ParentField;var m=w.ParentPanel;var y=m.FixedColumns;var A=w.ListTabOrder==-1?w.Index:w.ListTabOrder;var F=(w.ListList&&y>0&&A>y);if(!F){var J=this.CtrlRectX+(m.PanelMode==RD3_Glb.PANEL_LIST&&w.InList&&w.ListList?w.ListLeft:0);var I=J+w.GetValueWidth(this.InList);if((I-m.ContentBox.scrollLeft)>m.ContentBox.clientWidth){var o=I-m.ContentBox.clientWidth+1;if(J<o&&this.ValueAlign=="left"){o=J}if(o<0){o=0}m.ContentBox.scrollLeft=o}else{if(m.ContentBox.scrollLeft>J&&(this.ValueAlign=="left"||w.GetValueWidth(this.InList)<m.ContentBox.clientWidth)){m.ContentBox.scrollLeft=J}}}if(RD3_Glb.IsMobile()){var u=(m.PanelMode==RD3_Glb.PANEL_LIST)?m.ListBox:m.FormBox;var j=RD3_Glb.TranslateY(u);var M=u.parentNode.offsetHeight;var p=0;var b=this.ParentField.GetValueHeight(this.InList);var a=false;if(this.CtrlRectY+j<0){p=this.CtrlRectY;a=true}if(this.CtrlRectY+b+j>M){p=this.CtrlRectY+b-M;a=true}if(a){RD3_Glb.SetTransform(u,"translate3d(0px,-"+p+"px,0px)")}}if(RD3_Glb.IsMobile()&&this.ParentField.UsePopupControl()&&this.IsEnabled&&!(this.IntCtrl instanceof IDCombo)){var q=new PopupControl(this.ParentField.GetPopupControlType(),this);q.Open();q.LastActiveObject=null;q.LastActiveElement=null;return true}var c=this.GetDOMObj();if(this.ControlType==4){c=this.SubIntCtrl}if(this.ControlType==5&&c.childNodes.length>0){var v=c.childNodes[0];for(var e=0;e<c.childNodes.length;e++){if(c.childNodes[e].checked){v=c.childNodes[e];break}}c=v}if(this.ControlType==111){c=this.GroupLabel}c.focus();c.focus();if((this.ControlType==2&&!this.IsReadOnly)||this.ControlType==3){var K=this.IsEnabled;var E=this.Mask;var i=this.MaskType;if(K&&E&&i){mc(E,i,null,this.GetDOMObj())}if(K){var D=true;if(this.HasWatermark){s=false}if(RD3_DesktopManager.SelFld&&RD3_DesktopManager.SelFld==this.ParentField.Identifier&&!this.HasWatermark){try{var x=parseInt(RD3_DesktopManager.SelSt);var k=parseInt(RD3_DesktopManager.SelEn);if(c.createTextRange){var H=c.createTextRange();H.move("character",x-1);H.moveEnd("character",(k-x+1));H.select()}else{c.selectionStart=x-1;c.selectionEnd=k}D=false}catch(G){}}if(D){if(s){if(c.createTextRange){var H=c.createTextRange();H.select()}else{c.selectionStart=0;c.selectionEnd=c.value.length}this.ParentField.SendtextSelChange(this.GetDOMObj(true));if(RD3_KBManager.SelTextTimer){window.clearTimeout(RD3_KBManager.SelTextTimer);RD3_KBManager.SelTextSrc=null;RD3_KBManager.SelTextObj=null;RD3_KBManager.SelTextTimer=null}}else{if(this.HasWatermark){setCursorPos(c,0);c.scrollLeft=0}else{if(c.createTextRange){if(this.Text!=""&&((this.NumRows==1&&getCursorPos(c)<=0)||(this.NumRows>1&&RD3_Glb.getTextAreaSelection(c,false)<=0))){var H=c.createTextRange();H.collapse(false);H.select()}}}}}RD3_DesktopManager.SelFld=null;RD3_DesktopManager.SelSt=null;RD3_DesktopManager.SelEn=null}else{if(z&&(RD3_Glb.IsChrome()||RD3_Glb.IsSafari())){setCursorPos(c,0);c.scrollLeft=0}}}else{if(this.ControlType==101&&!RD3_ServerParams.UseIDEditor){if(RD3_DesktopManager.SelFld&&RD3_DesktopManager.SelFld==this.ParentField.Identifier){var P=this.ParentField.Identifier+(this.InList?":lcke":":fcke");var C=CKEDITOR.instances[P];var x=parseInt(RD3_DesktopManager.SelSt);var k=parseInt(RD3_DesktopManager.SelEn);C.focus();if(RD3_Glb.IsIE()){C.document.$.selection.empty();var f=C.document.$.selection.createRange();f.moveStart("character",x-1);f.moveEnd("character",k-1);f.select()}else{var d=new Object();d.node=C.document.$.body;d.currPos=x-1;var n=new Object();n.node=C.document.$.body;n.currPos=k;var O=this.SearchRangeNode(d);var N=this.SearchRangeNode(n);var f=C.document.$.createRange();f.setStart(O.node,O.pos);f.setEnd(N.node,N.pos);var B=C.document.getWindow().$.getSelection();B.removeAllRanges();B.addRange(f)}}RD3_DesktopManager.SelFld=null;RD3_DesktopManager.SelSt=null;RD3_DesktopManager.SelEn=null}else{if(this.ControlType==101&&RD3_ServerParams.UseIDEditor){this.IntCtrl.Focus()}}}RD3_KBManager.CheckFocus=false;if(RD3_KBManager.FocusFieldTimerId){window.clearTimeout(RD3_KBManager.FocusFieldTimerId);RD3_KBManager.FocusFieldTimerId=0}return true}catch(G){RD3_KBManager.CheckFocus=true;return false}};PCell.prototype.SetActive=function(){if(this.ControlType==111){return}var l=RD3_DesktopManager.WebEntryPoint.HilightedCell;if(l==this){if(this.ControlType==3&&this.IntCtrl.DeferEmpty){this.IntCtrl.SetText("",true,true)}return}if(l){l.SetInactive()}if(this.IsEnabled&&this.ControlType!=6&&!RD3_Glb.IsMobile()){var f=this.ParentField;var m=this.PValue?this.PValue.GetVisualStyle():f.VisualStyle;var e=m.GetColor(10);var c=m.GetColor(11);var k=m.GetBorders((this.InList)?1:6);var b=m.GetBookOffset(true,(this.InList)?1:6);var o=this.GetDOMObj().style;if(e!="transparent"){o.backgroundColor=e}else{if(RD3_ServerParams.Theme!="zen"){o.border="2px solid "+c;var h=parseInt(o.width)-(4-b.x-b.w);var d=parseInt(o.height)-(4-b.y-b.h);o.width=(h<0?0:h)+"px";o.height=(d<0?0:d)+"px"}}if(this.ActObj&&this.ActObjVisible){var n=this.ActObj.style;if(e!="transparent"){n.backgroundColor=e}else{if(RD3_ServerParams.Theme!="zen"){if(this.ActPos==1){n.borderLeft="2px solid "+c;o.borderLeft="none";n.backgroundPosition="1px center";o.width=(parseInt(o.width)+2)+"px"}else{n.borderRight="2px solid "+c;o.borderRight="none";var j=3-2*b.w;n.left=(parseInt(n.left)-j)+"px";n.backgroundPosition="3px center"}n.borderTop="2px solid "+c;n.borderBottom="2px solid "+c;var g=(b.y==0&&b.h==0)?3:4;n.height=(parseInt(n.height)-(g-b.y-b.h))+"px"}}}if(this.ControlType==3||(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){this.IntCtrl.SetActive(true)}RD3_DesktopManager.WebEntryPoint.HilightedCell=this;if(this.ControlType==2&&this.NumRows==1){var m=this.PValue.GetVisualStyle();if(m.IsPassword()){var a=true;for(var i=0;i<this.Text.length;i++){if(this.Text.substr(i,1)!="*"){a=false;break}}if(a){this.IntCtrl.value="";this.PwdSvuotata=true}}}if(this.TooltipErrorObj&&!this.TooltipErrorObj.Opened&&RD3_ServerParams.TooltipErrorMode==2){this.TooltipErrorObj.Activate()}}else{this.ParentField.LostFocus(this.IntCtrl,null,true)}};PCell.prototype.SetInactive=function(){RD3_DesktopManager.WebEntryPoint.HilightedCell=null;this.VisualStyleSign="";this.DynPropSign="|||-1|";this.CtrlRectW=-1;this.CtrlRectH=-1;this.ActObjX=-1;if(this.ControlType==2&&this.NumRows==1&&this.PValue){var b=this.PValue.GetVisualStyle();if(b.IsPassword()){this.Text=""}}if(this.Mask!=""&&this.ControlType==2&&this.IntCtrl&&this.Text==""){this.IntCtrl.value=""}if(this.ControlType==101&&!RD3_ServerParams.UseIDEditor){var a=this.ParentField.Identifier+(this.InList?":lcke":":fcke");this.ParentField.OnFCKSelectionChange(CKEDITOR.instances[a])}this.Update(this.PValue,this.GetDOMObj().parentNode);if(this.ControlType==3||(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){this.IntCtrl.SetActive(false)}if(this.TooltipErrorObj&&this.TooltipErrorObj.Opened&&RD3_ServerParams.TooltipErrorMode==2){this.TooltipErrorObj.Deactivate(true)}if(this.ActObj&&this.ActObjVisible){this.ActObj.style.backgroundPosition="center center"}};PCell.prototype.OnComboChange=function(e,c,d){var a=this.Text;this.Text=this.IntCtrl.GetComboValue();if(e&&this.PValue){var f=this.IntCtrl.GetDOMObj();var b=((e&&this.ParentField.HasValueSource)||c?RD3_Glb.EVENT_IMMEDIATE:0);if(this.ParentField.HasValueSource&&this.ParentField.SuperActive&&d){b=RD3_Glb.EVENT_SERVERSIDE}this.PValue.SendChanges(f,b);if(this.ParentField.LKE&&this.ParentField.ChangeEventDef==RD3_Glb.EVENT_ACTIVE&&a!=this.Text){this.ComboEditing=true}}};PCell.prototype.OnComboActivatorClick=function(b){if(this.ParentField.LKE&&this.IsEnabled&&(b||!this.ParentField.CanActivate)){if(this.Text==""||this.Text==this.IntCtrl.OriginalText||RD3_Glb.IsMobile()){this.Text="*"}var a="";if(this.IntCtrl.MultiSel){a+=this.IntCtrl.GetComboFinalName(true);a+=(a.length>0&&this.Text.length>0?";":"")}a+=this.Text;var c=new IDEvent("chg",this.PValue.Identifier,null,this.ParentField.ChangeEventDef|RD3_Glb.EVENT_IMMEDIATE,"",a)}else{if(this.ParentField.HasValueSource&&this.ParentField.SuperActive){var c=new IDEvent("clk",this.PValue.Identifier,null,RD3_Glb.EVENT_SERVERSIDE,"","","","","",RD3_ClientParams.SuperActiveDelay,true)}else{var c=new IDEvent("clk",this.PValue.Identifier,null,this.ParentField.ClickEventDef)}}};PCell.prototype.UploadBlob=function(){if(this.ControlType==10){if(!this.SubIntCtrl[0].value){return}if(window.RD4_Enabled){var a=new FileReader();a.onload=(function(c){return(function(h){var d=c.ParentField.ParentPanel;var f=c.FileToUpload;var g=new IDEvent("IWUpload","",null,RD3_Glb.EVENT_ACTIVE,"","F"+d.WebForm.IdxForm,f.name,f.type,h.target.result)})})(this);a.readAsBinaryString(this.FileToUpload)}else{try{RD3_DesktopManager.WebEntryPoint.DelayDialog.Open(RD3_ServerParams.DelayDefaultMessage,RD3_Glb.DELAY);this.SubIntCtrl.submit()}catch(b){RD3_DesktopManager.WebEntryPoint.DelayDialog.Close()}}}};PCell.prototype.CloneFrom=function(a){if(this.ControlType!=-1){this.ClearElement(true)}if(RD3_DesktopManager.WebEntryPoint.HilightedCell==a){a.SetInactive()}this.ControlType=a.ControlType;this.ErrorType=a.ErrorType;this.NumRows=a.NumRows;this.IsVisible=a.IsVisible;this.IsCtrlVisible=a.IsCtrlVisible;this.FixIsVisible=a.FixIsVisible;this.IsEnabled=a.IsEnabled;this.IsReadOnly=a.IsReadOnly;this.BackGroundImage=a.BackGroundImage;this.FixBackGroundImage=a.FixBackGroundImage;this.BackGroundImageRM=a.BackGroundImageRM;this.FixBackGroundImageRM=a.FixBackGroundImageRM;this.VisualStyleSign=a.VisualStyleSign;this.DynPropSign=a.DynPropSign;this.IsCellClickable=a.IsCellClickable;this.ValueAlign=a.ValueAlign;this.Text=a.Text;this.BlobCellType=a.BlobCellType;this.IsCellHidden=a.IsCellHidden;this.Badge=a.Badge;this.Tooltip=a.Tooltip;this.Mask=a.Mask;this.MaskType=a.MaskType;this.MaskDataSign=a.MaskDataSign;this.MaxLength=a.MaxLength;this.HasWatermark=a.HasWatermark;this.ClassName=a.ClassName;if(a.PopupControlReadOnly!=undefined){this.PopupControlReadOnly=a.PopupControlReadOnly}if(a.ForeImage!=undefined){this.ForeImage=a.ForeImage}this.CtrlRectX=a.CtrlRectX;this.CtrlRectY=a.CtrlRectY;this.CtrlRectW=a.CtrlRectW;this.CtrlRectH=a.CtrlRectH;if(a.IntCtrl){if(this.ControlType==3){this.IntCtrl=a.IntCtrl.Clone(this);RD3_Glb.RemoveClass(this.IntCtrl.ComboInput,"cell-hover")}else{if(this.ControlType==101&&RD3_ServerParams.UseIDEditor){this.IntCtrl=a.IntCtrl.Clone(this)}else{this.IntCtrl=a.IntCtrl.cloneNode(true);RD3_Glb.RemoveClass(this.IntCtrl,"cell-hover");if(this.ControlType==2&&this.NumRows>1&&(RD3_Glb.IsWebKit()||RD3_Glb.IsFirefox())){this.IntCtrl.value=a.IntCtrl.value}if(this.ControlType==2&&this.NumRows==1&&RD3_Glb.IsChrome()){this.IntCtrl.value=a.IntCtrl.value}if(a.SubIntCtrl){this.SubIntCtrl=this.IntCtrl.lastChild;if((RD3_Glb.IsIE()||RD3_Glb.IsMobile())&&this.ControlType==4){this.SubIntCtrl.checked=a.SubIntCtrl.checked}this.SubCtrlRectX=a.SubCtrlRectX;this.SubCtrlRectY=a.SubCtrlRectY;this.SubCtrlRectW=a.SubCtrlRectW;this.SubCtrlRectH=a.SubCtrlRectH;if(this.ControlType==10){this.SubCtrlRectIMG=a.SubCtrlRectIMG}}if(a.ActObj){this.ActObj=a.ActObj.cloneNode(false);this.ActObjVisible=a.ActObjVisible;this.ActObjSrc=a.ActObjSrc;this.ActPos=a.ActPos;this.ActObjX=a.ActObjX;this.ActObjY=a.ActObjY;this.ActObjW=a.ActObjW;this.ActObjCurs=a.ActObjCurs}else{this.ActObj=null}if(a.ErrorBox){this.ErrorBox=a.IntCtrl.lastChild}else{this.ErrorBox=null}if(a.BadgeObj){this.BadgeObj=a.BadgeObj.cloneNode(true);this.BadgeObjX=a.BadgeObjX;this.BadgeObjY=a.BadgeObjX}else{this.BadgeObj=null}this.PaddingLeft=a.PaddingLeft;this.PaddingRight=a.PaddingRight}}}else{this.IntCtrl=null;this.ControlType=-1}};PCell.prototype.IsGoodClone=function(d){if(this.PValue.GetControlType()!=d.ControlType){return false}if((this.NumRows==1)!=(d.NumRows==1)){return false}if(this.PValue.ErrorType!=d.ErrorType){return false}if(this.PValue.IsVisible()!=d.IsVisible){return false}if(this.PValue.GetVisualStyle()!=(d.PValue?d.PValue.GetVisualStyle():null)){return false}if(this.InList&&this.ParentField.ListList&&d.PValue){if(((this.PValue instanceof PListGroup)&&(d.PValue instanceof PValue))||((this.PValue instanceof PValue)&&(d.PValue instanceof PListGroup))){return false}if(this.PValue instanceof PListGroup){return true}var e=false;var b=false;var f=false;var c=false;var a=this.ParentField.ParentPanel;e=(this.PValue.Index==a.ActualPosition+a.ActualRow);b=(d.PValue.Index==a.ActualPosition+a.ActualRow);f=((this.PValue.Index-a.ActualPosition)%2==0?false:true);c=((d.PValue.Index-a.ActualPosition)%2==0?false:true);if(e!=b||f!=c){return false}}return true};PCell.prototype.GetTooltip=function(b,c){if(this.TooltipErrorObj&&this.TooltipErrorObj!=b){if(RD3_ServerParams.TooltipErrorMode==2||RD3_ServerParams.TooltipErrorMode==3){return false}}if(this.ControlType==3){return this.IntCtrl.GetTooltip(b,c)}if(this.ControlType==101&&RD3_ServerParams.UseIDEditor){return this.IntCtrl.GetTooltip(b,c)}if(this.ControlType==5){var a=(this.PValue?this.PValue.GetValueList():null);if(a&&a.GetTooltipOption(this.IntCtrl,b,c)){b.SetTitle(this.GetTooltipTitle()+(b.Title.length>0?": "+b.Title:""));b.SetObj(this.IntCtrl);return true}}if(this.Tooltip==""){return false}if(this.ErrorType==1){b.SetStyle("error")}else{if(this.ErrorType==2||this.ErrorType==3){b.SetStyle("warning")}}b.SetTitle(this.GetTooltipTitle());b.SetText(this.Tooltip);b.SetAutoAnchor(true);b.SetPosition(2);return true};PCell.prototype.GetTooltipTitle=function(){return this.ParentField.Header};PCell.prototype.DropElement=function(){return this.GetDOMObj()};PCell.prototype.ComputeDropList=function(b,a){if(a==this){return}var c=this.GetDOMObj();if(c){b.push(this);this.AbsLeft=RD3_Glb.GetScreenLeft(c,true);this.AbsTop=RD3_Glb.GetScreenTop(c,true);this.AbsRight=this.AbsLeft+c.offsetWidth-1;this.AbsBottom=this.AbsTop+c.offsetHeight-1;if(!this.InList&&RD3_Glb.IsMobile()&&this.ParentField.HdrForm){if(this.ParentField.HdrFormAbove){this.AbsTop-=this.ParentField.FormHeaderSize}else{this.AbsLeft-=this.ParentField.FormHeaderSize}}}};PCell.prototype.GetParentFrame=function(){return this.ParentField.GetParentFrame()};PCell.prototype.OnMouseDownObj=function(b,a){if(this.ControlType==3){this.IntCtrl.OnMouseDownObj(b,a)}};PCell.prototype.RenderPListGroup=function(j){var d=this.ParentField.IsFirstListList();if(!d&&this.ParentField.FirstListFld){this.ParentField.FirstListFld=false;this.ParentField.ListBox.className="panel-field-list-box"}if(!this.ParentField.FirstListFld&&d){this.ParentField.FirstListFld=true;this.ParentField.ListBox.className="panel-field-grouped-list-box"}if(this.ControlType!=111||this.FirstGroupField!=d){var c=(RD3_KBManager.ActiveElement&&RD3_KBManager.ActiveElement==this.GetDOMObj());if(c){RD3_DesktopManager.WebEntryPoint.SetHideFocusBox();RD3_KBManager.ActiveElement=null}this.ClearElement(true);this.ControlType=111;this.IntCtrl=document.createElement("DIV");this.IntCtrl.className="group-container";if(d){this.GroupLabel=document.createElement(RD3_Glb.IsMobile()?"SPAN":"input");if(!RD3_Glb.IsMobile()){this.GroupLabel.type="text"}this.GroupId=this.ParentField.Identifier+":lsg:"+this.PValue.Index;this.GroupLabel.setAttribute("id",this.GroupId);this.IntCtrl.style.overflow="visible"}else{this.GroupLabel=document.createElement("SPAN");if(!this.PValue.Aggregations||this.PValue.Aggregations.length==0){this.IntCtrl.className="group-container group-container-list"}}this.GroupLabel.className="group-label";this.IntCtrl.appendChild(this.GroupLabel);if(!RD3_Glb.IsIE(10,false)&&d&&!RD3_Glb.IsMobile()){var g=function(n){RD3_KBManager.IDRO_GetFocus(n)};this.GroupLabel.onfocus=g}j.appendChild(this.IntCtrl)}else{if(d){this.GroupId=this.ParentField.Identifier+":lsg:"+this.PValue.Index;this.GroupLabel.setAttribute("id",this.GroupId)}}if(d&&!this.IsVisible){this.IntCtrl.style.display="";this.IsVisible=true}this.IsEnabled=false;var e=d?(this.PValue.Level*20+2):0;if(this.leftPadding!=e){this.leftPadding=e;this.IntCtrl.style.paddingLeft=RD3_Glb.IsMobile()?(this.leftPadding+10)+"pt":this.leftPadding+"px"}var i=d?this.PValue.Label:this.PValue.Aggregations[this.ParentField.Index];if(!i){i=""}if(this.Text!=i){this.Text=i;if(d&&!RD3_Glb.IsMobile()){this.GroupLabel.value=this.Text}else{this.GroupLabel.innerHTML=this.Text}}if(!RD3_Glb.IsMobile()){if(!this.GroupCollapseButton&&d){this.GroupCollapseButton=document.createElement("IMG");this.GroupCollapseButton.className="group-collapse-img";this.IntCtrl.insertBefore(this.GroupCollapseButton,this.GroupLabel);this.GroupCollapseVis=true}if(d){var f=this.PValue;var b=function(n){f.OnExpandGrp(n,"")};this.IntCtrl.onclick=b;this.IntCtrl.style.cursor="pointer";if(this.GroupLabel){this.GroupLabel.style.cursor="pointer"}}var m=RD3_Glb.GetImgSrc("images/"+(this.PValue.Expanded?"grcl.gif":"grxp.gif"));if(this.GroupCollapseButton&&this.GroupCollapseSrc!=m){if(!RD3_Glb.IsMobile()){this.GroupCollapseSrc=m;this.GroupCollapseButton.src=this.GroupCollapseSrc}}if(this.GroupCollapseButton&&this.GroupCollapseVis!=d){this.GroupCollapseVis=d;this.GroupCollapseButton.style.display=this.GroupCollapseVis?"":"none"}var l=this.PValue.GetVisualStyle();var h=l.Identifier+"*00$0000";var k=false;if(h!=this.VisualStyleSign){if(this==RD3_DesktopManager.WebEntryPoint.HilightedCell){RD3_DesktopManager.WebEntryPoint.HilightedCell=null}var a=this.ParentField.IsRightAligned()?"right":"left";l.ApplyListGroupStyle(this.GetDOMObj(),d,false,a);if(d){l.ApplyListGroupStyle(this.GroupLabel,false,true,a)}this.VisualStyleSign=h}}this.EnlargeCell=d;this.FirstGroupField=d;this.UpdateDims()};PCell.prototype.GetDynPropSign=function(){var e=(this.PValue&&this.PValue.BackColor!=""?this.PValue.BackColor:this.ParentField.BackColor);var b=(this.PValue&&this.PValue.ForeColor!=""?this.PValue.ForeColor:this.ParentField.ForeColor);var c=(this.PValue&&this.PValue.FontMod!=""?this.PValue.FontMod:this.ParentField.FontMod);var d=(this.PValue&&this.PValue.Alignment!=-1?this.PValue.Alignment:this.ParentField.Alignment);var a=(this.PValue&&this.PValue.Mask!=""?this.PValue.Mask:this.ParentField.Mask);return e+"|"+b+"|"+c+"|"+d+"|"+a};PCell.prototype.GetDynAlignment=function(){var b=(this.PValue&&this.PValue.Alignment!=-1?this.PValue.Alignment:this.ParentField.Alignment);if(b!=-1){var c="";switch(b){case 2:c="left";break;case 3:c="center";break;case 4:c="right";break;case 5:c="justify";break}return c}return""};PCell.prototype.ApplyDynPropToVisualStyle=function(k){var h=(this.PValue&&this.PValue.BackColor!=""?this.PValue.BackColor:this.ParentField.BackColor);var b=(this.PValue&&this.PValue.ForeColor!=""?this.PValue.ForeColor:this.ParentField.ForeColor);if(h!=""||b!=""){k.OldColor=new Array();var a=k.Color.length;for(var d=0;d<a;d++){k.OldColor[d]=k.Color[d]}if(h!=""){k.Color[5]=h;k.Color[4]=h;k.Color[14]=h;k.Color[22]=h;k.Color[23]=h;k.Color[16]=h;k.Color[18]=h;k.Color[15]=h;k.Color[9]=h}if(b!=""){k.Color[1]=b;k.Color[2]=b;k.Color[20]=b;k.Color[21]=b}}var j=(this.PValue&&this.PValue.FontMod!=""?this.PValue.FontMod:this.ParentField.FontMod);if(j!=""){k.OldFont=new Array();var a=k.Font.length;for(var d=0;d<a;d++){k.OldFont[d]=k.Font[d]}var g=k.GetFont(1).split(",");g[1]=j;k.Font[1]=g.join(",");g=k.GetFont(4).split(",");g[1]=j;k.Font[4]=g.join(",");g=k.GetFont(5).split(",");g[1]=j;k.Font[5]=g.join(",");g=k.GetFont(6).split(",");g[1]=j;k.Font[6]=g.join(",")}var e=(this.PValue&&this.PValue.Alignment!=-1?this.PValue.Alignment:this.ParentField.Alignment);if(e!=-1){k.OldAlign=new Array();for(var d=0;d<k.Alignments.length;d++){k.OldAlign[d]=k.Alignments[d]}k.Alignments[1]=e}var c=(this.PValue&&this.PValue.Mask!=""?this.PValue.Mask:this.ParentField.Mask);if(c!=""){k.OldMask=k.Mask;k.Mask=c}};PCell.prototype.CleanVisualStyle=function(a){if(a.OldColor!=undefined){a.Color=a.OldColor;a.OldColor=undefined}if(a.OldFont!=undefined){a.Font=a.OldFont;a.OldFont=undefined}if(a.OldAlign!=undefined){a.Alignments=a.OldAlign;a.OldAlign=undefined}if(a.OldMask!=undefined){a.Mask=a.OldMask;a.OldMask=undefined}};PCell.prototype.SearchRangeNode=function(j){var g=/[ \t\n\r]+$/g;var f=RD3_Glb.IsFirefox();var b=j.node.childNodes.length;for(var d=0;d<b;d++){var c=j.node.childNodes[d];var e=(c.nodeType==3?c.nodeValue:(f?c.textContent:c.innerText));e=e.replace(g,"");if(e==""){continue}var h=new Object();h.node=c;h.currPos=j.currPos;var a=this.SearchRangeNode(h);if(a!=null){return a}if(j.currPos<e.length){var a=new Object();a.pos=j.currPos;a.node=c;return a}j.currPos-=e.length}return null};PCell.prototype.RemoveWatermark=function(){if(!this.HasWatermark){return}if(this.ControlType==3||(this.ControlType==101&&RD3_ServerParams.UseIDEditor)){this.Text=this.PValue?this.PValue.Text:"";this.HasWatermark=false;this.IntCtrl.RemoveWatermark();this.IntCtrl.SetText(this.Text,true,false);return}RD3_Glb.RemoveClass(this.IntCtrl,"panel-field-value-watermark");this.Text=this.PValue?this.PValue.Text:"";this.IntCtrl.value=this.Text;this.HasWatermark=false;if((RD3_Glb.IsChrome()||RD3_Glb.IsSafari())){this.MaxLength=this.ParentField.MaxLength;if(this.NumRows==1){if(this.MaxLength<=0){this.IntCtrl.removeAttribute("maxLength")}else{this.IntCtrl.setAttribute("maxLength",this.MaxLength)}}}};PCell.prototype.SetZIndex=function(b){var a=this.ParentField;if(!this.InList||!a.ListList){b.style.zIndex=a.Index}};PCell.prototype.ResizeBLOBImage=function(){if(this.ControlType!=10||!this.SubIntCtrl||(RD3_Glb.IsIE(10,false)&&this.SubIntCtrl&&this.SubIntCtrl.readyState!="complete")){return}var d=this.SubIntCtrl.style;switch(this.ParentField.ImageResizeMode){case 1:if(this.SubCtrlRectW!=-1){d.width="";this.SubCtrlRectW=-1}if(this.SubCtrlRectH!=-1){d.height="";this.SubCtrlRectH=-1}break;case 2:if(this.Text!=this.SubCtrlRectIMG||this.SubCtrlRectW!=this.CtrlRectW||this.SubCtrlRectH!=this.CtrlRectH){this.SubCtrlRectIMG=this.SubIntCtrl.src;d.width="auto";d.height="auto";var g=this.SubIntCtrl.width;var c=this.SubIntCtrl.height;if(RD3_Glb.IsIE()&&(g==0&&c==0)){document.body.appendChild(this.SubIntCtrl);g=this.SubIntCtrl.width;c=this.SubIntCtrl.height;this.IntCtrl.appendChild(this.SubIntCtrl)}if(g&&c&&this.CtrlRectW&&this.CtrlRectH){var a=c/g;var b=(this.CtrlRectW-6)*a;var f=(this.CtrlRectH-6)/a;if(b>this.CtrlRectH){d.width=f+"px";d.height=this.CtrlRectH-6+"px";d.position="absolute";this.SubCtrlRectW=this.CtrlRectW;this.SubCtrlRectH=this.CtrlRectH;if(this.SubCtrlRectL!=(this.CtrlRectW-f)/2){d.left=(this.CtrlRectW-f)/2+"px";this.SubCtrlRectL=(this.CtrlRectW-f)/2}if(this.SubCtrlRectT!=0){d.top="0px";this.SubCtrlRectT=0}}else{d.width=this.CtrlRectW-6+"px";d.height=b+"px";d.position="absolute";this.SubCtrlRectW=this.CtrlRectW;this.SubCtrlRectH=this.CtrlRectH;if(this.SubCtrlRectL!=0){d.left="0px";this.SubCtrlRectL=0}if(this.SubCtrlRectT!=(this.CtrlRectH-b)/2){d.top=(this.CtrlRectH-b)/2+"px";this.SubCtrlRectT=(this.CtrlRectH-b)/2}}}}break;case 3:var e=(RD3_Glb.IsFirefox()?1:0);if(this.SubCtrlRectW!=this.CtrlRectW-6){d.width=this.CtrlRectW-6+"px";this.SubCtrlRectW=this.CtrlRectW-6}if(this.SubCtrlRectH!=this.CtrlRectH-6-e){d.height=this.CtrlRectH-6-e+"px";this.SubCtrlRectH=this.CtrlRectH-6-e}break}};PCell.prototype.SetHilite=function(e){if(this.IntCtrl){var c=this.ParentField;var d=c.ParentPanel;if(d.PanelMode==RD3_Glb.PANEL_LIST&&d.ShowMultipleSel&&c.ListList){var f=this.IntCtrl;if(f instanceof IDCombo){f=f.ComboInput}if(f instanceof IDEditor){f=f.GetDOMObj()}var b=d.MultiSelStatus[this.PValue.Index];if(!b){var a=RD3_Glb.HasClass(f,"panel-field-unselected")?"panel-field-selected":"panel-field-selected-back";RD3_Glb.SetClass(f,a,e)}return}if(this.IntCtrl instanceof IDCombo){if(e){RD3_Glb.AddClass(this.IntCtrl.ComboInput,"cell-hover");this.IntCtrl.ComboActivator.style.backgroundImage="url(images/detailw.png)"}else{RD3_Glb.RemoveClass(this.IntCtrl.ComboInput,"cell-hover");this.IntCtrl.ComboActivator.style.backgroundImage=""}}else{if(this.IntCtrl instanceof IDEditor){}else{if(e){RD3_Glb.AddClass(this.IntCtrl,"cell-hover");if(this.ActObj){this.ActObj.style.setProperty("background-image","url(images/detailw.png)","important")}}else{RD3_Glb.RemoveClass(this.IntCtrl,"cell-hover");if(this.ActObj){this.ActObj.style.backgroundImage=""}}}}}};PCell.prototype.IsUncommitted=function(){var c=this.GetDOMObj();if(c&&!this.HasWatermark&&RD3_KBManager.ActiveElement==c&&(c.tagName=="INPUT"||c.tagName=="TEXTAREA")){var b=this.Text;if(c.tagName=="INPUT"){b=b.replace(/\n/g,"")}b=b.replace(/\r/g,"");var d=c.value;if(RD3_Glb.IsIE(10,false)){d=d.replace(/\r/g,"")}if(this.Mask&&this.Mask!=""&&(b==""&&d!="")){b=GetInitValue(this.Mask,this.MaskType)}if(d!=b){return true}}var a=null;if(window.RD4_Enabled){a=RD3_DesktopManager.MessagePumpRD4.GetEvent(this.PValue,"chg")}else{a=RD3_DesktopManager.MessagePump.GetEvent(this.PValue,"chg")}if(a&&this.ParentField&&this.ParentField.ParentPanel&&this.ParentField.ParentPanel.IsDO){return this.Text===this.PValue.Text}return(a)?true:false};PCell.prototype.OnAdaptRetina=function(a,c,b){if(b&&b=="FORE"&&this.ControlType==30){var d=this.IntCtrl.firstChild.style;d.width=a+"px";d.height=c+"px";d.top="2px";d.left="2px";d.display=""}else{if(this.IntCtrl){this.IntCtrl.style.backgroundSize=a+"px "+c+"px"}this.BackGroundImage=b;if(this.ParentField.ImageResizeMode!=1&&RD3_ServerParams.ShowFieldImageInValue){this.SetBackGroundImageRM(this.ParentField.ImageResizeMode)}}};function PDFPrint(a){this.PDFUrl=a.getAttribute("id");this.Message=a.getAttribute("msg");this.FromPage=parseInt(a.getAttribute("from"));this.ToPage=parseInt(a.getAttribute("to"));this.FitToPaper=a.getAttribute("fit")!="0";this.PrintDialog=a.getAttribute("dlg")=="1";this.IE=RD3_Glb.IsIE(10,false);this.StartPrint=null;this.PDFBox=document.createElement("div");this.PDFBox.className="pdf-object";document.body.appendChild(this.PDFBox);if(this.IE){RD3_DesktopManager.WebEntryPoint.DelayDialog.Open(this.Message,0)}this.PDFBox.innerHTML="<object type='application/pdf' classid='clsid:CA8A9780-280D-11CF-A24D-444553540000' width='0' height='0'><param name='src' value='"+this.PDFUrl+"'></object>";this.PDFObj=this.PDFBox.childNodes[0]}PDFPrint.prototype.Tick=function(){if(this.StartPrint==null){if(this.PDFObj.readyState==4){this.StartPrint=new Date();if(this.PrintDialog){this.PDFObj.printWithDialog()}else{if(this.FromPage>0&&this.ToPage>0){this.PDFObj.printPagesFit(this.FromPage,this.ToPage,this.FitToPaper)}else{this.PDFObj.printAllFit(this.FitToPaper)}}if(this.IE){RD3_DesktopManager.WebEntryPoint.DelayDialog.Close()}var b=new IDEvent("pdfprint",this.PDFUrl,null,RD3_Glb.EVENT_SERVERSIDE|RD3_Glb.EVENT_IMMEDIATE)}}else{var a=new Date();if(a-this.StartPrint>20000){this.PDFBox.parentNode.removeChild(this.PDFBox);return true}}return false};function PField(a){this.Identifier=null;this.Index=0;this.Visible=true;this.Enabled=true;this.VisualStyle=0;this.ListList=true;this.CanActivate=false;this.HasValueSource=false;this.AutoLookup=false;this.ActWidth=RD3_ClientParams.ActivatorWidth;this.ActImage="";this.LKE=false;this.Optional=true;this.IsPK=false;this.DBCode="";this.ActivableDisabled=false;this.CauseValidation=true;this.Image="";this.ImageResizeMode=1;this.Header="";this.Tooltip="";this.Page=0;this.Group=null;this.DataType=0;this.MaxLength=255;this.Scale=0;this.SortMode=0;this.IdxPanel=0;this.SubFrame=null;this.ValueList=null;this.EditorType=0;this.Command=null;this.CanSort=true;this.QBEEnabled=true;this.SuperActive=false;this.Unbound=false;this.ComboMultiSel=true;this.ComboValueSep=";";this.BackColor="";this.ForeColor="";this.FontMod="";this.Mask="";this.Alignment=-1;this.Badge="";this.FontList;this.ColorList;this.TokenList;this.ShowEditorTool=true;this.EdToolCommands=-1;this.DefaultFormatting="";this.InList=true;this.ListHeader="";this.HdrList=true;this.HdrListAbove=false;this.ListLeft=0;this.ListTop=0;this.ListWidth=0;this.ListHeight=0;this.ListNumRows=1;this.ListHResMode=1;this.ListVResMode=1;this.ListHeaderSize=0;this.ListTabOrder=-1;this.InForm=true;this.FormHeader="";this.HdrForm=true;this.HdrFormAbove=false;this.FormLeft=0;this.FormTop=0;this.FormWidth=0;this.FormHeight=0;this.FormNumRows=1;this.FormHResMode=1;this.FormVResMode=1;this.FormHeaderSize=0;this.FormTabOrder=-1;this.UseHL=false;this.VisualFlags=-1;this.UseTextSel=false;this.WaterMark="";this.ClassName;this.ClassHeader;this.PValues=new Array();this.PListCells=null;this.PFormCell=null;this.FCKTimerID=0;this.ParentPanel=a;this.ConfirmBox=null;this.ClickEventDef=RD3_Glb.EVENT_ACTIVE;this.ChangeEventDef=RD3_Glb.EVENT_DEFERRED;this.Realized=false;this.Realizing=false;this.FormCaptionBox=null;this.ListCaptionBox=null;this.ListBox=null;this.SortImage=null;this.ListBlobUploadImg=null;this.ListBlobDeleteImg=null;this.ListBlobZoomImg=null;this.ListFlashUploader=null;this.FormBlobUploadImg=null;this.FormBlobDeleteImg=null;this.FormBlobZoomImg=null;this.FormFlashUploader=null;this.ListResizeSkipped=false;this.FormResizeSkipped=false;this.ListDeltaH=0;this.ListDeltaW=0;this.FormDeltaH=0;this.FormDeltaW=0;this.MaxUploadSize=10*1024*1024;this.MaxUploadFiles=0;this.UploadExtensions="*.*";this.UploadDescription="";this.MultiUpload=false;this.FileUploading=null;this.UploadAll=false;this.MsgFileNotQueued="";this.FileList=null;this.MUPHeader=null;this.SelectFilesImg=null;this.UploadAllImgImg=null;this.RemoveAllImg=null;this.AbortAllImg=null;this.AggregateOfField=-1}PField.prototype.LoadFromXml=function(e){this.LoadProperties(e);var k=e.childNodes;var c=k.length;for(var g=0;g<c;g++){var f=k.item(g);var b=f.nodeName;switch(b){case"val":var a=new PValue(this);a.LoadFromXml(f);if(this.ParentPanel.IsGrouped()){this.PValues[this.ParentPanel.ListGroupRoot.GetPValOffset(a.Index)+a.Index]=a}else{this.PValues[a.Index]=a}break;case"vls":if(f.getAttribute("del")=="1"){this.ValueList=null}else{this.ValueList=new ValueList();this.ValueList.LoadFromXml(f)}if(this.Realized){this.SetActualPosition(this.ParentPanel.ActualPosition)}break;case"cls":if(f.getAttribute("del")=="1"){this.ColorList=null}else{this.ColorList=new Array();var l=f.attributes;var j=l.length;if(RD3_Glb.IsIE()){for(var d=j-1;d>=0;d--){var h=l.item(d);this.ColorList.push(h.nodeValue)}}else{for(var d=0;d<j;d++){var h=l.item(d);this.ColorList.push(h.nodeValue)}}}if(this.Realized){this.SetActualPosition(this.ParentPanel.ActualPosition)}break;case"tks":if(f.getAttribute("del")=="1"){this.TokenList=null}else{this.TokenList=new ValueList();this.TokenList.LoadFromXml(f)}if(this.Realized){this.SetActualPosition(this.ParentPanel.ActualPosition)}break;case"fls":if(f.getAttribute("del")=="1"){this.FontList=null}else{this.FontList=new ValueList();this.FontList.LoadFromXml(f)}if(this.Realized){this.SetActualPosition(this.ParentPanel.ActualPosition)}break}}};PField.prototype.ChangeProperties=function(a){this.LoadFromXml(a)};PField.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"idx":this.SetIndex(parseInt(a));break;case"vis":this.SetVisible(a=="1");break;case"ena":this.SetEnabled(a=="1");break;case"sty":this.SetVisualStyle(parseInt(a));break;case"lli":this.SetListList(a=="1");break;case"act":this.SetCanActivate(a=="1");break;case"aci":this.SetActivatorImage(a);break;case"acw":this.SetActivatorWidth(parseInt(a));break;case"opt":this.SetOptional(parseInt(a));break;case"lke":this.SetLKE(a=="1");break;case"img":this.SetImage(a);break;case"irm":this.SetImageResizeMode(parseInt(a));break;case"hdr":this.SetHeader(a);break;case"tip":this.SetTooltip(a);break;case"pag":this.SetPage(parseInt(a));break;case"gru":this.SetGroup(a);break;case"dat":this.SetDataType(parseInt(a));break;case"max":this.SetMaxLength(parseInt(a));break;case"smo":this.SetSortMode(parseInt(a));break;case"inl":this.SetInList(a=="1");break;case"lih":this.SetListHeader(a);break;case"hdl":this.SetHdrList(a=="1");break;case"hla":this.SetHdrListAbove(a=="1");break;case"lle":this.SetListLeft(parseInt(a));break;case"lto":this.SetListTop(parseInt(a));break;case"lwi":this.SetListWidth(parseInt(a),true);break;case"lhe":this.SetListHeight(parseInt(a),true);break;case"lnr":this.SetListNumRows(parseInt(a));break;case"lhr":this.SetListHResMode(parseInt(a));break;case"lvr":this.SetListVResMode(parseInt(a));break;case"lhs":this.SetListHeaderSize(parseInt(a));break;case"lta":this.SetListTabOrder(parseInt(a));break;case"inf":this.SetInForm(a=="1");break;case"foh":this.SetFormHeader(a);break;case"hdf":this.SetHdrForm(a=="1");break;case"hfa":this.SetHdrFormAbove(a=="1");break;case"fle":this.SetFormLeft(parseInt(a));break;case"fto":this.SetFormTop(parseInt(a));break;case"fwi":this.SetFormWidth(parseInt(a),true);break;case"fhe":this.SetFormHeight(parseInt(a),true);break;case"fnr":this.SetFormNumRows(parseInt(a));break;case"fhr":this.SetFormHResMode(parseInt(a));break;case"fvr":this.SetFormVResMode(parseInt(a));break;case"fhs":this.SetFormHeaderSize(parseInt(a));break;case"fta":this.SetFormTabOrder(parseInt(a));break;case"idp":this.SetIdxPanel(parseInt(a));break;case"sub":this.SetSubFrame(a);break;case"qvs":this.SetHasValueSource(a=="1");break;case"alo":this.SetAutoLookup(a=="1");break;case"edi":this.SetEditorType(parseInt(a));break;case"fsc":this.SetScale(parseInt(a));break;case"cmd":this.SetCommand(a);break;case"cva":this.SetCauseValidation(a=="1");break;case"acd":this.SetActivableDisabled(a=="1");break;case"srt":this.SetFieldCanSort(a=="1");break;case"qen":this.SetQBEEnabled(a=="1");break;case"sac":this.SetSuperActive(a=="1");break;case"uhl":this.SetUseHL(a=="1");break;case"mup":this.SetMultiUpload(a=="1");break;case"mus":this.SetMaxUploadSize(parseInt(a));break;case"muf":this.SetMaxUploadFiles(parseInt(a));break;case"uex":this.SetUploadExtensions(a);break;case"uds":this.SetUploadDescription(a);break;case"vfl":this.SetVisualFlags(parseInt(a));break;case"unb":this.SetUnbound(a=="1");break;case"cms":this.SetComboMultiSel(a=="1");break;case"cvs":this.SetComboValueSep(a);break;case"uts":this.SetUseTextSel(a=="1");break;case"bkc":this.SetBackColor(a);break;case"frc":this.SetForeColor(a);break;case"msk":this.SetMask(a);break;case"ftm":this.SetFontMod(a);break;case"aln":this.SetAlignment(parseInt(a));break;case"wtm":this.SetWaterMark(a);break;case"ocb":this.DoOpenCombo=(a=="1");break;case"ipk":this.SetIsPK(a=="1");break;case"dbc":this.SetDBCode(a);break;case"bdg":this.SetBadge(a);break;case"uet":this.SetShowEditorTool(a=="1");break;case"itc":this.SetEditorCommands(parseInt(a));break;case"def":this.SetDefaultFormatting(a);break;case"cln":this.SetClassName(a);break;case"aof":this.SetAggregateOfField(parseInt(a));break;case"clk":this.ClickEventDef=parseInt(a);break;case"chg":this.ChangeEventDef=parseInt(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};PField.prototype.SetIndex=function(a){if(a!=undefined){this.Index=a}};PField.prototype.SetFieldCanSort=function(a){if(a!=undefined){this.CanSort=a}};PField.prototype.SetQBEEnabled=function(b){var a=this.QBEEnabled;if(b!=undefined){this.QBEEnabled=b}if(this.Realized&&this.ParentPanel.Status==RD3_Glb.PS_QBE&&a!=this.QBEEnabled){if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST){this.PListCells[0].SetQBEEnabled(this.QBEEnabled)}else{this.PFormCell.SetQBEEnabled(this.QBEEnabled)}}};PField.prototype.SetSuperActive=function(a){if(a!=undefined){this.SuperActive=a}};PField.prototype.SetUseHL=function(a){if(a!=undefined){this.UseHL=a}};PField.prototype.SetMultiUpload=function(a){if(a!=undefined){this.MultiUpload=a&&(RD3_Glb.IsFlashPresent()||(RD3_ServerParams.UseHTML5Upload&&typeof FileReader!="undefined")||RD3_Glb.IsTouch())}};PField.prototype.SetMaxUploadSize=function(a){if(a!=undefined){this.MaxUploadSize=a}};PField.prototype.SetMaxUploadFiles=function(a){if(a!=undefined){this.MaxUploadFiles=a}};PField.prototype.SetUploadExtensions=function(a){if(a!=undefined){if(RD3_ServerParams.UseHTML5Upload&&typeof FileReader!="undefined"&&a!="*.*"){this.UploadExtensions=a.replace(/\*/g,"");this.UploadExtensions=this.UploadExtensions.replace(/;/g,",")}else{this.UploadExtensions=a}}};PField.prototype.SetUploadDescription=function(a){if(a!=undefined){this.UploadDescription=a}};PField.prototype.SetVisualFlags=function(b){var a=this.VisualFlags;if(b!=undefined){this.VisualFlags=b}if(a!=this.VisualFlags&&this.Realized){this.SetCanSort();if(this.IsStatic()){this.UpdateVisualStyle(this.VisualStyle)}else{this.ParentPanel.ResetPosition=true}}};PField.prototype.SetVisible=function(c){var b=this.Visible;if(c!=undefined){this.Visible=c}if(this.Realized){this.UpdateFieldVisibility();if(b!=this.Visible&&!this.Realizing){var a=this.FirstListFld;this.SetActualPosition();if((a||this.FirstListFld)&&this.ParentPanel.IsGrouped()){this.ParentPanel.ResetPosition=true}this.ParentPanel.RecalcLayout=true;this.ParentPanel.ResVisFld=true;if(this.ParentPanel.ResOnlyVisFlds){this.UpdFldVs=true}}}};PField.prototype.SetEnabled=function(c){var a=this.Enabled;if(c!=undefined){this.Enabled=c}if(this.Realized){if((a!=this.Enabled||c==undefined)&&!this.Realizing){this.SetActualPosition()}if(this.IsStatic()){var b=(this.IsEnabled()||this.ActivableDisabled)&&this.VisHyperLink(this.VisualStyle);if(this.ListCaptionBox){this.ListCaptionBox.style.cursor=b?"pointer":""}if(this.FormCaptionBox){this.FormCaptionBox.style.cursor=b?"pointer":""}if(this.IsButton()){if(this.ListCaptionBox){this.ListCaptionBox.disabled=!b}if(this.FormCaptionBox){this.FormCaptionBox.disabled=!b}}}}};PField.prototype.SetEditorType=function(a){if(a!=undefined){this.EditorType=a}};PField.prototype.SetScale=function(a){if(a!=undefined){this.Scale=a}};PField.prototype.SetCommand=function(a){if(a!=undefined){this.Command=RD3_DesktopManager.ObjectMap[a]}};PField.prototype.SetVisualStyle=function(b){var a=this.VisualStyle;if(b!=undefined){if(b.Identifier){this.VisualStyle=b}else{this.VisualStyle=RD3_DesktopManager.ObjectMap["vis:"+b]}}if(this.Realized){if(this.VisualStyle){if(this.IsStatic()){this.SetEnabled()}this.UpdateVisualStyle(this.VisualStyle);if(this.SubFrame||this.MultiUpload){if(this.ListCaptionBox){this.ListCaptionBox.style.padding="0px"}if(this.FormCaptionBox){this.FormCaptionBox.style.padding="0px"}}if(((a!=this.VisualStyle)||b==undefined)&&this.ParentPanel.Realized){this.ParentPanel.ResetPosition=true}}}};PField.prototype.SetListList=function(a){if(a!=undefined){this.ListList=a}};PField.prototype.SetListTabOrder=function(a){if(a!=undefined){this.ListTabOrder=a}};PField.prototype.SetFormTabOrder=function(a){if(a!=undefined){this.FormTabOrder=a}};PField.prototype.SetCanActivate=function(a){if(a!=undefined){this.CanActivate=a}};PField.prototype.SetHasValueSource=function(a){if(a!=undefined){this.HasValueSource=a}};PField.prototype.SetAutoLookup=function(a){if(a!=undefined){this.AutoLookup=a}};PField.prototype.SetActivatorImage=function(b){var a=this.ActImage;if(b!=undefined){this.ActImage=b}if(this.Realized&&a!=this.ActImage){this.ParentPanel.ResetPosition=true}};PField.prototype.SetActivatorWidth=function(b){var a=this.ActWidth;if(b!=undefined){this.ActWidth=b}if(this.Realized&&a!=this.ActWidth){this.ParentPanel.ResetPosition=true}};PField.prototype.SetOptional=function(a){if(a!=undefined){this.Optional=a}};PField.prototype.SetLKE=function(a){if(a!=undefined){this.LKE=a}};PField.prototype.SetCauseValidation=function(a){if(a!=undefined){this.CauseValidation=a}if(this.Realized){this.ParentPanel.ResetPosition=true}};PField.prototype.SetActivableDisabled=function(a){if(a!=undefined){this.ActivableDisabled=a}if(this.Realized){this.ParentPanel.ResetPosition=true}};PField.prototype.SetImage=function(d){var a=this.Image;if(d!=undefined){this.Image=d}if(this.Realized&&(a!=this.Image||(d==undefined&&this.Image!=""))){if(!RD3_ServerParams.ShowFieldImageInValue||this.IsStatic()){if(this.FormCaptionBox){this.ApplyBackgroundImage(this.FormCaptionBox.style)}if(this.ListCaptionBox){this.ApplyBackgroundImage(this.ListCaptionBox.style)}}if(RD3_ServerParams.ShowFieldImageInValue){if(this.PFormCell){if(this.Image!=""){var b=this.Image;if(!RD3_Glb.IsAbsoluteUrl(this.Image)){b=RD3_Glb.GetAbsolutePath()+"images/"+this.Image}this.PFormCell.SetBackGroundImage("url("+encodeURI(b)+")")}else{this.PFormCell.SetBackGroundImage("")}}if(this.PListCells&&!this.DelayedUpdate){var e=this.PListCells.length;for(var c=0;c<e;c++){if(this.Image!=""){var b=this.Image;if(!RD3_Glb.IsAbsoluteUrl(this.Image)){b=RD3_Glb.GetAbsolutePath()+"images/"+this.Image}this.PListCells[c].SetBackGroundImage("url("+encodeURI(b)+")")}else{this.PListCells[c].SetBackGroundImage("")}}}}}};PField.prototype.SetImageResizeMode=function(f){var d=this.ImageResizeMode;if(f!=undefined){this.ImageResizeMode=f}if(this.Realized&&(d!=this.ImageResizeMode||f==undefined)){if(!RD3_ServerParams.ShowFieldImageInValue||this.IsStatic()){var h="";var b="";var g="";var a="background-size";if(RD3_Glb.IsFirefox(3)){a="-moz-background-size"}if(RD3_Glb.IsSafari()){a="-webkit-background-size"}switch(this.ImageResizeMode){case 1:h="repeat";break;case 2:h="no-repeat";if(!this.UseHL){b="center center"}break;case 3:g="100% 100%";break}if(this.FormCaptionBox){var j=this.FormCaptionBox.style;j.backgroundRepeat=h;j.backgroundPosition=b;if(RD3_Glb.IsIE(10,false)||!j.setProperty){this.ApplyBackgroundImage(j)}else{j.setProperty(a,g,null)}if(this.ImageResizeMode!=3&&RD3_Glb.Adapt4Retina(this.Identifier,this.Image,this.FormHeight,1)){j.backgroundSize="0px 0px"}}if(this.ListCaptionBox){var j=this.ListCaptionBox.style;j.backgroundRepeat=h;j.backgroundPosition=b;if(RD3_Glb.IsIE(10,false)||!j.setProperty){this.ApplyBackgroundImage(j)}else{j.setProperty(a,g,null)}if(this.ImageResizeMode!=3&&RD3_Glb.Adapt4Retina(this.Identifier,this.Image,this.ListHeight,2)){j.backgroundSize="0px 0px"}}}if(RD3_ServerParams.ShowFieldImageInValue){if(this.PFormCell){this.PFormCell.SetBackGroundImageRM(this.ImageResizeMode)}if(this.PListCells&&!this.DelayedUpdate){var c=this.PListCells.length;for(var e=0;e<c;e++){this.PListCells[e].SetBackGroundImageRM(this.ImageResizeMode)}}}}};PField.prototype.ApplyBackgroundImage=function(b,a){if(a==undefined){a=""}else{if(a!=""){if(this.Image!=""){a=", "+a}}}var c=this.Image;if(!RD3_Glb.IsAbsoluteUrl(this.Image)){c=RD3_Glb.GetAbsolutePath()+"images/"+this.Image}c=encodeURI(c);if(this.ImageResizeMode==3&&this.Image!=""){if(RD3_Glb.IsIE(10,false)){b.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"', sizingMethod='scale')";b.backgroundImage=""}else{b.backgroundImage="url("+c+")"+a}}else{if(RD3_Glb.IsIE(10,false)){var d="progid:DXImageTransform.Microsoft.AlphaImageLoader";if(b.filter.substring(0,d.length)==d){b.removeAttribute("filter")}}b.backgroundImage=(this.Image!=""?"url("+c+")":"")+a}};PField.prototype.SetHeader=function(b){if(b!=undefined){this.Header=b}if(this.Realized&&!this.SubFrame&&(!this.Realizing||this.IsStatic())){if(this.MultiUpload){if(RD3_Glb.IsIE(10,false)){this.MUPHeader.innerText=this.Header}else{this.MUPHeader.textContent=this.Header}return}var a=((this.FormHeader==""&&this.Header!="")||this.IsStatic())?this.Header:this.FormHeader;if(this.FormCaptionBox){if(this.IsStatic()){this.RunJScript(a)}if(this.IsButton()){this.FormCaptionBox.value=a}else{if(RD3_ServerParams.Theme=="zen"){this.FormCaptionBox.innerHTML="<span>"+a+"</span>"}else{this.FormCaptionBox.innerHTML=a}}if(this.FormBlobUploadImg){this.FormCaptionBox.appendChild(this.FormBlobUploadImg);this.FormCaptionBox.appendChild(this.FormBlobDeleteImg);this.FormCaptionBox.appendChild(this.FormBlobZoomImg);if(this.UseHTML5ForUpload()&&this.FormFlashUploader){this.FormCaptionBox.appendChild(this.FormFlashUploader)}}}a=((this.ListHeader==""&&this.Header!="")||this.IsStatic())?this.Header:this.ListHeader;if(this.ListCaptionBox){if(this.SortImage){this.SortImage.parentNode.removeChild(this.SortImage)}if(this.IsStatic()){this.RunJScript(a)}if(this.IsButton()){this.ListCaptionBox.value=a}else{if(RD3_ServerParams.Theme=="zen"){this.ListCaptionBox.innerHTML="<span>"+a+"</span>"}else{this.ListCaptionBox.innerHTML=a}}if(this.SortImage){this.ListCaptionBox.appendChild(this.SortImage)}}}};PField.prototype.SetTooltip=function(a){if(a!=undefined){this.Tooltip=a}if(this.Realized){if(this.FormCaptionBox){RD3_TooltipManager.SetObjTitle(this.FormCaptionBox,this.Tooltip)}if(this.ListCaptionBox){RD3_TooltipManager.SetObjTitle(this.ListCaptionBox,this.Tooltip)}}};PField.prototype.SetPage=function(a){if(a!=undefined){this.Page=a}};PField.prototype.SetGroup=function(b){if(b!=undefined){if(b.Identifier){this.Group=b}else{var a=RD3_DesktopManager.ObjectMap[b];if(a){this.Group=a}else{this.Group=b}}}};PField.prototype.SetDataType=function(g){if(g!=undefined){this.DataType=g}if(this.Realized){var b=this;if(this.DataType==10&&this.ListBlobUploadImg==null&&this.FormBlobUploadImg==null){var e=RD3_Glb.IsMobile();var f="";if(RD3_Glb.IsTouch()){var d=window.location.href;d+="?WCI=IWUpload";d+="&WCE="+this.Identifier;d+="&SESSIONID="+RD3_DesktopManager.WebEntryPoint.SessionID;var c=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+"uploadcomplete.htm";f="fileupload://new?returnstatus=false";f+="&posturl="+encodeURIComponent(d);f+="&callbackurl="+encodeURIComponent(c);f+="&purpose="+encodeURIComponent("Scegli una foto da caricare");f+="&referrerName="+encodeURIComponent(RD3_DesktopManager.WebEntryPoint.MainCaption)}if(this.ListCaptionBox){if(RD3_Glb.IsTouch()){this.ListBlobUploadImg=document.createElement("a");this.ListBlobUploadImg.href=f;this.ListBlobUploadImg.className="panel-blob-fileupload"}else{if(this.UseHTML5ForUpload()){this.ListFlashUploader=this.CreateHTML5Uploader(true);this.ListBlobUploadImg=document.createElement("img");this.ListBlobUploadImg.onclick=function(i){b.OnBlobCommand(i,"upload:list")};if(!e){this.ListBlobUploadImg.src=RD3_Glb.GetImgSrc("images/upload.gif")}this.ListBlobUploadImg.className="panel-blob-button";var a=function(i){b.OnHTML5Drop(i)};var h=function(i){b.OnHTML5Drag(i)};this.ListCaptionBox.ondrop=a;this.ListCaptionBox.ondragover=h}else{if(this.UseFlashForUpload()){this.ListFlashUploader=this.CreateFlashUploader();this.ListBlobUploadImg=this.ListFlashUploader.getMovieElement();if(!e){this.ListBlobUploadImg.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/upload.gif)"}this.ListBlobUploadImg.className="panel-blob-button"}else{this.ListBlobUploadImg=document.createElement("img");this.ListBlobUploadImg.onclick=function(i){b.OnBlobCommand(i,"upload"+b.Index)};if(!e){this.ListBlobUploadImg.src=RD3_Glb.GetImgSrc("images/upload.gif")}this.ListBlobUploadImg.className="panel-blob-button"}}}RD3_TooltipManager.SetObjTitle(this.ListBlobUploadImg,RD3_ServerParams.CaricaDoc);this.ListCaptionBox.appendChild(this.ListBlobUploadImg);if(this.UseHTML5ForUpload()&&!RD3_Glb.IsTouch()){this.ListCaptionBox.appendChild(this.ListFlashUploader)}this.ListBlobDeleteImg=document.createElement("img");this.ListBlobDeleteImg.className="panel-blob-button";this.ListBlobDeleteImg.onclick=function(i){b.OnBlobCommand(i,"delblob"+b.Index)};RD3_TooltipManager.SetObjTitle(this.ListBlobDeleteImg,RD3_ServerParams.CancellaDoc);if(!e){this.ListBlobDeleteImg.src=RD3_Glb.GetImgSrc("images/delbl.gif")}this.ListCaptionBox.appendChild(this.ListBlobDeleteImg);this.ListBlobZoomImg=document.createElement("img");this.ListBlobZoomImg.className="panel-blob-button";this.ListBlobZoomImg.onclick=function(i){b.OnBlobCommand(i,"zoom")};RD3_TooltipManager.SetObjTitle(this.ListBlobZoomImg,RD3_ServerParams.VisualizzaDocumento);if(!e){this.ListBlobZoomImg.src=RD3_Glb.GetImgSrc("images/zoom.gif")}this.ListCaptionBox.appendChild(this.ListBlobZoomImg)}if(this.FormCaptionBox){if(RD3_Glb.IsTouch()){this.FormBlobUploadImg=document.createElement("a");this.FormBlobUploadImg.href=f;this.FormBlobUploadImg.className="panel-blob-fileupload"}else{if(this.UseHTML5ForUpload()){this.FormFlashUploader=this.CreateHTML5Uploader(false);this.FormBlobUploadImg=document.createElement("img");this.FormBlobUploadImg.onclick=function(i){b.OnBlobCommand(i,"upload:form")};if(!e){this.FormBlobUploadImg.src=RD3_Glb.GetImgSrc("images/upload.gif")}this.FormBlobUploadImg.className="panel-blob-button";var a=function(i){b.OnHTML5Drop(i)};var h=function(i){b.OnHTML5Drag(i)};this.FormCaptionBox.ondrop=a;this.FormCaptionBox.ondragover=h}else{if(this.UseFlashForUpload()){this.FormFlashUploader=this.CreateFlashUploader();this.FormBlobUploadImg=this.FormFlashUploader.getMovieElement();if(!e){this.FormBlobUploadImg.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/upload.gif)"}this.FormBlobUploadImg.className="panel-blob-button"}else{this.FormBlobUploadImg=document.createElement("img");this.FormBlobUploadImg.onclick=function(i){b.OnBlobCommand(i,"upload"+b.Index)};if(!e){this.FormBlobUploadImg.src=RD3_Glb.GetImgSrc("images/upload.gif")}this.FormBlobUploadImg.className="panel-blob-button"}}}RD3_TooltipManager.SetObjTitle(this.FormBlobUploadImg,RD3_ServerParams.CaricaDoc);this.FormCaptionBox.appendChild(this.FormBlobUploadImg);if(this.UseHTML5ForUpload()&&!RD3_Glb.IsTouch()){this.FormCaptionBox.appendChild(this.FormFlashUploader)}this.FormBlobDeleteImg=document.createElement("img");this.FormBlobDeleteImg.className="panel-blob-button";this.FormBlobDeleteImg.onclick=function(i){b.OnBlobCommand(i,"delblob"+b.Index)};RD3_TooltipManager.SetObjTitle(this.FormBlobDeleteImg,RD3_ServerParams.CancellaDoc);if(!e){this.FormBlobDeleteImg.src=RD3_Glb.GetImgSrc("images/delbl.gif")}this.FormCaptionBox.appendChild(this.FormBlobDeleteImg);this.FormBlobZoomImg=document.createElement("img");this.FormBlobZoomImg.className="panel-blob-button";this.FormBlobZoomImg.onclick=function(i){b.OnBlobCommand(i,"zoom")};RD3_TooltipManager.SetObjTitle(this.FormBlobZoomImg,RD3_ServerParams.VisualizzaDocumento);if(!e){this.FormBlobZoomImg.src=RD3_Glb.GetImgSrc("images/zoom.gif")}this.FormCaptionBox.appendChild(this.FormBlobZoomImg)}}if(this.DataType!=10){if(this.ListBlobUploadImg!=null){this.ListBlobUploadImg.parentNode.removeChild(this.ListBlobUploadImg);this.ListBlobDeleteImg.parentNode.removeChild(this.ListBlobDeleteImg);this.ListBlobZoomImg.parentNode.removeChild(this.ListBlobZoomImg);this.ListBlobUploadImg=null;this.ListBlobDeleteImg=null;this.ListBlobZoomImg=null}if(this.FormBlobUploadImg!=null){this.FormBlobUploadImg.parentNode.removeChild(this.FormBlobUploadImg);this.FormBlobDeleteImg.parentNode.removeChild(this.FormBlobDeleteImg);this.FormBlobZoomImg.parentNode.removeChild(this.FormBlobZoomImg);this.FormBlobUploadImg=null;this.FormBlobDeleteImg=null;this.FormBlobZoomImg=null}}}};PField.prototype.SetMaxLength=function(a){if(a!=undefined){this.MaxLength=a}};PField.prototype.SetSortMode=function(c){if(this.Realizing){return}if(c!=undefined){this.SortMode=c}if(this.Realized&&this.SortImage){var a="sortno";switch(this.SortMode){case 1:a="sortdn";break;case -1:a="sortup";break}a+=RD3_Glb.IsMobile()?".png":".gif";var b=this.SortImage.src;if((RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro())&&!RD3_Glb.IsIE()&&!RD3_Glb.IsEdge()){this.SortImage.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/"+a)+"')"}else{this.SortImage.src=RD3_Glb.GetImgSrc("images/"+a)}if(this.SortImage.src!=b){this.ParentPanel.AdaptFieldsSortImage=true}}};PField.prototype.AdaptSortImage=function(){if(!this.Realized||!this.SortImage){return}if(this.SortMode==1||this.SortMode==-1||RD3_ServerParams.Theme=="simplicity"){var c=this.VisualStyle.GetAlignment(2);if(c==1){c=(RD3_Glb.IsNumericObject(this.DataType))?4:2}if(c!=4){c=2}var b=(c==2?this.ListCaptionBox.clientWidth-this.SortImage.offsetWidth:0);var d=this.ListCaptionBox.clientHeight-this.SortImage.offsetHeight;this.SortImage.style.left=b+"px";this.SortImage.style.top=d+"px"}};PField.prototype.SetInList=function(a){if(a!=undefined){this.InList=a}};PField.prototype.SetListHeader=function(b){if(b!=undefined){this.ListHeader=b}if(this.Realized&&!this.SubFrame){if(this.ListCaptionBox&&!this.IsStatic()){var a=(this.ListHeader==""&&this.Header!="")?this.Header:this.ListHeader;if(this.SortImage){this.SortImage.parentNode.removeChild(this.SortImage)}if(RD3_ServerParams.Theme=="zen"){this.ListCaptionBox.innerHTML="<span>"+a+"</span>"}else{this.ListCaptionBox.innerHTML=a}if(this.SortImage){this.ListCaptionBox.appendChild(this.SortImage)}if(this.ListBlobUploadImg){this.ListCaptionBox.appendChild(this.ListBlobUploadImg);this.ListCaptionBox.appendChild(this.ListBlobDeleteImg);this.ListCaptionBox.appendChild(this.ListBlobZoomImg);if(this.UseHTML5ForUpload()&&this.ListFlashUploader){this.ListCaptionBox.appendChild(this.ListFlashUploader)}}}}};PField.prototype.SetHdrList=function(a){if(a!=undefined){this.HdrList=a}if(this.Realized){this.SetListPosition()}};PField.prototype.SetHdrListAbove=function(a){if(a!=undefined){this.HdrListAbove=a}if(this.Realized){this.SetListPosition()}};PField.prototype.SetListLeft=function(a){if(a!=undefined){this.ListLeft=a}if(this.Realized){this.SetListPosition()}};PField.prototype.SetListTop=function(a){if(a!=undefined){this.ListTop=a}if(this.Realized){this.SetListPosition()}};PField.prototype.SetListWidth=function(c,b){var a=this.ListWidth;if(c!=undefined){this.ListWidth=c}if(b){this.OrgListWidth=this.ListWidth}if(this.Realized){this.SetListPosition();if(a!=this.ListWidth){this.ParentPanel.ResetPosition=true;this.ParentPanel.DenyScroll=true;this.ParentPanel.AdaptFieldsSortImage=true}}};PField.prototype.SetListHeight=function(c,b){var a=this.ListHeight;if(c!=undefined){this.ListHeight=c}if(b){this.OrgListHeight=this.ListHeight}if(this.Realized){this.SetListPosition();if(a!=this.ListHeight){this.ParentPanel.ResetPosition=true;this.ParentPanel.DenyScroll=true}}};PField.prototype.SetListHeaderSize=function(a){if(a!=undefined){this.ListHeaderSize=a}if(this.Realized){this.SetListPosition()}};PField.prototype.SetListNumRows=function(a){if(a!=undefined){this.ListNumRows=a}};PField.prototype.SetListHResMode=function(a){if(a!=undefined){this.ListHResMode=a}};PField.prototype.SetListVResMode=function(a){if(a!=undefined){this.ListVResMode=a}};PField.prototype.SetInForm=function(a){if(a!=undefined){this.InForm=a}};PField.prototype.SetFormHeader=function(b){if(b!=undefined){this.FormHeader=b}if(this.Realized&&!this.SubFrame){if(this.FormCaptionBox&&!this.IsStatic()){var a=(this.FormHeader==""&&this.Header!="")?this.Header:this.FormHeader;if(RD3_ServerParams.Theme=="zen"){this.FormCaptionBox.innerHTML="<span>"+a+"</span>"}else{this.FormCaptionBox.innerHTML=a}this.AdjustHeaderSize();if(this.FormBlobUploadImg){this.FormCaptionBox.appendChild(this.FormBlobUploadImg);this.FormCaptionBox.appendChild(this.FormBlobDeleteImg);this.FormCaptionBox.appendChild(this.FormBlobZoomImg);if(this.UseHTML5ForUpload()&&this.FormFlashUploader){this.FormCaptionBox.appendChild(this.FormFlashUploader)}}}}};PField.prototype.SetHdrForm=function(a){if(a!=undefined){this.HdrForm=a}if(this.Realized){this.SetFormPosition()}};PField.prototype.SetHdrFormAbove=function(a){if(a!=undefined){this.HdrFormAbove=a}if(this.Realized){this.SetFormPosition()}};PField.prototype.SetFormLeft=function(a){if(a!=undefined){this.FormLeft=a}if(this.Realized){this.SetFormPosition()}};PField.prototype.SetFormTop=function(a){if(a!=undefined){this.FormTop=a}if(this.Realized){this.SetFormPosition()}};PField.prototype.SetFormWidth=function(c,b){var a=this.FormWidth;if(c!=undefined){this.FormWidth=c}if(b){this.OrgFormWidth=this.FormWidth}if(this.Realized){this.SetFormPosition();if(a!=this.FormWidth){this.ParentPanel.ResetPosition=true;this.ParentPanel.DenyScroll=true}}};PField.prototype.SetFormHeight=function(c,b){var a=this.FormHeight;if(c!=undefined){this.FormHeight=c}if(b){this.OrgFormHeight=this.FormHeight}if(this.Realized){this.SetFormPosition();if(a!=this.FormHeight){this.ParentPanel.ResetPosition=true;this.ParentPanel.DenyScroll=true}}};PField.prototype.SetFormHeaderSize=function(a){if(a!=undefined){this.FormHeaderSize=a}if(this.Realized){this.SetFormPosition();this.AdjustHeaderSize()}};PField.prototype.AdjustHeaderSize=function(){if(this.FormCaptionBox&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&RD3_Glb.IsMobile()){this.FormCaptionBox.style.lineHeight="";var a=true;if(RD3_Glb.IsChrome()&&!RD3_Glb.IsTouch()&&RD3_Glb.HasClass(this.FormCaptionBox,"last-group-field")&&this.FormCaptionBox.scrollHeight-this.FormCaptionBox.offsetHeight==1){a=false}if(this.FormCaptionBox.scrollHeight>this.FormCaptionBox.offsetHeight&&a){this.FormCaptionBox.style.setProperty("line-height","100%","important")}else{this.FormCaptionBox.style.setProperty("line-height","","")}}};PField.prototype.SetFormNumRows=function(a){if(a!=undefined){this.FormNumRows=a}};PField.prototype.SetFormHResMode=function(a){if(a!=undefined){this.FormHResMode=a}};PField.prototype.SetFormVResMode=function(a){if(a!=undefined){this.FormVResMode=a}};PField.prototype.SetIdxPanel=function(a){if(a!=undefined){this.IdxPanel=a}};PField.prototype.SetSubFrame=function(a){if(a!=undefined){this.SubFrame=a}if(this.SubFrame!=null&&!this.SubFrame.Identifier){var b=RD3_DesktopManager.ObjectMap[this.SubFrame];if(b!=undefined){this.SubFrame=b;this.SubFrame.ParentFrameIdentifier=this.Identifier}}};PField.prototype.SetUnbound=function(a){if(a!=undefined){this.Unbound=a}};PField.prototype.SetComboMultiSel=function(a){if(a!=undefined){this.ComboMultiSel=a}};PField.prototype.SetComboValueSep=function(a){if(a!=undefined){this.ComboValueSep=a}};PField.prototype.SetBackColor=function(b){var a=this.BackColor;if(b!=undefined){this.BackColor=b}if(a!=this.BackColor&&this.Realized){if(this.IsStatic()){this.UpdateVisualStyle(this.VisualStyle)}else{this.ParentPanel.ResetPosition=true}}};PField.prototype.SetForeColor=function(b){var a=this.ForeColor;if(b!=undefined){this.ForeColor=b}if(a!=this.ForeColor&&this.Realized){if(this.IsStatic()){this.UpdateVisualStyle(this.VisualStyle)}else{this.ParentPanel.ResetPosition=true}}};PField.prototype.SetFontMod=function(b){var a=this.FontMod;if(b!=undefined){this.FontMod=b}if(a!=this.FontMod&&this.Realized){if(this.IsStatic()){this.UpdateVisualStyle(this.VisualStyle)}else{this.ParentPanel.ResetPosition=true}}};PField.prototype.SetMask=function(a){if(a!=undefined){this.Mask=a}};PField.prototype.SetAlignment=function(b){var a=this.Alignment;if(b!=undefined){this.Alignment=b}if(a!=this.Alignment&&this.Realized){this.UpdateVisualStyle(this.VisualStyle);if(!this.IsStatic()){this.ParentPanel.ResetPosition=true}}};PField.prototype.SetUseTextSel=function(a){if(a!=undefined){this.UseTextSel=a}};PField.prototype.SetWaterMark=function(b){var a=this.WaterMark;if(b!=undefined){this.WaterMark=b}if(((a!=this.WaterMark)||b==undefined)&&this.ParentPanel.Realized){this.ParentPanel.ResetPosition=true}};PField.prototype.SetClassName=function(f){var d=this.ClassName;var a=this.ClassHeader;if(f!=undefined){var b="";var e="";var c=f.split(",");if(c.length==1){e=c[0];b=c[0]}else{if(c.length>1){e=c[0];b=c[1]}}this.ClassName=b;this.ClassHeader=e}if(((d!=this.ClassName)||f==undefined)&&this.ParentPanel.Realized){this.ParentPanel.ResetPosition=true}if(((a!=this.ClassHeader)||f==undefined)&&this.Realized){if(this.FormCaptionBox){if(a!=""){RD3_Glb.RemoveClass2(this.FormCaptionBox,a)}if(this.ClassHeader&&this.ClassHeader!=""){RD3_Glb.AddClass(this.FormCaptionBox,this.ClassHeader)}}if(this.ListCaptionBox){if(a!=""){RD3_Glb.RemoveClass2(this.ListCaptionBox,a)}if(this.ClassHeader&&this.ClassHeader!=""){RD3_Glb.AddClass(this.ListCaptionBox,this.ClassHeader)}}}};PField.prototype.SetAggregateOfField=function(a){this.AggregateOfField=a};PField.prototype.SetIsPK=function(a){if(a!=undefined){this.IsPK=a}};PField.prototype.SetDBCode=function(a){if(a!=undefined){this.DBCode=a}};PField.prototype.SetBadge=function(a){if(a!=undefined){this.Badge=a}if(this.Realized&&this.IsStatic()){if(this.Badge==""){if(this.BadgeObjForm&&this.BadgeObjForm.parentNode){this.BadgeObjForm.parentNode.removeChild(this.BadgeObjForm)}if(this.BadgeObjList&&this.BadgeObjList.parentNode){this.BadgeObjList.parentNode.removeChild(this.BadgeObjList)}this.BadgeObjForm=null;this.BadgeObjList=null}else{if(this.BadgeObjForm==null&&this.InForm&&this.ParentPanel.HasForm){this.BadgeObjForm=document.createElement("div");this.BadgeObjForm.className="badge-red";this.BadgeObjForm.style.position="absolute";this.ParentPanel.FormBox.appendChild(this.BadgeObjForm)}if(this.BadgeObjList==null&&this.InList&&this.ParentPanel.HasList){this.BadgeObjList=document.createElement("div");this.BadgeObjList.className="badge-red";this.BadgeObjList.style.position="absolute";this.ParentPanel.ListBox.appendChild(this.BadgeObjList)}if(this.BadgeObjForm){this.BadgeObjForm.innerHTML=this.Badge}if(this.BadgeObjList){this.BadgeObjList.innerHTML=this.Badge}this.SetListPosition();this.SetFormPosition()}}};PField.prototype.SetShowEditorTool=function(a){if(a!=undefined){this.ShowEditorTool=a}if(this.Realized){this.SetActualPosition(this.ParentPanel.ActualPosition)}};PField.prototype.SetEditorCommands=function(a){if(a!=undefined){this.EdToolCommands=a}if(this.Realized){this.SetActualPosition(this.ParentPanel.ActualPosition)}};PField.prototype.SetDefaultFormatting=function(a){if(a!=undefined){this.DefaultFormatting=a}if(this.Realized){this.SetActualPosition(this.ParentPanel.ActualPosition)}};PField.prototype.SetNumRows=function(e){var f=RD3_Glb.IsIE();if(this.ParentPanel.HasList&&!this.IsStatic()&&(this.InList||this.ListList)){if(!this.ListList){e=1}if(this.PListCells==null){this.PListCells=new Array()}if(this.PListCells.length>e){for(var d=e;d<this.PListCells.length;d++){if(this.PListCells[d]){this.PListCells[d].Unrealize()}}}if(this.PListCells.length<e&&(!this.ListList||!this.DelayedUpdate)){var c=this.ParentPanel.ActualPosition;for(var d=this.PListCells.length;d<e;d++){var b=new PCell(this,true);this.PListCells[d]=b;if(this.ListList){if(!this.ParentPanel.IsGrouped()){b.Update(this.PValues[d+c],this.ListBox)}else{var a=this.ParentPanel.GetRowIndex(d,RD3_Glb.PANEL_LIST);b.Update(this.PValues[a],this.ListBox)}}else{if(!this.ParentPanel.IsGrouped()){b.Update(this.PValues[d+c],this.ParentPanel.ListBox)}else{var a=this.ParentPanel.GetRowIndex(d,RD3_Glb.PANEL_LIST);b.Update(this.PValues[a],this.ParentPanel.ListBox)}}}}this.PListCells.length=e;if(RD3_ServerParams.ShowFieldImageInValue&&!this.Realizing){this.SetImage()}}};PField.prototype.SetFormPosition=function(){if(this.Realizing){return}if(!this.ParentPanel.HasForm||!this.InForm){return}if(this.IsStatic()){var a=new Rect(this.FormLeft,this.FormTop,this.FormWidth,this.FormHeight);this.VisualStyle.AdaptCaptionRect(a,false,false,true,(this.SubFrame||this.MultiUpload||this.IsButton()));if(RD3_Glb.IsTouch()&&this.IsButton()){a.w--;a.h--}RD3_Glb.SetDisplay(this.FormCaptionBox,(this.IsVisible()?"":"none"));this.FormCaptionBox.style.left=a.x+"px";this.FormCaptionBox.style.top=a.y+"px";this.FormCaptionBox.style.width=a.w+"px";this.FormCaptionBox.style.height=a.h+"px";this.FormCaptionBox.style.paddingLeft=a.pxl+"px";this.FormCaptionBox.style.paddingRight=a.pxr+"px";this.FormCaptionBox.style.paddingTop=a.pyt+"px";this.FormCaptionBox.style.paddingBottom=a.pyb+"px";if(this.BadgeObjForm){this.BadgeObjForm.style.top=(a.y-12>0?a.y-12:0)+"px";this.BadgeObjForm.style.left=(a.x+a.w-RD3_Glb.GetBadgeWidth(this.Badge,"red")+12)+"px"}return}var b=(this.HdrForm)?this.FormHeaderSize+4:0;var c=null;var a=null;if(this.HdrFormAbove){a=new Rect(this.FormLeft,this.FormTop,this.FormWidth,this.FormHeaderSize);c=new Rect(this.FormLeft,this.FormTop+b,this.FormWidth,this.FormHeight-b)}else{a=new Rect(this.FormLeft,this.FormTop,this.FormHeaderSize,this.FormHeight);c=new Rect(this.FormLeft+b,this.FormTop,this.FormWidth-b,this.FormHeight)}if(this.HdrForm){this.VisualStyle.AdaptCaptionRect(a,false,this.HdrFormAbove);RD3_Glb.SetDisplay(this.FormCaptionBox,(this.IsVisible()?"":"none"));this.FormCaptionBox.style.left=a.x+"px";this.FormCaptionBox.style.top=a.y+"px";this.FormCaptionBox.style.width=a.w+"px";this.FormCaptionBox.style.height=a.h+"px";if(RD3_ServerParams.Theme=="zen"&&a.pyt==3){a.pyt=8}this.FormCaptionBox.style.paddingLeft=a.pxl+"px";this.FormCaptionBox.style.paddingRight=a.pxr+"px";this.FormCaptionBox.style.paddingTop=a.pyt+"px";this.FormCaptionBox.style.paddingBottom=a.pyb+"px"}else{RD3_Glb.SetDisplay(this.FormCaptionBox,"none")}this.VisualStyle.AdaptRect(c,1,false);this.PFormCell.UpdateDims(c.x,c.y);this.ParentPanel.RecalcLayout=true};PField.prototype.SetListPosition=function(){if(this.Realizing){return}if(!this.ParentPanel.HasList||!this.InList){return}if(this.ListList){this.ParentPanel.RecalcLayout=true;return}var b=this.ListLeft+this.ParentPanel.RowSelWidth();if(this.IsStatic()){var a=new Rect(b,this.ListTop,this.ListWidth,this.ListHeight);this.VisualStyle.AdaptCaptionRect(a,false,false,true,(this.SubFrame||this.MultiUpload||this.IsButton()));if(RD3_Glb.IsTouch()&&this.IsButton()){a.w--;a.h--}RD3_Glb.SetDisplay(this.ListCaptionBox,(this.IsVisible()?"":"none"));this.ListCaptionBox.style.left=a.x+"px";this.ListCaptionBox.style.top=a.y+"px";this.ListCaptionBox.style.width=a.w+"px";this.ListCaptionBox.style.height=a.h+"px";this.ListCaptionBox.style.paddingLeft=a.pxl+"px";this.ListCaptionBox.style.paddingRight=a.pxr+"px";this.ListCaptionBox.style.paddingTop=a.pyt+"px";this.ListCaptionBox.style.paddingBottom=a.pyb+"px";if(this.BadgeObjList){this.BadgeObjList.style.top=(a.y-12>0?a.y-12:0)+"px";this.BadgeObjList.style.left=(a.x+a.w-RD3_Glb.GetBadgeWidth(this.Badge,"red")+12)+"px"}return}var c=(this.HdrList)?this.ListHeaderSize+4:0;var e=null;var a=null;if(this.HdrListAbove){a=new Rect(b,this.ListTop,this.ListWidth,this.ListHeaderSize);e=new Rect(b,this.ListTop+c,this.ListWidth,this.ListHeight-c)}else{a=new Rect(b,this.ListTop,this.ListHeaderSize,this.ListHeight);e=new Rect(b+c,this.ListTop,this.ListWidth-c,this.ListHeight)}if(this.HdrList){this.VisualStyle.AdaptCaptionRect(a,false,this.HdrListAbove);RD3_Glb.SetDisplay(this.ListCaptionBox,(this.IsVisible()?"":"none"));this.ListCaptionBox.style.left=a.x+"px";this.ListCaptionBox.style.top=a.y+"px";this.ListCaptionBox.style.width=a.w+"px";this.ListCaptionBox.style.height=a.h+"px";this.ListCaptionBox.style.paddingLeft=a.pxl+"px";this.ListCaptionBox.style.paddingRight=a.pxr+"px";this.ListCaptionBox.style.paddingTop=a.pyt+"px";this.ListCaptionBox.style.paddingBottom=a.pyb+"px"}else{RD3_Glb.SetDisplay(this.ListCaptionBox,"none")}this.VisualStyle.AdaptRect(e,1,false);this.PListCells[0].UpdateDims(e.x,e.y);this.ParentPanel.RecalcLayout=true};PField.prototype.SetListListPosition=function(a,k,h){if(this.Realizing){return}var p=this.ParentPanel;if(p.HasList&&this.InList&&this.ListList&&this.Realized){if(this.ListCaptionBox.parentNode!=h){this.ListCaptionBox.parentNode.removeChild(this.ListCaptionBox);h.appendChild(this.ListCaptionBox)}var c=k;var g=p.HeaderSize;if(this.Group){c+=this.Group.ListHeight;g-=this.Group.ListHeight}var t=p.VisStyle.GetBorders(1);var v=this.VisualStyle.GetBorders(1);var u=this.VisualStyle.GetBorders(2);var o=new Rect(a,c,this.ListWidth,g);this.VisualStyle.AdaptCaptionRect(o,true,true);if((t==4||t==3)&&u!=4&&u!=3){o.x++;o.w--;if(o.x+o.w==p.ListWidth-4){o.w--}}if((t==4||t==2)&&u!=4&&u!=2){o.y++;o.h--}var d=this.ListCaptionBox.style;if(RD3_ServerParams.Theme=="zen"&&this.InList&&this.ListList){o.y-=1;o.h+=2;o.w+=2}d.left=o.x+"px";d.top=o.y+"px";d.width=o.w+"px";d.height=o.h+"px";if(RD3_ServerParams.Theme=="zen"&&this.Group&&this.InList&&this.ListList){d.lineHeight=d.height}d.paddingLeft=o.pxl+"px";d.paddingRight=o.pxr+"px";d.paddingTop=o.pyt+"px";d.paddingBottom=o.pyb+"px";var e=ofsy=0;if((v==4||v==2)&&t!=4&&t!=2){ofsy=1}if((t==4||t==3)&&v!=4&&v!=3){if(a==-1){e=1}}d=this.ListBox.style;d.left=(a+e)+"px";d.top=(this.ListTop-p.ListTop+ofsy-1)+"px";d.width=(this.ListWidth+1-2*e)+"px";var j=p.ListHeightRounded+1-2*ofsy;if(p.HeaderSize>0){j-=p.HeaderSize+p.VisStyle.GetHeaderOffset()}if(RD3_Glb.IsQuadro()||RD3_Glb.IsMobile7()||RD3_Glb.IsMobile()){j++}if(j<0){j=0}d.height=j+"px";if(!this.DelayedUpdate){var l=p.GetRowHeight();var b=0;var m=this.PListCells.length;for(var q=0;q<m;q++){this.PListCells[q].UpdateDims(0,b);b+=l}}if(this.ListBox.parentNode!=h){this.ListBox.parentNode.removeChild(this.ListBox);h.appendChild(this.ListBox)}this.PGroupListLeft=a;var m=p.Fields.length;for(var q=0;q<m;q++){var r=p.Fields[q];if(r.AggregateOfField!=this.Index){continue}if(r.ListCaptionBox.parentNode!=h){h.appendChild(r.ListCaptionBox)}r.SetListLeft(parseInt(d.left)-p.RowSelWidth());r.SetListWidth(parseInt(d.width))}}};PField.prototype.Realize=function(b){this.Realizing=true;var a=this;if(this.ParentPanel.HasForm&&this.InForm){if(this.IsButton()){this.FormCaptionBox=document.createElement("input");this.FormCaptionBox.type="button";this.FormCaptionBox.className="panel-value-button";if(RD3_Glb.IsMobile()&&this.VisShowActivator()){RD3_Glb.AddClass(this.FormCaptionBox,"with-detail")}}else{this.FormCaptionBox=document.createElement("div");if(this.IsStatic()){this.FormCaptionBox.className="panel-field-static"}else{this.FormCaptionBox.className="panel-field-caption-form"}}this.FormCaptionBox.setAttribute("id",this.Identifier+":fc");this.FormCaptionBox.style.zIndex=this.Index;this.ParentPanel.FormBox.appendChild(this.FormCaptionBox);if(!this.IsStatic()){this.PFormCell=new PCell(this,false);this.PFormCell.Update(this.PValues[0],this.ParentPanel.FormBox)}}if(this.ParentPanel.HasList&&this.InList){if(this.IsButton()){this.ListCaptionBox=document.createElement("input");this.ListCaptionBox.type="button";this.ListCaptionBox.className="panel-value-button";if(RD3_Glb.IsMobile()&&this.VisShowActivator()){RD3_Glb.AddClass(this.ListCaptionBox,"with-detail")}}else{this.ListCaptionBox=document.createElement("div");if(this.IsStatic()){this.ListCaptionBox.className="panel-field-static"}else{this.ListCaptionBox.className=this.ListList?"panel-field-caption-list":"panel-field-caption-form"}}this.ListCaptionBox.setAttribute("id",this.Identifier+":lc");if(!this.IsStatic()&&this.ListList){if(!RD3_Glb.IsMobile()){this.ListCaptionBox.onclick=function(c){a.OnClickCaption(c)}}this.ListCaptionBox.style.cursor="pointer";this.ListBox=document.createElement("div");this.ListBox.className="panel-field-list-box";this.ListBox.setAttribute("id",this.Identifier+":lb");if(this.IsHidden()){this.DelayedUpdate=true;this.ParentPanel.DelayedListUpdate=true}}if(this.ListList){this.ParentPanel.ListListBox.appendChild(this.ListCaptionBox);this.ParentPanel.ListListBox.appendChild(this.ListBox)}else{this.ListCaptionBox.style.zIndex=this.Index;this.ParentPanel.ListBox.appendChild(this.ListCaptionBox)}}if(this.IsStatic()){if(this.MultiUpload){this.RenderMultiUpload()}else{if(this.ListCaptionBox&&!RD3_Glb.IsMobile()){this.ListCaptionBox.onclick=function(c){a.OnClickCaption(c)}}if(this.FormCaptionBox&&!RD3_Glb.IsMobile()){this.FormCaptionBox.onclick=function(c){a.OnClickCaption(c)}}}}this.ea=function(c){a.OnEndAnimation(c)};this.Realized=true;this.SetSubFrame();this.SetPage();this.SetGroup(this.Group);this.SetNumRows(1);this.SetIndex();this.SetVisible();this.SetEnabled();this.SetVisualStyle();this.SetListList();this.SetCanActivate();this.SetOptional();this.SetImage();this.SetHeader();this.SetTooltip();this.SetDataType();this.SetMaxLength();this.SetInList();this.SetListHeader();this.SetHdrList();this.SetHdrListAbove();this.SetListLeft();this.SetListTop();this.SetListWidth();this.SetListHeight();this.SetListNumRows();this.SetListHResMode();this.SetListVResMode();this.SetInForm();this.SetFormHeader();this.SetHdrForm();this.SetHdrFormAbove();this.SetFormLeft();this.SetFormTop();this.SetFormWidth();this.SetFormHeight();this.SetFormNumRows();this.SetFormHResMode();this.SetFormVResMode();this.SetSortMode();this.SetImageResizeMode();this.SetBadge();this.SetClassName();this.Realizing=false;this.SetFormPosition();this.SetListPosition()};PField.prototype.SetActualPosition=function(g,d,b){var e=this.ParentPanel.PanelMode;if(this.IsStatic()){return}if(g==undefined){g=this.ParentPanel.ActualPosition}var l=this.ParentPanel.OldAttR;if(this.InList&&this.ParentPanel.HasList&&this.PListCells&&(e==RD3_Glb.PANEL_LIST||e==-1)){if(this.ListList){if(!this.DelayedUpdate){if(this.IsHidden()&&!RD3_Glb.IsMobile()){this.DelayedUpdate=true;this.ParentPanel.DelayedListUpdate=true}else{var c=this.ParentPanel.NumRows;for(var f=0;f<c;f++){if(d!=undefined&&f!=d&&f!=b){continue}var k=this.PListCells[f];if(k){if(!this.ParentPanel.IsGrouped()){k.Update(this.PValues[g+f],this.ListBox)}else{var h=this.ParentPanel.GetRowIndex(f,RD3_Glb.PANEL_LIST,g);k.Update(this.PValues[h],this.ListBox);if(d!=undefined&&k&&k.ControlType==111&&f+1<c){k=this.PListCells[f+1];if(k.ControlType!=111){h=this.ParentPanel.GetRowIndex(f+1,RD3_Glb.PANEL_LIST,g);k.Update(this.PValues[h],this.ListBox)}}}}}}}}else{var j=this.PValues[g+this.ParentPanel.ActualRow];if(this.ParentPanel.IsGrouped()){var h=this.ParentPanel.GetRowIndex(this.ParentPanel.ActualRow,RD3_Glb.PANEL_LIST,g);j=this.PValues[h]}this.PListCells[0].Update(j,this.ParentPanel.ListBox);if(j&&this.HdrList){var a=j.IsVisible();if(a&&this.ListCaptionBox.style.display=="none"){RD3_Glb.SetDisplay(this.ListCaptionBox,"")}if(!a&&this.ListCaptionBox.style.display==""){RD3_Glb.SetDisplay(this.ListCaptionBox,"none")}}}}if(this.InForm&&this.ParentPanel.HasForm&&this.PFormCell&&(e==RD3_Glb.PANEL_FORM||e==-1)){var j=this.PValues[g];if(this.ParentPanel.IsGrouped()){var h=this.ParentPanel.GetRowIndex(0,RD3_Glb.PANEL_FORM,g);j=this.PValues[h]}this.PFormCell.Update(j,this.ParentPanel.FormBox);if(j&&this.HdrForm){var a=j.IsVisible();if(a&&this.FormCaptionBox.style.display=="none"){RD3_Glb.SetDisplay(this.FormCaptionBox,"")}if(!a&&this.FormCaptionBox.style.display==""){RD3_Glb.SetDisplay(this.FormCaptionBox,"none")}}}if(RD3_KBManager.ActiveObject==this&&RD3_KBManager.FocusFieldTimerId==0){var k=this.GetCurrentCell();if(k){k.SetActive()}RD3_DesktopManager.HandleFocus2(this.Identifier,this.ParentPanel.ActualRow)}};PField.prototype.HasValues=function(a){var c=this.ParentPanel.NumRows;for(var b=a;b<a+c;b++){if(this.PValues[b]==null||this.PValues[b]==undefined){return false}}return true};PField.prototype.AdaptLayout=function(){if(this.SubFrame&&this.SubFrame.Realized&&this.IsVisible()){RD3_Glb.AdaptToParent(this.SubFrame.FrameBox,0,0);if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&this.FormResizeSkipped){if(this.FormDeltaW!=0||this.FormDeltaH!=0){this.SubFrame.DeltaW=this.FormDeltaW;this.SubFrame.DeltaH=this.FormDeltaH;this.SubFrame.SendResize=true}this.FormResizeSkipped=false;this.FormDeltaW=0;this.FormDeltaH=0}if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.ListResizeSkipped){if(this.ListDeltaW!=0||this.ListDeltaH!=0){this.SubFrame.DeltaW=this.ListDeltaW;this.SubFrame.DeltaH=this.ListDeltaH;this.SubFrame.SendResize=true}this.ListResizeSkipped=false;this.ListDeltaW=0;this.ListDeltaH=0}this.SubFrame.AdaptLayout()}this.SetSortMode();this.AdjustHeaderSize();this.UpdateToolbar()};PField.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);var d=this.PValues.length;for(var b=0;b<d;b++){if(this.PValues[b]){this.PValues[b].Unrealize()}}if(this.PListCells){d=this.PListCells.length;for(var b=0;b<d;b++){if(this.PListCells[b]){this.PListCells[b].Unrealize()}}}if(this.PFormCell){this.PFormCell.Unrealize()}if(RD3_KBManager.ActiveElement&&RD3_KBManager.ActiveElement.parentNode){var c=RD3_KBManager.ActiveElement.parentNode;if(c.id&&c.id.indexOf(this.Identifier,0)!=-1){RD3_KBManager.ActiveElement=null}}if(RD3_KBManager.ActiveElement){var a=RD3_KBManager.ActiveElement;if(a.id&&a.id.indexOf(this.Identifier)!=-1){RD3_KBManager.ActiveElement=null}}if(RD3_KBManager.ActiveObject==this){RD3_KBManager.ActiveObject=null}if(this.SubFrame){if(this.SubFrame.Unrealize){this.SubFrame.Unrealize()}else{this.SubFrame=RD3_DesktopManager.ObjectMap[this.SubFrame];if(this.SubFrame){this.SubFrame.Unrealize()}}}if(!this.UseHTML5ForUpload()){if(this.ListFlashUploader){this.SWFUpload_Destroy(this.ListFlashUploader)}if(this.FormFlashUploader){this.SWFUpload_Destroy(this.FormFlashUploader)}}else{if(this.MultiUpload){if(this.FormFlashUploader&&this.FormFlashUploader.parentNode){this.FormFlashUploader.parentNode.removeChild(this.FormFlashUploader)}this.ReqList=null;this.FileList=null;this.MUPHeader=null}}};PField.prototype.ResetCache=function(b){var d=parseInt(b.getAttribute("from"));var c=parseInt(b.getAttribute("to"));if(!d){for(var a=0;a<=this.PValues.length;a++){if(this.PValues[a]){this.PValues[a].Unrealize()}}this.PValues=new Array()}else{for(var a=d;a<=c;a++){if(this.PValues[a]){this.PValues[a].Unrealize()}this.PValues[a]=null}}};PField.prototype.OnClickCaption=function(e){if(window.event&&e==undefined){e=window.event}if(this.IsStatic()){if(RD3_Glb.IsAndroid()||(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsTouch())){RD3_DDManager.ChompClick()}if((this.IsEnabled()||this.ActivableDisabled)&&!this.SubFrame&&this.VisHyperLink(this.VisualStyle)){if(this.Command){this.Command.OnClick(e)}else{var c=new IDEvent("clk",this.Identifier,e,this.ClickEventDef,null,"cap")}if(RD3_Glb.IsMobile()){var d=(window.event)?e.srcElement:e.explicitOriginalTarget;RD3_KBManager.ActiveButton=d}}}else{if(this.ParentPanel.CanSort&&this.CanSort&&this.VisCanSort()&&this.ListList){if(RD3_Glb.IsAndroid()||(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsTouch())){RD3_DDManager.ChompClick()}var a=true;if(RD3_Glb.IsFirefox()){var b=RD3_Glb.GetScreenLeft(this.ListCaptionBox)+this.ListCaptionBox.clientWidth;if((b-e.clientX<=RD3_ClientParams.ResizeLimit)&&this.ParentPanel.CanResizeColumn&&this.ParentPanel.PanelMode==0){a=false}}if(RD3_Glb.IsMobile()){var f=e.target?e.target:e.srcElement;if(f&&f.id&&f.id.indexOf(":lsg:")!=-1){a=false}}if(a){var c=new IDEvent("clk",this.Identifier,e,this.ClickEventDef,null,"cap")}}}};PField.prototype.IsVisible=function(a){var b=false;if(this.Page==-1){b=true}else{b=(this.ParentPanel.PanelPage==this.Page&&this.ParentPanel.Pages[this.Page].IsVisible())}if(b){if(this.Group){if(this.Group.IsVisible&&!this.Group.IsVisible()){b=false}if(!a&&this.Group.Collapsed){b=false}}}if(b){b=this.Visible}if(b){if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&!this.InList){b=false}if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&!this.InForm){b=false}}return b};PField.prototype.IsEnabled=function(e){if(e&&this.ParentPanel.Status==RD3_Glb.PS_QBE){if((e-1)!=1){return false}if(this.IdxPanel>0&&!this.AutoLookup&&!this.LKE){return false}if(!this.QBEEnabled){return false}return true}if(this.ParentPanel.Locked&&!this.IsStatic()&&this.CauseValidation){return false}var d=false;if(this.Page==-1){d=true}else{d=(this.ParentPanel.Pages[this.Page].IsEnabled())}if(d){if(this.Group&&this.Group.IsEnabled&&!this.Group.IsEnabled()){d=false}}if(d){d=this.Enabled}if(e&&d){var a=null;if(this.ParentPanel.IsGrouped()){a=this.PValues[(e-1)+this.ParentPanel.ListGroupRoot.GetPValOffset(e-1)]}else{a=this.PValues[e-1]}if(a&&!a.Enabled){d=false}}if(e&&d){var c=(e-1)>this.ParentPanel.TotalRows;if(!c&&this.ParentPanel.CanInsert&&!this.ParentPanel.CanUpdate){var b=this.ParentPanel.Fields[0];var a=null;if(this.ParentPanel.IsGrouped()){a=b.PValues[(e-1)+this.ParentPanel.ListGroupRoot.GetPValOffset(e-1)]}else{a=b.PValues[e-1]}if(a&&(a.RowSelector==3||a.RowSelector==4)){c=true}}if(!c&&!this.ParentPanel.CanUpdate){d=false}if(c&&!this.ParentPanel.CanInsert){d=false}if(this.Unbound&&c){return false}}return d};PField.prototype.UpdateFieldVisibility=function(){if(this.Realizing){return}this.UpdateSubFrameVisibility();if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM){if(this.PFormCell){var b=this.ParentPanel.ActualPosition+this.ParentPanel.ActualRow;if(this.ParentPanel.IsGrouped()){b=this.ParentPanel.GetRowIndex(this.ParentPanel.ActualRow,RD3_Glb.PANEL_FORM)}var c=this.PValues[b];if(c){this.PFormCell.SetVisible(c.IsVisible());if(this.FormCaptionBox){RD3_Glb.SetDisplay(this.FormCaptionBox,((this.HdrForm&&c.IsVisible())?"":"none"))}}}else{if(this.FormCaptionBox){RD3_Glb.SetDisplay(this.FormCaptionBox,(this.HdrForm&&this.IsVisible())?"":"none")}}}else{if(this.InList&&this.ListList){RD3_Glb.SetDisplay(this.ListBox,(this.IsVisible()?"":"none"))}if(this.ListCaptionBox){RD3_Glb.SetDisplay(this.ListCaptionBox,((this.HdrList&&this.IsVisible()&&(!this.ListList||this.ParentPanel.HeaderSize>0))?"":"none"))}if(this.PListCells&&!this.DelayedUpdate){if(this.ListList){var e=this.ParentPanel.NumRows;var b=this.ParentPanel.ActualPosition;for(var d=0;d<e;d++){if(!this.ParentPanel.IsGrouped()){var c=this.PValues[b+d];this.PListCells[d].SetVisible(c?c.IsVisible():this.IsVisible())}else{var a=this.ParentPanel.GetRowIndex(d,RD3_Glb.PANEL_LIST);var c=this.PValues[a];this.PListCells[d].SetVisible(c?c.IsVisible():this.IsVisible())}}}else{var b=this.ParentPanel.ActualPosition+this.ParentPanel.ActualRow;if(this.ParentPanel.IsGrouped()){b=this.ParentPanel.GetRowIndex(this.ParentPanel.ActualRow,RD3_Glb.PANEL_LIST)}var c=this.PValues[b];this.PListCells[0].SetVisible(c?c.IsVisible():this.IsVisible());if(this.ListCaptionBox&&c){RD3_Glb.SetDisplay(this.ListCaptionBox,((this.HdrList&&c.IsVisible())?"":"none"))}}}}};PField.prototype.UpdateSubFrameVisibility=function(){if(this.SubFrame&&this.IsVisible()&&(this.FormCaptionBox||this.ListCaptionBox)){if(!this.SubFrame.Realized){var a=(this.FormCaptionBox?this.FormCaptionBox:this.ListCaptionBox);a.style.textAlign="left";this.SubFrame.Realize(a);if(this.SubFrame instanceof IDPanel){this.SubFrame.AdjustSubFrame(this,a)}this.SubFrame.ContentBox.style.margin="0px";if(a.style.paddingBottom=="0px"&&RD3_Glb.IsMobile()){this.SubFrame.ContentBox.style.marginBottom="4px"}}if(this.InList&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.SubFrame.FrameBox.parentNode!=this.ListCaptionBox){this.ListCaptionBox.appendChild(this.SubFrame.FrameBox);this.SubFrame.AdaptLayout()}if(this.InForm&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&this.SubFrame.FrameBox.parentNode!=this.FormCaptionBox){this.FormCaptionBox.appendChild(this.SubFrame.FrameBox);this.SubFrame.AdaptLayout()}}};PField.prototype.SetCanSort=function(b){if(!this.Realized||!this.ListList||!this.InList||!this.ListCaptionBox){return}if(b==undefined){b=this.CanSort&&this.VisCanSort()}else{b=b&&(this.CanSort&&this.VisCanSort())}this.ListCaptionBox.style.cursor=b?"pointer":"";if(b&&!this.SortImage){this.SortImage=document.createElement("img");this.SortImage.className="panel-sort-image";var a=this;this.SortImage.onclick=function(c){a.OnClickCaption(c)};this.ListCaptionBox.appendChild(this.SortImage)}if(!b&&this.SortImage){this.SortImage.parentNode.removeChild(this.SortImage);this.SortImage=null}if(!this.ParentPanel.Realizing){this.SetSortMode()}};PField.prototype.GetValueWidth=function(b){var a=0;if(b){a=this.ListWidth;if(!this.ListList){if(this.HdrList&&!this.HdrListAbove){a-=(this.ListHeaderSize+4)}}}else{a=this.FormWidth;if(this.HdrForm&&!this.HdrFormAbove){a-=(this.FormHeaderSize+4)}}return a};PField.prototype.GetValueHeight=function(b){var a=0;if(b){a=this.ListHeight;if(!this.ListList){if(this.HdrList&&this.HdrListAbove){a-=(this.ListHeaderSize+4)}}}else{a=this.FormHeight;if(this.HdrForm&&this.HdrFormAbove){a-=(this.FormHeaderSize+4)}}return a};PField.prototype.OnChange=function(c,b){var a=this.PValues[this.ParentPanel.ActualPosition+b];if(this.ParentPanel.IsGrouped()){a=this.PValues[this.ParentPanel.GetRowIndex(b)]}if(a){a.OnChange(c)}};PField.prototype.OnKeyPress=function(c,b){var a=this.PValues[this.ParentPanel.ActualPosition+b];if(this.ParentPanel.IsGrouped){a=this.PValues[this.ParentPanel.GetRowIndex(b)]}if(a){a.OnKeyPress(c)}};PField.prototype.Focus=function(e,g,f){if(!this.IsVisible()||!this.Realized){return false}if(this.ParentPanel.WebForm.Animating&&this.ParentPanel.WebForm.Modal!=0){RD3_GFXManager.ModalFocusFldId=this.Identifier;RD3_GFXManager.ModalFocusFldRow=g;return true}if(this.ParentPanel.AnimatingPanel){RD3_DesktopManager.HandleFocus2(this.Identifier,g);return}if(RD3_DDManager.OpenCombo&&!RD3_DDManager.OpenCombo.IsPopOver()&&RD3_Glb.IsMobile()){return}var a=null;if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM){a=this.PFormCell}else{var c=0;if(this.ListList){c=g}if(this.PListCells){a=this.PListCells[c]}}if(!a){if(this.IsButton()){var h=null;if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&this.FormCaptionBox){h=this.FormCaptionBox}else{if(this.ListCaptionBox){h=this.ListCaptionBox}}if(h){try{h.focus();return true}catch(b){return false}}else{return false}}else{return false}}if(a.ControlType==111){var d=this.ParentPanel.GetFirstListField();if(d&&this!=d){return d.Focus(e,g,f)}}if(a.ErrorType==1&&RD3_DDManager.OpenCombo){return false}return a.Focus(f,e)};PField.prototype.GotFocus=function(c,d){while(c&&!c.id){c=c.parentNode}var a=null;if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.ListList){var e=this.PListCells.length;for(var b=0;b<e;b++){if(this.PListCells[b].GetDOMObj(true)==c||this.PListCells[b].TooltipDiv==c){if(this.ParentPanel.Status==RD3_Glb.PS_QBE&&b!=0){return}this.ParentPanel.ChangeActualRow(b,d);a=this.PListCells[b];break}}}else{if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.PListCells){a=this.PListCells[0]}else{a=this.PFormCell}}if(a){this.ParentPanel.FieldFocus(this.Index,true);a.SetActive()}};PField.prototype.LostFocus=function(c,d,a){if(!a){this.ParentPanel.FieldFocus(this.Index,false)}while(c&&!c.id){c=c.parentNode}var b=RD3_DesktopManager.WebEntryPoint.FocusBox;if(b.parentNode==c){RD3_DesktopManager.WebEntryPoint.SetHideFocusBox()}};PField.prototype.HandleNavKeys=function(f){var b=(f.charCode)?f.charCode:f.keyCode;var o=(window.event)?f.srcElement:f.explicitOriginalTarget;var e=(o.tagName=="TEXTAREA"||RD3_Glb.isInsideEditor(o));var g=RD3_KBManager.IsListGroup(o);var i=false;switch(b){case 33:if(!e&&this.ParentPanel.PrevButton.style.display!="none"){this.ParentPanel.OnToolbarClick(f,"prev");i=true}break;case 34:if(!e&&this.ParentPanel.NextButton.style.display!="none"){this.ParentPanel.OnToolbarClick(f,"next");i=true}break;case 35:if(!e&&f.ctrlKey&&this.ParentPanel.BottomButton.style.display!="none"){this.ParentPanel.OnToolbarClick(f,"bottom");i=true}break;case 36:if(!e&&f.ctrlKey&&this.ParentPanel.TopButton.style.display!="none"){this.ParentPanel.OnToolbarClick(f,"top");i=true}break;case 9:if(g){i=true;break}if(f.shiftKey){this.ParentPanel.FocusPrevField(this,f)}else{this.ParentPanel.FocusNextField(this,f)}i=true;break;case 37:if(g&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.ParentPanel.IsGrouped()){var a=o.id;var j=a.substring(a.indexOf(":lsg:"));var d=parseInt(j.substring(5));var l=this.PValues[d];if(!l||!(l instanceof PListGroup)){i=true;break}if(l.Expanded){l.OnExpandGrp()}i=true;break}var p=true;if(RD3_Glb.IsEditFld(o)||o.tagName=="TEXTAREA"){p=getCursorPos(o)==0}if(p&&!f.ctrlKey&&!f.shiftKey){this.ParentPanel.FocusPrevField(this,f);i=true}break;case 39:if(g&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.ParentPanel.IsGrouped()){var a=o.id;var j=a.substring(a.indexOf(":lsg:"));var d=parseInt(j.substring(5));var l=this.PValues[d];if(!l||!(l instanceof PListGroup)){i=true;break}if(!l.Expanded){l.OnExpandGrp()}i=true;break}var k=true;if(RD3_Glb.IsEditFld(o)||o.tagName=="TEXTAREA"){k=getCursorPos(o)==o.value.length}if(k&&!f.ctrlKey&&!f.shiftKey){this.ParentPanel.FocusNextField(this,f);i=true}break;case 38:if(!e){if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST){if(this.ParentPanel.ActualRow>0){this.Focus(f,this.ParentPanel.ActualRow-1,true)}else{if(this.ParentPanel.ActualPosition>1){var i=true;var c=this.ParentPanel.ActualPosition-1;if(this.ParentPanel.IsGrouped()){if(this.ParentPanel.CompactActualPosition==1){i=false}c=this.ParentPanel.GetServerIndex(-1);if(c==this.ParentPanel.ActualPosition){c=this.ParentPanel.ActualPosition-1}}if(i){this.ParentPanel.ScrollTo(c,f,200);this.ParentPanel.UpdateScrollPos()}}}}else{this.ParentPanel.FocusPrevField(this,f,true)}i=true}break;case 40:if(!e){if(!RD3_Glb.IsIE()){var h=this.GetCurrentCell(this.ParentPanel.ActualRow,o);if(h&&h.ControlType==3&&f.altKey){return false}}if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST){if(this.ParentPanel.ActualRow<this.ParentPanel.NumRows-1){this.Focus(f,this.ParentPanel.ActualRow+1,true)}else{if(this.ParentPanel.IsGrouped()&&this.ParentPanel.CompactActualPosition+this.ParentPanel.NumRows<this.ParentPanel.GetTotalRows()+1){c=this.ParentPanel.GetServerIndex(1);var m=this.ParentPanel.GetServerIndex(0);if(c==m){c=this.ParentPanel.GetServerIndex(2)}this.ParentPanel.ScrollTo(c,f,200);this.ParentPanel.UpdateScrollPos();break}if(this.ParentPanel.ActualPosition+this.ParentPanel.NumRows<=this.ParentPanel.TotalRows){var c=this.ParentPanel.ActualPosition+1;if(this.ParentPanel.IsGrouped()){c=this.ParentPanel.GetServerIndex(1);i=this.ParentPanel.CompactActualPosition+this.ParentPanel.NumRows<this.ParentPanel.GetTotalRows()+1;if(!i){break}}this.ParentPanel.ScrollTo(c,f,200);this.ParentPanel.UpdateScrollPos()}}}else{this.ParentPanel.FocusNextField(this,f)}i=true}break}if(i&&RD3_DesktopManager.WebEntryPoint.CalPopup){if(RD3_DesktopManager.WebEntryPoint.CalPopup.style.display!="none"){RD3_DesktopManager.WebEntryPoint.CalPopup.style.display="none"}}return i};PField.prototype.HandleFunctionKeys=function(a){return this.ParentPanel.HandleFunctionKeys(a)};PField.prototype.IsStatic=function(){return this.IdxPanel<0};PField.prototype.IsButton=function(){return(this.VisualStyle&&this.VisualStyle.GetContrType()==6&&this.IsStatic())};PField.prototype.UpdateToolbar=function(){if(this.DataType==10){var g=false;var i=false;var a=false;var h=this.PValues[this.ParentPanel.ActualPosition+this.ParentPanel.ActualRow];if(this.ParentPanel.IsGrouped()){h=this.PValues[this.ParentPanel.GetRowIndex(this.ParentPanel.ActualRow)]}var d=(h)?h.BlobMime:null;if(!d){d="empty"}var c=this.ParentPanel.ActualPosition+this.ParentPanel.ActualRow;if(this.ParentPanel.IsGrouped()&&h){c=h.Index}if(this.IsEnabled(c+1)&&this.ParentPanel.Status!=RD3_Glb.PS_QBE&&!this.ParentPanel.IsNewRow(this.ParentPanel.ActualPosition,this.ParentPanel.ActualRow)){g=this.ParentPanel.IsCommandEnabled(RD3_Glb.PCM_BLOBEDIT);i=this.ParentPanel.IsCommandEnabled(RD3_Glb.PCM_BLOBDELETE)}if(d!="empty"&&d!="upload"){a=this.ParentPanel.IsCommandEnabled(RD3_Glb.PCM_BLOBSAVEAS)}RD3_Glb.SetDisplay(this.ListBlobUploadImg,(g)?"":"none");RD3_Glb.SetDisplay(this.FormBlobUploadImg,(g)?"":"none");RD3_Glb.SetDisplay(this.ListBlobDeleteImg,(i)?"":"none");RD3_Glb.SetDisplay(this.FormBlobDeleteImg,(i)?"":"none");RD3_Glb.SetDisplay(this.ListBlobZoomImg,(a)?"":"none");RD3_Glb.SetDisplay(this.FormBlobZoomImg,(a)?"":"none");var e=RD3_ClientParams.BlobButtonWidth*((g?1:0)+(i?1:0)+(a?1:0));if(this.FormBlobUploadImg){var f=0;var b=this.FormCaptionBox.clientWidth-e;if(!this.HdrFormAbove){f=20;b=0}if(g){this.FormBlobUploadImg.style.left=b+"px";this.FormBlobUploadImg.style.top=f+"px";b+=RD3_ClientParams.BlobButtonWidth}if(i){this.FormBlobDeleteImg.style.left=b+"px";this.FormBlobDeleteImg.style.top=f+"px";b+=RD3_ClientParams.BlobButtonWidth}if(a){this.FormBlobZoomImg.style.left=b+"px";this.FormBlobZoomImg.style.top=f+"px";b+=RD3_ClientParams.BlobButtonWidth}}if(this.ListBlobUploadImg){var f=0;var b=this.ListCaptionBox.clientWidth-e;if(!this.HdrListAbove){f=20;b=0}if(g){this.ListBlobUploadImg.style.left=b+"px";this.ListBlobUploadImg.style.top=f+"px";b+=RD3_ClientParams.BlobButtonWidth}if(i){this.ListBlobDeleteImg.style.left=b+"px";this.ListBlobDeleteImg.style.top=f+"px";b+=RD3_ClientParams.BlobButtonWidth}if(a){this.ListBlobZoomImg.style.left=b+"px";this.ListBlobZoomImg.style.top=f+"px";b+=RD3_ClientParams.BlobButtonWidth}}}};PField.prototype.OnBlobCommand=function(d,g){var l=this.PValues[this.ParentPanel.ActualPosition+this.ParentPanel.ActualRow];if(this.ParentPanel.IsGrouped()){l=this.PValues[this.ParentPanel.GetRowIndex(this.ParentPanel.ActualRow)]}if(g=="zoom"||g=="link"){var c=l.BlobUrl;if(c&&c!=""){c=c.replace("&amp;","&");if(window.RD4_Enabled&&c.substr(0,11)=="?WCI=IWBlob"){var a=c.substring(16);var i=new IDEvent("IWBlob","",null,RD3_Glb.EVENT_ACTIVE,"",a);this.DownloadSource=g;return}if(g=="zoom"&&RD3_Glb.BlobShowPreview(l.HTMLBlobMime)){var f=new PopupPreview(c,RD3_ServerParams.VisualizzaDocumento,l.HTMLBlobMime);f.Open()}else{RD3_DesktopManager.OpenDocument(c,"","")}}}else{if(g.substr(0,6)=="upload"&&l.BlobMime=="upload"){var j=(this.ListList)?this.ParentPanel.ActualRow:0;var k=(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST)?this.PListCells[j]:this.PFormCell;k.UploadBlob()}else{var h=true;if(g.substr(0,7)=="delblob"){this.DoHighlightDelete(true);var e=RD3_Glb.FormatMessage(ClientMessages.PAN_MSG_ConfirmDeleteBLOB,this.Header);this.MessageConfirm=new MessageBox(e,RD3_Glb.MSG_CONFIRM,false);this.MessageConfirm.CallBackFunction=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnDelBlobConfirm', ev, '"+g+"')");this.MessageConfirm.Open();h=false}if(g.substr(0,6)=="upload"&&this.UseHTML5ForUpload()){if(g.indexOf("list")!=-1){this.ListFlashUploader.value="";this.ListFlashUploader.click()}else{this.FormFlashUploader.value="";this.FormFlashUploader.click()}h=false}if(h){var b=0;if(g=="zoom"){b=(this.ParentPanel.BlockingCommands&RD3_Glb.PCM_BLOBSAVEAS)}else{if(g.substr(0,6)=="upload"){b=(this.ParentPanel.BlockingCommands&RD3_Glb.PCM_BLOBEDIT)}else{if(g.substr(0,7)=="delblob"){b=(this.ParentPanel.BlockingCommands&RD3_Glb.PCM_BLOBDELETE)}}}var i=new IDEvent("pantb",this.ParentPanel.Identifier,d,this.ParentPanel.ToolbarEventDef|(b?RD3_Glb.EVENT_BLOCKING:0),g)}}}};PField.prototype.OnFCKSelectionChange=function(a){var f=this.ParentPanel.ActualPosition+this.ParentPanel.ActualRow;if(this.ParentPanel.IsGrouped()){f=this.ParentPanel.GetRowIndex(this.ParentPanel.ActualRow)}try{var b=a.editor?a.editor:a;var e=false;var g=(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.PListCells?this.PListCells[0]:this.PFormCell);if(g&&g.ControlType==101){e=(g.Text!=b.getData())}if(b&&b.checkDirty&&b.checkDirty()||e){var d=b.getData();if(this.PValues[f].Text!=d&&this.FCKTimerID==0){this.OnChange(b,this.ParentPanel.ActualRow)}b.resetDirty()}}catch(c){}};PField.prototype.OnDelBlobConfirm=function(b,a){if(this.MessageConfirm){this.DoHighlightDelete(false);if(this.MessageConfirm.UserResponse=="Y"){var b=new IDEvent("pantb",this.ParentPanel.Identifier,b,this.ParentPanel.ToolbarEventDef,a)}this.MessageConfirm=null}};PField.prototype.IsRightAligned=function(){var a=(this.Alignment!=-1?this.Alignment:this.VisualStyle.GetAlignment(1));if(a==4){return true}if(!RD3_Glb.IsNumericObject(this.DataType)){return false}if(this.ValueList){var b=this.VisualStyle;if(!b||b.GetContrType()!=2){return false}}if(this.AutoLookup){return false}if(a!=1){return false}return true};PField.prototype.CanHaveFocus=function(d){if(this.IsStatic()){return this.IsButton()}if(d==undefined){d=this.ParentPanel.ActualRow}var e=d+this.ParentPanel.ActualPosition;if(this.ParentPanel.IsGrouped()){e=this.ParentPanel.GetRowIndex(d)}var b=this.Enabled;var a=this.GetCurrentCell(d);var c=-1;if(a){c=a.ControlType;if(c==6){b=a.IsEnabled}}if(!b&&this.ParentPanel.Status!=RD3_Glb.PS_QBE){return false}if(!this.IsVisible()){return false}var f=this.VisualStyle;if(this.PValues[e]&&!(this.PValues[e] instanceof PListGroup)){b=this.PValues[e].IsEnabled();f=this.PValues[e].GetVisualStyle();if(!this.PValues[e].IsVisible()){return false}}switch(c){case 2:if(!b&&(this.VisHyperLink(f)||this.EditorType!=0||f.ShowHTML()||(this.PValues[e]&&this.PValues[e].ShowHTML()))){return false}break;case 30:if(RD3_Glb.IsSafari()||RD3_Glb.IsChrome()){return false}break;case 4:return b;case 5:return b;case 6:return a.IsEnabled;case 10:if(RD3_Glb.IsSafari()||this.ParentPanel.Status==RD3_Glb.PS_QBE||RD3_Glb.IsChrome()){return false}break;case 101:return(b&&RD3_ServerParams.UseIDEditor);case -1:return false;break}return true};PField.prototype.ResizeForm=function(b,k,i,h){var a=this.Formleft;var l=this.FormTop;var f=this.FormWidth;var c=this.FormHeight;if(this.FormHResMode==RD3_Glb.RESMODE_STRETCH){if(!this.IsStatic()&&!this.HdrFormAbove&&this.HdrForm&&RD3_Glb.IsSmartPhone()){if(this.OrgFormHeaderSize==undefined){this.OrgFormHeaderSize=this.FormHeaderSize}var e=(this.OrgFormHeaderSize+0)/this.OrgFormWidth;var n=Math.floor(b*e);var p=this.FormHeaderSize+n;if(n<0&&p<80&&this.OrgFormHeaderSize>80){p=80;n=this.FormHeaderSize-p}this.SetFormHeaderSize(p)}var j=this.FormWidth+b;var o=i?this.OrgFormWidth:48;if(b<0&&j<o){j=o}this.SetFormWidth(j)}if(this.FormHResMode==RD3_Glb.RESMODE_MOVE){this.SetFormLeft(this.FormLeft+b)}if(this.FormVResMode==RD3_Glb.RESMODE_STRETCH){var d=this.FormHeight+k;var g=h?this.OrgFormHeight:48;if(k<0&&d<g){d=g}this.SetFormHeight(d)}if(this.FormVResMode==RD3_Glb.RESMODE_MOVE){this.SetFormTop(this.FormTop+k)}if(this.FormLeft!=a||this.FormTop!=l||this.FormWidth!=f||this.FormHeight!=c){var m=new IDEvent("resize",this.Identifier,null,RD3_Glb.EVENT_SERVERSIDE,"form",this.FormWidth,this.FormHeight,this.FormLeft,this.FormTop)}if(this.SubFrame&&this.SubFrame.Realized){if(this.FormHResMode!=RD3_Glb.RESMODE_STRETCH){b=0}if(this.FormVResMode!=RD3_Glb.RESMODE_STRETCH){k=0}if(b!=0||k!=0){this.SubFrame.Width=this.FormWidth;this.SubFrame.Height=this.FormHeight;this.SubFrame.DeltaW=b;this.SubFrame.DeltaH=k;this.SubFrame.SendResize=true}}else{this.FormResizeSkipped=true;if(this.FormHResMode!=RD3_Glb.RESMODE_STRETCH){b=0}if(this.FormVResMode!=RD3_Glb.RESMODE_STRETCH){k=0}this.FormDeltaH+=k;this.FormDeltaW+=b}};PField.prototype.ResizeList=function(b,j,h,g){var a=this.ListLeft;var k=this.ListTop;var e=this.ListWidth;var c=this.ListHeight;if(this.ListHResMode==RD3_Glb.RESMODE_MOVE){this.SetListLeft(this.ListLeft+b)}if(this.ListVResMode==RD3_Glb.RESMODE_MOVE){this.SetListTop(this.ListTop+j)}if(this.ListHResMode==RD3_Glb.RESMODE_STRETCH){var i=this.ListWidth+b;var m=h?this.OrgListWidth:48;if(b<0&&i<m){i=m}this.SetListWidth(i)}if(this.ListVResMode==RD3_Glb.RESMODE_STRETCH){var d=this.ListHeight+j;var f=g?this.OrgListHeight:48;if(j<0&&d<f){d=f}this.SetListHeight(d)}if(this.ListLeft!=a||this.ListTop!=k||this.ListWidth!=e||this.ListHeight!=c){var l=new IDEvent("resize",this.Identifier,null,RD3_Glb.EVENT_SERVERSIDE,"list",this.ListWidth,this.ListHeight,this.ListLeft,this.ListTop)}if(this.SubFrame&&this.SubFrame.Realized){if(this.ListHResMode!=RD3_Glb.RESMODE_STRETCH){b=0}if(this.ListVResMode!=RD3_Glb.RESMODE_STRETCH){j=0}if(b!=0||j!=0){this.SubFrame.Width=this.ListWidth;this.SubFrame.Height=this.ListHeight;this.SubFrame.DeltaW=b;this.SubFrame.DeltaH=j;this.SubFrame.SendResize=true}}else{this.ListResizeSkipped=true;if(this.ListHResMode!=RD3_Glb.RESMODE_STRETCH){b=0}if(this.ListVResMode!=RD3_Glb.RESMODE_STRETCH){j=0}this.ListDeltaH+=j;this.ListDeltaW+=b}};PField.prototype.FieldFunctionKeys=function(c){var b=false;if(this.Command&&this.IsEnabled()&&this.IsVisible()){var a=this.Command.IsMenu;this.Command.IsMenu=true;b=this.Command.HandleFunctionKeys(c,-1,-1);this.Command.IsMenu=a}return b};PField.prototype.GetParentFrame=function(){return this.ParentPanel};PField.prototype.OnClickActivator=function(c){if(window.event&&c==undefined){c=window.event}var f=false;var i=(window.event)?c.srcElement:c.explicitOriginalTarget;if(RD3_Glb.IsMobile()&&i==this.FormCaptionBox&&this.PFormCell){i=this.PFormCell.IntCtrl.ComboInput?this.PFormCell.IntCtrl.ComboInput:this.PFormCell.IntCtrl}if(i&&i.className&&i.className.indexOf("-activator")!=-1){i=i.previousSibling;f=true}if(i&&i.className=="combo-img"){i=i.parentNode}var h=RD3_KBManager.GetCell(i);var b=h.IsEnabled;if(!b&&!this.ActivableDisabled){return true}this.GotFocus(i,c);RD3_KBManager.ActiveElement=i;var d=this.DataType;if((d==6||d==7||d==8)&&b){var a=(h.Mask!=""?h.Mask:this.Mask);ShowCalendar(h.IntCtrl,a);if(f){RD3_DesktopManager.WebEntryPoint.CalPopup.setAttribute("idjustopened","1");if(!RD3_Glb.IsIE()){i.focus()}}return false}if(h&&h.ControlType==3&&h.IntCtrl){h.IntCtrl.OnClickActivator();return}var e=RD3_KBManager.GetObject(i,true);var g=new IDEvent("clk",e.Identifier,c,this.ClickEventDef)};PField.prototype.OnRightClick=function(a){if(this.ParentPanel.ActivateRightClick){this.OnClickActivator(a)}};PField.prototype.GetDOMObj=function(a){if(!this.IsStatic()){return null}var b=this.ParentPanel;if(b.PanelMode==RD3_Glb.PANEL_FORM){return this.FormCaptionBox}else{return this.ListCaptionBox}};PField.prototype.OnMouseOverObj=function(b,a){if(this.IsStatic()&&a==this.FormCaptionBox&&this.UseHL){this.FormCaptionBox.style.backgroundPosition="0px -"+this.FormCaptionBox.offsetHeight+"px"}if(this.IsStatic()&&a==this.ListCaptionBox&&this.UseHL){this.ListCaptionBox.style.backgroundPosition="0px -"+this.ListCaptionBox.offsetHeight+"px"}};PField.prototype.OnMouseOutObj=function(b,a){if(this.IsStatic()&&a==this.FormCaptionBox&&this.UseHL){this.FormCaptionBox.style.backgroundPosition=""}if(this.IsStatic()&&a==this.ListCaptionBox&&this.UseHL){this.ListCaptionBox.style.backgroundPosition=""}};PField.prototype.OnMouseDownObj=function(c,b){if(this.IsStatic()&&b==this.FormCaptionBox&&this.UseHL){this.FormCaptionBox.style.backgroundPosition="0px -"+this.FormCaptionBox.offsetHeight*2+"px"}if(this.IsStatic()&&b==this.ListCaptionBox&&this.UseHL){this.ListCaptionBox.style.backgroundPosition="0px -"+this.ListCaptionBox.offsetHeight*2+"px"}var a=this.GetCurrentCell(0,b);if(a){a.OnMouseDownObj(c,b)}};PField.prototype.RunJScript=function(a){var c=a.indexOf("<!--scr>");while(c!=-1){var b=a.indexOf("-->",c);if(b!=-1){window.setTimeout(a.substring(c+8,b),100);c=b+3}else{alert("Error while parsing static field Javascript")}c=a.indexOf("<!--scr>",c)}};PField.prototype.IsCellClickable=function(b,c){var a=this.IsEnabled(b+1);if(!a&&!this.ActivableDisabled){return false}if(this.VisHyperLink(c)){return true}if(this.CanActivate){return true}return false};PField.prototype.IsComboClickable=function(b,c){var a=this.IsEnabled(b);if(!a&&!this.ActivableDisabled){return false}if(this.VisHyperLink(c)&&this.CanActivate){return true}return false};PField.prototype.GetCurrentCell=function(c,d){if(d){while(d&&(d.className=="panel-value-activator"||d.className=="combo-img"||d.className=="combo-activator")){d=d.previousSibling}while(d&&!d.id){d=d.parentNode}if(!d){return null}var b=d.id;if(b.indexOf(":lv")!=-1){c=parseInt(b.substring(b.indexOf(":lv")+3),10);return this.PListCells[c]}else{if(b.indexOf(":fv")!=-1){return this.PFormCell}}return null}if(c==undefined){c=this.ParentPanel.ActualRow}var a=null;if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.InList){if(!this.PListCells){return null}if(this.ListList){return this.PListCells[c]}else{return this.PListCells[0]}}if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&this.InForm){return this.PFormCell}return null};PField.prototype.HandleDelayedUpdate=function(){var d=this.ListBox.parentNode;var h=this.ListBox.nextSibling;var g=RD3_Glb.IsIE(10,false)&&!RD3_Glb.IsIE(6);if(g){this.ListBox.parentNode.removeChild(this.ListBox)}var f=this.ParentPanel.ActualPosition;var b=0;var k=this.ParentPanel.GetRowHeight();for(var e=0;e<this.PListCells.length;e++){var l=this.PValues[e+f];if(this.ParentPanel.IsGrouped()){var j=this.ParentPanel.GetRowIndex(e,RD3_Glb.PANEL_LIST);l=this.PValues[j]}var c=this.PListCells[e];if(!c){c=new PCell(this,true);this.PListCells[e]=c}c.Update(l,this.ListBox);c.UpdateDims(0,b);c.SetVisible(l?l.IsVisible():this.IsVisible());if(this.Image!=""){var a=this.Image;if(!RD3_Glb.IsAbsoluteUrl(this.Image)){a=RD3_Glb.GetAbsolutePath()+"images/"+this.Image}c.SetBackGroundImage("url("+encodeURI(a)+")")}else{c.SetBackGroundImage("")}b+=k}if(g){if(h){d.insertBefore(this.ListBox,h)}else{d.appendChild(this.ListBox)}}this.DelayedUpdate=false};PField.prototype.IsHidden=function(){if(!this.IsVisible()){return true}var a=this.ParentPanel;if(!a.ListBox||!a.ListBox.parentNode){return false}if(a.PanelMode!=RD3_Glb.PANEL_LIST){return false}var b=a.Width;if(a.ParentTab&&a.ParentFrame&&b==0){b=a.ParentFrame.Width}if(a.HResMode==3&&a.WebForm.ResModeW!=1){var c=(a.WebForm.Modal>0?a.WebForm.FormWidth:RD3_DesktopManager.WebEntryPoint.FormsBox.clientWidth);if(c>b){b=c}}if(a.ListWidth>b){var e=a.ListBox.parentNode.scrollLeft;if(this.ListLeft>e+b){return true}else{if(this.ListLeft+this.ListWidth<e){return true}}}else{if(a.FixedColumns>0&&a.ScrollAreaBox&&this.ListBox&&this.ListBox.parentNode==a.ScrollAreaBox){var d=a.ScrollAreaBox.scrollLeft;if(this.ListLeft>d+b){return true}else{if(this.ListLeft+this.ListWidth<a.ScrollAreaBox.offsetLeft+d){return true}}}}return false};PField.prototype.UseFlashForUpload=function(){if(window.RD4_Enabled){return false}if(RD3_Glb.IsMobile()){return false}if(this.ChangeEventDef==RD3_Glb.EVENT_ACTIVE){if(RD3_Glb.IsFlashPresent()){return true}}return false};PField.prototype.UseHTML5ForUpload=function(){if(RD3_Glb.IsMobile()){return false}var a=RD3_ServerParams.UseHTML5Upload&&typeof FileReader!="undefined";if(this.DataType==10&&this.ChangeEventDef!=RD3_Glb.EVENT_ACTIVE){a=false}return a};PField.prototype.RenderMultiUpload=function(){var e=this;var d=null;if(this.InList&&this.InForm){d=(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST?this.ListCaptionBox:this.FormCaptionBox)}else{d=(this.InList?this.ListCaptionBox:this.FormCaptionBox)}if(!d){return}if(RD3_Glb.IsTouch()){var i=window.location.href;i+="?WCI=IWFiles";i+="&WCE="+this.ParentPanel.WebForm.Identifier;i+="&SESSIONID="+RD3_DesktopManager.WebEntryPoint.SessionID;var l=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1)+"uploadcomplete.htm";zUrl="fileupload://new?returnstatus=false";zUrl+="&posturl="+encodeURIComponent(i);zUrl+="&callbackurl="+encodeURIComponent(l);zUrl+="&purpose="+encodeURIComponent("Scegli una foto da caricare");zUrl+="&referrerName="+encodeURIComponent(RD3_DesktopManager.WebEntryPoint.MainCaption);this.MUPHeader=document.createElement("a");this.MUPHeader.href=zUrl;this.MUPHeader.innerHTML=this.Caption;d.appendChild(this.MUPHeader);RD3_Glb.AddClass(d,"mup-header-button");return}if(this.UseHTML5ForUpload()){if(!this.FormFlashUploader){this.FormFlashUploader=this.CreateHTML5Uploader(false);var g=this.Identifier+":jsuf";document.body.appendChild(this.FormFlashUploader);RD3_Glb.AddClass(d,"multi-js-upload");this.VisualStyle.ApplyMUPStyle(d,true);var k=function(m){e.OnHTML5UploadClick(m,g)};var a=function(m){e.OnHTML5Drop(m)};var f=function(m){e.OnHTML5Drag(m)};if(d.addEventListener){d.addEventListener("click",k,true);d.addEventListener("drop",a,true);d.addEventListener("dragover",f,true)}else{d.attachEvent("onclick",k);d.attachEvent("ondrop",a);d.addEventListener("ondragover",f)}}if(!this.ReqList){this.ReqList=new HashTable()}this.MUPHeader=document.createElement("span");this.MUPHeader.style.cursor="pointer";d.appendChild(this.MUPHeader);this.FileList=document.createElement("table");this.FileList.className="mup-table";this.FileList.FileItems=new HashTable(true);d.appendChild(this.FileList);var c=document.createElement("tbody");this.FileList.appendChild(c);return}d.style.overflowY="auto";this.FileList=document.createElement("table");this.FileList.className="mup-table";this.FileList.FileItems=new HashTable(true);d.appendChild(this.FileList);var c=document.createElement("tbody");this.FileList.appendChild(c);var h=document.createElement("tr");h.className="panel-field-caption-list";h.style.position="relative";this.VisualStyle.ApplyMUPStyle(h,true);c.appendChild(h);var b=document.createElement("td");b.className="mup-header-filename";h.appendChild(b);if(!this.FormFlashUploader){this.FormFlashUploader=this.CreateFlashUploader()}this.SelectFilesImg=this.FormFlashUploader.getMovieElement();this.SelectFilesImg.className="mup-header-button";if(RD3_ServerParams.Theme!=="zen"){this.SelectFilesImg.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/find.gif)"}RD3_TooltipManager.SetObjTitle(this.SelectFilesImg,ClientMessages.SWF_TP_SELECTFILES);b.appendChild(this.SelectFilesImg);this.MUPHeader=document.createElement("span");b.appendChild(this.MUPHeader);var b=document.createElement("td");b.className="mup-header-filesize";h.appendChild(b);if(RD3_Glb.IsIE()){b.innerText=ClientMessages.SWF_HD_FILESIZE}else{b.textContent=ClientMessages.SWF_HD_FILESIZE}var b=document.createElement("td");b.className="mup-header-button";h.appendChild(b);this.RemoveAllImg=document.createElement("img");this.RemoveAllImg.src=RD3_Glb.GetImgSrc("images/delete.gif");RD3_TooltipManager.SetObjTitle(this.RemoveAllImg,ClientMessages.SWF_TP_REMOVEALL);this.RemoveAllImg.style.display="none";this.RemoveAllImg.style.cursor="pointer";this.RemoveAllImg.onclick=function(m){e.SWFUpload_RemoveFile(m)};b.appendChild(this.RemoveAllImg);var b=document.createElement("td");b.className="mup-header-button";h.appendChild(b);this.UploadAllImg=document.createElement("img");this.UploadAllImg.src=RD3_Glb.GetImgSrc("images/upload.gif");RD3_TooltipManager.SetObjTitle(this.UploadAllImg,ClientMessages.SWF_TP_SENDALL);this.UploadAllImg.style.display="none";this.UploadAllImg.style.cursor="pointer";this.UploadAllImg.onclick=function(m){e.SWFUpload_StartUpload(m)};b.appendChild(this.UploadAllImg);var b=document.createElement("td");b.className="mup-header-button";h.appendChild(b);this.AbortAllImg=document.createElement("img");this.AbortAllImg.src=RD3_Glb.GetImgSrc("images/cancel.gif");RD3_TooltipManager.SetObjTitle(this.AbortAllImg,ClientMessages.SWF_TP_ABORTALL);this.AbortAllImg.style.display="none";this.AbortAllImg.style.cursor="pointer";this.AbortAllImg.onclick=function(m){e.SWFUpload_AbortUpload(m)};b.appendChild(this.AbortAllImg);var b=document.createElement("td");b.className="mup-header-filestatus";h.appendChild(b);var j=document.createElement("span");b.appendChild(j);if(RD3_Glb.IsIE(10,false)){j.innerText=ClientMessages.SWF_HD_FILESTATUS}else{j.textContent=ClientMessages.SWF_HD_FILESTATUS}};PField.prototype.AddFile=function(g){var c=this;var e=document.createElement("tr");this.VisualStyle.ApplyMUPStyle(e,false);e.FileID=this.UseHTML5ForUpload()?g:g.id;if(this.UseHTML5ForUpload()){e.setAttribute("id",g+":fi")}if(!this.UseHTML5ForUpload()){e.FileName=document.createElement("td");e.FileName.className="mup-row-filename";e.appendChild(e.FileName);if(RD3_Glb.IsIE()){e.FileName.innerText=g.name}else{e.FileName.textContent=g.name}e.FileSize=document.createElement("td");e.FileSize.className="mup-row-filesize";e.FileSize.style.textAlign="right";e.appendChild(e.FileSize);var f=g.size;var d={0:"B",1:"KB",2:"MB",3:"GB"};for(var a=0;a<=3;a++){if(g.size<Math.pow(1024,a+1)){f=Math.round(g.size/Math.pow(1024,a),0)+" "+d[a];break}}if(RD3_Glb.IsIE()){e.FileSize.innerText=f}else{e.FileSize.textContent=f}var h=document.createElement("td");h.className="mup-row-button";e.appendChild(h);e.RemoveImg=document.createElement("img");e.RemoveImg.src="images/delete_sm.gif";RD3_TooltipManager.SetObjTitle(e.RemoveImg,ClientMessages.SWF_TP_REMOVETHIS);e.RemoveImg.style.cursor="pointer";e.RemoveImg.onclick=function(b){c.SWFUpload_RemoveFile(b,e.FileID)};h.appendChild(e.RemoveImg);var h=document.createElement("td");h.className="mup-row-button";e.appendChild(h);e.UploadImg=document.createElement("img");e.UploadImg.src="images/upload.gif";RD3_TooltipManager.SetObjTitle(e.UploadImg,ClientMessages.SWF_TP_SENDTHIS);e.UploadImg.style.cursor="pointer";e.UploadImg.onclick=function(b){c.SWFUpload_StartUpload(b,e.FileID)};h.appendChild(e.UploadImg)}var h=document.createElement("td");h.className="mup-row-button";e.appendChild(h);e.AbortImg=document.createElement("img");e.AbortImg.src="images/cancel_sm.gif";RD3_TooltipManager.SetObjTitle(e.AbortImg,ClientMessages.SWF_TP_ABORTTHIS);if(!this.UseHTML5ForUpload()){e.AbortImg.style.display="none"}e.AbortImg.style.cursor="pointer";e.AbortImg.onclick=function(b){c.SWFUpload_AbortUpload(b,e.FileID)};h.appendChild(e.AbortImg);if(this.UseHTML5ForUpload()){e.AbortImg.setAttribute("id",g+":abort")}e.FileStatus=document.createElement("td");e.FileStatus.className="mup-row-filestatus"+(this.UseHTML5ForUpload()?"-js":"");e.appendChild(e.FileStatus);if(this.UseHTML5ForUpload()){e.FileStatus.setAttribute("id",g+":status")}this.FileList.childNodes[0].appendChild(e);this.FileList.FileItems.add(e.FileID,e);return e};PField.prototype.RemoveFile=function(a){var b=this.FileList.FileItems[a];this.FileList.childNodes[0].removeChild(b);this.FileList.FileItems.remove(a)};PField.prototype.CreateFlashUploader=function(){var d=document.createElement("div");document.body.appendChild(d);var b={flash_url:"swfupload/swfupload.swf",file_size_limit:this.MaxUploadSize+" B",file_upload_limit:this.MaxUploadFiles,file_types:this.UploadExtensions,button_placeholder:d,button_cursor:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,swfupload_loaded_handler:SWFUpload_OnLoaded,file_dialog_start_handler:SWFUpload_OnDialogStart,file_queued_handler:SWFUpload_OnFileQueued,file_queue_error_handler:SWFUpload_OnFileQueueError,file_dialog_complete_handler:SWFUpload_OnFileDialogComplete,upload_start_handler:SWFUpload_OnUploadStart,upload_progress_handler:SWFUpload_OnUploadProgress,upload_error_handler:SWFUpload_OnUploadError,upload_success_handler:SWFUpload_OnUploadSuccess,upload_complete_handler:SWFUpload_OnUploadComplete};var a=window.location.href.substring(0,window.location.href.length-window.location.search.length);a+="?WCI="+(this.MultiUpload?"IWFiles":"IWUpload");if(this.MultiUpload){a+="&WCE="+this.ParentPanel.WebForm.Identifier}else{a+="&WCE="+this.Identifier}a+="&SESSIONID="+RD3_DesktopManager.WebEntryPoint.SessionID;b.upload_url=a;var c=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);if(this.MultiUpload){b.button_image_url=c+"images/find_sprite.gif";b.button_action=SWFUpload.BUTTON_ACTION.SELECT_FILES;if(RD3_ServerParams.Theme=="seattle"){b.button_width="22";b.button_height="22"}else{if(RD3_ServerParams.Theme=="zen"){b.button_width="20";b.button_height="20"}else{b.button_width="26";b.button_height="28"}}}else{b.button_image_url=c+"images/upload_sprite.gif";b.button_action=SWFUpload.BUTTON_ACTION.SELECT_FILE;b.button_width="18";b.button_height="18"}if(this.UploadDescription.length>0){b.file_types_description=this.UploadDescription}FlashUploader=new SWFUpload(b);FlashUploader.ParentField=this;return FlashUploader};PField.prototype.CreateHTML5Uploader=function(d){var c=document.createElement("input");var b=this.Identifier+":jsu"+(d?"l":"f");c.setAttribute("id",b);c.setAttribute("type","file");c.style.display="none";var a=this;c.onchange=function(e){a.OnHTML5Upload(e,b)};if(this.MultiUpload){c.setAttribute("multiple","1")}if(this.UploadExtensions!="*.*"){c.setAttribute("accept",this.UploadExtensions)}return c};function SWFUpload_OnLoaded(){}function SWFUpload_OnDialogStart(){this.MsgFileNotQueued=""}function SWFUpload_OnFileQueueError(e,g,f){var c="";switch(g){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:c=ClientMessages.SWF_ER_QUEUEEXCEEDED;break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:var h=this.ParentField.MaxUploadSize;var d={0:"B",1:"KB",2:"MB",3:"GB"};for(var a=0;a<=3;a++){if(this.ParentField.MaxUploadSize<Math.pow(1024,a+1)){h=Math.round(this.ParentField.MaxUploadSize/Math.pow(1024,a),0)+" "+d[a];break}}c=ClientMessages.SWF_ER_FILESIZEEXCEEDED+" (max "+h+")";break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:c=ClientMessages.SWF_ER_ZEROBYTEFILE;break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:c=ClientMessages.SWF_ER_INVALIDFILETYPE;break;default:c=ClientMessages.SWF_ER_UNHANDLED;break}c+=(g.length>0?" "+g:"");c+=(f.length>0?": "+f:"");if(this.ParentField.DataType==10){this.MsgFileNotQueued+=c}if(this.ParentField.MultiUpload){this.MsgFileNotQueued+="<tr><td><b>"+(e?e.name:"")+"</b></td>";this.MsgFileNotQueued+="<td>"+c+"</td></tr>"}}function SWFUpload_OnFileQueued(b){if(this.ParentField.MultiUpload){var a=this.ParentField.AddFile(b);a.file=b;if(RD3_Glb.IsIE()){a.FileStatus.innerText=ClientMessages.SWF_FS_READY}else{a.FileStatus.textContent=ClientMessages.SWF_FS_READY}}}function SWFUpload_OnFileDialogComplete(d,e,c){if(d>e){if(this.ParentField.DataType==10){this.MsgFileNotQueued=ClientMessages.SWF_ER_FILENOTSEND+"<br>"+this.MsgFileNotQueued}if(this.ParentField.MultiUpload){var b="";if(d-e==1){b=ClientMessages.SWF_ER_FILENOTQUEUED}else{b=ClientMessages.SWF_ER_FILESNOTQUEUED}this.MsgFileNotQueued=b+"<br><table>"+this.MsgFileNotQueued+"</table>"}var a=new MessageBox(this.MsgFileNotQueued,RD3_Glb.MSG_BOX,false);a.Open()}if(e>0){if(this.ParentField.DataType==10){this.startUpload()}if(this.ParentField.MultiUpload){this.ParentField.RemoveAllImg.style.display="";this.ParentField.UploadAllImg.style.display="";if(this.ParentField.ChangeEventDef==RD3_Glb.EVENT_ACTIVE){this.ParentField.SWFUpload_StartUpload()}}}}function SWFUpload_OnUploadStart(c){if(this.ParentField.DataType==10){var d=RD3_Glb.FormatMessage(ClientMessages.SWF_MG_UPLOADING,c.name);RD3_DesktopManager.WebEntryPoint.DelayDialog.SetCanAbort(true);RD3_DesktopManager.WebEntryPoint.DelayDialog.Open(d,RD3_Glb.PROGRESS);RD3_DesktopManager.WebEntryPoint.DelayDialog.FlashUploading=this}if(this.ParentField.MultiUpload){var b=this.ParentField.FileList.FileItems[c.id];this.ParentField.AbortAllImg.style.display="";b.AbortImg.style.display="";b.UploadImg.style.display="none";b.FileStatus.style.backgroundPosition="-400px";if(RD3_Glb.IsIE()){b.FileStatus.innerText=ClientMessages.SWF_FS_UPLOADING}else{b.FileStatus.textContent=ClientMessages.SWF_FS_UPLOADING}this.ParentField.FileUploading=c.id;var a=(this.ParentField.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST?this.ParentField.ListCaptionBox:this.ParentField.FormCaptionBox);if(b.offsetTop<a.scrollTop){a.scrollTop=b.offsetTop-b.offsetHeight}else{if(b.offsetTop+b.offsetHeight>a.scrollTop+a.offsetHeight){a.scrollTop=b.offsetTop+(2*b.offsetHeight)-a.offsetHeight}}}}function SWFUpload_OnUploadProgress(c,e,d){if(this.ParentField.DataType==10){RD3_DesktopManager.WebEntryPoint.DelayDialog.SetProgress(Math.ceil(e*100/d))}if(this.ParentField.MultiUpload){var a=this.ParentField.FileList.FileItems[c.id];var b=Math.ceil(e*100/d);var f=-400+(b*a.FileStatus.clientWidth/100);a.FileStatus.style.backgroundPosition=f+"px";if(RD3_Glb.IsIE()){a.FileStatus.innerText=ClientMessages.SWF_FS_UPLOADING+" "+b+"%"}else{a.FileStatus.textContent=ClientMessages.SWF_FS_UPLOADING+" "+b+"%"}}}function SWFUpload_OnUploadSuccess(c,b,a){if(b&&b.length>0){if(b.charCodeAt(0)==65279){b=b.substring(1)}if(this.ParentField.DataType==10){RD3_DesktopManager.WebEntryPoint.OnBlobUpload(b)}if(this.ParentField.MultiUpload){RD3_DesktopManager.ProcessXmlText(b)}}}function SWFUpload_OnUploadError(f,h,g){var e="";switch(h){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:e=ClientMessages.SWF_ER_HTTPERROR;break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:e=ClientMessages.SWF_ER_UPLOADFAILED;break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:e=ClientMessages.SWF_ER_IO_ERROR;break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:e=ClientMessages.SWF_ER_SECURITY_ERROR;break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:e=ClientMessages.SWF_ER_UPLOADEXCEEDED;break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:e=ClientMessages.SWF_ER_VALIDATIONFAILED;break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:e=ClientMessages.SWF_ER_FILECANCELLED;break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:e=ClientMessages.SWF_ER_UPLOADSTOPPED;break;default:e=ClientMessages.SWF_ER_UNHANDLED;break}if(this.ParentField.DataType==10){var c=ClientMessages.SWF_ER_FILENOTSEND+"<br>";c+=e;c+=(h.length>0?" "+h:"");c+=(g.length>0?": "+g:"");var b=new MessageBox(c,RD3_Glb.MSG_BOX,false);b.Open()}if(this.ParentField.MultiUpload){var d=this.ParentField.FileList.FileItems[f.id];if(d){var a=e;a+=(h.length>0?" "+h:"");a+=(g.length>0?": "+g:"");if(RD3_Glb.IsIE()){d.FileStatus.innerText=a}else{d.FileStatus.textContent=a}}}}function SWFUpload_OnUploadComplete(e){if(this.ParentField.DataType==10){RD3_DesktopManager.WebEntryPoint.DelayDialog.Close();RD3_DesktopManager.WebEntryPoint.DelayDialog.FlashUploading=null}if(this.ParentField.MultiUpload){var a=this.ParentField.FileList.FileItems[e.id];if(e.filestatus==SWFUpload.FILE_STATUS.COMPLETE){if(RD3_Glb.IsIE()){a.FileStatus.innerText=ClientMessages.SWF_FS_SEND}else{a.FileStatus.textContent=ClientMessages.SWF_FS_SEND}}else{if(e.filestatus==SWFUpload.FILE_STATUS.QUEUED){a.UploadImg.style.display="";if(RD3_Glb.IsIE()){a.FileStatus.innerText=ClientMessages.SWF_FS_STOPPED}else{a.FileStatus.textContent=ClientMessages.SWF_FS_STOPPED}}}a.FileStatus.style.backgroundPosition="-400px";a.file=e;a.AbortImg.style.display="none";var d=this.getStats();if(d.files_queued==0){this.ParentField.UploadAllImg.style.display="none";this.ParentField.AbortAllImg.style.display="none";this.ParentField.FileUploading=null}else{if(this.ParentField.UploadAll){var c=false;this.ParentField.UploadAll=false;for(var b=0;b<this.ParentField.FileList.FileItems.length;b++){var a=this.ParentField.FileList.FileItems.GetItem(b);if(c){if(a.file.filestatus==SWFUpload.FILE_STATUS.QUEUED){this.startUpload(a.FileID);this.ParentField.UploadAll=true;break}}if(!c&&a.FileID==e.id){c=true}}}}if(!this.ParentField.UploadAll){this.ParentField.AbortAllImg.style.display="none"}}}PField.prototype.SWFUpload_StartUpload=function(d,a){if(this.FileUplading>0){return}if(a){this.UploadAll=false;this.FormFlashUploader.startUpload(a)}else{this.UploadAll=true;for(var c=0;c<this.FileList.FileItems.length;c++){var b=this.FileList.FileItems.GetItem(c);if(b.file.filestatus==SWFUpload.FILE_STATUS.QUEUED){this.FormFlashUploader.startUpload(b.FileID);break}}}};PField.prototype.SWFUpload_RemoveFile=function(c,a){if(a){this.SWFUpload_AbortUpload(c,a);this.FormFlashUploader.cancelUpload(a);this.RemoveFile(a)}else{while(this.FileList.FileItems.length>0){var b=this.FileList.FileItems.GetItem(0);if(this.FormFlashUploader.getFile(b.FileID)){this.SWFUpload_AbortUpload(c,a);this.FormFlashUploader.cancelUpload(b.FileID)}this.RemoveFile(b.FileID)}}if(this.FileList.FileItems.length==0){this.UploadAllImg.style.display="none";this.RemoveAllImg.style.display="none"}};PField.prototype.SWFUpload_AbortUpload=function(c,a){if(this.UseHTML5ForUpload()){var b=this.ReqList[a];if(b){b.abort()}this.HTML5UploadComplete(a);RD3_Glb.StopEvent(c);return false}if(a){if(this.FileUploading==a){this.FormFlashUploader.stopUpload(a)}}else{if(this.FileUploading){this.FormFlashUploader.stopUpload(this.FileUploading)}this.UploadAll=false}};PField.prototype.SWFUpload_Destroy=function(g){try{try{g.cancelUpload(null,false)}catch(f){}var a=g.getMovieElement();if(a&&typeof(a.CallFunction)==="unknown"){for(var d in a){try{if(typeof(a[d])==="function"){a[d]=null}}catch(e){}}try{a.parentNode.removeChild(a)}catch(c){}}window[g.movieName]=null;SWFUpload.instances[g.movieName]=null;delete SWFUpload.instances[g.movieName];g.movieElement=null;g.settings=null;g.customSettings=null;g.eventQueue=null;g.movieName=null;return true}catch(b){return false}};PField.prototype.GetTooltip=function(e,f){if(f==this.FormCaptionBox||f==this.ListCaptionBox||(f.parentNode&&f.parentNode==this.FormCaptionBox&&f.tagName=="SPAN")||(f.parentNode&&f.parentNode==this.ListCaptionBox&&f.tagName=="SPAN")){if(this.Tooltip==""){return false}if(this.Header==""){e.SetImage("")}else{e.SetTitle(this.Header)}e.SetText(this.Tooltip);e.SetAutoAnchor(true);e.SetPosition(2);return true}var d=false;if(f==this.ListBlobUploadImg||f==this.FormBlobUploadImg){e.SetTitle(ClientMessages.TIP_TITLE_CaricaDoc);e.SetText(RD3_ServerParams.CaricaDoc);d=true}else{if(f==this.ListBlobDeleteImg||f==this.FormBlobDeleteImg){e.SetTitle(ClientMessages.TIP_TITLE_CancellaDoc);e.SetText(RD3_ServerParams.CancellaDoc);d=true}else{if(f==this.ListBlobZoomImg||f==this.FormBlobZoomImg){e.SetTitle(ClientMessages.TIP_TITLE_VisualizzaDocumento);e.SetText(RD3_ServerParams.VisualizzaDocumento);d=true}else{if(this.MultiUpload){if(f==this.SelectFilesImg){e.SetTitle(ClientMessages.SWF_TT_SELECTFILES);e.SetText(ClientMessages.SWF_TP_SELECTFILES);d=true}else{if(f==this.RemoveAllImg){e.SetTitle(ClientMessages.SWF_TT_REMOVEALL);e.SetText(ClientMessages.SWF_TP_REMOVEALL);d=true}else{if(f==this.UploadAllImg){e.SetTitle(ClientMessages.SWF_TT_SENDALL);e.SetText(ClientMessages.SWF_TP_SENDALL);d=true}else{if(f==this.AbortAllImg){e.SetTitle(ClientMessages.SWF_TT_ABORTALL);e.SetText(ClientMessages.SWF_TP_ABORTALL);d=true}else{if(this.FileList){for(var c=0;c<this.FileList.FileItems.length;c++){var b=this.FileList.FileItems.GetItem(c);if(f==b.RemoveImg){e.SetTitle(ClientMessages.SWF_TT_REMOVETHIS);e.SetText(ClientMessages.SWF_TP_REMOVETHIS);d=true}else{if(f==b.RemoveImg){e.SetTitle(ClientMessages.SWF_TT_SENDTHIS);e.SetText(ClientMessages.SWF_TP_SENDTHIS);d=true}else{if(f==b.RemoveImg){e.SetTitle(ClientMessages.SWF_TT_ABORTTHIS);e.SetText(ClientMessages.SWF_TP_ABORTTHIS);d=true}}}}}}}}}}}}}if(d){e.SetAnchor(RD3_Glb.GetScreenLeft(f)+(f.offsetWidth/2),RD3_Glb.GetScreenTop(f));e.SetPosition(0);return true}var a=this.GetCurrentCell(0,f);if(a){return a.GetTooltip(e,f)}return false};PField.prototype.VisCanSort=function(){return this.VisualFlags&1};PField.prototype.VisOnlyIcon=function(){return this.VisualFlags&8};PField.prototype.VisShowActivator=function(){return this.VisualFlags&16};PField.prototype.VisHyperLink=function(a){return(this.VisualFlags&128)||(a&&a.HasHyperLink())};PField.prototype.VisSlidePad=function(){return(this.VisualFlags&64)==0||RD3_Glb.IsSmartPhone()};PField.prototype.UsePopupControl=function(){return(this.VisualFlags&64)&&!this.ValueList&&(RD3_Glb.IsDateOrTimeObject(this.DataType)||RD3_Glb.IsNumericObject(this.DataType))};PField.prototype.AutoTab=function(){return(this.VisualFlags&512)};PField.prototype.UseWatermarkAsNull=function(){return(this.VisualFlags&1024)};PField.prototype.HandlesTabOrder=function(){return(this.VisualFlags&2048)};PField.prototype.GetPopupControlType=function(){switch(this.DataType){case 6:return RD3_Glb.CTRL_DATE;case 7:return RD3_Glb.CTRL_TIME;case 8:return RD3_Glb.CTRL_DATETIME;case 1:case 2:case 3:case 4:return RD3_Glb.CTRL_KEYNUM}};PField.prototype.IsDraggable=function(c){var b=(c&&c.length>3)?c.substring(c.length-3):"";if(this.ListList&&b==":lc"&&this.ParentPanel.CanReorderColumn){return true}else{var a=this.DragObj(c);return this.ParentPanel.CanDrag&&!a.IsEnabled&&(c.indexOf(":lv")>0||c.indexOf(":fv")>0)}};PField.prototype.DropElement=function(){return this.ListCaptionBox};PField.prototype.GetDropList=function(){var a=new Array();this.ParentPanel.ComputeDropList(a,this);return a};PField.prototype.OnDrop=function(a,b){this.ParentPanel.ChangeListConfiguration(a,this,b);return true};PField.prototype.IsTransformable=function(b){var a=(b&&b.length>3)?b.substring(b.length-3):"";if(this.ListList&&a==":lc"&&this.ParentPanel.CanResizeColumn){return true}else{return false}};PField.prototype.CanResizeW=function(){return true};PField.prototype.CanResizeH=function(){return false};PField.prototype.CanResizeL=function(){return false};PField.prototype.CanResizeR=function(){return true};PField.prototype.IsMoveable=function(){return false};PField.prototype.ApplyCursor=function(b){var a=b;if(a=="move"||a==""){a=this.CanSort?"pointer":""}this.ListCaptionBox.style.cursor=a};PField.prototype.OnTransform=function(a,i,b,c,g){var f=new Rect(a,i,b,c);this.VisualStyle.AdaptCaptionRect(f,true,true);var e=b>f.w?b+(b-f.w):b;e=e<50?50:Math.ceil(e);if(e==this.ListWidth){return}var d=new IDEvent("rescol",this.Identifier,g,RD3_Glb.EVENT_ACTIVE,"",e);if(d.ClientSide){this.SetListWidth(e,false);this.ParentPanel.AfterProcessResponse()}};PField.prototype.OnDoubleClick=function(h){var o=(window.event)?h.srcElement:h.explicitOriginalTarget;if(o.getAttribute("id")=="resize-object"){o=RD3_DDManager.MD_Target}if(!o){return true}var f=RD3_Glb.GetRD3ObjectId(o);var b=(f&&f.length>3)?f.substring(f.length-3):"";var j=RD3_Glb.GetScreenLeft(o)+o.clientWidth;if(this.ListList&&b==":lc"&&this.ListNumRows==1&&(j-h.clientX<=RD3_ClientParams.ResizeLimit)&&this.ParentPanel.CanResizeColumn){var g=new Array();var c=this.PValues.length;var a=false;for(var e=1;e<c;e++){var l=this.PValues[e];if(l){g.push("<span>");g.push(l.Text);g.push("</span><br/>");if(!a&&l.ActivatorImage(l.GetVisualStyle())!=""){a=true}}else{continue}}var m=document.createElement("div");m.innerHTML=g.join("");var d=m.style;d.position="absolute";d.top="0px";d.left="0px";d.overflow="auto";document.body.appendChild(m);var k=m.clientWidth;document.body.removeChild(m);if(a){k+=this.ActWidth+2}this.OnTransform(this.ListLeft,this.ListTop,k,this.ListHeight,h)}return true};PField.prototype.DragObj=function(c){if(c!=undefined&&(c.indexOf(":lv")>0||c.indexOf(":fv")>0)){if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM){return this.PFormCell}else{var a=c.indexOf(":lv");var b=parseInt(c.substr(a+3));return this.PListCells[b]}}else{return this}};PField.prototype.ComputeDropList=function(c,a){if(!this.Realized){return}if(a instanceof PField){if(this.ListList&&this.ParentPanel.CanReorderColumn&&a!=this){if(this.IsHidden()){return}c.push(this);this.AbsLeft=RD3_Glb.GetScreenLeft(this.ListCaptionBox,true);this.AbsTop=RD3_Glb.GetScreenTop(this.ListCaptionBox,true);this.AbsRight=this.AbsLeft+this.ListCaptionBox.offsetWidth-1;this.AbsBottom=this.AbsTop+this.ListCaptionBox.offsetHeight-1}return}if(!this.ParentPanel.CanDrop||this.IsHidden()||this.IsStatic()){return}if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM){this.PFormCell.ComputeDropList(c,a)}else{var d=this.PListCells.length;for(var b=0;b<d;b++){this.PListCells[b].ComputeDropList(c,a)}}};PField.prototype.IsFirstListList=function(){if(!(this.InList&&this.ListList)){return false}var c=this.ParentPanel;var d=c.Fields.length;for(var a=0;a<d;a++){var b=c.Fields[a];if(c.AdvTabOrder){b=c.ListTabOrder[a]}if(b&&b.InList&&b.ListList&&b.IsVisible()){return(b==this)}}return false};PField.prototype.PListGetFocus=function(c){var d=c.id;if(!(this.InList&&this.ListList)||!this.ParentPanel.IsGrouped()||this.ParentPanel.PanelMode!=RD3_Glb.PANEL_LIST){return}for(var b=0;b<this.PListCells.length;b++){var a=this.PListCells[b];if(a&&a.GroupId&&a.GroupId==d){this.ParentPanel.SetActualRow(b);this.ParentPanel.SetStatusBarText();return}}};PField.prototype.setPListGroupPosition=function(){if(!this.DelayedUpdate){var b=this.PListCells.length;for(var a=0;a<b;a++){this.PListCells[a].EnlargeCell=true;this.PListCells[a].UpdateDims()}}};PField.prototype.GotFocusCK=function(b){var a=null;if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.ListList){var c=b.RowNumber;if(this.ParentPanel.Status==RD3_Glb.PS_QBE&&c!=0){return}this.ParentPanel.ChangeActualRow(c,evento);a=this.PListCells[c]}else{if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.PListCells){a=this.PListCells[0]}else{a=this.PFormCell}}if(a){a.SetActive()}};PField.prototype.KeyPressCKEditor=function(c,b){if(b){var a=this;var d=function(e){a.SendtextSelChange(e,b)};if(RD3_KBManager.SelTextTimer){window.clearTimeout(RD3_KBManager.SelTextTimer)}RD3_KBManager.SelTextTimer=window.setTimeout(d,50);RD3_KBManager.SelTextSrc=null;RD3_KBManager.SelTextObj=null}};PField.prototype.SendtextSelChange=function(l,b){if(b){var e=CKEDITOR.instances[b];if(e&&e.getSelection()&&e.getSelection().getType()==CKEDITOR.SELECTION_TEXT&&e.getSelection().getRanges().length>0){var a=e.getSelection().getRanges()[0].startOffset;var g=e.getSelection().getRanges()[0].endOffset;var h=this.StartSel;var m=this.EndSel;if(h!=a||m!=g){var j=new IDEvent("txtsel",this.Identifier,null,this.ParentPanel.TextSelEventDef,"",a,g,"","",this.ParentPanel.TextSelEventDef==RD3_Glb.EVENT_ACTIVE?250:600000,true);this.StartSel=a;this.EndSel=g}}}else{var f=null;if(l.tagName){f=l}else{f=(window.event)?window.event.srcElement:l.explicitOriginalTarget}if(f==null||!this.UseTextSel||this.ParentPanel.Status==RD3_Glb.PS_QBE){return}while(f&&!f.id){f=f.parentNode}var k=null;if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.ListList){var c=this.PListCells.length;for(var d=0;d<c;d++){if(this.PListCells[d].GetDOMObj(true)==f){k=this.PListCells[d];break}}}else{if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.PListCells){k=this.PListCells[0]}else{k=this.PFormCell}}if(k&&(k.ControlType==2||k.ControlType==101)){var a=-1;var g=-1;if(k.ControlType==2){if(k.NumRows>1){a=RD3_Glb.getTextAreaSelection(k.GetDOMObj(),false);g=RD3_Glb.getTextAreaSelection(k.GetDOMObj(),true)}else{a=getCursorPos(k.GetDOMObj());g=RD3_Glb.getSelEnd(k.GetDOMObj())}}var h=this.StartSel;var m=this.EndSel;if(h!=a||m!=g){var j=new IDEvent("txtsel",this.Identifier,null,this.ParentPanel.TextSelEventDef,"",a,g,"","",this.ParentPanel.TextSelEventDef==RD3_Glb.EVENT_ACTIVE?250:600000,true);this.StartSel=a;this.EndSel=g}}}};PField.prototype.ShowDescription=function(a){if(this.VisOnlyIcon()){return false}if(a){return a.ShowDescription()}return true};PField.prototype.CellMustHaveWaterMark=function(d,e,c,b,a){if(this.WaterMark==""||!d){return false}if(e&&!RD3_Glb.IsMobile()){return false}if(a.Mask&&a.GetDOMObj(false).value!=""&&a.GetDOMObj(false).value==GetInitValue(a.Mask,a.MaskType)){return false}if(c&&this.ListList){return b==this.ParentPanel.TotalRows+1}return true};PField.prototype.DoHighlightDelete=function(b){if(!this.ParentPanel.HighlightDelete){return}var a=null;if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST){a=this.PListCells[this.ListList?this.ParentPanel.ActualRow:0].GetDOMObj()}else{a=this.PFormCell.GetDOMObj()}if(b){this.HLDelObject=document.createElement("DIV");this.HLDelObject.className="panel-highlight-delete";this.HLDelObject.style.left="0px";this.HLDelObject.style.top="0px";this.HLDelObject.style.width=(a.clientWidth-2*RD3_ClientParams.HLDBorderWidth)+"px";this.HLDelObject.style.height=(a.clientHeight-2*RD3_ClientParams.HLDBorderWidth)+"px";a.appendChild(this.HLDelObject)}else{a.removeChild(this.HLDelObject);this.HLDelObject=undefined}};PField.prototype.ApplyDynPropToVisualStyle=function(d){if(this.BackColor!=""||this.ForeColor!=""){d.OldColor=new Array();var c=d.Color.length;for(var a=0;a<c;a++){d.OldColor[a]=d.Color[a]}if(this.BackColor!=""){d.Color[4]=this.BackColor}if(this.ForeColor!=""){d.Color[1]=this.ForeColor}}if(this.FontMod!=""){d.OldFont=new Array();var c=d.Font.length;for(var a=0;a<c;a++){d.OldFont[a]=d.Font[a]}var b=d.GetFont(1).split(",");b[1]=this.FontMod;d.Font[1]=b.join(",")}if(this.Alignment!=-1){d.OldAlign=new Array();for(var a=0;a<d.Alignments.length;a++){d.OldAlign[a]=d.Alignments[a]}d.Alignments[1]=this.Alignment}};PField.prototype.CleanVisualStyle=function(a){if(a.OldColor!=undefined){a.Color=a.OldColor;a.OldColor=undefined}if(a.OldFont!=undefined){a.Font=a.OldFont;a.OldFont=undefined}if(a.OldAlign!=undefined){a.Alignments=a.OldAlign;a.OldAlign=undefined}};PField.prototype.UpdateVisualStyle=function(g){var c=this.IsRightAligned();var b=this.IsStatic();var f=!this.Optional&&this.ParentPanel.Status!=RD3_Glb.PS_QBE&&!this.ParentPanel.Locked&&!b;var a=(b&&(this.BackColor!=""||this.ForeColor!=""||this.FontMod!=""||this.Alignment!=-1));if(this.ListCaptionBox){if(this.ListList){var e=c?"right":"left";g.ApplyValueStyle(this.ListCaptionBox,true,!b,false,false,false,false,false,e,false,f);var d=this.Alignment;if(d==1||d==-1){d=g.GetAlignment(!b?2:1)}switch(d){case 2:e="left";break;case 3:e="center";break;case 4:e="right";break;case 5:e="justify";break}if(e!=this.ListCaptionBox.style.textAlign){this.ListCaptionBox.style.textAlign=e}}else{if(a){this.ListCaptionBox.setAttribute("vsign","");this.ApplyDynPropToVisualStyle(g)}var e=(c&&this.HdrListAbove)?"right":"left";g.ApplyValueStyle(this.ListCaptionBox,false,!b,false,false,false,false,false,e,false,f,false,false,this.IsButton());if(a){this.CleanVisualStyle(g)}if(RD3_Glb.IsMobile7()&&this.IsButton()&&this.ForeColor!=""){this.ListCaptionBox.style.setProperty("color",this.ForeColor,"important")}}}if(this.FormCaptionBox){if(a){this.FormCaptionBox.setAttribute("vsign","");this.ApplyDynPropToVisualStyle(g)}var e=(c&&this.HdrFormAbove)?"right":"left";if(this.HdrFormAbove){var d=this.Alignment;if(d==1||d==-1){d=g.GetAlignment(!b?2:1)}switch(d){case 2:e="left";break;case 3:e="center";break;case 4:e="right";break;case 5:e="justify";break}}g.ApplyValueStyle(this.FormCaptionBox,false,!b,false,false,false,false,false,e,false,f,false,false,this.IsButton());if(a){this.CleanVisualStyle(g)}if(RD3_Glb.IsMobile7()&&this.IsButton()&&this.ForeColor!=""){this.FormCaptionBox.style.setProperty("color",this.ForeColor,"important")}}};PField.prototype.AfterProcessResponse=function(){var c=this.PValues.length;for(var b=0;b<c;b++){if(this.PValues[b]){this.PValues[b].AfterProcessResponse()}}if(this.DoOpenCombo){this.DoOpenCombo=false;var a=this.GetCurrentCell();if(!a){return}if(!a.IsEnabled&&!this.ActivableDisabled){return}if(a.ControlType==3&&a.IntCtrl){a.IntCtrl.OpenComboForced()}}};PField.prototype.BLOBImageReadyStateChanged=function(c){var b=(window.event)?window.event.srcElement:c.explicitOriginalTarget;if(RD3_Glb.IsIE(10,true)){b=c.srcElement}b=b.parentNode;var a=RD3_KBManager.GetCell(b);if(a){a.ResizeBLOBImage()}};PField.prototype.OnTouchDown=function(e,b){if(this.IsButton()||(this.VisHyperLink(this.VisualStyle)&&this.VisShowActivator())){var d=this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST?this.ListCaptionBox:this.FormCaptionBox;RD3_Glb.AddClass(d,"button-hover");if(!RD3_Glb.IsMobile7()){var a="-webkit-gradient(linear, 0% 0%, 0% 100%, from("+RD3_ClientParams.GetColorHL1()+"), to("+RD3_ClientParams.GetColorHL2()+"))";if(RD3_Glb.IsIE(10,true)){a="linear-gradient(180deg, "+RD3_ClientParams.GetColorHL1()+", "+RD3_ClientParams.GetColorHL2()+")"}if(this.VisShowActivator()&&this.IsButton()){d.setAttribute("OldBkgImage",d.style.backgroundImage);d.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/detailw.png), "+a;d.style.backgroundPosition=(d.offsetWidth-27)+"px 50%, 0% 0%"}else{d.setAttribute("OldBkgImage",d.style.backgroundImage);this.ApplyBackgroundImage(d.style,a)}this.ParentPanel.hilitedButton=this}}if(!this.IsStatic()&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&this.PFormCell&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&this.PFormCell.PValue){var c=(this.PFormCell.IntCtrl.ComboInput?this.PFormCell.IntCtrl.ComboInput:this.PFormCell.IntCtrl);if(c instanceof IDEditor){c=c.GetDOMObj()}return this.PFormCell.PValue.OnTouchDown(e,b,c)}else{this.ParentPanel.OnTouchDown(e)}return true};PField.prototype.OnTouchUp=function(e,b){if(!this.IsStatic()&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&this.PFormCell&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM&&this.PFormCell.PValue){var d=(this.PFormCell.IntCtrl.ComboInput?this.PFormCell.IntCtrl.ComboInput:this.PFormCell.IntCtrl);if(d instanceof IDEditor){d=d.GetDOMObj()}return this.PFormCell.PValue.OnTouchUp(e,b,d)}else{this.ParentPanel.OnTouchUp(e,b)}if(b){if(RD3_Glb.IsAndroid()||(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsTouch())){RD3_DDManager.ChompClick()}if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST||this.IsStatic()){this.OnClickCaption(e)}if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM){if(this.IsCombo()&&this.PFormCell&&this.PFormCell.IsEnabled){this.PFormCell.IntCtrl.Open()}}}else{if(this.ParentPanel.HilitedCombo){this.ParentPanel.HilitedCombo.HiliteCombo(null,false)}}if(this.IsButton()||this.VisHyperLink(this.VisualStyle)){var c=this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST?this.ListCaptionBox:this.FormCaptionBox;RD3_Glb.RemoveClass(c,"button-hover");if(c.hasAttribute("OldBkgImage")||this.Image!=""){if(this.VisShowActivator()&&this.IsButton()){c.style.backgroundImage="";c.style.backgroundPosition=""}var a=c.getAttribute("OldBkgImage");c.removeAttribute("OldBkgImage");a=this.Image!=""?"":a;this.ApplyBackgroundImage(c.style,a);if(this.ParentPanel.hilitedButton==this){delete this.ParentPanel.hilitedButton}}}return true};PField.prototype.OnToggleCheck=function(d){var c=d.target;if(RD3_Glb.IsIE(10,true)){c=d.srcElement}while(c.className.substr(0,9)=="radio-int"){c=c.parentNode}if(c.firstChild&&c.firstChild.className=="panel-value-check"){c=c.firstChild}if(c.tagName=="SPAN"){c=c.parentNode}var b=RD3_KBManager.GetObject(c,true);if(!b||!b.IsEnabled()){return}c.checked=!c.checked;if(RD3_Glb.IsQuadro()){var e=c.firstChild;RD3_Glb.SetTransitionDuration(e,"200ms");var a="translate3d("+(c.checked?0:-53)+"px, 0px, 0px)";RD3_Glb.SetTransform(e,a);RD3_Glb.AddEndTransaction(e,this.ea,false)}else{RD3_Glb.SetTransitionDuration(c,"200ms");c.style.backgroundPosition=(c.checked?"0%":"100%")+" -27px";RD3_Glb.AddEndTransaction(c,this.ea,false)}if(b.OnChange){RD3_DesktopManager.CallEventHandler(b.Identifier,"OnChange",d)}};PField.prototype.OnThreeStateCheck=function(b){if(this.ParentPanel.Status!==RD3_Glb.PS_QBE||RD3_Glb.IsIE(10,false)||RD3_Glb.IsSafari(5)){return}var a=b.target;if(RD3_Glb.IsIE(10,true)){a=b.srcElement}switch(a.getAttribute("checkstatus")){case"0":a.setAttribute("checkstatus","1");a.indeterminate=true;break;case"1":a.setAttribute("checkstatus","2");a.indeterminate=false;a.checked=false;break;default:a.setAttribute("checkstatus","0");a.indeterminate=false;a.checked=true;break}};PField.prototype.OnEndAnimation=function(b){var a=b.target;RD3_Glb.SetTransitionDuration(a,"0ms");RD3_Glb.RemoveEndTransaction(a,this.ea,false)};PField.prototype.HiliteCombo=function(d,g){var f=this;var b=f.ParentPanel;if(!g&&b.HilitedCombo){var a=b.HilitedCombo;b.HilitedCombo=null;a.HiliteCombo(null,g);return}var h=null;if(d==null){h=this.PFormCell}else{h=RD3_KBManager.GetCell(d)}if(h==null){return}if(g){if(b.HilitedCombo){b.HilitedCombo.HiliteCombo(null,false)}b.HilitedCombo=this;if(f.FormCaptionBox&&!RD3_Glb.IsQuadro()){RD3_Glb.AddClass(f.FormCaptionBox,"combo-hover")}if(h.IntCtrl.ComboInput){RD3_Glb.AddClass(h.IntCtrl.ComboInput,"combo-hover");if(this.ActImage==""){h.IntCtrl.ComboActivator.style.setProperty("background-image","url(images/detailw.png)","important")}}else{RD3_Glb.AddClass(h.IntCtrl,"combo-hover");if(h.ActObj&&this.ActImage==""){h.ActObj.style.setProperty("background-image","url(images/detailw.png)","important")}}if(!b.HiliteBox){b.HiliteBox=document.createElement("div");b.HiliteBox.className="cell-hover";var e="0px 0px ";var c="0px 0px";if(RD3_Glb.HasClass(h.IntCtrl.ComboInput?h.IntCtrl.ComboInput:h.IntCtrl,"first-group-field")){e="6px 6px "}if(RD3_Glb.HasClass(h.IntCtrl.ComboInput?h.IntCtrl.ComboInput:h.IntCtrl,"last-group-field")){c="6px 6px"}if(!RD3_Glb.IsMobile7()){RD3_Glb.SetBorderRadius(b.HiliteBox,e+c)}b.HiliteBox.style.position="absolute"}var i=b.HiliteBox.style;i.left=f.FormLeft+"px";i.top=f.FormTop+"px";i.width=f.FormWidth+"px";i.height=(f.FormHeight-2)+"px";if(f.FormCaptionBox){f.FormCaptionBox.parentNode.insertBefore(b.HiliteBox,f.FormCaptionBox)}}else{if(f.FormCaptionBox){RD3_Glb.RemoveClass(f.FormCaptionBox,"combo-hover")}if(h.IntCtrl.ComboInput){RD3_Glb.RemoveClass(h.IntCtrl.ComboInput,"combo-hover");if(this.ActImage==""){h.IntCtrl.ComboActivator.style.backgroundImage=""}}else{RD3_Glb.RemoveClass(h.IntCtrl,"combo-hover");if(h.ActObj&&this.ActImage==""){h.ActObj.style.backgroundImage=""}}if(b.HiliteBox&&b.HiliteBox.parentNode){b.HiliteBox.parentNode.removeChild(b.HiliteBox)}b.HiliteBox=null}};PField.prototype.IsCombo=function(a){if(a==undefined){if(this.PFormCell){return this.PFormCell.IntCtrl instanceof IDCombo}else{return false}}if(a.tagName==undefined){a=a.parentNode}if(a.tagName=="DIV"&&(RD3_Glb.HasClass(a,"combo-input")||RD3_Glb.HasClass(a,"combo-activator"))){return true}};PField.prototype.IsIDEditor=function(a){if(a==undefined){if(this.PFormCell){return this.PFormCell.IntCtrl instanceof IDEditor}else{return false}}if(RD3_Glb.isInsideEditor(a)){return true}if(this.IsIDEditorToolbar(a)){return true}if(a.tagName==undefined){a=a.parentNode}if(a.tagName=="TEXTAREA"&&RD3_Glb.HasClass(a,"ideditor-body")){return true}};PField.prototype.IsIDEditorToolbar=function(a){if(!a){return false}if(a.tagName==undefined){a=a.parentNode}if((a.tagName=="SPAN"&&(RD3_Glb.HasClass(a,"ideditor-toolbar-img")||RD3_Glb.HasClass(a,"ideditor-applier")))||(a.tagName=="DIV"&&RD3_Glb.HasClass(a,"ideditor-toolbar"))){return true}if(a.tagName=="DIV"&&(RD3_Glb.HasClass(a,"combo-input")||RD3_Glb.HasClass(a,"combo-activator"))){if(a.parentNode&&a.parentNode.tagName=="DIV"&&RD3_Glb.HasClass(a.parentNode,"ideditor-toolbar")){return true}}return false};PField.prototype.HandleFileSelect=function(c){var b=(window.event)?window.event.srcElement:c.explicitOriginalTarget;var a=RD3_KBManager.GetCell(b);a.FileToUpload=c.target.files[0]};PField.prototype.UpdateMultipleSel=function(b,c,a){if(!this.PListCells){return}for(var d=0;d<this.PListCells.length;d++){this.UpdateMultiSelCell(d,b&&d<this.ParentPanel.TotalRows,c[d+1],a)}};PField.prototype.UpdateMultiSelCell=function(c,b,e,a){if(!this.PListCells[c]||!this.PListCells[c].IntCtrl){return}var d=this.PListCells[c].IntCtrl;if(d instanceof IDCombo){d=d.ComboInput}if(a){RD3_Glb.SetClass(d,"panel-field-selected-back",b&&e)}else{RD3_Glb.SetClass(d,"panel-field-selected",b&&e);RD3_Glb.SetClass(d,"panel-field-unselected",b&&!e);if(this.PListCells[c].Tooltip!=""&&this.PListCells[c].TooltipDiv){RD3_Glb.SetClass(this.PListCells[c].TooltipDiv,"panel-value-tooltip-multiplesel",b)}}};PField.prototype.COMBOImageReadyStateChanged=function(c){var b=(window.event)?window.event.srcElement:c.explicitOriginalTarget;b=b.parentNode;var a=RD3_KBManager.GetCell(b);if(a){a.UpdateDims()}};PField.prototype.TranslateServerRow=function(c){if(this.ParentPanel.IsGrouped()){var b=this.ParentPanel.ActualPosition+parseInt(c,10);var a=this.ParentPanel.GetRowForIndex(b);return a==-1?c:a}return c};PField.prototype.OnHTML5Upload=function(B,x,h){var e=document.getElementById(x);if(h==undefined){if(!e||!e.files||e.files.length==0){return}}if(window.RD4_Enabled){var C=e.files[0];var d=new FileReader();d.onload=(function(i,b,m){return(function(F){var n=i.ParentPanel;var t=new IDEvent((i.MultiUpload?"IWFiles":"IWUpload"),"",null,RD3_Glb.EVENT_ACTIVE,"",(i.MultiUpload?"F"+n.WebForm.IdxForm:i.Identifier),b,m,F.target.result)})})(this,C.name,C.type);d.readAsBinaryString(C)}else{try{var c=RD3_DesktopManager.MessagePump.CreateRequest();var k=ClientMessages.SWF_FS_UPLOADING;if(!this.MultiUpload){var E="";if(e&&e.files&&e.files.length>0){E=e.files[0].name}else{if(h&&h.length>0){E=h[0].name}}k=RD3_Glb.FormatMessage(ClientMessages.SWF_MG_UPLOADING,E)}if(this.MultiUpload){var r="REQ"+Math.floor(Math.random()*100);this.ReqList[r]=c;c.reqid=r;c.reqFld=this;var z=this.AddFile(r);c.upload.reqid=r;c.upload.addEventListener("progress",function(b){if(b.lengthComputable){var i=document.getElementById(this.reqid+":status");if(!i){return}var n=Math.ceil(b.loaded/b.total*100);i.style.backgroundSize=n+"%";if(b.loaded==b.total||n==100){var m=document.getElementById(this.reqid+":abort");if(m){m.style.display="none"}}}},false);c.addEventListener("load",function(){if(this.status==200){RD3_DesktopManager.ProcessXmlText(this.responseText)}if(this.reqFld){this.reqFld.HTML5UploadComplete(this.reqid);this.reqFld=null}},false)}else{RD3_DesktopManager.WebEntryPoint.DelayDialog.Open(k,RD3_Glb.PROGRESS,0);RD3_DesktopManager.WebEntryPoint.DelayDialog.SetProgress(0);RD3_DesktopManager.WebEntryPoint.DelayDialog.SetTotal(100);c.upload.addEventListener("progress",function(b){if(b.lengthComputable){RD3_DesktopManager.WebEntryPoint.DelayDialog.SetProgress(Math.ceil(b.loaded/b.total*100))}else{RD3_DesktopManager.WebEntryPoint.DelayDialog.SetProgress(b.loaded)}},false);c.addEventListener("load",function(){if(this.status==200){RD3_DesktopManager.WebEntryPoint.OnBlobUpload(this.responseText)}},false);c.upload.addEventListener("error",function(i){var n=ClientMessages.SWF_ER_FILENOTSEND+"<br>"+c.status;var b=new MessageBox(n,RD3_Glb.MSG_BOX,false);b.Open()},false)}var l=this.MaxUploadSize;var v={0:"B",1:"KB",2:"MB",3:"GB"};for(var D=0;D<=3;D++){if(this.MaxUploadSize<Math.pow(1024,D+1)){l=Math.round(this.MaxUploadSize/Math.pow(1024,D),0)+" "+v[D];break}}var g="?WCI="+(this.MultiUpload?"IWFiles":"IWUpload");if(this.MultiUpload){g+="&WCE="+this.ParentPanel.WebForm.Identifier}else{g+="&WCE="+this.Identifier}c.open("post",g,true);var w=new FormData();var A=h?h:e.files;var s=A.length;k="";var a=false;for(var y=0;y<s;y++){var C=A[y];var o=false;if(this.UploadExtensions=="*.*"){o=true}else{var f=this.UploadExtensions.split(",");for(var q=0;q<f.length;q++){var j=f[q];if(C.name.substring(C.name.length-j.length)==j){o=true;break}}if(!o){k+=k==""?ClientMessages.SWF_ER_FILENOTSEND:"";k+="<br>"+C.name+" : "+ClientMessages.SWF_ER_VALIDATIONFAILED}}if(o){if(C.size==0){o=false;k+=k==""?ClientMessages.SWF_ER_FILENOTSEND:"";k+="<br>"+C.name+" : "+ClientMessages.SWF_ER_VALIDATIONFAILED}if(C.size>this.MaxUploadSize){o=false;k+=k==""?ClientMessages.SWF_ER_FILENOTSEND:"";k+="<br>"+C.name+" : "+ClientMessages.SWF_ER_FILESIZEEXCEEDED+" (max "+l+")"}}if(o){w.append("thefile"+y,C);a=true}}if(a){RD3_DesktopManager.SendEvents(true);c.send(w)}else{if(this.MultiUpload){this.HTML5UploadComplete(c.reqid)}else{RD3_DesktopManager.WebEntryPoint.DelayDialog.Close()}}if(k!=""){var u=new MessageBox(k,RD3_Glb.MSG_BOX,false);u.Open()}}catch(p){RD3_DesktopManager.WebEntryPoint.DelayDialog.Close()}}};PField.prototype.HTML5UploadComplete=function(a){var b=document.getElementById(a+":fi");if(b){b.parentNode.removeChild(b)}this.FileList.FileItems.remove(a);this.ReqList.remove(a)};PField.prototype.OnHTML5UploadClick=function(b,a){var c=window.event?window.event.srcElement:b.explicitOriginalTarget;if(c&&c.id&&c.id.indexOf(":abort")!=-1){return}document.getElementById(a).value="";document.getElementById(a).click()};PField.prototype.OnHTML5Drop=function(a){if(!this.MultiUpload&&this.DataType!=10){return}var b=window.event?window.event.srcElement:a.explicitOriginalTarget;if(a&&a.dataTransfer&&a.dataTransfer.files){this.OnHTML5Upload(a,b.id,a.dataTransfer.files)}RD3_Glb.StopEvent(a);return false};PField.prototype.OnHTML5Drag=function(b){if(b&&b.dataTransfer){var c=window.event?window.event.srcElement:b.explicitOriginalTarget;var d=RD3_KBManager.GetObject(c,true);var e=this.DataType==10||this.MultiUpload;if(this.DataType==10){e=false;var a=this.ParentPanel.ActualPosition+this.ParentPanel.ActualRow;if(this.IsEnabled(a+1)&&this.ParentPanel.Status!=RD3_Glb.PS_QBE&&!this.ParentPanel.IsNewRow(this.ParentPanel.ActualPosition,this.ParentPanel.ActualRow)){e=this.ParentPanel.IsCommandEnabled(RD3_Glb.PCM_BLOBEDIT)}}if(e&&this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.InList&&this.ListList&&d!=null&&d instanceof PValue){e=d.Index==this.ParentPanel.ActualPosition+this.ParentPanel.ActualRow}if(e){b.dataTransfer.dropEffect="copy"}else{b.dataTransfer.dropEffect="none"}}RD3_Glb.StopEvent(b);return false};PField.prototype.OnAdaptRetina=function(a,d,c){var b;if(c==1){b=this.FormCaptionBox.style}else{if(c==2){b=this.ListCaptionBox.style}}if(b){b.backgroundSize=a+"px "+d+"px"}};PField.prototype.OnServerEditorCommand=function(d,e,c){if(!RD3_ServerParams.UseIDEditor||this.EditorType!=1){return}var b=(this.ListList)?this.ParentPanel.ActualRow:0;var a=(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST)?this.PListCells[b]:this.PFormCell;if(a&&a.IsEnabled&&a.ControlType==101&&a.IntCtrl instanceof IDEditor){a.IntCtrl.OnServerEditorCommand(d,e,c)}};function PGroup(a){this.VisualStyle=-1;this.Flags=0;this.Image="";this.Header="";this.Tooltip="";this.ListLeft=0;this.ListTop=0;this.ListWidth=0;this.ListHeight=0;this.FormLeft=0;this.FormTop=0;this.FormWidth=0;this.FormHeight=0;this.Page=0;this.ListHeaderPos=0;this.FormHeaderPos=0;this.HeaderHeight=0;this.HeaderWidth=0;this.InList=false;this.Identifier="";this.ClassName="";this.ParentPanel=a;this.IsListPositioned=false;this.Collapsible=false;this.Collapsed=false;this.Realized=false;this.ListGroupBox=null;this.ListGroupSA=null;this.FormGroupBox=null;this.ListCaption=null;this.ListCaptionSA=null;this.FormCaption=null;this.ListHeader=null;this.FormHeader=null;this.ListCollapseButton=null;this.FormCollapseButton=null}PGroup.prototype.LoadFromXml=function(a){this.LoadProperties(a)};PGroup.prototype.ChangeProperties=function(a){this.LoadProperties(a)};PGroup.prototype.LoadProperties=function(e){var f=e.getAttribute("col");if(f=="0"||f=="1"){e.removeAttribute("col");e.setAttribute("col",f)}var b=e.attributes;var h=b.length;for(var d=0;d<h;d++){var g=b.item(d);var c=g.nodeName;var a=g.nodeValue;switch(c){case"flg":this.SetFlags(parseInt(a));break;case"img":this.SetImage(a);break;case"cap":this.SetHeader(a);break;case"tip":this.SetTooltip(a);break;case"lle":this.SetListLeft(parseInt(a));break;case"lto":this.SetListTop(parseInt(a));break;case"lwi":this.SetListWidth(parseInt(a));break;case"lhe":this.SetListHeight(parseInt(a));break;case"fle":this.SetFormLeft(parseInt(a));break;case"fto":this.SetFormTop(parseInt(a));break;case"fwi":this.SetFormWidth(parseInt(a));break;case"fhe":this.SetFormHeight(parseInt(a));break;case"pag":this.SetPage(parseInt(a));break;case"lhp":this.SetListHeaderPosition(parseInt(a));break;case"fhp":this.SetFormHeaderPosition(parseInt(a));break;case"hhe":this.SetHeaderHeight(parseInt(a));break;case"hwi":this.SetHeaderWidth(parseInt(a));break;case"inl":this.SetInlist(a=="1");break;case"sty":this.SetVisualStyle(parseInt(a));break;case"clp":this.SetCollapsible(a=="1");break;case"col":this.SetCollapsed(a=="1");break;case"mfl":this.SetListMovedFields(a=="1");break;case"mff":this.SetFormMovedFields(a=="1");break;case"cln":this.SetClassName(a);break;case"cla":this.CollapseAnimDef=a;break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};PGroup.prototype.SetFlags=function(f){var a=this.Flags;if(f!=undefined){this.Flags=f}if(this.Realized){var e=a&2;var d=this.Flags&2;if(e!=d||f==undefined){this.UpdateVisibility(true)}var c=a&1;var b=this.Flags&1;if(c!=b||f==undefined){this.ParentPanel.UpdateGroupEnability(this)}}};PGroup.prototype.SetImage=function(a){if(a!=undefined){this.Image=a}if(this.Realized){if(this.Image!=""){if(this.ListGroupBox){this.ListGroupBox.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/"+encodeURI(this.Image)+")"}if(this.ListGroupSA){this.ListGroupSA.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/"+encodeURI(this.Image)+")"}if(this.FormGroupBox){this.FormGroupBox.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+"images/"+encodeURI(this.Image)+")"}}else{if(this.ListGroupBox){this.ListGroupBox.style.backgroundImage=""}if(this.ListGroupSA){this.ListGroupSA.style.backgroundImage=""}if(this.FormGroupBox){this.FormGroupBox.style.backgroundImage=""}}}};PGroup.prototype.SetHeader=function(e){var b=this.Header;if(e!=undefined){this.Header=e}if(this.Realized){if(this.ListCaption){this.ListCaption.nodeValue=this.Header}if(this.ListCaptionSA){this.ListCaptionSA.nodeValue=this.Header}if(this.FormCaption){this.FormCaption.nodeValue=this.Header}if(this.Header!=b&&(this.FormHeader||(!this.InList&&this.ListHeader))){var d=document.createElement("div");d.className="group-header-box";d.innerText=this.Header;var c=this.FormHeader?this.FormHeader.style:(!this.InList?this.ListHeader.style:null);if(c){d.style.fontFamily=c.fontFamily;d.style.fontWeight=c.fontWeight;d.style.fontSize=c.fontSize;d.style.fontStyle=c.fontStyle;d.style.textDecoration=c.textDecoration}document.body.appendChild(d);var a=d.clientWidth;document.body.removeChild(d);a=this.Collapsible?a+15:a;this.SetHeaderWidth(a)}}};PGroup.prototype.SetTooltip=function(a){if(a!=undefined){this.Tooltip=a}if(this.Realized){if(this.ListGroupBox){RD3_TooltipManager.SetObjTitle(this.ListGroupBox,this.Tooltip)}if(this.ListGroupSA){RD3_TooltipManager.SetObjTitle(this.ListGroupSA,this.Tooltip)}if(this.FormGroupBox){RD3_TooltipManager.SetObjTitle(this.FormGroupBox,this.Tooltip)}}};PGroup.prototype.SetListLeft=function(a){if(a!=undefined){this.ListLeft=a}if(this.Realized){if(this.ListGroupBox){this.ListGroupBox.style.left=this.ListLeft+"px";if(this.ListHeader){this.ListHeader.style.left=this.ListLeft+4+"px"}}this.ParentPanel.RecalcLayout=true}};PGroup.prototype.SetListTop=function(a){if(a!=undefined){this.ListTop=a}if(this.Realized){if(!this.InList){switch(this.ListHeaderPos){case 1:if(this.ListGroupBox){this.ListGroupBox.style.top=this.ListTop+"px"}if(this.ListHeader){this.ListHeader.style.top=this.ListTop+"px"}break;case 2:if(this.ListGroupBox){this.ListGroupBox.style.top=(this.ListTop-5)+"px"}if(this.ListHeader){this.ListHeader.style.top=(this.ListTop-Math.floor(this.HeaderHeight/2)-6)+"px"}break;case 3:if(this.ListGroupBox){this.ListGroupBox.style.top=this.ListTop+"px"}if(this.ListHeader){this.ListHeader.style.top=(this.ListTop-this.HeaderHeight-3)+"px"}break;case 4:if(this.ListGroupBox){this.ListGroupBox.style.top=(this.ListTop-this.HeaderHeight-6)+"px"}if(this.ListHeader){this.ListHeader.style.top=(this.ListTop-this.HeaderHeight-3)+"px"}break}}this.ParentPanel.RecalcLayout=true}};PGroup.prototype.SetListWidth=function(a){if(a!=undefined){this.ListWidth=a}if(this.Realized){if(this.ListGroupBox&&this.ListWidth>1){if(this.InList){this.ListGroupBox.style.width=(this.ListWidth-1)+"px"}else{this.ListGroupBox.style.width=this.ListWidth+"px"}}this.ParentPanel.RecalcLayout=true}};PGroup.prototype.SetListHeight=function(b){if(b!=undefined){this.ListHeight=b}if(this.Realized&&this.ListGroupBox&&this.ListHeight>1){if(this.InList){this.ListGroupBox.style.height=(this.ListHeight-1)+"px";if(this.ListGroupSA){this.ListGroupSA.style.height=this.ListGroupBox.style.height}}else{var a=(this.Collapsed?0:this.ListHeight);switch(this.ListHeaderPos){case 1:this.ListGroupBox.style.height=a+"px";break;case 2:this.ListGroupBox.style.height=(a+5)+"px";break;case 3:this.ListGroupBox.style.height=a+"px";break;case 4:this.ListGroupBox.style.height=(a+this.HeaderHeight+6)+"px";break}}this.ParentPanel.RecalcLayout=true}};PGroup.prototype.SetFormLeft=function(c){if(c!=undefined){this.FormLeft=c}if(this.Realized){var b=(RD3_Glb.IsMobile()?3:0);var a=(RD3_Glb.IsMobile()?8:0);if(this.FormGroupBox){this.FormGroupBox.style.left=(this.FormLeft+b)+"px";this.FormHeader.style.left=(this.FormLeft+4+a)+"px"}this.ParentPanel.RecalcLayout=true}};PGroup.prototype.SetFormTop=function(b){if(b!=undefined){this.FormTop=b}if(this.Realized){var a=(RD3_Glb.IsMobile()?3:0);switch(this.FormHeaderPos){case 1:if(this.FormGroupBox){this.FormGroupBox.style.top=(this.FormTop+a)+"px"}if(this.FormHeader){this.FormHeader.style.top=(this.FormTop-a)+"px"}break;case 2:if(this.FormGroupBox){this.FormGroupBox.style.top=(this.FormTop-5)+"px"}if(this.FormHeader){this.FormHeader.style.top=(this.FormTop-Math.floor(this.HeaderHeight/2)-6)+"px"}break;case 3:if(this.FormGroupBox){this.FormGroupBox.style.top=(this.FormTop+a)+"px"}if(this.FormHeader){this.FormHeader.style.top=(this.FormTop-this.HeaderHeight-3)+"px"}break;case 4:if(this.FormGroupBox){this.FormGroupBox.style.top=(this.FormTop-this.HeaderHeight-6)+"px"}if(this.FormHeader){this.FormHeader.style.top=(this.FormTop-this.HeaderHeight-3)+"px"}break}}};PGroup.prototype.SetFormWidth=function(b){if(b!=undefined){this.FormWidth=b}if(this.Realized&&this.FormGroupBox){if(this.FormGroupBox&&this.FormWidth>1){var a=(RD3_Glb.IsMobile()?-8:0);this.FormGroupBox.style.width=(this.FormWidth+a)+"px"}}};PGroup.prototype.SetFormHeight=function(b){if(b!=undefined){this.FormHeight=b}if(this.Realized&&this.FormGroupBox&&this.FormHeight>0){var a=(this.Collapsed?0:this.FormHeight+(RD3_Glb.IsMobile()?-9:0));switch(this.FormHeaderPos){case 1:this.FormGroupBox.style.height=a+"px";break;case 2:this.FormGroupBox.style.height=(a+5)+"px";break;case 3:this.FormGroupBox.style.height=a+"px";break;case 4:this.FormGroupBox.style.height=(a+this.HeaderHeight+6)+"px";break}}};PGroup.prototype.SetPage=function(a){if(a!=undefined){this.Page=a}if(this.Realized){this.UpdateVisibility(true)}};PGroup.prototype.SetListHeaderPosition=function(a){if(a!=undefined){this.ListHeaderPos=a}if(this.Realized){if(!this.InList&&this.ListHeader){this.ListHeader.style.display=(this.ListHeaderPos==1)?"none":""}}};PGroup.prototype.SetFormHeaderPosition=function(a){if(a!=undefined){this.FormHeaderPos=a}if(this.Realized){if(this.FormHeader){this.FormHeader.style.display=(this.FormHeaderPos==1)?"none":""}}};PGroup.prototype.SetHeaderHeight=function(a){if(a!=undefined){this.HeaderHeight=a}if(this.Realized){if(this.ListGroupBox){if(!this.InList&&this.ListHeader){this.ListHeader.style.height=this.HeaderHeight+"px"}}if(this.FormGroupBox&&this.FormHeader){this.FormHeader.style.height=this.HeaderHeight+"px"}}};PGroup.prototype.SetHeaderWidth=function(a){if(a!=undefined){this.HeaderWidth=a}if(this.Realized){if(this.ListGroupBox){if(!this.InList&&this.ListHeader){this.ListHeader.style.width=(RD3_ServerParams.Theme=="zen"?"auto":this.HeaderWidth+"px")}}if(this.FormGroupBox&&this.FormHeader){this.FormHeader.style.width=(RD3_ServerParams.Theme=="zen"?"auto":this.HeaderWidth+"px")}}};PGroup.prototype.SetInlist=function(a){if(a!=undefined){this.InList=a}};PGroup.prototype.SetVisualStyle=function(b){if(b!=undefined){if(b.Identifier){this.VisualStyle=b}else{if(b!=-1){this.VisualStyle=RD3_DesktopManager.ObjectMap["vis:"+b]}else{this.VisualStyle=b}}}if(this.Realized){var c=this.VisualStyle;if(c==-1){c=this.ParentPanel.VisualStyle}if(this.ListGroupBox){if(this.InList){c.ApplyGroupStyle(this.ListGroupBox,true,true);if(this.ListGroupSA){c.ApplyGroupStyle(this.ListGroupSA,true,true)}this.ParentPanel.VisStyle.ApplyBorderStyle(this.ListGroupBox,11);if(this.ListGroupSA){this.ParentPanel.VisStyle.ApplyBorderStyle(this.ListGroupSA,11)}this.ListGroupBox.style.textAlign=""}else{var a=(this.ListHeaderPos!=3)?true:false;if(this.ListHeaderPos==2&&c.GetColor(12)=="transparent"){a=false;this.ListHeader.style.backgroundColor=this.ParentPanel.VisStyle.GetColor(6)}c.ApplyGroupStyle(this.ListHeader,false,a);c.ApplyBorderStyle(this.ListGroupBox,13);this.ListGroupBox.style.backgroundColor=c.GetColor(12)}}if(this.FormGroupBox&&this.FormHeader){var a=(this.FormHeaderPos!=3)?true:false;if(this.FormHeaderPos==2&&c.GetColor(12)=="transparent"){a=false;this.FormHeader.style.backgroundColor=this.ParentPanel.VisStyle.GetColor(6)}c.ApplyGroupStyle(this.FormHeader,false,a);c.ApplyBorderStyle(this.FormGroupBox,13);this.FormGroupBox.style.backgroundColor=c.GetColor(12)}}};PGroup.prototype.SetClassName=function(b){var a=this.ClassName;if(b!=undefined){this.ClassName=b}if(((a!=this.ClassName)||b==undefined)&&this.Realized){if(this.ListGroupBox){if(a&&a!=""){RD3_Glb.RemoveClass2(this.ListGroupBox,a)}if(this.ClassName&&this.ClassName!=""){RD3_Glb.AddClass(this.ListGroupBox,this.ClassName)}}if(this.FormGroupBox){if(a&&a!=""){RD3_Glb.RemoveClass2(this.FormGroupBox,a)}if(this.ClassName&&this.ClassName!=""){RD3_Glb.AddClass(this.FormGroupBox,this.ClassName)}}}};PGroup.prototype.Realize=function(a){var b=RD3_Glb.IsMobile();if(this.ParentPanel.HasList){this.ListGroupBox=document.createElement("div");this.ListGroupBox.id=this.Identifier+":lht";this.ListCaption=document.createTextNode("");if(this.InList){this.ListGroupBox.className="group-list-box";this.ListGroupBox.appendChild(this.ListCaption);this.ParentPanel.ListListBox.appendChild(this.ListGroupBox)}else{this.ListHeader=document.createElement("div");this.ListHeader.className="group-header-box";this.ListHeader.setAttribute("id",this.Identifier+":hdr");this.ListGroupBox.className="group-form-box";this.ListCollapseButton=document.createElement("img");this.ListCollapseButton.setAttribute("id",this.Identifier+":collapse");this.ListCollapseButton.className="group-collapse-img";this.ListCollapseButton.style.verticalAlign="baseline";if(!b){this.ListCollapseButton.src=RD3_Glb.GetImgSrc("images/grcl.gif")}this.ListHeader.appendChild(this.ListCollapseButton);this.ListHeader.appendChild(this.ListCaption);this.ParentPanel.ListBox.appendChild(this.ListGroupBox);this.ParentPanel.ListBox.appendChild(this.ListHeader)}}if(this.ParentPanel.HasForm){this.FormGroupBox=document.createElement("div");this.FormGroupBox.className="group-form-box";this.FormGroupBox.id=this.Identifier+":lht";this.FormCaption=document.createTextNode("");this.FormHeader=document.createElement("div");this.FormHeader.className="group-header-box";this.FormHeader.setAttribute("id",this.Identifier+":hdr");this.FormCollapseButton=document.createElement("img");this.FormCollapseButton.setAttribute("id",this.Identifier+":collapse");this.FormCollapseButton.className="group-collapse-img";this.FormCollapseButton.style.verticalAlign="baseline";if(!b){this.FormCollapseButton.src=RD3_Glb.GetImgSrc("images/grcl.gif")}this.FormHeader.appendChild(this.FormCollapseButton);this.FormHeader.appendChild(this.FormCaption);this.ParentPanel.FormBox.appendChild(this.FormGroupBox);this.ParentPanel.FormBox.appendChild(this.FormHeader)}this.Realized=true;this.SetFlags();this.SetImage();this.SetHeader();this.SetTooltip();this.SetListLeft();this.SetListTop();this.SetListWidth();this.SetListHeight();this.SetFormLeft();this.SetFormTop();this.SetFormWidth();this.SetFormHeight();this.SetPage();this.SetListHeaderPosition();this.SetFormHeaderPosition();this.SetHeaderHeight();this.SetHeaderWidth();this.SetInlist();this.SetVisualStyle();this.SetCollapsible();this.SetClassName()};PGroup.prototype.Unrealize=function(){if(this.ListGroupBox){this.ListGroupBox.parentNode.removeChild(this.ListGroupBox)}if(this.ListGroupSA){this.ListGroupSA.parentNode.removeChild(this.ListGroupSA)}if(this.ListHeader){this.ListHeader.parentNode.removeChild(this.ListHeader)}if(this.FormGroupBox){this.FormGroupBox.parentNode.removeChild(this.FormGroupBox)}if(this.FormHeader){this.FormHeader.parentNode.removeChild(this.FormHeader)}RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.ListGroupBox=null;this.ListGroupSA=null;this.FormGroupBox=null;this.ListCaption=null;this.ListCaptionSA=null;this.FormCaption=null;this.ListHeader=null;this.FormHeader=null;this.ListCollapseButton=null;this.FormCollapseButton=null;this.Realized=false};PGroup.prototype.IsVisible=function(){var a=false;if(this.Page!=-1){if(this.ParentPanel.PanelPage==this.Page){a=true}else{a=false}}else{a=true}if(a){if((this.Flags&2)!=0){a=true}else{a=false}}return a};PGroup.prototype.IsEnabled=function(){return this.Flags&1};PGroup.prototype.UpdateVisibility=function(e){var c=this.IsVisible();var a=c&&this.ListWidth>0;var d=c&&this.FormWidth>0;var b=a?"":"none";var f=d?"":"none";if(this.ListGroupBox){RD3_Glb.SetDisplay(this.ListGroupBox,(this.InList&&this.ListHeaderPos==1?"none":b))}if(this.ListGroupSA){this.ListGroupSA.style.display=this.ListGroupBox.style.display}if(this.ListHeader){RD3_Glb.SetDisplay(this.ListHeader,(this.ListHeaderPos==1?"none":b))}if(this.FormGroupBox){RD3_Glb.SetDisplay(this.FormGroupBox,f)}if(this.FormHeader){RD3_Glb.SetDisplay(this.FormHeader,(this.FormHeaderPos==1?"none":f))}if(e){this.ParentPanel.UpdateGroupVisibility(this);this.ParentPanel.UpdateGroupEnability(this)}};PGroup.prototype.SetListPosition=function(e,d,a,c){if(!this.Realized){return}var b=this.ListGroupBox;if(this.IsListPositioned&&b.parentNode!=a&&this.InList){if(!this.ListGroupSA){this.ListGroupSA=document.createElement("div");this.ListGroupSA.id=this.Identifier+":sa";this.ListGroupSA.className="group-list-box";this.ListCaptionSA=document.createTextNode(this.Header);this.ListGroupSA.appendChild(this.ListCaptionSA);a.appendChild(this.ListGroupSA);this.ListGroupSA.style.left=e+"px";this.ListGroupSA.style.top=d+"px";this.ListGroupSA.style.height=this.ListGroupBox.style.height;this.ListGroupSA.style.top=d+"px";this.VisualStyle.ApplyGroupStyle(this.ListGroupSA,true,true);this.ParentPanel.VisStyle.ApplyBorderStyle(this.ListGroupSA,11);this.ListGroupSA.style.textAlign="";RD3_TooltipManager.SetObjTitle(this.ListGroupSA,this.ListGroupBox.title);this.ListGroupSA.style.backgroundImage=this.ListGroupBox.style.backgroundImage;this.ListWidth=0}b=this.ListGroupSA}if(!this.IsListPositioned&&this.InList&&b){b.style.left=e+"px";b.style.top=d+"px";if(b.parentNode!=a){b.parentNode.removeChild(b);a.appendChild(b)}this.IsListPositioned=true;this.ListWidth=0}this.ListWidth+=c;b.style.width=(this.ListWidth>0?this.ListWidth-1:0)+"px"};PGroup.prototype.ResetListPosition=function(){this.IsListPositioned=false;if(this.ListGroupSA){this.ListGroupSA.parentNode.removeChild(this.ListGroupSA);this.ListGroupSA=null}if(this.InList){this.ListWidth=0}};PGroup.prototype.GetTooltip=function(b,c){if(this.Tooltip==""){return false}var a=false;if(c==this.ListGroupBox||c==this.ListHeader){b.SetObj(this.ListGroupBox);a=true}if(c==this.FormGroupBox||c==this.FormHeader){b.SetObj(this.FormGroupBox);a=true}if(a){b.SetTitle(this.Header);b.SetText(this.Tooltip);b.SetAutoAnchor(true);b.SetPosition(2);return true}return false};PGroup.prototype.SetCollapsible=function(b){var a=this.Collapsible;if(b!=undefined){this.Collapsible=b}if(this.Realized){if(this.ListHeader){this.ListHeader.onclick=(this.Collapsible?new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCollapseClick', ev)"):null);this.ListHeader.style.cursor=(this.Collapsible?"pointer":"")}if(this.FormHeader){this.FormHeader.onclick=(this.Collapsible?new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCollapseClick', ev)"):null);this.FormHeader.style.cursor=(this.Collapsible?"pointer":"")}if(this.ListCollapseButton){this.ListCollapseButton.style.display=(this.Collapsible?"":"none")}if(this.FormCollapseButton){this.FormCollapseButton.style.display=(this.Collapsible?"":"none")}if(this.Collapsible!=a||b==undefined){if(b==undefined&&this.Collapsible){this.SetHeaderWidth(this.HeaderWidth+15)}else{if(this.Collapsible!=a){this.SetHeaderWidth(this.Collapsible?this.HeaderWidth+15:this.HeaderWidth-15)}}}}};PGroup.prototype.SetListMovedFields=function(a){this.ListMovedFields=a};PGroup.prototype.SetFormMovedFields=function(a){this.FormMovedFields=a};PGroup.prototype.SetCollapsed=function(o,c){var f=this.Collapsed;if(o!=undefined){this.Collapsed=o}if(this.Realized&&(f!=this.Collapsed||o==undefined)){var l=(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST);var q=RD3_Glb.GetImgSrc("images/gr"+(this.Collapsed?"xp":"cl")+".gif");if(l&&this.ListCollapseButton){if(!RD3_Glb.IsMobile()){this.ListCollapseButton.src=q}}if(!l&&this.FormCollapseButton){if(!RD3_Glb.IsMobile()){this.FormCollapseButton.src=q}}var a=true;if(!c){a=!(l?this.ListMovedFields:this.FormMovedFields)}var k=((l?this.WasLCollapsed:this.WasFCollapsed)==true);if(a&&o==undefined){if(this.Collapsed!=k){this.CalcLayout()}else{a=false}}this.FindObjectsUnderMe(k);if(l){this.WasLCollapsed=this.Collapsed}else{this.WasFCollapsed=this.Collapsed}if(a){var b=(l?this.ListHeight:this.FormHeight);if(this.Collapsed){b=-b}e=this.FieldsUnderMe.length;for(var j=0;j<e;j++){var g=this.FieldsUnderMe[j];if(l){var m=new IDEvent("resize",g.Identifier,c,RD3_Glb.EVENT_SERVERSIDE,"list",g.ListWidth,g.ListHeight,g.ListLeft,g.ListTop+b)}else{var m=new IDEvent("resize",g.Identifier,c,RD3_Glb.EVENT_SERVERSIDE,"form",g.FormWidth,g.FormHeight,g.FormLeft,g.FormTop+b)}}}var p=(f==this.Collapsed?RD3_Glb.EVENT_DEFERRED:RD3_Glb.EVENT_ACTIVE);var m=new IDEvent("grpcol",this.Identifier,c,p,!this.Collapsed?"exp":"col");var h=new GFX("group",this.Collapsed,this,(o==undefined)||this.ParentPanel.WebForm.Animating||!a,null,this.CollapseAnimDef);h.Immediate=true;h.MoveFields=a;RD3_GFXManager.AddEffect(h);if(f!=this.Collapsed&&!this.Collapsed){var e=this.ParentPanel.Fields.length;for(var j=0;j<e;j++){var d=this.ParentPanel.ActualPosition+this.ParentPanel.ActualRow;var g=this.ParentPanel.Fields[j];if(g.Group==this&&d<g.PValues.length&&g.PValues[d]){g.PValues[d].UpdateScreen()}}}}};PGroup.prototype.OnCollapseClick=function(a){RD3_KBManager.ActiveElement=null;RD3_KBManager.LastActiveObject=null;RD3_KBManager.ActiveObject=null;if(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST){this.ListCollapseButton.focus()}else{this.FormCollapseButton.focus()}this.SetCollapsed(!this.Collapsed,a)};PGroup.prototype.FindObjectsUnderMe=function(j){this.MyFields=new Array();this.FieldsUnderMe=new Array();var d=(RD3_Glb.IsMobile()?3:0);var f=this.ParentPanel;var g=f.Fields.length;for(var b=0;b<g;b++){var a=f.Fields[b];if(a.Page!=this.Page){continue}var e=(a.Group?a.Group:a);if(f.PanelMode==RD3_Glb.PANEL_LIST&&a.InList&&!a.ListList){if(a.Group==this){this.MyFields.push(a)}else{var c=(j?0:this.ListHeight);if((this.ListTop+c<=e.ListTop)&&(this.ListLeft<=e.ListLeft)&&(this.ListLeft+this.ListWidth>=e.ListLeft+e.ListWidth-d)){this.FieldsUnderMe.push(a)}}}else{if(f.PanelMode==RD3_Glb.PANEL_FORM&&a.InForm){if(a.Group==this){this.MyFields.push(a)}else{var c=(j?0:this.FormHeight);if((this.FormTop+c<=e.FormTop)&&(this.FormLeft<=e.FormLeft)&&(this.FormLeft+this.FormWidth>=e.FormLeft+e.FormWidth-d)){this.FieldsUnderMe.push(a)}}}}}};PGroup.prototype.CalcLayout=function(){var c=(this.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST);if(c&&this.InList){return false}var g=new Rect(10000,10000,0,0);var b=false;var e=this.ParentPanel.Fields.length;for(var a=0;a<e;a++){var d=this.ParentPanel.Fields[a];if(c){if(d.InList&&d.IsVisible(true)&&d.Group==this){if(d.ListLeft<g.x){g.x=d.ListLeft}if(d.ListTop<g.y){g.y=d.ListTop}if(d.ListLeft+d.ListWidth>g.w){g.w=d.ListLeft+d.ListWidth}if(d.ListTop+d.ListHeight>g.h){g.h=d.ListTop+d.ListHeight}b=true}}else{if(d.InForm&&d.IsVisible(true)&&d.Group==this){if(d.FormLeft<g.x){g.x=d.FormLeft}if(d.FormTop<g.y){g.y=d.FormTop}if(d.FormLeft+d.FormWidth>g.w){g.w=d.FormLeft+d.FormWidth}if(d.FormTop+d.FormHeight>g.h){g.h=d.FormTop+d.FormHeight}b=true}}}if(!b){return false}if(c){this.SetListLeft(g.x-4+this.ParentPanel.RowSelWidth());this.SetListTop(g.y-4);this.SetListWidth(g.w-g.x+8);this.SetListHeight(g.h-g.y+8)}else{this.SetFormLeft(g.x-4);this.SetFormTop(g.y-4);this.SetFormWidth(g.w-g.x+8);this.SetFormHeight(g.h-g.y+8)}return true};PGroup.prototype.OnTouchDown=function(b,a){this.ParentPanel.OnTouchDown(b);return true};PGroup.prototype.OnTouchUp=function(b,a){if(a&&RD3_Glb.IsTouch()&&this.Collapsible){this.OnCollapseClick(b)}this.ParentPanel.OnTouchUp(b,a);return true};function PListGroup(a){this.Label="";this.StartingRecord=0;this.EndingRecord=0;this.Level=-1;this.ParentPanel=a;this.VisualStyle=0;this.Expanded=false;this.Identifier="";this.GroupList=new Array();this.ParentGroup=null;this.Index=0;this.Aggregations=new Array();this.ExpandEventDef=RD3_Glb.EVENT_ACTIVE}PListGroup.prototype.LoadFromXml=function(d){this.LoadProperties(d);var h=d.childNodes;var c=h.length;for(var g=0;g<c;g++){var f=h.item(g);var a=f.nodeName;switch(a){case"lsg":var j=new PListGroup(this.ParentPanel);j.ParentGroup=this;this.GroupList.push(j);j.LoadFromXml(f);break;case"agr":var e=f.getAttribute("shw");var b=f.getAttribute("fid");this.Aggregations[parseInt(b)]=e;break}}};PListGroup.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"lbl":this.SetLabel(a);break;case"str":this.SetStartingRecord(parseInt(a));break;case"end":this.SetEndingRecord(parseInt(a));break;case"lvl":this.SetLevel(parseInt(a));break;case"sty":this.SetVisualStyle(parseInt(a));break;case"exp":this.Expanded=(a=="1");break;case"evt":this.ExpandEventDef=parseInt(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};PListGroup.prototype.SetLabel=function(a){this.Label=a};PListGroup.prototype.SetStartingRecord=function(a){this.StartingRecord=a};PListGroup.prototype.SetEndingRecord=function(a){this.EndingRecord=a};PListGroup.prototype.SetLevel=function(a){this.Level=a;if(this.Level==-1){this.Expanded=true}};PListGroup.prototype.SetVisualStyle=function(a){if(a!=undefined){if(a.Identifier){this.VisualStyle=a}else{this.VisualStyle=RD3_DesktopManager.ObjectMap["vis:"+a]}}};PListGroup.prototype.SetExpanded=function(a){this.Expanded=a;this.ParentPanel.UpdateScrollBox();this.ParentPanel.ResetPosition=true;this.ParentPanel.RefreshToolbar=true};PListGroup.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.ParentGroup=null;var b=this.GroupList.length;for(var a=0;a<b;a++){this.GroupList[a].Unrealize()}};PListGroup.prototype.GetPValOffset=function(a){if(this.StartingRecord<=a){var c=this.Level==-1?0:1;if(this.GroupList.length>0){var d=this.GroupList.length;for(var b=0;b<d;b++){c+=this.GroupList[b].GetPValOffset(a)}}return c}return 0};PListGroup.prototype.AddGroups=function(c,b){if(!c){return}var e=b;if(this.Level!=-1){e=b+1;this.Index=this.StartingRecord+b;c[this.Index]=this}var d=this.GroupList.length;for(var a=0;a<d;a++){e=this.GroupList[a].AddGroups(c,e)}return e};PListGroup.prototype.IsRowVisible=function(d,c){if(this.StartingRecord<=d&&d<=this.EndingRecord){if(c&&!this.Expanded&&d==this.StartingRecord){return true}if(!this.Expanded){return false}var b=true;var e=this.GroupList.length;for(var a=0;a<e;a++){b&=this.GroupList[a].IsRowVisible(d,c)}return b}return true};PListGroup.prototype.IsVisibleInGrouped=function(){var b=true;var a=this.ParentGroup;while(a!=null){b&=a.Expanded;a=a.ParentGroup}return b};PListGroup.prototype.OnExpandGrp=function(){this.SetExpanded(!this.Expanded);var h=-1;if(this.ParentPanel.ListGroupRoot.IsRowVisible(this.StartingRecord)){var d=this.ParentPanel.ListGroupRoot.GetRowPos(this.StartingRecord,false);var f=this.ParentPanel.ListGroupRoot.GetRowPos(this.ParentPanel.ActualPosition);h=d-f;if(h<0){h=0}if(h>=this.ParentPanel.NumRows){h=this.ParentPanel.NumRows-1}this.ParentPanel.SetActualRow(h);RD3_KBManager.CheckFocus=false;RD3_KBManager.DontCheckFocus=true}if(!this.Expanded){var a=this.ParentPanel;var e=a.GetTotalRows()+(a.TotalRows-a.ListGroupRoot.EndingRecord);if(a.CompactActualPosition+(a.NumRows-1)>e){var g=a.CompactActualPosition-(a.CompactActualPosition+a.NumRows-e)+1;if(g<=0){g=1}var c=a.ListGroupRoot.GetServerIndex(g,false);this.ParentPanel.SetActualPosition(c);RD3_KBManager.CheckFocus=false;RD3_KBManager.DontCheckFocus=true}}var b=new IDEvent("grlexp",this.Identifier,null,this.ExpandEventDef,this.Expanded?"1":"0",h,RD3_Glb.IsMobile()?"-1":this.ParentPanel.GetTotalRows())};PListGroup.prototype.GetRowIndex=function(e,f,j,a){var h=-1;var l=e+f;if(this.Level==-1){var k=0;var d=this.GroupList.length;for(var g=0;g<d;g++){var b=k+this.GroupList[g].GetNumRows();if(k<=l&&l<=b){h=this.GroupList[g].GetRowIndex(e,f,k,this);break}k=b}if(h==-1){var c=e+f-this.GetNumRows();h=this.GetPValOffset(this.EndingRecord)+this.EndingRecord+c}return h}else{if(j+1==l){return this.Index}j=j+1;if(this.GroupList.length>0){var d=this.GroupList.length;for(var g=0;g<d;g++){var b=j+this.GroupList[g].GetNumRows();if(j<=l&&l<=b){h=this.GroupList[g].GetRowIndex(e,f,j,a);break}j=b}return h}else{for(var g=this.StartingRecord;g<=this.EndingRecord;g++){j=j+1;if(j==l){return a.GetPValOffset(g)+g}}return -1}}};PListGroup.prototype.GetRowPos=function(a,c,e){if(a<this.StartingRecord||a>this.EndingRecord){if(this.Level==-1&&a>this.EndingRecord){return this.GetNumRows()+a-this.EndingRecord}else{return -1}}if(!this.Expanded){return 1}if(c==undefined||c==null){c=true}if(!this.IsRowVisible(a,e)&&this.Level!=-1){return 1}if(this.IsRowVisible(a,e)&&this.Level!=-1&&a==1&&c){return 1}if(this.GroupList.length>0){var f=this.Level==-1?0:1;var g=this.GroupList.length;for(var b=0;b<g;b++){var d=this.GroupList[b].GetRowPos(a,c,e);if(d==-1){f+=this.GroupList[b].GetNumRows()}else{f+=d;break}}return f}else{return(a-this.StartingRecord+1)+1}};PListGroup.prototype.GetServerIndex=function(j,h,f,a){var e=-1;if(this.Level==-1){var g=0;var c=this.GroupList.length;for(var d=0;d<c;d++){var b=g+this.GroupList[d].GetNumRows();if(g<=j&&j<=b){e=this.GroupList[d].GetServerIndex(j,h,g,this);break}g=b}if(e==-1){if(!h){return this.EndingRecord}return(j-g)+this.EndingRecord}return e}else{if(f+1==j){return this.StartingRecord}f=f+1;if(this.GroupList.length>0){var c=this.GroupList.length;for(var d=0;d<c;d++){var b=f+this.GroupList[d].GetNumRows();if(f<=j&&j<=b){e=this.GroupList[d].GetServerIndex(j,h,f,a);break}f=b}return e}else{for(var d=this.StartingRecord;d<=this.EndingRecord;d++){f=f+1;if(f==j){return d}}return -1}}};PListGroup.prototype.GetNumRows=function(){if(!this.Expanded){return 1}if(this.GroupList.length>0){var c=this.GroupList.length;var b=this.Level==-1?0:1;for(var a=0;a<c;a++){b+=this.GroupList[a].GetNumRows()}return b}else{if(this.StartingRecord===1&&this.EndingRecord===0){return 0}return(this.EndingRecord-this.StartingRecord+1)+1}};PListGroup.prototype.IsVisible=function(){return this.IsVisibleInGrouped()};PListGroup.prototype.GetVisualStyle=function(){return this.VisualStyle};PListGroup.prototype.AfterProcessResponse=function(){};PListGroup.prototype.UpdateRowSel=function(b){var a=(this.ParentPanel&&this.ParentPanel.RowSel?this.ParentPanel.RowSel[b]:null);if(RD3_ServerParams.CompletePanelBorders&&this.ParentPanel&&this.ParentPanel.RowSel){a=this.ParentPanel.RowSel[b]?this.ParentPanel.RowSel[b].firstChild:null}if(a){a.style.display="none"}else{this.ParentPanel.UpdateRSel=true}};PListGroup.prototype.IsHeader=function(a,g,f){var b=-1;if(this.Level==-1){var e=0;var h=this.GroupList.length;for(var c=0;c<h;c++){var d=e+this.GroupList[c].GetNumRows();if(e<=a&&a<=d){b=this.GroupList[c].IsHeader(a,e,this);break}e=d}return b}else{if(g+1==a){return -1}g=g+1;if(this.GroupList.length>0){var h=this.GroupList.length;for(var c=0;c<h;c++){var d=g+this.GroupList[c].GetNumRows();if(g<=a&&a<=d){b=this.GroupList[c].IsHeader(a,g,f);break}g=d}return b}else{for(var c=this.StartingRecord;c<=this.EndingRecord;c++){g=g+1;if(g==a){return c}}return -1}}};function PopupControl(a,c,b){this.Type=a;this.Cell=c;this.Day=1;this.Month=1;this.MaxDay=31;this.Year=1900;this.Hour=0;this.Minute=0;if(b!=undefined){this.ObjToAttach=b}}PopupControl.prototype=new PopupFrame();PopupControl.prototype.Realize=function(){this.Borders=RD3_Glb.BORDER_THIN;this.AutoClose=true;this.Centered=false;this.CanMove=false;if(RD3_Glb.IsSmartPhone()){this.ModalAnim=true}this.SetWidth(100);this.SetHeight(100);PopupFrame.prototype.Realize.call(this,"-popover");if(this.Type!=RD3_Glb.CTRL_CPICKER){this.SetCaption(this.Cell.ParentField?this.Cell.ParentField.FormHeader:"")}this.ContentBox.style.paddingTop="0px";switch(this.Type){case RD3_Glb.CTRL_DATE:this.RealizeDateControl();this.SetDate(this.ParseDate(this.Cell.Text));break;case RD3_Glb.CTRL_TIME:this.RealizeTimeControl();this.SetTime(this.ParseTime(this.Cell.Text));break;case RD3_Glb.CTRL_DATETIME:this.RealizeDateControl();this.RealizeTimeControl();this.SetDate(this.ParseDate(this.Cell.Text));this.SetTime(this.ParseTime(this.Cell.Text));break;case RD3_Glb.CTRL_KEYNUM:this.RealizeNumericKeyboard();mc(this.Cell.Mask,"N",null,this.Cell.IntCtrl,true);this.UpdateCaption();break;case RD3_Glb.CTRL_CPICKER:this.RealizeColorChooser();this.UpdateCaption();break}this.AttachTo(this.ObjToAttach?this.ObjToAttach:this.Cell.IntCtrl)};PopupControl.prototype.RealizeDateControl=function(){var c=(this.Type==RD3_Glb.CTRL_DATETIME?"45px":"");var a=(this.Type==RD3_Glb.CTRL_DATETIME?"115px":"");var d=(this.Type==RD3_Glb.CTRL_DATETIME?"70px":"");if(RD3_Glb.IsSmartPhone()){var e=RD3_DesktopManager.WebEntryPoint.WepBox;var b=e.offsetWidth>320?e.offsetWidth:320;c=(this.Type==RD3_Glb.CTRL_DATETIME?b/100*15:b/100*25)+"px";a=(this.Type==RD3_Glb.CTRL_DATETIME?b/100*35:b/100*50)+"px";d=(this.Type==RD3_Glb.CTRL_DATETIME?b/100*20:b/100*25)+"px"}this.DayContainer=document.createElement("div");this.DayContainer.className="ctrl-day-container";this.DayContainer.style.left="0px";this.DayContainer.style.width=c;this.ContentBox.appendChild(this.DayContainer);this.DayPicker=document.createElement("div");this.DayPicker.className="ctrl-day-picker";this.DayContainer.appendChild(this.DayPicker);this.DayScroll=new IDScroll(this.Identifier+":ds",this.DayPicker,this.DayContainer,this);this.FillPicker(1,this.MaxDay,this.DayPicker,this.DayScroll);this.MonthContainer=document.createElement("div");this.MonthContainer.className="ctrl-month-container";this.MonthContainer.style.left=this.DayContainer.offsetWidth+"px";this.MonthContainer.style.width=a;this.ContentBox.appendChild(this.MonthContainer);this.MonthPicker=document.createElement("div");this.MonthPicker.className="ctrl-month-picker";this.MonthContainer.appendChild(this.MonthPicker);this.MonthScroll=new IDScroll(this.Identifier+":ms",this.MonthPicker,this.MonthContainer,this);this.FillPicker(1,12,this.MonthPicker,this.MonthScroll,ClientMessages.WEP_CAL_MonthNames);this.YearContainer=document.createElement("div");this.YearContainer.className="ctrl-year-container";this.YearContainer.style.left=(this.DayContainer.offsetWidth+this.MonthContainer.offsetWidth)+"px";this.YearContainer.style.width=d;this.ContentBox.appendChild(this.YearContainer);this.YearPicker=document.createElement("div");this.YearPicker.className="ctrl-year-picker";this.YearContainer.appendChild(this.YearPicker);this.YearScroll=new IDScroll(this.Identifier+":ys",this.YearPicker,this.YearContainer,this);this.FillPicker(1950,2050,this.YearPicker,this.YearScroll);this.DateSelector=document.createElement("div");this.DateSelector.className="ctrl-date-selector";this.ContentBox.appendChild(this.DateSelector);this.SetHeight(264);if(RD3_Glb.IsSmartPhone()){var e=RD3_DesktopManager.WebEntryPoint.WepBox;this.SetWidth(e.offsetWidth>320?e.offsetWidth:320)}else{this.SetWidth(320)}};PopupControl.prototype.RealizeTimeControl=function(){var c=this.Type==RD3_Glb.CTRL_DATETIME?"45px":"160px";var i=this.Type==RD3_Glb.CTRL_DATETIME?"45px":"160px";if(RD3_Glb.IsSmartPhone()){var g=RD3_DesktopManager.WebEntryPoint.WepBox;var f=g.offsetWidth>320?g.offsetWidth:320;c=(this.Type==RD3_Glb.CTRL_DATETIME?f/100*15:f/100*50)+"px";i=(this.Type==RD3_Glb.CTRL_DATETIME?f/100*15:f/100*50)+"px"}var j=(this.Type!=RD3_Glb.CTRL_DATETIME?0:this.DayContainer.offsetWidth+this.MonthContainer.offsetWidth+this.YearContainer.offsetWidth);this.HourContainer=document.createElement("div");this.HourContainer.className="ctrl-hour-container";this.HourContainer.style.left=j+"px";this.HourContainer.style.width=c;this.ContentBox.appendChild(this.HourContainer);this.HourPicker=document.createElement("div");this.HourPicker.className="ctrl-hour-picker";this.HourContainer.appendChild(this.HourPicker);var b=new Array();for(var d=0;d<24;d++){b[d]=d<10?"0"+d.toString():d.toString()}this.HourScroll=new IDScroll(this.Identifier+":hs",this.HourPicker,this.HourContainer,this);this.FillPicker(1,24,this.HourPicker,this.HourScroll,b);j=j+this.HourContainer.offsetWidth;this.MinuteContainer=document.createElement("div");this.MinuteContainer.className="ctrl-minute-container";this.MinuteContainer.style.left=j+"px";this.MinuteContainer.style.width=i;this.ContentBox.appendChild(this.MinuteContainer);this.MinutePicker=document.createElement("div");this.MinutePicker.className="ctrl-minute-picker";this.MinuteContainer.appendChild(this.MinutePicker);var e=new Array();for(var a=0;a<60;a++){e[a]=a<10?"0"+a.toString():a.toString()}this.MinuteScroll=new IDScroll(this.Identifier+":mms",this.MinutePicker,this.MinuteContainer,this);this.FillPicker(1,60,this.MinutePicker,this.MinuteScroll,e);this.DateSelector=document.createElement("div");this.DateSelector.className="ctrl-time-selector";this.ContentBox.appendChild(this.DateSelector);this.SetHeight(264);if(RD3_Glb.IsSmartPhone()){var g=RD3_DesktopManager.WebEntryPoint.WepBox;this.SetWidth(g.offsetWidth>320?g.offsetWidth:320)}else{this.SetWidth(320)}};PopupControl.prototype.FillPicker=function(h,g,f,c,e){var d=document.createElement("div");d.className="ctrl-picker-cell";f.appendChild(d);d=document.createElement("div");d.className="ctrl-picker-cell";f.appendChild(d);for(var a=h;a<=g;a++){var b="";if(e==undefined){b+=a}else{b+=e[a-1]}d=document.createElement("div");d.className="ctrl-picker-cell";d.textContent=b;f.appendChild(d)}d=document.createElement("div");d.className="ctrl-picker-cell";f.appendChild(d);d=document.createElement("div");d.className="ctrl-picker-cell";f.appendChild(d);c.DisplayScrollbar=false;c.SetSnap(0,44);c.ChangeSize()};PopupControl.prototype.Unrealize=function(){if(this.DayScroll){this.DayScroll.Unrealize()}if(this.MonthScroll){this.MonthScroll.Unrealize()}if(this.YearScroll){this.YearScroll.Unrealize()}if(this.HourScroll){this.HourScroll.Unrealize()}if(this.MinuteScroll){this.MinuteScroll.Unrealize()}PopupFrame.prototype.Unrealize.call(this)};PopupControl.prototype.AdaptLayout=function(){PopupFrame.prototype.AdaptLayout.call(this)};PopupControl.prototype.Open=function(){PopupFrame.prototype.Open.call(this)};PopupControl.prototype.SetDay=function(a){this.Day=a};PopupControl.prototype.SetMonth=function(a){this.Month=a;this.SetMaxDay(new Date(this.Year,a,0).getDate())};PopupControl.prototype.SetYear=function(a){this.Year=a};PopupControl.prototype.SetHour=function(a){this.Hour=a};PopupControl.prototype.SetMinute=function(a){this.Minute=a};PopupControl.prototype.SetMaxDay=function(b){var a=this.MaxDay;this.MaxDay=b;if(a!=b){var c=this.Day;this.FillPicker(1,this.MaxDay,this.DayPicker,this.DayScroll);this.Day=c;if(this.Day>this.MaxDay){this.SetDay(this.MaxDay)}this.UpdateScreen(this.Day,this.DayPicker)}};PopupControl.prototype.OnScrollToPage=function(c,e,b,a){if(a==this.DayScroll){this.SetDay(b)}if(a==this.MonthScroll){this.SetMonth(b)}if(a==this.YearScroll){this.SetYear(b+1949)}if(a==this.HourScroll){this.SetHour(b-1)}if(a==this.MinuteScroll){this.SetMinute(b-1)}};PopupControl.prototype.SetDate=function(a){this.SetYear(a.getFullYear());this.SetMonth(a.getMonth()+1);this.SetDay(a.getDate());this.UpdateScreen(this.Year-1949,this.YearPicker);this.UpdateScreen(this.Month,this.MonthPicker);this.UpdateScreen(this.Day,this.DayPicker)};PopupControl.prototype.ParseDate=function(a){glbCalMask=this.Cell.Mask;ParseInputValue(a);return new Date(glbYear,glbMonth-1,glbDay)};PopupControl.prototype.SetTime=function(a){this.SetHour(a.getHours());this.SetMinute(a.getMinutes());this.UpdateScreen(this.Hour+1,this.HourPicker);this.UpdateScreen(this.Minute+1,this.MinutePicker)};PopupControl.prototype.ParseTime=function(a,c){if(c==undefined){c=new Date();c.setFullYear(1899);c.setMonth(11);c.setDate(31)}var b=getToken(a,this.Cell.Mask,"hh");if(isNaN(b)){b=0}if(b>=0){c.setHours(b)}b=getToken(a,this.Cell.Mask,"nn");if(isNaN(b)){b=0}if(b>=0){c.setMinutes(b)}return c};PopupControl.prototype.UpdateScreen=function(a,b){var c=44*(a-1);RD3_Glb.SetTransform(b,"translate3d(0px,-"+c+"px,0px)")};PopupControl.prototype.Close=function(){switch(this.Type){case RD3_Glb.CTRL_DATE:glbSourceFieldValue=this.Cell.Text;glbCalMask=this.Cell.Mask;glbSourceField=this.Cell.IntCtrl;SetDate2(this.Day,this.Month,this.Year,false);break;case RD3_Glb.CTRL_TIME:var a=this.Cell.Text;var c=this.Cell.Mask;if(a.length==0){a=c}var b=setToken(a,c,"hh",this.Hour);b=setToken(b,c,"nn",this.Minute);this.Cell.IntCtrl.value=b;glbSourceField=this.Cell.IntCtrl;window.setTimeout("RD3_KBManager.IDRO_OnChange(glbSourceField);",50);break;case RD3_Glb.CTRL_DATETIME:var a=this.Cell.Text;var c=this.Cell.Mask;if(a.length==0){a=c}var b=setToken(a,c,"hh",this.Hour);b=setToken(b,c,"nn",this.Minute);glbSourceFieldValue=b;glbCalMask=this.Cell.Mask;glbSourceField=this.Cell.IntCtrl;SetDate2(this.Day,this.Month,this.Year,false);break;case RD3_Glb.CTRL_KEYNUM:glbSourceField=this.Cell.IntCtrl;window.setTimeout("RD3_KBManager.IDRO_OnChange(glbSourceField);",50);break}PopupFrame.prototype.Close.call(this)};PopupControl.prototype.RealizeNumericKeyboard=function(){var b=new Array("1","2","3","+","4","5","6","-","7","8","9","C","-","0",".","=");var e=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyPress', ev)");for(var f=0;f<4;f++){for(var a=0;a<4;a++){var c=document.createElement("div");this.ContentBox.appendChild(c);c.textContent=b[f*4+a];c.id="key_"+(f*4+a);c.className="ctrl-key-button";if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){if(RD3_Glb.IsAndroid()&&c.textContent=="="){c.ontouchend=e}else{c.ontouchstart=e}}else{c.onmousedown=e}c.style.left=((a+1)*24-20)+"%";c.style.top=((f+1)*24-20)+"%"}}RD3_Glb.AddClass(this.ContentBox,"ctrl-keyboard");this.CaptionBox.style.textAlign="right";if(RD3_Glb.IsSmartPhone()){var d=RD3_DesktopManager.WebEntryPoint.WepBox;this.SetWidth(d.offsetWidth>320?d.offsetWidth:320)}else{this.SetWidth(256)}this.SetHeight(300)};PopupControl.prototype.OnKeyPress=function(e){var h=e.target?e.target:e.srcElement;RD3_Glb.StopEvent(e);var d=h.textContent;switch(d){case"=":this.Close();break;case"C":var g=this.Cell.IntCtrl.value;var f=g.indexOf(glbDecSep);if(f>=0){var a=g.length-1;while(a>f){var c=true;if(g.charAt(a)=="0"){var b=g.substring(0,a).replace(new RegExp((glbThoSep=="."?"\\.":glbThoSep),"g"),"");b=formatNumber(b,glbMask);if(b.length==g.length){c=false}}if(c){break}a--}setCursorPos(this.Cell.IntCtrl,(a==f?a:a+1))}hk(null,8);break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":hk(null,48+parseInt(d,10));break;case"0":hk(null,48);break;case".":hk(null,188);break;case"+":this.Increment(1);break;case"-":if(h.id=="key_7"){this.Increment(-1)}else{hk(null,189)}break}this.UpdateCaption()};PopupControl.prototype.UpdateCaption=function(){if(this.Type!=RD3_Glb.CTRL_CPICKER){this.SetCaption((this.Cell.ParentField?this.Cell.ParentField.FormHeader+"=":"")+this.Cell.IntCtrl.value)}};PopupControl.prototype.Increment=function(c){var a=unmask(this.Cell.IntCtrl.value);var b=parseFloat(a)+c;if(isNaN(b)){b=0}this.Cell.IntCtrl.value=formatNumber(b+"",this.Cell.Mask)};PopupControl.prototype.RealizeColorChooser=function(){if(!this.Colors){return}var f=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnColorPress', ev)");var b=Math.ceil(this.Colors.length/6);var j=0;var d=this.CaptionBox?this.CaptionBox.offsetHeight:0;var h=0;for(var i=0;i<b;i++){var c=0;for(var k=0;k<6;k++){var g=k+i*6;if(g>=this.Colors.length){break}var a=document.createElement("div");a.id="color_"+g;a.className="ctrl-key-color";a.colorTag=this.Colors[g];if(this.Colors[g]=="transparent"){RD3_Glb.AddClass(a,"ctrl-color-transparent")}else{a.style.backgroundColor=this.Colors[g]}this.ContentBox.appendChild(a);if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){a.ontouchstart=f}else{a.onmousedown=f}var e=RD3_Glb.GetCurrentStyle(a);a.style.left=c+"px";a.style.top=j+"px";c=c+a.offsetWidth+parseInt("0"+e.marginLeft,10)+parseInt("0"+e.marginRight,10);if(k==5){j=j+a.offsetHeight+parseInt("0"+e.marginTop,10)+parseInt("0"+e.marginBottom,10)}if(k==0){d=d+a.offsetHeight+parseInt("0"+e.marginTop,10)+parseInt("0"+e.marginBottom,10)}h=c>h?c:h}}RD3_Glb.AddClass(this.ContentBox,"ctrl-colorchooser");if(RD3_Glb.IsSmartPhone()){var l=RD3_DesktopManager.WebEntryPoint.WepBox;this.SetWidth(l.offsetWidth>320?l.offsetWidth:320)}else{this.SetWidth(h)}this.SetHeight(d)};PopupControl.prototype.OnColorPress=function(b){var c=b.target?b.target:b.srcElement;RD3_Glb.StopEvent(b);var a=c.colorTag?c.colorTag:c.style.backgroundColor;this.CallBackFunction(a);this.Close()};function PopupDelay(){this.MessageText=RD3_ServerParams.DelayDefaultMessage;this.Progress=0;this.Total=-1;this.Present=-1;this.CanAbort=false;this.DelayType=RD3_Glb.DELAY;this.Identifier="DELAY"+Math.floor(Math.random()*100);this.Opened=false;this.Hidden=false;this.TextBox=null;this.ProgressBoxContainer=null;this.ProgressBox=null;this.InnerProgress=null;this.AbortButton=null;this.Interval=null;this.AnimationInterval=null;this.ProgressTimer=null;this.XmlReq=null}PopupDelay.prototype=new PopupFrame();PopupDelay.prototype.Realize=function(){this.Centered=true;this.Modal=true;this.HasCaption=false;this.CanMove=true;this.CanResize=false;this.Height=0;this.Width=0;if(RD3_ServerParams.BorderType==RD3_Glb.BORDER_DEFAULT){if(RD3_ServerParams.Theme=="seattle"){this.Borders=RD3_Glb.BORDER_THICK}else{this.Borders=RD3_Glb.BORDER_THIN}}else{this.Borders=RD3_ServerParams.BorderType}PopupFrame.prototype.Realize.call(this,"-message-box",this.UseDoubleMode());this.TextBox=document.createElement("div");this.TextBox.className="popup-delay-text";this.ProgressBoxContainer=document.createElement("div");this.ProgressBoxContainer.className="popup-delay-progress-container";this.ProgressBox=document.createElement("div");this.ProgressBox.className="popup-delay-progress-box";this.InnerProgress=document.createElement("div");this.InnerProgress.className="popup-delay-inner-progress-box";this.AbortButton=document.createElement("input");this.AbortButton.type="button";this.AbortButton.value=ClientMessages.MSG_POPUP_CancelButton;this.AbortButton.className="popup-progress-abortbutton";this.AbortButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'Abort', ev)");this.ProgressBox.appendChild(this.InnerProgress);this.ProgressBoxContainer.appendChild(this.ProgressBox);this.ContentBox.appendChild(this.TextBox);this.ContentBox.appendChild(this.ProgressBoxContainer);this.ContentBox.appendChild(this.AbortButton);this.SetType();this.SetText();this.SetCanAbort();if(this.UseDoubleMode()&&!this.AutoClose){if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.ModalBox.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnModalMouseDown', ev)")}else{this.ModalBox.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnModalMouseDown', ev)")}}};PopupDelay.prototype.Unrealize=function(){if(this.Realized){PopupFrame.prototype.Unrealize.call(this);this.TextBox=null;this.ProgressBox=null;this.InnerProgress=null;this.AbortButton=null;if(this.Interval){clearInterval(this.Interval)}this.Interval=null}};PopupDelay.prototype.AdaptLayout=function(){if(this.Hidden){return}var a=this.TextBox.offsetWidth;var c=(this.Type==RD3_Glb.MSG_INPUT)?RD3_ClientParams.PopupInputMinW:RD3_ClientParams.PopupDlgMinW;var f=800;if(RD3_DesktopManager.WebEntryPoint){var d=RD3_Glb.IsTouch()?0.8:0.5;f=Math.max(RD3_DesktopManager.WebEntryPoint.WepBox.clientWidth*d,c)}var b;b=(a<c)?c:a;b=(b>f)?f:b;this.SetWidth(b);RD3_Glb.AdaptToParent(this.ContentBox,0,-1);this.ProgressBoxContainer.style.width=(b-20)+"px";if(this.ProgressBoxContainer.offsetWidth>(b-20)){this.ProgressBoxContainer.style.width=(this.ProgressBoxContainer.offsetWidth-(this.ProgressBoxContainer.offsetWidth-this.ProgressBoxContainer.clientWidth))+"px"}this.ProgressBoxContainer.style.top=this.TextBox.offsetTop+this.TextBox.offsetHeight+"px";this.ProgressBoxContainer.style.left=(b-this.ProgressBoxContainer.offsetWidth)/2+"px";RD3_Glb.AdaptToParent(this.ProgressBox,-1,0);RD3_Glb.AdaptToParent(this.InnerProgress,-1,0);if(this.DelayType==RD3_Glb.DELAY&&!RD3_Glb.IsMobile()){RD3_Glb.AdaptToParent(this.ProgressBox,0,0)}this.AbortButton.style.top=this.ProgressBoxContainer.offsetTop+this.ProgressBoxContainer.offsetHeight+5+"px";this.AbortButton.style.left=(b-this.AbortButton.clientWidth)/2+"px";var e=0;if(this.CanAbort){e=this.AbortButton.offsetHeight+5}this.SetHeight(this.TextBox.offsetTop+this.TextBox.offsetHeight+this.ProgressBoxContainer.offsetHeight+(this.CaptionBox?this.CaptionBox.offsetHeight:0)+e+10);PopupFrame.prototype.AdaptLayout.call(this);this.Centered=false};PopupDelay.prototype.Open=function(c,b,a){if(c!=undefined){this.SetText(c)}if(b!=undefined){this.SetType(b)}if(!a){a=1}PopupFrame.prototype.Open.call(this);if(this.UseDoubleMode()){this.PopupBox.style.visibility="hidden";this.Hidden=true;if(this.AnimationInterval){clearInterval(this.AnimationInterval);this.AnimationInterval=null}this.DelayShowTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnModalMouseDown')",RD3_ClientParams.DelayDlgShowTime)}this.PopupBox.style.display="";this.ModalBox.style.display="";if(this.DelayType==RD3_Glb.DELAY){if(!this.AnimationInterval&&!this.UseDoubleMode()){this.AnimationInterval=window.setInterval("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'AnimateProgress')",10)}if(a==1){this.ProgressTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'RefreshProgressBar')",500)}}this.Opened=true};PopupDelay.prototype.Close=function(){if(!this.Realized){return}if(this.Interval){clearInterval(this.Interval);this.Interval=null}if(this.AnimationInterval){clearInterval(this.AnimationInterval);this.AnimationInterval=null}if(this.ProgressTimer){clearTimeout(this.ProgressTimer);this.ProgressTimer=null}if(this.DelayShowTimer){clearTimeout(this.DelayShowTimer);this.DelayShowTimer=null}this.SetProgress(0);this.SetCanAbort(false);this.SetTotal(-1);this.SetPresent(-1);this.PopupBox.style.display="none";this.ModalBox.style.display="none";this.InnerProgress.style.left="0px";this.Unrealize();this.Opened=false};PopupDelay.prototype.SetText=function(b){if(b!=undefined){this.MessageText=b}if(this.Realized){var a=this.MessageText;if(!a||a==""){a=RD3_ServerParams.DelayDefaultMessage}this.TextBox.innerHTML=a}};PopupDelay.prototype.SetType=function(a){if(a!=undefined){this.DelayType=a}if(this.Realized){if(this.DelayType==RD3_Glb.DELAY){}else{if(this.Interval){window.clearInterval(this.Interval);this.Interval=null}this.SetProgress(0);if(this.Hidden){window.setTimeout("document.getElementById('"+this.ModalBox.id+"').style.opacity = 1",5);window.setTimeout("RD3_Glb.SetTransform(document.getElementById('"+this.PopupBox.id+"'), 'scale3d(1,1,1)');",5);this.PopupBox.style.visibility="visible";this.Hidden=false;if(this.DelayShowTimer){clearTimeout(this.DelayShowTimer);this.DelayShowTimer=null}}}if(!this.AnimationInterval){this.AnimationInterval=window.setInterval("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'AnimateProgress')",10)}}};PopupDelay.prototype.SetProgress=function(a){this.Progress=a>100?a%100:a;this.ProgressBox.style.width=(this.ProgressBoxContainer.clientWidth/100*this.Progress)+"px"};PopupDelay.prototype.SetTotal=function(a){this.Total=a};PopupDelay.prototype.SetPresent=function(a){this.Present=a};PopupDelay.prototype.SetCanAbort=function(a){if(a!=undefined){this.CanAbort=a}if(this.Realized){this.AbortButton.style.display=this.CanAbort?"":"none";if(RD3_Glb.IsMobile()){this.PopupBox.style.zIndex=this.CanAbort?10000:""}else{if(this.CanAbort){this.PopupBox.className="popup-frame-container-abortible";this.PopupBox.style.zIndex=""}else{this.PopupBox.className="popup-frame-container";this.PopupBox.style.zIndex=300}}}};PopupDelay.prototype.AnimateProgress=function(){var a=this.InnerProgress.offsetLeft;a=(a)?a:0;if(this.InnerProgress.offsetLeft>(this.ProgressBox.clientWidth*3)){this.InnerProgress.style.left=(0-this.InnerProgress.offsetWidth)+"px"}else{this.InnerProgress.style.left=(a+RD3_ClientParams.PopupProgressSpeed)+"px"}};PopupDelay.prototype.ProgressTick=function(){if(this.DelayType==RD3_Glb.DELAY&&this.Realized&&!RD3_Glb.IsMobile()){this.SetProgress(this.Progress+10)}};PopupDelay.prototype.RefreshProgressBar=function(){this.ProgressTimer=null;if(window.RD4_Enabled){this.ProcessRequestChange()}else{this.XmlReq=RD3_DesktopManager.MessagePump.CreateRequest();this.XmlReq.onreadystatechange=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'ProcessRequestChange', ev)");if(this.XmlReq.overrideMimeType){this.XmlReq.overrideMimeType("text/xml")}this.XmlReq.open("GET","temp/"+RD3_DesktopManager.WebEntryPoint.ProgressBarFile+"?NOCACHE="+Math.random(),true);this.XmlReq.send("")}};PopupDelay.prototype.ProcessRequestChange=function(){var b=false;if(window.RD4_Enabled){b=true;if(RD4_ApplicationManager.progress){this.SetPresent(RD4_ApplicationManager.progress.present);this.SetTotal(RD4_ApplicationManager.progress.total);this.SetCanAbort(RD4_ApplicationManager.progress.canAbort);this.SetText(RD4_ApplicationManager.progress.message)}}else{if(this.XmlReq.readyState==4){if(this.XmlReq.status==200){if(this.XmlReq.responseXML.childNodes.length==0&&document.all){var a=this.XmlReq.responseText;if(a.indexOf("\n")!=-1){a=a.substring(a.indexOf("\n")+1)}this.XmlReq.responseXML.loadXML(a)}var c=this.XmlReq.responseXML;this.ParseXML(c);b=true}else{this.ProgressTimer=null}}}if(b){if(this.DelayType!=RD3_Glb.PROGRESS){this.SetType(RD3_Glb.PROGRESS)}this.SetProgress((this.Present/this.Total)*100);if(this.Realized){this.ProgressTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'RefreshProgressBar')",2000)}}};PopupDelay.prototype.ParseXML=function(a){var d=null;if(a.childNodes.length>0){d=a.childNodes[a.childNodes.length-1];for(var c=0;c<d.childNodes.length;c++){var b=d.childNodes[c];switch(b.nodeName){case"PRESENT":this.SetPresent(parseInt(b.firstChild.nodeValue));break;case"TOTAL":this.SetTotal(parseInt(b.firstChild.nodeValue));break;case"CANABORT":this.SetCanAbort(b.firstChild.nodeValue=="-1");break;case"MESSAGE":this.SetText(b.firstChild==null?"":b.firstChild.nodeValue);break}}}};PopupDelay.prototype.Abort=function(){if(this.FlashUploading){this.AbortButton.disabled=true;this.FlashUploading.cancelUpload();return}if(confirm(ClientMessages.DLG_DELAY_Abort)){this.AbortButton.disabled=true;if(window.RD4_Enabled){try{var c="SSManager";var a=openDatabase(c,"",c,5*1024*1024);var f="UPDATE Sessions SET Aborted = -1 WHERE SessionName = ''";try{a.transaction(function(e){e.executeSql(f)})}catch(h){throw h}finally{if(a&&a.close){a.close()}}}catch(h){WriteToConsole("Error while aborting progress of main session","error")}}else{var d=RD3_DesktopManager.WebEntryPoint.ProgressBarFile;var g=RD3_DesktopManager.WebEntryPoint.EntryPoint;var b=(g.indexOf(".aspx")>0);if(b){g="D_"+g}this.XmlReq=RD3_DesktopManager.MessagePump.CreateRequest();this.XmlReq.open("GET",g+"?FN="+d.substring(0,d.length-4)+"&NOCACHE="+Math.floor(Math.random()*1000000),true);this.XmlReq.send("")}if(this.ProgressTimer){window.clearTimeout(this.ProgressTimer)}}};PopupDelay.prototype.UseDoubleMode=function(a){return(RD3_Glb.IsMobile()&&RD3_ClientParams.DelayDlgShowTime>RD3_ClientParams.DelayDlgTime&&this.DelayType==RD3_Glb.DELAY)};PopupDelay.prototype.OnModalMouseDown=function(a){if(this.Hidden==false){return}if(this.DelayShowTimer){clearTimeout(this.DelayShowTimer);this.DelayShowTimer=null}window.setTimeout("document.getElementById('"+this.ModalBox.id+"').style.opacity = 1",5);window.setTimeout("RD3_Glb.SetTransform(document.getElementById('"+this.PopupBox.id+"'), 'scale3d(1,1,1)');",5);this.PopupBox.style.visibility="visible";this.Hidden=false;if(!this.AnimationInterval){this.AnimationInterval=window.setInterval("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'AnimateProgress')",10)}};function PopupError(a){this.ErrorHeader=a.getAttribute("hdr");this.ErrorNumber=a.getAttribute("num");this.ErrorDescription=a.getAttribute("des");this.ErrorEffects=a.getAttribute("eff");this.ErrorActions=a.getAttribute("act");this.ErrorSource=a.getAttribute("src");this.ErrorException=a.getAttribute("exc")?a.getAttribute("exc"):"";this.ErrorMessage=a.getAttribute("erm")?a.getAttribute("erm"):"";this.Identifier="PopupError"+Math.floor(Math.random()*100);this.HeaderDiv=null;this.ErrorIcon=null;this.CaptionTxt=null;this.ErrorNumTitle=null;this.ErrorNumTxt=null;this.ErrorDescTitle=null;this.ErrorDescTxt=null;this.ErrorEffTitle=null;this.ErrorEffTxt=null;this.ErrorActTitle=null;this.ErrorActTxt=null;this.ErrorSrcTitle=null;this.ErrorSrcTxt=null;this.ErrorButton=null;this.ErrorMessageTitle=null;this.ErrorMessageTxt=null;this.ErrorStackTitle=null;this.ErrorStackTxt=null}PopupError.prototype=new PopupFrame();PopupError.prototype.Realize=function(){if(RD3_ServerParams.BorderType==RD3_Glb.BORDER_DEFAULT){if(RD3_ServerParams.Theme=="seattle"){this.Borders=RD3_Glb.BORDER_THICK}else{this.Borders=RD3_Glb.BORDER_THIN}}else{this.Borders=RD3_ServerParams.BorderType}PopupFrame.prototype.Realize.call(this);this.PopupBox.style.zIndex=300;this.PopupBox.className="popup-error-frame-container";this.CaptionBox.className="popup-error-frame-caption";this.ContentBox.className="popup-error-frame-content";this.CaptionBox.innerHTML=ClientMessages.MSG_POPUP_MsgErrorCaption;this.ErrorIcon=document.createElement("img");this.ErrorIcon.src=RD3_Glb.GetImgSrc("images/errpg.gif");this.ErrorIcon.removeAttribute("width");this.ErrorIcon.removeAttribute("height");this.ErrorIcon.className="popup-error-icon";this.CaptionTxt=document.createElement("span");this.CaptionTxt.innerHTML=this.ErrorHeader;this.CaptionTxt.className="popup-error-caption-text";this.HeaderDiv=document.createElement("div");this.HeaderDiv.appendChild(this.ErrorIcon);this.HeaderDiv.appendChild(this.CaptionTxt);this.ContentBox.appendChild(this.HeaderDiv);this.ErrorNumTitle=document.createElement("span");this.ErrorNumTxt=document.createElement("div");this.ErrorNumTitle.className="popup-error-content-title";this.ErrorNumTxt.className="popup-error-content-title";this.ErrorNumTitle.innerHTML=RD3_ServerParams.ErrorNum;this.ErrorNumTxt.innerHTML=this.ErrorNumber;this.ContentBox.appendChild(this.ErrorNumTitle);this.ContentBox.appendChild(this.ErrorNumTxt);if(this.ErrorDescription.length>0){this.ErrorDescTitle=document.createElement("span");this.ErrorDescTxt=document.createElement("div");this.ErrorDescTitle.className="popup-error-content-title";this.ErrorDescTxt.className="popup-error-content-txt";this.ErrorDescTitle.innerHTML="";this.ErrorDescTxt.innerHTML=this.ErrorDescription;this.ContentBox.appendChild(this.ErrorDescTitle);this.ContentBox.appendChild(this.ErrorDescTxt)}if(this.ErrorEffects.length>0){this.ErrorEffTitle=document.createElement("span");this.ErrorEffTxt=document.createElement("div");this.ErrorEffTitle.className="popup-error-content-title";this.ErrorEffTxt.className="popup-error-content-txt";this.ErrorEffTitle.innerHTML=RD3_ServerParams.ErrorEffects;this.ErrorEffTxt.innerHTML=this.ErrorEffects;this.ContentBox.appendChild(this.ErrorEffTitle);this.ContentBox.appendChild(this.ErrorEffTxt)}if(this.ErrorActions.length>0){this.ErrorActTitle=document.createElement("span");this.ErrorActTxt=document.createElement("div");this.ErrorActTitle.className="popup-error-content-title";this.ErrorActTxt.className="popup-error-content-txt";this.ErrorActTitle.innerHTML=RD3_ServerParams.ErrorAction;this.ErrorActTxt.innerHTML=this.ErrorActions;this.ContentBox.appendChild(this.ErrorActTitle);this.ContentBox.appendChild(this.ErrorActTxt)}if(this.ErrorSource.length>0){this.ErrorSrcTitle=document.createElement("span");this.ErrorSrcTxt=document.createElement("div");this.ErrorSrcTitle.className="popup-error-content-title";this.ErrorSrcTxt.className="popup-error-content-txt";this.ErrorSrcTitle.innerHTML=RD3_ServerParams.ErrorSrc;this.ErrorSrcTxt.innerHTML=this.ErrorSource;this.ContentBox.appendChild(this.ErrorSrcTitle);this.ContentBox.appendChild(this.ErrorSrcTxt)}if(RD3_ServerParams.Theme=="Classic"){this.ErrorButton=document.createElement("div");this.ErrorButton.innerHTML=RD3_ServerParams.ErrorButton}else{this.ErrorButton=document.createElement("div");if(RD3_ServerParams.Theme!="zen"){this.ErrorButton.style.background="url("+RD3_Glb.GetImgSrc("images/errbk.gif")+")"}this.ErrorButton.innerHTML=RD3_ServerParams.ErrorButton}this.ErrorButton.className="popup-error-button";this.ErrorButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClickEB', ev)");this.ContentBox.appendChild(this.ErrorButton);if(RD3_Glb.IsTouch()){this.ContentBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClickEB', ev)")}if(this.ErrorMessage.length>0){this.ErrorMessageTitle=document.createElement("span");this.ErrorMessageTxt=document.createElement("div");this.ErrorMessageTitle.className="popup-error-content-title";this.ErrorMessageTxt.className="popup-error-content-txt";this.ErrorMessageTitle.innerHTML="Error Details:";this.ErrorMessageTxt.innerHTML=this.ErrorMessage;this.ContentBox.appendChild(this.ErrorMessageTitle);this.ContentBox.appendChild(this.ErrorMessageTxt)}if(this.ErrorException.length>0){this.ErrorStackTitle=document.createElement("span");this.ErrorStackTxt=document.createElement("div");this.ErrorStackTitle.className="popup-error-content-title";this.ErrorStackTxt.className="popup-error-content-txt";this.ErrorStackTitle.innerHTML="Stack Trace:";this.ErrorStackTxt.innerHTML=this.ErrorException;this.ContentBox.appendChild(this.ErrorStackTitle);this.ContentBox.appendChild(this.ErrorStackTxt)}this.PopupBox.onkeydown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyPress', ev)");this.ModalBox.onkeydown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyPress', ev)");if(!RD3_Glb.IsIE(10,false)){var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyPress', ev)");if(document.addEventListener){document.body.addEventListener("keyup",a,true)}else{document.body.attachEvent("onkeyup",a)}}};PopupError.prototype.Unrealize=function(){PopupFrame.prototype.Unrealize.call(this);this.ErrorIcon=null;this.CaptionTxt=null;this.ErrorNumTitle=null;this.ErrorNumTxt=null;this.ErrorDescTitle=null;this.ErrorDescTxt=null;this.ErrorEffTitle=null;this.ErrorEffTxt=null;this.ErrorActTitle=null;this.ErrorActTxt=null;this.ErrorSrcTitle=null;this.ErrorSrcTxt=null;this.ErrorButton=null;this.ErrorMessageTitle=null;this.ErrorMessageTxt=null;this.ErrorStackTitle=null;this.ErrorStackTxt=null;if(!RD3_Glb.IsIE(10,false)){var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyPress', ev)");if(document.addEventListener){document.body.removeEventListener("keyup",a,true)}}};PopupError.prototype.AdaptLayout=function(){var a=RD3_Glb.CalcBottom(this.CaptionBox)+5;this.ContentBox.style.top=a+"px";var b=this.HeaderDiv.offsetHeight;this.ErrorNumTitle.style.top=b+"px";this.ErrorNumTitle.style.left="10px";this.ErrorNumTxt.style.top=b+"px";this.ErrorNumTxt.style.left="100px";b=Math.max(RD3_Glb.CalcBottom(this.ErrorNumTitle),RD3_Glb.CalcBottom(this.ErrorNumTxt))+20;if(this.ErrorDescription.length>0){this.ErrorDescTitle.style.top=b+"px";this.ErrorDescTitle.style.left="10px";this.ErrorDescTxt.style.top=b+"px";this.ErrorDescTxt.style.left="100px";b=Math.max(RD3_Glb.CalcBottom(this.ErrorDescTitle),RD3_Glb.CalcBottom(this.ErrorDescTxt))+20}if(this.ErrorEffects.length>0){this.ErrorEffTitle.style.top=b+"px";this.ErrorEffTitle.style.left="10px";this.ErrorEffTxt.style.top=b+"px";this.ErrorEffTxt.style.left="100px";b=Math.max(RD3_Glb.CalcBottom(this.ErrorEffTitle),RD3_Glb.CalcBottom(this.ErrorEffTxt))+20}if(this.ErrorActions.length>0){this.ErrorActTitle.style.top=b+"px";this.ErrorActTitle.style.left="10px";this.ErrorActTxt.style.top=b+"px";this.ErrorActTxt.style.left="100px";b=Math.max(RD3_Glb.CalcBottom(this.ErrorActTitle),RD3_Glb.CalcBottom(this.ErrorActTxt))+20}if(this.ErrorSource.length>0){this.ErrorSrcTitle.style.top=b+"px";this.ErrorSrcTitle.style.left="10px";this.ErrorSrcTxt.style.top=b+"px";this.ErrorSrcTxt.style.left="100px";b=Math.max(RD3_Glb.CalcBottom(this.ErrorSrcTitle),RD3_Glb.CalcBottom(this.ErrorSrcTxt))+20}this.ErrorButton.style.top=b+"px";this.ErrorButton.style.left="10px";b=RD3_Glb.CalcBottom(this.ErrorButton)+40;if(this.ErrorMessage.length>0){this.ErrorMessageTitle.style.top=b+"px";this.ErrorMessageTitle.style.left="10px";this.ErrorMessageTxt.style.top=b+"px";this.ErrorMessageTxt.style.left="100px";b=Math.max(RD3_Glb.CalcBottom(this.ErrorMessageTitle),RD3_Glb.CalcBottom(this.ErrorMessageTxt))+20}if(this.ErrorException.length>0){this.ErrorStackTitle.style.top=b+"px";this.ErrorStackTitle.style.left="10px";this.ErrorStackTxt.style.top=b+"px";this.ErrorStackTxt.style.left="100px";b=Math.max(RD3_Glb.CalcBottom(this.ErrorStackTitle),RD3_Glb.CalcBottom(this.ErrorStackTxt))+20}this.ContentBox.style.width="550px";this.ContentBox.style.height="370px";this.SetWidth(600);this.SetHeight(400);this.SetLeft((document.body.offsetWidth-this.Width)/2);this.SetTop((document.body.offsetHeight-this.Height)/2);PopupFrame.prototype.AdaptLayout.call(this);this.Centered=false};PopupError.prototype.OnClickEB=function(a){this.Close()};PopupError.prototype.OnKeyPress=function(b){var a=(b.charCode)?b.charCode:b.keyCode;if(a==13||a==32||a==27){this.Close()}return true};PopupError.prototype.Open=function(){PopupFrame.prototype.Open.call(this);RD3_DesktopManager.WebEntryPoint.SoundAction("error","play")};function PopupFrame(b,a){this.Left=0;this.Top=0;this.Width=0;this.Height=0;this.Centered=true;this.Modal=true;this.AutoClose=false;this.ModalAnim=false;this.HasCaption=true;this.WepClick=true;this.CanMove=true;this.CanResize=false;this.Borders=0;if(!this.Identifier){this.Identifier="POPUP"+Math.floor(Math.random()*1000)}this.Realized=false;this.NoOpacity=true;this.PopupBox=null;this.CoverBox=null;this.ModalBox=null;this.CaptionBox=null;this.ContentBox=null;this.CornerTL=null;this.CornerTR=null;this.CornerBL=null;this.CornerBR=null;this.BorderTop=null;this.BorderBottom=null;this.BorderLeft=null;this.BorderRight=null;this.LastActiveObject=null;this.LastActiveElement=null;this.TheForm=(b)?b:null;this.Owner=a;this.ObjToAttach=null}PopupFrame.prototype.SetLeft=function(a){if(a!=undefined){this.Left=a}if(this.Realized){this.PopupBox.style.left=this.Left+"px"}};PopupFrame.prototype.SetTop=function(a){if(a!=undefined){this.Top=a}if(this.Realized){this.PopupBox.style.top=this.Top+"px"}};PopupFrame.prototype.SetWidth=function(a){if(a!=undefined){this.Width=a}if(this.Realized&&this.Width>0){this.PopupBox.style.width=this.Width+"px"}};PopupFrame.prototype.SetHeight=function(a){if(a!=undefined){this.Height=a}if(this.Realized&&this.Height>0){this.PopupBox.style.height=this.Height+"px"}};PopupFrame.prototype.Realize=function(a,c){if(!RD3_Glb.IsMobile()){a=""}this.Classe=a;if(this.Modal){this.ModalBox=document.createElement("div");this.ModalBox.className="popup-modal-frame"+a;if(!RD3_Glb.IsMobile()&&RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR){this.ModalBox.style.zIndex=10}if(this.AutoClose){if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.ModalBox.ontouchstart=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClickOut', ev)")}else{this.ModalBox.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClickOut', ev)")}}else{this.ModalBox.onclick=new Function("ev","return RD3_DesktopManager.WebEntryPoint.OnClick(ev);")}this.ModalBox.id=this.Identifier+":mb";if(RD3_Glb.IsMobile()){if(!c){window.setTimeout("document.getElementById('"+this.ModalBox.id+"').style.opacity = 1;",5)}RD3_DesktopManager.WebEntryPoint.WepBox.appendChild(this.ModalBox)}else{document.body.appendChild(this.ModalBox)}}this.PopupBox=document.createElement("div");this.PopupBox.className="popup-frame-container"+a;this.PopupBox.id=this.Identifier+":pb";if(a=="-message-box"){if(!c){window.setTimeout("RD3_Glb.SetTransform(document.getElementById('"+this.PopupBox.id+"'), 'scale3d(1,1,1)');",5)}}if(a=="-modal"||this.ModalAnim){if(RD3_Glb.IsIE(10,true)){this.PopupBox.style.visibility="hidden"}RD3_Glb.SetTransform(this.PopupBox,"translate3d(0px,"+(RD3_DesktopManager.WebEntryPoint.WepBox.offsetHeight-this.Top)+"px,0px)");RD3_Glb.SetTransitionProperty(this.PopupBox,"-webkit-transform");RD3_Glb.AddEndTransaction(this.PopupBox,new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEndAnimation', ev)"),false);if(RD3_Glb.IsIE(10,true)){window.setTimeout("document.getElementById('"+this.PopupBox.id+"').style.visibility=''; RD3_Glb.SetTransform(document.getElementById('"+this.PopupBox.id+"'), 'translate3d(0px,0px,0px)');",100)}else{window.setTimeout("RD3_Glb.SetTransform(document.getElementById('"+this.PopupBox.id+"'), 'translate3d(0px,0px,0px)');",5)}}if(a=="-popover"){window.setTimeout(new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEndAnimation', ev)"),250)}if(this.Borders==RD3_Glb.BORDER_THIN||RD3_Glb.IsIE(6)){RD3_Glb.AddClass(this.PopupBox,"popup-border-thin"+a)}if(this.HasCaption){this.CaptionBox=document.createElement("div");this.CaptionBox.className="popup-frame-caption"+a;this.CaptionBox.id=this.Identifier+":cap";this.PopupBox.appendChild(this.CaptionBox)}this.ContentBox=document.createElement("div");this.ContentBox.className="popup-frame-content"+a;this.PopupBox.appendChild(this.ContentBox);if(RD3_Glb.IsMobile()){RD3_DesktopManager.WebEntryPoint.WepBox.appendChild(this.PopupBox)}else{document.body.appendChild(this.PopupBox)}this.PopupBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev)");this.Realized=true;this.SetLeft();this.SetTop();this.SetWidth();this.SetHeight();this.AttachTo();if(this.Borders==RD3_Glb.BORDER_THICK&&!RD3_Glb.IsIE(6)&&RD3_ServerParams.Theme!="zen"){this.BorderTop=document.createElement("div");this.BorderTop.className="popup-border-top";this.BorderBottom=document.createElement("div");this.BorderBottom.className="popup-border-bottom";this.BorderLeft=document.createElement("div");this.BorderLeft.className="popup-border-left";this.BorderRight=document.createElement("div");this.BorderRight.className="popup-border-right";this.CornerTL=document.createElement("div");this.CornerTL.className="popup-corner-top-left";this.CornerTR=document.createElement("div");this.CornerTR.className="popup-corner-top-right";this.CornerBL=document.createElement("div");this.CornerBL.className="popup-corner-bottom-left";this.CornerBR=document.createElement("div");this.CornerBR.className="popup-corner-bottom-right";var b=this.TheForm?this.TheForm.Identifier:this.Identifier;this.BorderTop.setAttribute("id",b+":bd0");this.BorderBottom.setAttribute("id",b+":bd1");this.BorderLeft.setAttribute("id",b+":bd2");this.BorderRight.setAttribute("id",b+":bd3");this.CornerTL.setAttribute("id",b+":bd4");this.CornerTR.setAttribute("id",b+":bd5");this.CornerBL.setAttribute("id",b+":bd6");this.CornerBR.setAttribute("id",b+":bd7");this.PopupBox.appendChild(this.BorderTop);this.PopupBox.appendChild(this.BorderBottom);this.PopupBox.appendChild(this.BorderLeft);this.PopupBox.appendChild(this.BorderRight);this.PopupBox.appendChild(this.CornerTL);this.PopupBox.appendChild(this.CornerTR);this.PopupBox.appendChild(this.CornerBL);this.PopupBox.appendChild(this.CornerBR)}if(!RD3_Glb.IsMobile()&&RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR){this.PopupBox.style.zIndex=10}RD3_DesktopManager.ObjectMap.add(this.Identifier,this)};PopupFrame.prototype.AdaptLayout=function(){if(this.CaptionBox){this.ContentBox.style.top=this.CaptionBox.offsetHeight+"px";RD3_Glb.AdaptToParent(this.CaptionBox,0,-1)}var b=this.Classe=="-popover"?4:-1;var a=this.Classe=="-popover"?2:0;if(RD3_Glb.IsQuadro()){b=0;a=0}RD3_Glb.AdaptToParent(this.ContentBox,b,((this.CaptionBox)?this.CaptionBox.offsetHeight:0)+a);if(this.Centered){var c=(RD3_DesktopManager.WebEntryPoint.WepBox.clientWidth-this.PopupBox.offsetWidth)/2;c=c<0?0:c;this.SetLeft(c);var d=(RD3_DesktopManager.WebEntryPoint.WepBox.clientHeight-this.PopupBox.offsetHeight)/2;d=d<0?0:d;this.SetTop(d)}if(this.Borders==RD3_Glb.BORDER_THICK&&!RD3_Glb.IsIE(6)&&RD3_ServerParams.Theme!="zen"){if(this.BorderTop.style.display!="none"){this.BorderTop.style.top=(0-this.BorderTop.offsetHeight)+"px";this.BorderTop.style.left=(0)+"px";this.BorderTop.style.width=(this.Width)+"px"}if(this.BorderBottom.style.display!="none"){this.BorderBottom.style.top=(0+this.Height)+"px";this.BorderBottom.style.left=(0)+"px";this.BorderBottom.style.width=(this.Width)+"px"}if(this.BorderLeft.style.display!="none"){this.BorderLeft.style.left=(0-this.BorderLeft.offsetWidth)+"px";this.BorderLeft.style.top=(0)+"px";this.BorderLeft.style.height=(this.PopupBox.offsetHeight)+"px"}if(this.BorderRight.style.display!="none"){this.BorderRight.style.left=(0+this.Width)+"px";this.BorderRight.style.top=(0)+"px";this.BorderRight.style.height=(this.Height)+"px"}if(this.CornerTL.style.display!="none"){this.CornerTL.style.left=this.BorderLeft.offsetLeft+"px";this.CornerTL.style.top=this.BorderTop.offsetTop+"px"}if(this.CornerTR.style.display!="none"){this.CornerTR.style.left=this.BorderRight.offsetLeft+"px";this.CornerTR.style.top=this.BorderTop.offsetTop+"px"}if(this.CornerBL.style.display!="none"){this.CornerBL.style.left=this.BorderLeft.offsetLeft+"px";this.CornerBL.style.top=this.BorderBottom.offsetTop+"px"}if(this.CornerBR.style.display!="none"){this.CornerBR.style.left=this.BorderRight.offsetLeft+"px";this.CornerBR.style.top=this.BorderBottom.offsetTop+"px"}}};PopupFrame.prototype.Unrealize=function(){if(this.IDScroll){this.IDScroll.Unrealize()}this.IDScroll=null;if(this.OrgContentParent){while(this.ContentBox.firstChild){var a=this.ContentBox.firstChild;this.ContentBox.removeChild(a);this.OrgContentParent.appendChild(a)}}if(this.OrgHeaderParent){var a=this.CaptionBox.firstChild;this.CaptionBox.removeChild(a);this.OrgHeaderParent.insertBefore(a,this.OrgHeaderSibling)}if(this.PopupBox){this.PopupBox.parentNode.removeChild(this.PopupBox)}if(this.ModalBox){this.ModalBox.parentNode.removeChild(this.ModalBox)}if(this.ArrowBox){this.ArrowBox.parentNode.removeChild(this.ArrowBox)}if(this.ArrowBorder){this.ArrowBorder.parentNode.removeChild(this.ArrowBorder)}RD3_DesktopManager.ObjectMap[this.Identifier]=null;RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.PopupBox=null;this.CoverBox=null;this.ModalBox=null;this.ArrowBox=null;this.CaptionBox=null;this.ContentBox=null;this.TheForm=null;this.Realized=false};PopupFrame.prototype.Open=function(){if(this.Modal){this.LastActiveObject=RD3_KBManager.ActiveObject;this.LastActiveElement=RD3_KBManager.ActiveElement}if(!this.Realized){this.Realize()}if(this.Modal){try{this.ContentBox.focus();RD3_KBManager.ActiveObject=this;RD3_KBManager.ActiveElement=this.ContentBox}catch(a){document.body.focus()}}this.AdaptLayout()};PopupFrame.prototype.Close=function(){RD3_DDManager.RemovePopup(this);if(RD3_Glb.IsMobile()){var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'Close2', ev)");if(RD3_Glb.IsIE()){window.setTimeout(a,500)}else{RD3_Glb.AddEndTransaction(this.PopupBox,a,false)}this.ModalBox.style.opacity=0;if(this.Classe=="-message-box"){RD3_Glb.SetTransitionProperty(this.PopupBox,"opacity");this.PopupBox.style.opacity=0}else{if(this.Classe=="-modal"||this.ModalAnim){RD3_Glb.SetTransform(this.PopupBox,"translate3d(0px,"+(RD3_DesktopManager.WebEntryPoint.WepBox.offsetHeight-this.Top)+"px,0px)")}else{if(this.Classe=="-popover"){this.PopupBox.style.opacity=0;if(this.ArrowBox){this.ArrowBox.style.opacity=0}if(this.ArrowBorder){this.ArrowBorder.style.opacity=0}this.Close2()}}}}else{this.Close2()}};PopupFrame.prototype.Close2=function(){if(this.Owner&&this.Owner.OnClosePopup){this.Owner.OnClosePopup(this)}if(RD3_Glb.IsMobile()&&this.TheForm){this.TheForm.Unrealize()}else{this.Unrealize()}if(RD3_Glb.IsAndroid()){RD3_DDManager.ChompClick()}else{if(this.Modal){RD3_KBManager.ActiveObject=this.LastActiveObject;RD3_KBManager.ActiveElement=this.LastActiveElement;RD3_KBManager.CheckFocus=true}}};PopupFrame.prototype.IsTransformable=function(){return(this.CanMove||this.CanResize)};PopupFrame.prototype.IsMoveable=function(){return this.CanMove};PopupFrame.prototype.IsResizable=function(){return this.CanResize};PopupFrame.prototype.DropElement=function(){return this.PopupBox};PopupFrame.prototype.OnTransform=function(a,e,b,c,d){if(this.CanMove){this.SetLeft(a);this.SetTop(e)}if(this.CanResize){this.SetHeight(c);this.SetWidth(b)}};PopupFrame.prototype.OnClick=function(a){if(this.WepClick){RD3_DesktopManager.WebEntryPoint.OnClick(a)}if(this.TheForm){this.TheForm.OnFLClick(a,true)}return true};PopupFrame.prototype.BringToFront=function(){if(this.PopupBox){this.PopupBox.parentNode.removeChild(this.PopupBox);if(RD3_Glb.IsMobile()){RD3_DesktopManager.WebEntryPoint.WepBox.appendChild(this.PopupBox)}else{document.body.appendChild(this.PopupBox)}}};PopupFrame.prototype.SetActive=function(a){if(!a&&!this.CoverBox){this.CoverBox=document.createElement("div");this.PopupBox.appendChild(this.CoverBox)}if(this.CoverBox){this.CoverBox.className="form-cover"+((a)?"":"-inactive")}};PopupFrame.prototype.SetVisible=function(a){this.PopupBox.style.display=a?"":"none"};PopupFrame.prototype.ShowThickBorders=function(a){if(this.Borders!=RD3_Glb.BORDER_THICK||RD3_Glb.IsIE(6)||RD3_ServerParams.Theme=="zen"){return}if(a){RD3_Glb.RemoveClass(this.PopupBox,"popup-border-thin");this.BorderTop.style.display="";this.BorderBottom.style.display="";this.BorderLeft.style.display="";this.BorderRight.style.display="";this.CornerTL.style.display="";this.CornerTR.style.display="";this.CornerBL.style.display="";this.CornerBR.style.display=""}else{this.BorderTop.style.display="none";this.BorderBottom.style.display="none";this.BorderLeft.style.display="none";this.BorderRight.style.display="none";this.CornerTL.style.display="none";this.CornerTR.style.display="none";this.CornerBL.style.display="none";this.CornerBR.style.display="none";RD3_Glb.AddClass(this.PopupBox,"popup-border-thin")}};PopupFrame.prototype.ApplyCursor=function(a){if(this.Borders==RD3_Glb.BORDER_THICK&&!RD3_Glb.IsIE(6)&&RD3_ServerParams.Theme!="zen"){this.CornerTL.style.cursor=a;this.CornerBL.style.cursor=a;this.CornerTR.style.cursor=a;this.CornerBR.style.cursor=a;this.BorderLeft.style.cursor=a;this.BorderRight.style.cursor=a;this.BorderTop.style.cursor=a;this.BorderBottom.style.cursor=a}};PopupFrame.prototype.Host=function(g,b,a,d){if(g){this.OrgHeaderParent=g.parentNode;this.OrgHeaderSibling=g.nextSibling;g.parentNode.removeChild(g);this.CaptionBox.appendChild(g)}if(b){this.OrgContentParent=b;while(b.firstChild){var f=b.firstChild;f.parentNode.removeChild(f);this.ContentBox.appendChild(f)}if(a){var e=f;var c=this.ContentBox;this.IDScroll=new IDScroll(this.Identifier,e,c,this.Owner);if(d){this.IDScroll.MarginTop=d}}}};PopupFrame.prototype.HostForm=function(b){var a=b.GetFirstToolbar();if(!a){a=b.CaptionBox}this.OrgHeaderParent=a.parentNode;this.OrgHeaderSibling=a.nextSibling;a.parentNode.removeChild(a);this.CaptionBox.appendChild(a);this.OrgContentParent=b.FramesBox.parentNode;b.FramesBox.parentNode.removeChild(b.FramesBox);this.ContentBox.appendChild(b.FramesBox);window.setTimeout("RD3_DesktopManager.CallEventHandler('"+b.Identifier+"', 'AdaptLayout');",50)};PopupFrame.prototype.OnClickOut=function(c,a){if(this.AutoClose){var b=true;if(this.Owner&&this.Owner.OnAutoClosePopup){b=this.Owner.OnAutoClosePopup(this)}if(this.TheForm&&this.TheForm.OnAutoClosePopup){b=this.TheForm.OnAutoClosePopup(this)}if(b){this.Close()}}};PopupFrame.prototype.AttachTo=function(k){if(k!=undefined){this.ObjToAttach=k}if(this.Realized&&this.ObjToAttach){var m=RD3_DesktopManager.WebEntryPoint.WepBox;var e=0;var a=0;if(this.ObjToAttach.Point){e=this.ObjToAttach.x;a=this.ObjToAttach.y}else{e=RD3_Glb.GetScreenLeft(this.ObjToAttach,true);a=RD3_Glb.GetScreenTop(this.ObjToAttach,true);if(RD3_Glb.IsMobile()&&this.Type==RD3_Glb.CTRL_CPICKER&&document.body.scrollTop>0){a=(a-document.body.scrollTop>0?a-document.body.scrollTop:a)}}var l=this.ObjToAttach.offsetWidth;var f=this.ObjToAttach.offsetHeight;var i=true;if(RD3_Glb.IsSmartPhone()){this.SetLeft(0);this.SetTop(m.offsetHeight-this.Height)}else{var j=e+(l-this.Width)/2;if(j<8){j=8}if(j+this.Width>m.offsetWidth){j=m.offsetWidth-this.Width-4}this.SetLeft(j);var g=false;var c=a+f+12;if(c+this.Height>m.offsetHeight){c=a-this.Height-15;g=true}if(c<0){c=2;i=false}this.SetTop(c)}if(!RD3_Glb.IsSmartPhone()&&i){if(!this.ArrowBox){this.ArrowBox=document.createElement("div");this.ArrowBox.setAttribute("id",this.Identifier+":arr");this.ArrowBox.className="popover-arrow-box";this.PopupBox.parentNode.insertBefore(this.ArrowBox,this.PopupBox)}if(!this.ArrowBorder&&!g&&!this.TheForm){this.ArrowBorder=document.createElement("div");this.ArrowBorder.setAttribute("id",this.Identifier+":arb");this.ArrowBorder.className="popover-arrow-border";this.PopupBox.parentNode.appendChild(this.ArrowBorder)}}var b=e+l/2-10;if(b<this.Left){b=this.Left+5}if(this.ArrowBox){var d=10;if(RD3_Glb.IsMobile7()){RD3_Glb.SetTransform(this.ArrowBox,(g)?"rotate(225deg)":"");this.ArrowBox.style.background=(g)?"-webkit-gradient(linear, left top, right bottom, from(white), color-stop(0.5, white), color-stop(0.5, transparent), to(transparent))":"";d=11}else{this.ArrowBox.style.background=(g||this.TheForm)?"black":""}if(RD3_Glb.IsQuadro()){b+=1}this.ArrowBox.style.left=b+"px";this.ArrowBox.style.top=(g?(this.Top+this.Height-12):(this.Top-d))+"px"}if(this.ArrowBorder){this.ArrowBorder.style.top=(this.Top)+"px";this.ArrowBorder.style.left=(b-2)+"px"}}};PopupFrame.prototype.SetCaption=function(a){if(this.CaptionBox){if(!this.CaptionSpan){this.CaptionSpan=document.createElement("span");this.CaptionSpan.className="popup-caption-span";this.CaptionBox.appendChild(this.CaptionSpan)}this.CaptionSpan.textContent=a;if(RD3_Glb.IsQuadro()){RD3_Glb.AdjustCaptionPosition(this.CaptionBox,this.CaptionSpan)}}};PopupFrame.prototype.OnEndAnimation=function(a){if(this.TheForm){if(RD3_DesktopManager.WebEntryPoint.InResponse){this.TheForm.RecalcLayout=true}else{this.TheForm.AdaptLayout()}}if(this instanceof PopupControl&&RD3_Glb.IsQuadro()){if(this.Type==RD3_Glb.CTRL_DATETIME||this.Type==RD3_Glb.CTRL_DATE||this.Type==RD3_Glb.CTRL_TIME){this.ContentBox.removeChild(this.DateSelector);this.ContentBox.appendChild(this.DateSelector)}}};function PopupPreview(a,b,c){this.PreviewUrl=a;this.PreviewCaption=b;this.PreviewMime=c;this.Identifier="POPPRE"+Math.floor(Math.random()*100);this.Loaded=false;this.IE=false;this.CloseButton=null;this.CaptionTxt=null;this.PreviewFrame=null}PopupPreview.prototype=new PopupFrame();PopupPreview.prototype.Realize=function(a){if(RD3_ServerParams.BorderType==RD3_Glb.BORDER_DEFAULT){if(RD3_ServerParams.Theme=="seattle"){this.Borders=RD3_Glb.BORDER_THICK}else{this.Borders=RD3_Glb.BORDER_THIN}}else{this.Borders=RD3_ServerParams.BorderType}this.Width=300;this.Height=170;PopupFrame.prototype.Realize.call(this,a);RD3_Glb.AddClass(this.CaptionBox,"popup-preview-caption");this.PopupBox.style.visibility="hidden";this.ContentBox.className="popup-preview-content-frame";this.CaptionTxt=document.createElement("span");var c=document.createTextNode(this.PreviewCaption);this.CaptionTxt.appendChild(c);this.PreviewFrame=document.createElement("iframe");this.PreviewFrame.src=this.PreviewUrl;this.PreviewFrame.className="popup-preview-iframe";this.IE=RD3_Glb.IsIE(10,false);if(this.IE){this.PreviewFrame.onreadystatechange=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}else{if(RD3_Glb.IsIE(10,true)&&this.PreviewMime&&this.PreviewMime=="application/pdf"){this.Loaded=true;var b=this;var d=function(){b.AdaptLayout()};window.setTimeout(d,0);this.PopupBox.style.visibility=""}else{this.PreviewFrame.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}}this.CloseButton=document.createElement("img");this.CloseButton.className="popup-preview-close";this.CloseButton.src=RD3_Glb.GetImgSrc("images/closef.gif");this.CloseButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCloseClick', ev)");this.ContentBox.appendChild(this.PreviewFrame);if(!RD3_Glb.IsMobile()||a!="-popover"){this.CaptionBox.appendChild(this.CloseButton)}this.CaptionBox.appendChild(this.CaptionTxt)};PopupPreview.prototype.Unrealize=function(){PopupFrame.prototype.Unrealize.call(this);this.CloseButton=null;this.CaptionTxt=null;this.PreviewFrame=null};PopupPreview.prototype.AdaptLayout=function(){if(this.Loaded){var e=this.CaptionBox.offsetHeight;var f=RD3_DesktopManager.WebEntryPoint.WepBox.clientWidth;var b=RD3_DesktopManager.WebEntryPoint.WepBox.clientHeight;if(this.DebugPreview){f=Math.floor((f/10)*9)}else{f=Math.floor((f/3)*2)}b=Math.floor((b/10)*9);var a=-1;var d=-1;try{if(!this.DebugPreview&&!(this.PreviewMime&&this.PreviewMime=="application/pdf")){a=this.PreviewFrame.contentWindow.document.body.scrollWidth+10;d=this.PreviewFrame.contentWindow.document.body.scrollHeight+10}}catch(c){}if(a==-1||a>f){a=f}if(d==-1||d>b){d=b}this.SetWidth(a);this.SetHeight(d+e);RD3_Glb.AdaptToParent(this.ContentBox,0,0);RD3_Glb.AdaptToParent(this.CaptionBox,0,-1);RD3_Glb.AdaptToParent(this.PreviewFrame,0,e);this.Centered=true}PopupFrame.prototype.AdaptLayout.call(this);this.Centered=false};PopupPreview.prototype.OnCloseClick=function(){this.Close()};PopupPreview.prototype.OnReadyStateChange=function(){var a=true;if(this.IE&&this.PreviewFrame.readyState!="complete"){a=false;if(this.PreviewFrame.readyState=="interactive"){this.PopupBox.style.visibility=""}}if(a){this.Loaded=true;this.AdaptLayout();this.PopupBox.style.visibility=""}};function PPage(a){this.VisualStyle=-1;this.Flags=0;this.Image="";this.Header="";this.Tooltip="";this.Style=0;this.Index=0;this.Badge="";this.Identifier="";this.ParentPanel=a;this.Realized=false;this.PageContainer=null;this.LeftSpan=null;this.CaptionContainer=null;this.LeftImage=null;this.HeaderCont=null;this.PageImg=null;this.CaptionTxt=null;this.RightSpan=null;this.RightImage=null;this.BadgeObj=null}PPage.prototype.LoadFromXml=function(a){this.LoadProperties(a)};PPage.prototype.ChangeProperties=function(a){this.LoadProperties(a)};PPage.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"sty":this.SetVisualStyle(parseInt(f.nodeValue));break;case"flg":this.SetFlags(parseInt(f.nodeValue));break;case"img":this.SetImage(f.nodeValue);break;case"cap":this.SetHeader(f.nodeValue);break;case"tip":this.SetTooltip(f.nodeValue);break;case"pst":this.SetStyle(parseInt(f.nodeValue));break;case"ind":this.SetIndex(parseInt(f.nodeValue));break;case"bdg":this.SetBadge(f.nodeValue);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};PPage.prototype.SetVisualStyle=function(a){if(a!=undefined){this.VisualStyle=a}};PPage.prototype.SetFlags=function(f){var a=this.Flags;if(f!=undefined){this.Flags=f}if(this.Realized){var e=a&2;var d=this.Flags&2;if(e!=d||f==undefined){this.UpdateVisibility()}var c=a&1;var b=this.Flags&1;if(c!=b||f==undefined){this.ParentPanel.UpdatePageEnability(this.Index)}}};PPage.prototype.UpdateVisibility=function(){var a=this.IsVisible()?"":"none";if(this.PageContainer&&!RD3_Glb.IsMobile()){this.PageContainer.style.display=a}else{if(this.CaptionContainer){this.CaptionContainer.style.display=a}}if(this.ParentPanel.PanelPage==this.Index){this.ParentPanel.SetPanelPage()}this.ParentPanel.RecalcLayout=true};PPage.prototype.SetImage=function(c){if(c!=undefined){this.Image=c}if(this.Realized){if(RD3_Glb.IsMobile()){var b=this.Image;if(!RD3_Glb.IsIE(10,true)&&!RD3_Glb.IsEdge()){if(b==""){b=(this.ParentPanel.PanelPage==this.Index?"tabsel.png":"tabunsel.png");if(RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro()){this.PageImg.style.webkitMaskImage="url("+RD3_Glb.GetAbsolutePath()+RD3_Glb.GetImgSrc("images/"+b)+")";this.PageImg.style.webkitMaskSize="25px 25px";this.PageImg.style.width="30px";this.PageImg.style.height="30px"}else{this.PageImg.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+RD3_Glb.GetImgSrc("images/"+b)+")"}}else{this.PageImg.style.webkitMaskImage="url("+RD3_Glb.GetAbsolutePath()+RD3_Glb.GetImgSrc("images/"+b)+")";if(RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro()){this.PageImg.style.width="";this.PageImg.style.height="";this.PageImg.style.webkitMaskSize="";if(RD3_Glb.Adapt4Retina(this.Identifier,b,25)){this.PageImg.style.webkitMaskSize="0px 0px"}}}}else{if(b==""){b=(this.ParentPanel.PanelPage==this.Index?"tabsel.png":"tabunsel.png")}if(this.ImgSrc!=b){this.TempImg=document.createElement("img");this.TempImg.src=RD3_Glb.GetImgSrc("images/"+b);if(!RD3_Glb.IsIE(10,false)){this.TempImg.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}else{this.TempImg.onreadystatechange=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}this.ImgSrc=b;return}var a=this.PageImg.getContext("2d");a.globalCompositeOperation="source-over";a.clearRect(0,0,RD3_ClientParams.ComboImageSize,RD3_ClientParams.ComboImageSize);this.PageImg.style.backgroundColor="";a.fillStyle=RD3_Glb.GetStyleProp(this.PageImg,"background-color");this.PageImg.style.backgroundColor="transparent";a.fillRect(0,0,RD3_ClientParams.ComboImageSize,RD3_ClientParams.ComboImageSize);a.globalCompositeOperation="destination-in";a.drawImage(this.TempImg,0,0,30,30)}}else{if(this.Image!=""){this.PageImg.src=RD3_Glb.GetImgSrc("images/"+this.Image);this.PageImg.style.display=""}else{this.PageImg.style.display="none"}}}};PPage.prototype.SetHeader=function(a){if(a!=undefined){this.Header=a}if(this.Realized){if(this.CaptionTxt){this.CaptionTxt.nodeValue=this.Header}else{this.HeaderCont.innerHTML=this.Header}}};PPage.prototype.SetTooltip=function(a){if(a!=undefined){this.Tooltip=a}if(this.Realized&&!RD3_Glb.IsMobile()){RD3_TooltipManager.SetObjTitle(this.PageContainer,this.Tooltip)}};PPage.prototype.SetBadge=function(b){if(b!=undefined){this.Badge=b}if(this.Realized){if(this.Badge==""){if(this.BadgeObj!=null&&this.BadgeObj.parentNode){this.BadgeObj.parentNode.removeChild(this.BadgeObj)}this.BadgeObj=null}else{if(this.BadgeObj==null){var a=RD3_Glb.IsMobile();this.BadgeObj=document.createElement("DIV");this.BadgeObj.className="badge-red"+(a?" badge-min":"");this.BadgeObj.style.position=a?"absolute":"static";if(a){this.BadgeObj.style.top="2px";this.BadgeObj.style.marginLeft=(66-RD3_Glb.GetBadgeWidth(this.Badge,"red badge-min"))+"px";if(RD3_Glb.IsChrome()||RD3_Glb.IsIpad(7)||RD3_Glb.IsIphone(7)){this.BadgeObj.style.marginLeft="12px"}this.CaptionContainer.appendChild(this.BadgeObj)}else{this.BadgeObj.style.marginLeft="4px";this.HeaderCont.appendChild(this.BadgeObj)}}this.BadgeObj.innerHTML=this.Badge}}};PPage.prototype.SetStyle=function(a){if(a!=undefined){this.Style=a}if(this.Realized){this.HeaderCont.className=((this.ParentPanel.PanelPage==this.Index)?"selected-":"")+"page-header-container-"+this.Style;this.PageImg.className="page-icon-"+this.Style;if(!RD3_Glb.IsMobile()){this.LeftSpan.className="page-left-separator-"+this.Style;this.LeftImage.className=((this.ParentPanel.PanelPage==this.Index)?"selected-":"")+"page-left-image-"+this.Style;this.RightSpan.className="page-right-separator-"+this.Style;this.RightImage.className="right-image-"+this.Style}this.UpdateSelection()}};PPage.prototype.SetIndex=function(a){if(a!=undefined){this.Index=a}};PPage.prototype.Realize=function(b){var c=RD3_Glb.IsMobile();this.CaptionContainer=document.createElement(c?"div":"span");this.CaptionContainer.setAttribute("id",this.Identifier+":cap");this.HeaderCont=document.createElement(c?"div":"span");if(c&&RD3_Glb.IsIE(10,true)){this.PageImg=document.createElement("canvas");this.PageImg.width=RD3_ClientParams.ComboImageSize;this.PageImg.height=RD3_ClientParams.ComboImageSize}else{this.PageImg=document.createElement(c?"div":"img")}if(!c){this.PageContainer=document.createElement("span");this.LeftImage=document.createElement("img");this.LeftSpan=document.createElement("span");this.CaptionTxt=document.createTextNode("");this.RightImage=document.createElement("img");this.RightSpan=document.createElement("span");this.LeftImage.src=RD3_Glb.GetImgSrc("images/pgleft.gif");this.LeftImage.removeAttribute("width");this.LeftImage.removeAttribute("height");this.RightImage.src=RD3_Glb.GetImgSrc("images/pgright.gif");this.RightImage.removeAttribute("width");this.RightImage.removeAttribute("height")}var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev)");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.HeaderCont.ontouchstart=a;this.PageImg.ontouchstart=a}else{if(c){this.CaptionContainer.onmousedown=a}else{this.CaptionContainer.onclick=a}}if(!c){this.HeaderCont.appendChild(this.PageImg);this.HeaderCont.appendChild(this.CaptionTxt);this.LeftSpan.appendChild(this.LeftImage);this.CaptionContainer.appendChild(this.LeftSpan);this.CaptionContainer.appendChild(this.HeaderCont);this.RightSpan.appendChild(this.RightImage);this.CaptionContainer.appendChild(this.RightSpan);this.PageContainer.appendChild(this.CaptionContainer);b.appendChild(this.PageContainer)}else{this.CaptionContainer.appendChild(this.PageImg);this.CaptionContainer.appendChild(this.HeaderCont);b.appendChild(this.CaptionContainer)}this.Realized=true;this.SetVisualStyle();this.SetFlags();this.SetImage();this.SetHeader();this.SetTooltip();this.SetBadge();this.SetStyle()};PPage.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.Realized=false};PPage.prototype.UpdateSelection=function(){if(this.CaptionContainer){var b=RD3_Glb.IsMobile();var a="";if(this.ParentPanel.PanelPage==this.Index){a="selected-"}this.CaptionContainer.className=a+"page-container-"+this.Style;this.HeaderCont.className=a+"page-header-container-"+this.Style;if(!b){this.LeftImage.className=a+"page-left-image-"+this.Style}if(b){this.PageImg.className=a+"page-icon-"+this.Style;this.SetImage()}}};PPage.prototype.OnClick=function(b){if(this.ParentPanel.PanelPage!=this.Index){var a=new IDEvent("panpg",this.Identifier,b,this.ParentPanel.PageClickEventDef,this.ParentPanel.Identifier);if(a.ClientSide){RD3_DesktopManager.SendEvents();this.ParentPanel.SetPanelPage(this.Index,true)}}};PPage.prototype.IsVisible=function(){return(this.Flags&2)!=0};PPage.prototype.IsEnabled=function(){return(this.Flags&1)!=0};PPage.prototype.OnMouseOverObj=function(b,a){if(this.CaptionContainer&&(this.ParentPanel.PanelPage!=this.Index)&&!RD3_Glb.IsMobile()){this.CaptionContainer.className="page-container-hl-"+this.Style}};PPage.prototype.OnMouseOutObj=function(b,a){if(this.CaptionContainer&&(this.ParentPanel.PanelPage!=this.Index)&&!RD3_Glb.IsMobile()){this.CaptionContainer.className="page-container-"+this.Style}};PPage.prototype.OnMouseDownObj=function(b,a){};PPage.prototype.GetTooltip=function(a,b){if(this.Tooltip==""){return false}a.SetObj(this.PageContainer);b=this.PageContainer;a.SetTitle(this.Header);a.SetText(this.Tooltip);a.SetAnchor(RD3_Glb.GetScreenLeft(b)+(b.offsetWidth/2),RD3_Glb.GetScreenTop(b));a.SetPosition(0);return true};PPage.prototype.OnReadyStateChange=function(){if(RD3_Glb.IsIE(10,false)){if(this.TempImg.readyState=="complete"){this.SetImage()}}else{this.SetImage()}};PPage.prototype.OnAdaptRetina=function(a,c,b){if(this.PageImg){this.PageImg.width=a+5;this.PageImg.height=c+5;this.PageImg.style.webkitMaskSize=a+"px "+c+"px"}};function PValue(a){this.Identifier=null;this.Text="";this.Index=0;this.Visible=-1;this.Enabled=-1;this.VisualStyle=-1;this.Tooltip="";this.ErrorText="";this.ErrorType=0;this.ValueListIdx=-1;this.BackColor="";this.ForeColor="";this.FontMod="";this.Mask="";this.Alignment=-1;this.Badge="";this.ParentField=a;this.Realized=false;this.RefreshScreen=false}PValue.prototype.LoadFromXml=function(e){this.LoadProperties(e);var c=e.childNodes;var f=c.length;for(var d=0;d<f;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"vls":this.ValueListType=parseInt(b.getAttribute("typ"));if(this.ValueListType==0){this.ValueList=null}else{this.ValueList=new ValueList();this.ValueList.LoadFromXml(b);this.RefreshScreen=true}break}}};PValue.prototype.ChangeProperties=function(a){this.LoadFromXml(a);if(this.RefreshScreen&&this.ParentField.Realized){this.UpdateScreen()}};PValue.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"txt":this.SetText(a);break;case"idx":this.SetIndex(parseInt(a));break;case"vis":this.SetVisible(parseInt(a));break;case"ena":this.SetEnabled(parseInt(a));break;case"sty":this.SetVisualStyle(parseInt(a));break;case"tip":this.SetTooltip(a);break;case"err":this.SetErrorText(a);break;case"ety":this.SetErrorType(parseInt(a));break;case"rse":this.SetRowSelector(parseInt(a));break;case"mim":this.SetBlobMime(a);break;case"mty":this.SetHTMLBlobMime(a);break;case"url":this.SetBlobUrl(a);break;case"bkc":this.SetBackColor(a);break;case"frc":this.SetForeColor(a);break;case"msk":this.SetMask(a);break;case"ftm":this.SetFontMod(a);break;case"aln":this.SetAlignment(parseInt(a));break;case"bdg":this.SetBadge(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};PValue.prototype.SetIndex=function(a){if(a!=undefined){this.Index=a}};PValue.prototype.SetVisible=function(b){var a=this.Visible;if(b!=undefined){this.Visible=b}if(this.ParentField.Realized&&a!=this.Visible){this.RefreshScreen=true}};PValue.prototype.SetEnabled=function(b){var a=this.Enabled;if(b!=undefined){this.Enabled=b}if(this.ParentField.Realized&&a!=this.Enabled){this.RefreshScreen=true}};PValue.prototype.SetVisualStyle=function(b){var a=this.VisualStyle;if(b!=undefined){if(b.Identifier){this.VisualStyle=b}else{if(b!=-1){this.VisualStyle=RD3_DesktopManager.ObjectMap["vis:"+b]}else{this.VisualStyle=b}}}if(this.ParentField.Realized&&a!=this.VisualStyle){this.RefreshScreen=true}};PValue.prototype.SetTooltip=function(b){var a=this.Tooltip;if(b!=undefined){this.Tooltip=b}if(this.ParentField.Realized&&a!=this.Tooltip){this.RefreshScreen=true}};PValue.prototype.SetText=function(b){var a=this.Text;if(b!=undefined){this.Text=b}if(this.ParentField.Realized&&a!=this.Text){this.RefreshScreen=true}};PValue.prototype.SetErrorText=function(b){var a=this.ErrorText;if(b!=undefined){this.ErrorText=b}if(this.ParentField.Realized&&a!=this.ErrorText){this.RefreshScreen=true}};PValue.prototype.SetErrorType=function(b){var a=this.ErrorType;if(b!=undefined){this.ErrorType=b}if(this.ParentField.Realized&&a!=this.ErrorType){this.RefreshScreen=true}};PValue.prototype.SetRowSelector=function(b){var a=this.RowSelector;if(b!=undefined){this.RowSelector=b}if(this.ParentField.Realized&&a!=this.RowSelector){this.RefreshScreen=true;this.UpdateRowSel()}else{if(!this.ParentField.Realized){this.ParentField.ParentPanel.UpdateRSel=true}}};PValue.prototype.SetBlobMime=function(a){if(a!=undefined){this.BlobMime=a}};PValue.prototype.SetHTMLBlobMime=function(a){if(a!=undefined){this.HTMLBlobMime=a}};PValue.prototype.SetBlobUrl=function(a){if(a!=undefined){this.BlobUrl=a}if(window.RD4_Enabled&&this.BlobUrl.substr(0,11)!="?WCI=IWBlob"&&this.ParentField.DownloadSource){this.ParentField.OnBlobCommand(null,this.ParentField.DownloadSource);this.ParentField.DownloadSource=""}};PValue.prototype.SetBackColor=function(b){var a=this.BackColor;if(b!=undefined){this.BackColor=b}if(this.ParentField.Realized&&a!=this.BackColor){this.RefreshScreen=true}};PValue.prototype.SetForeColor=function(b){var a=this.ForeColor;if(b!=undefined){this.ForeColor=b}if(this.ParentField.Realized&&a!=this.ForeColor){this.RefreshScreen=true}};PValue.prototype.SetFontMod=function(b){var a=this.FontMod;if(b!=undefined){this.FontMod=b}if(this.ParentField.Realized&&a!=this.FontMod){this.RefreshScreen=true}};PValue.prototype.SetMask=function(a){if(a!=undefined){this.Mask=a}};PValue.prototype.SetAlignment=function(b){var a=this.Alignment;if(b!=undefined){this.Alignment=b}if(this.ParentField.Realized&&a!=this.Alignment){this.RefreshScreen=true}};PValue.prototype.SetBadge=function(b){var a=this.Badge;if(b!=undefined){this.Badge=b}if(this.ParentField.Realized&&a!=this.Badge){this.RefreshScreen=true}};PValue.prototype.Realize=function(a){this.Realized=true;this.SetVisible();this.SetEnabled();this.SetVisualStyle();this.SetTooltip();this.SetText();this.SetErrorText();this.SetErrorType()};PValue.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);if(RD3_KBManager.ActiveObject==this){RD3_KBManager.ActiveObject=null}};PValue.prototype.IsVisible=function(a){if(!this.ParentField.IsVisible()){return false}if(this.Visible==0){return false}return true};PValue.prototype.IsEnabled=function(){return this.ParentField.IsEnabled(this.Index+1)};PValue.prototype.GetValueList=function(){if(this.ValueList){return this.ValueList}return this.ParentField.ValueList};PValue.prototype.GetVisualStyle=function(){var a=this.VisualStyle;if(a==-1){a=this.ParentField.VisualStyle}return a};PValue.prototype.ActivatorImage=function(d,b){var a=this.ParentField;var c=this.IsEnabled();if(a.ParentPanel.Status==RD3_Glb.PS_QBE&&this.Index>1){return""}if(a.ActWidth<=0&&!b){return""}if(!c&&!RD3_ServerParams.ShowDisabledIcons&&!(d&&!a.VisHyperLink(d)&&RD3_ServerParams.ShowDisabledFieldActivator&&a.CanActivate&&a.ActivableDisabled)){return""}if(a.ActImage!=""){return a.ActImage}if(RD3_Glb.IsDateOrTimeObject(a.DataType)&&!RD3_Glb.IsMobile()){return c?"aeda.gif":"adda.gif"}if(RD3_ServerParams.SmartLookupIcon&&a.IdxPanel>0){return c?"aeco.gif":"adco.gif"}if(a.HasValueSource){return c?"aeco.gif":"adco.gif"}if(a.CanActivate){return(c||a.ActivableDisabled)?"aelo.gif":"adlo.gif"}return""};PValue.prototype.GetActivator=function(c){if(c.hasChildNodes()){var b=c.childNodes;var e=b.length;for(var a=e-1;a>=0;a--){var d=b[a];if(d.tagName=="IMG"&&d.className=="panel-value-activator"){return d}}}return null};PValue.prototype.ActivatorPosition=function(c){if(RD3_ServerParams.RightAlignedIcons){return 2}var b=c.GetAlignment(1);if(this.Alignment!=-1){b=this.Alignment}else{if(this.ParentField.Alignment!=-1){b=this.ParentField.Alignment}}if(b==1){b=(RD3_Glb.IsNumericObject(this.ParentField.DataType))?4:2}if(b!=4){b=2}if(b==2){return 2}else{return 1}};PValue.prototype.OnDoubleClick=function(e){var c=true;var d=(window.event)?e.srcElement:e.target;var b=RD3_KBManager.GetCell(d);if(b&&(b.ControlType==3||b.ControlType==30)&&!b.IsCellClickable){c=false}if(b&&RD3_Glb.IsDateTimeObject(this.ParentField.DataType)&&this.ErrorType==2){c=false}var f=this.GetVisualStyle();if(c&&this.ActivatorImage(f,true)!=""){this.SendChanges(e);this.ParentField.OnClickActivator(e)}else{var a=true;if(RD3_Glb.HasClass(d,"combo-activator")){a=false}if(b&&b.ControlType>=4&&b.ControlType<=6){a=false}if(a){if(this.ParentField.ParentPanel.IsGrouped()){this.ParentField.ParentPanel.OnRowSelectorClick(e,this.ParentField.ParentPanel.GetRowForIndex(this.Index))}else{this.ParentField.ParentPanel.OnRowSelectorClick(e,this.Index-this.ParentField.ParentPanel.ActualPosition)}}}};PValue.prototype.InQBE=function(){return this.ParentField.ParentPanel.Status==RD3_Glb.PS_QBE&&this.Index==1};PValue.prototype.OnChange=function(a){if(this.ParentField.SuperActive){this.SendChanges(a,RD3_Glb.EVENT_SERVERSIDE)}else{this.SendChanges(a,0)}};PValue.prototype.OnKeyPress=function(f){var d=(f.charCode)?f.charCode:f.keyCode;if(d==13){var e=(window.event)?f.srcElement:f.target;var a=RD3_KBManager.GetCell(e);var b=a.IsEnabled;var c=a.Mask;if(b&&c&&c!=""&&e.tagName=="INPUT"){umc(f)}this.SendChanges(f,RD3_Glb.EVENT_IMMEDIATE);this.UpdateScreen();if(RD3_ServerParams.EnterChangeFocus){this.ParentField.ParentPanel.FocusNextField(this.ParentField,f);f.preventDefault()}else{RD3_KBManager.CheckFocus=true}}};PValue.prototype.SendChanges=function(f,t){var r=null;if(this.ParentField.DataType==10){return}if(f.tagName){r=f}else{if(f.getData){}else{r=(window.event)?f.srcElement:f.originalTarget}}if(r&&r.tagName=="SPAN"){var k=r.previousSibling;if(k&&k.tagName=="INPUT"){r=k}}if(this.IsEnabled()){var o=(r)?r.value:"";if(o==undefined){o=""}var z=false;var e=null;if(r){e=RD3_KBManager.GetCell(r);if(e&&e.HasWatermark&&(!RD3_Glb.IsIE()||RD3_Glb.IsMobile())){return}var c=e.IsEnabled;var g=e.Mask;if(c&&o.length>0&&g&&g!=""&&r.tagName=="INPUT"){var u=r.value;var p=getCursorPos(r);umc(null);o=r.value;r.value=u;if(!RD3_KBManager.LoosingFocus){setCursorPos(r,p!=-1?p:u.length)}}if(e&&e.ControlType==3){o=e.IntCtrl.GetComboValue()}if(e&&e.ControlType==101&&RD3_ServerParams.UseIDEditor){o=e.IntCtrl.getData()}if(e&&e.ControlType==4&&RD3_Glb.IsMobile()){if(r.tagName=="SPAN"){r=r.parentNode}o=r.checked?"on":""}}if(f.getData){o=f.getData();f=null;var i=(this.ParentField.ParentPanel.PanelMode==RD3_Glb.PANEL_LIST&&this.ParentField.PListCells?this.ParentField.PListCells[0]:this.ParentField.PFormCell);if(i&&i.ControlType==101&&!RD3_ServerParams.UseIDEditor){e=i}}var j=o;var a=true;if(e&&e.PwdSvuotata&&o==""){a=false;o=this.Text}if(r){switch(r.type){case"checkbox":var y=this.GetValueList();if(r.indeterminate){o="---";j="---"}else{if(y&&y.ItemList.length>=2){o=(r.checked)?y.ItemList[0].Value:y.ItemList[1].Value}else{o=(r.checked)?"on":""}j=(r.checked)?"on":""}if(!y){a=false}break;case"radio":var y=this.GetValueList();if(y){o=y.GetOption(r)}else{a=false}j=o;break}}z=(o!=this.Text);var m=this.Text;this.Text=o;if(e){e.Text=o;if(e.ControlType==101&&RD3_ServerParams.UseIDEditor){if(z){if(RD3_Glb.IsIE(10,false)){z=e.IntCtrl.IsDirty}else{var b=document.createDocumentFragment();var q=document.createDocumentFragment();var l=document.createElement("DIV");l.innerHTML=m;while(l.childNodes.length>0){b.appendChild(l.childNodes.item(0))}l.innerHTML=this.Text;while(l.childNodes.length>0){q.appendChild(l.childNodes.item(0))}l=null;if(q.isEqualNode&&q.isEqualNode(b)){z=false}b=null;q=null;if(z&&!e.IntCtrl.IsDirty){z=false}}}if(z){e.IntCtrl.HTMLContent=o;e.IntCtrl.IsDirty=false}}}if(z&&e&&e.ControlType==3&&this.ParentField.LKE){this.Text=e.IntCtrl.GetComboName();if(e){e.Text=o;e.IntCtrl.OriginalText=o}if(this.Text=="-"&&e.IntCtrl.GetComboValue()=="LKENULL"){e.IntCtrl.SetComboValue(this.Text)}if(this.Text!=""&&e.IntCtrl.GetComboValue()=="LKEPREC"){this.Text=this.Text.substring(1,this.Text.length-1);e.IntCtrl.SetComboValue(this.Text);e.Text=this.Text;e.IntCtrl.OriginalText=this.Text}}if(z&&a){var x;var d=(this.ParentField.SuperActive&&(t&RD3_Glb.EVENT_SERVERSIDE)!=0);var h=(this.ParentField.LKE&&this.ParentField.ChangeEventDef==RD3_Glb.EVENT_ACTIVE);var w=((this.ParentField.ChangeEventDef|t)&RD3_Glb.EVENT_IMMEDIATE);if(e&&e.IntCtrl&&e.IntCtrl.MultiSel&&this.ParentField.LKE&&j.substr(0,3)!="LKE"){var n=e.IntCtrl.GetComboFinalName(true);n+=(n.length>0&&j.length>0?";":"");j=n+j}if((RD3_DDManager.LButtonDown&&w)||d||h){x=new IDEvent("chg",this.Identifier,f,this.ParentField.ChangeEventDef|t,"",j,"","","",d?RD3_ClientParams.SuperActiveDelay:200,(d||h)?true:false)}else{x=new IDEvent("chg",this.Identifier,f,this.ParentField.ChangeEventDef|t,"",j)}}else{if(t==RD3_Glb.EVENT_IMMEDIATE){RD3_DesktopManager.SendEvents()}}}};PValue.prototype.IsComboOptional=function(){if(this.ParentField.Optional){return true}else{if(this.InQBE()){return true}else{if(this.Text==""){return true}else{var b=this.GetValueList();if(b){var c=false;var d=b.ItemList.length;if(d>0){for(var a=0;a<d;a++){if(this.Text==b.ItemList[a].Value){c=true;break}}}return !c}}}}return false};PValue.prototype.IsNewRow=function(){return this.Index>this.ParentField.ParentPanel.TotalRows};PValue.prototype.UpdateScreen=function(k){var b=this.IsVisible();var i=this.ParentField;var f=i.ParentPanel;var g=f.ActualPosition;var j=f.NumRows;var d=f.ActualRow;var c=false;if(f.Status==RD3_Glb.PS_QBE){c=this.Index==1}else{if(this.ParentField.ParentPanel.IsGrouped()){if(f.PanelMode==RD3_Glb.PANEL_LIST){if(i.InList){var b=f.ListGroupRoot.IsRowVisible(this.Index);var h=f.GetRowForIndex(this.Index);c=b&&h>=0&&h<=(f.NumRows-1)}else{c=false}}else{c=(this.Index==g+d)}}else{if(i.InList&&i.ListList){c=(this.Index>=g&&this.Index<g+j)}else{c=(this.Index==g+d)}}}if(c){if(i.InList&&f.HasList&&f.PanelMode==RD3_Glb.PANEL_LIST){if(!i.DelayedUpdate){var e=(i.ListList)?this.Index-g:0;var a=i.ParentPanel.ListGroupRoot;if(f.IsGrouped()&&i.ListList){e=f.GetRowForIndex(this.Index)}i.PListCells[e].Update(this,(i.InList&&i.ListList?i.ListBox:f.ListBox))}if(!i.ListList&&i.HdrList){if(b&&i.ListCaptionBox.style.display=="none"){RD3_Glb.SetDisplay(i.ListCaptionBox,"")}if(!b&&i.ListCaptionBox.style.display==""){RD3_Glb.SetDisplay(i.ListCaptionBox,"none")}}}if(i.InForm&&f.HasForm&&f.PanelMode==RD3_Glb.PANEL_FORM){if(f.IsGrouped()){g=f.GetRowIndex(0)}i.PFormCell.Update(i.PValues[g],f.FormBox);if(i.HdrForm){if(b&&i.FormCaptionBox.style.display=="none"){RD3_Glb.SetDisplay(i.FormCaptionBox,"")}if(!b&&i.FormCaptionBox.style.display==""){RD3_Glb.SetDisplay(i.FormCaptionBox,"none")}}}if(this.RowSelector!=undefined&&f.PanelMode==RD3_Glb.PANEL_LIST&&f.RowSel){this.UpdateRowSel()}}this.RefreshScreen=false};PValue.prototype.UpdateRowSel=function(){var b="rs.gif";switch(this.RowSelector){case 1:b="rse.gif";break;case 2:b="rsm.gif";break;case 3:b="rse.gif";break;case 4:b="rsm.gif";break}var d=this.ParentField.ParentPanel;var a=this.Index-d.ActualPosition;if(d.IsGrouped()){a=d.GetRowForIndex(this.Index);if(a<0||a>d.NumRows){a=-1}}var c=(d&&d.RowSel&&a>=0?d.RowSel[a]:null);if(RD3_ServerParams.CompletePanelBorders&&d&&d.RowSel&&a>=0){c=d.RowSel[a]?d.RowSel[a].firstChild:null}if(c){c.src=RD3_Glb.GetImgSrc("images/"+b);if(d.IsGrouped()){c.style.display=""}}else{d.UpdateRSel=true}};PValue.prototype.GetDOMObj=function(a){var b=this.ParentField;if(b.ParentPanel.PanelMode==RD3_Glb.PANEL_FORM){return b.PFormCell.GetDOMObj()}else{if(b.ListList){return b.PListCells[this.Index-1].GetDOMObj()}else{return b.PListCells[0].GetDOMObj()}}};PValue.prototype.SetFCK=function(c,e){var a=this.ParentField.Identifier+(e?":lcke":":fcke");var b=CKEDITOR.instances[a];if(b){var d=true;if(RD3_KBManager.ActiveElement==b){var f=e?this.ParentField.PListCells[0]:this.ParentField.PFormCell;if(f&&f.ControlType==101){d=(b.getData()!=f.Text?false:true)}}else{var c=RD3_DesktopManager.MessagePump.GetEvent(this,"chg");d=(c?false:true)}if(d){b.setData(this.Text)}}this.ParentField.FCKTimerID=0};PValue.prototype.GetParentFrame=function(){return this.ParentField.ParentPanel};PValue.prototype.GetVSign=function(k,i){var j=this.ParentField;var d=j.ParentPanel;var e=this.InQBE();var b=this.IsEnabled();var c=false;var h=false;if(i&&j.ListList){if(d.IsGrouped()){var f=d.GetServerIndex(d.ActualRow);c=(this.Index==f);h=d.GetRowForIndex(this.Index)%2}else{var f=d.ActualPosition+d.ActualRow;c=(this.Index==f);h=(this.Index-d.ActualPosition)%2}}var g=(j.IdxPanel<=0||j.AutoLookup||j.LKE);var a=j.IsRightAligned()?"right":"left";return k.GetSign(i,h,c,!b,this.ErrorType==1,(this.ErrorType==2||this.ErrorType==3),a,e&&g)};PValue.prototype.GetControlType=function(){var b=this.GetVisualStyle();var a=b.GetContrType();if(a==1){if(this.GetValueList()||this.ParentField.HasValueSource||this.ParentField.LKE){a=3}else{a=2}}if(this.ParentField.DataType==10){a=10}if(this.ParentField.EditorType==1){if(RD3_ServerParams.UseIDEditor){a=(!this.InQBE()?101:2)}else{a=(this.IsEnabled()&&!this.InQBE()?101:2)}}if(a==4&&!this.GetValueList()){a=2}return a};PValue.prototype.IsVisibleInGrouped=function(){if(!this.ParentField.ParentPanel.IsGrouped()||!(this.ParentField.InList&&this.ParentField.ListList)){return this.IsVisible()}return this.ParentField.ParentPanel.ListGroupRoot.IsRowVisible(this.Index)};PValue.prototype.AfterProcessResponse=function(){if(this.ValueListType==3||this.ValueListType==1){this.ValueListType=0;this.ValueList=null}};PValue.prototype.OnRadioLabelClick=function(b){if(!this.IsEnabled()){return}var c=(window.event)?window.event.srcElement:b.target;var a=c.previousSibling;if(a){if(RD3_Glb.IsAndroid()){a.checked=true;RD3_KBManager.IDRO_OnChange(b)}else{a.click()}}if(RD3_Glb.IsMobile()){this.GetValueList().SetOptionClass(c.parentNode,c)}};PValue.prototype.ShowHTML=function(){if(this.Mask=="="){return true}if(this.Mask==""&&this.ParentField.Mask=="="){return true}return false};PValue.prototype.TouchMulSel=function(d){var b=RD3_KBManager.GetCell(d.target);if(b&&b.IsEnabled){if(RD3_Glb.HasClass(b.IntCtrl,"panel-field-selected")||RD3_Glb.HasClass(b.IntCtrl,"panel-field-unselected")){var a=RD3_Glb.GetScreenLeft(b.IntCtrl,true);var c=d.clientX;if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){c=d.targetTouches.length>0?d.targetTouches[0].clientX:d.changedTouches[0].clientX}if(c>=a&&c<=a+32){return true}}}};PValue.prototype.OnTouchDown=function(h,e,g){var f=this.ParentField.ParentPanel;if(g==undefined){g=h.target?h.target:h.srcElement}f.OnTouchDown(h);if(f.PanelMode==RD3_Glb.PANEL_LIST&&f.Locked&&this.ParentField.ListList){if(!this.ParentField.CanActivate||!this.ParentField.VisOnlyIcon()){f.HiliteRow(this.Index)}}else{if(this.IsEnabled()){if(this.ParentField.IsIDEditor(g)){var c=h.target?h.target:h.srcElement;if(!this.ParentField.IsIDEditor(c)){if(f.PanelMode==RD3_Glb.PANEL_LIST){f.HiliteRow(this.Index)}return true}if(this.ParentField.IsIDEditorToolbar(g)){var a=RD3_KBManager.GetCell(g);if(a&&a.IntCtrl&&a.IntCtrl instanceof IDEditor){var b=a.IntCtrl;if(b.SelectionTimer!=null){window.clearTimeout(b.SelectionTimer);b.SelectionTimer=null}b.OnSelectionTimer()}return true}return false}if(this.ParentField.UsePopupControl()&&!this.ParentField.IsCombo(g)){if(f.PanelMode==RD3_Glb.PANEL_LIST){f.HiliteRow(this.Index)}return true}if(g.tagName=="INPUT"||g.tagName=="TEXTAREA"){var c=h.target?h.target:h.srcElement;var d=(c.tagName=="INPUT"||c.tagName=="TEXTAREA");if(e||!d){if(f.PanelMode==RD3_Glb.PANEL_LIST){f.HiliteRow(this.Index)}}else{return false}}if(this.ParentField.IsCombo(g)){if(f.PanelMode==RD3_Glb.PANEL_FORM){this.ParentField.HiliteCombo(g,true)}else{f.HiliteRow(this.Index)}}if(RD3_Glb.IsMobile7()&&RD3_Glb.HasClass(g,"book-span-radio-text-vertical")){g.style.backgroundColor=RD3_ClientParams.GetColorHL1()}}else{if(this.ParentField.CanActivate&&this.ParentField.ActivableDisabled&&this.ParentField.Enabled){this.ParentField.HiliteCombo(g,true)}}}return true};PValue.prototype.OnTouchUp=function(f,c,e){var d=this.ParentField.ParentPanel;if(e==undefined){e=f.target?f.target:f.srcElement}d.OnTouchUp(f,c);if(RD3_Glb.IsMobile7()&&RD3_Glb.HasClass(e,"book-span-radio-text-vertical")){e.style.backgroundColor=""}if(c){if(RD3_Glb.IsAndroid()||(RD3_Glb.IsIE(10,true)&&RD3_Glb.IsTouch())){RD3_DDManager.ChompClick()}this.ParentField.GotFocus(e,f);if(d.WebForm.CloseOnSelection){this.OnDoubleClick(f);return true}if(f&&d.PanelMode==RD3_Glb.PANEL_LIST&&d.ShowMultipleSel&&this.ParentField.ListList){if(d.Locked||this.TouchMulSel(f)){d.OnMultiSelClick(f,this.Index-1);return true}}var a=RD3_KBManager.GetCell(e);if(this.ParentField.UsePopupControl()&&a.IsEnabled&&!(a.IntCtrl instanceof IDCombo)){if(d.PanelMode==RD3_Glb.PANEL_LIST){this.ParentField.ParentPanel.HiliteRow(0);if(RD3_Glb.IsIE(10,true)){if(RD3_KBManager.FocusFieldTimerId){window.clearTimeout(RD3_KBManager.FocusFieldTimerId)}RD3_KBManager.FocusFieldTimerId=0}}var b=new PopupControl(this.ParentField.GetPopupControlType(),a);b.Open();b.LastActiveObject=null;b.LastActiveElement=null;return true}if(this.ParentField.CanActivate&&this.ParentField.VisOnlyIcon()){this.ParentField.OnClickActivator(f)}else{if(d.PanelMode==RD3_Glb.PANEL_LIST&&d.HasForm&&d.AutomaticLayout&&this.ParentField.ListList){if(this.IsNewRow()){if(this.ParentField.ParentPanel.CanInsert){this.ParentField.ParentPanel.OnToolbarClick(f,"insert")}else{this.ParentField.ParentPanel.HiliteRow(0)}}else{this.ParentField.ParentPanel.OnToolbarClick(f,"list")}}else{if(this.ParentField.IsCombo(e)){this.ParentField.ParentPanel.HiliteRow(0)}if(this.ParentField.CanActivate){this.ParentField.OnClickActivator(f)}}}if(RD3_Glb.IsTouch()){if(a&&a.ControlType==4&&a.IsEnabled){this.ParentField.OnToggleCheck(f)}}if(RD3_Glb.IsTouch()){if(a&&a.ControlType==5&&a.IsEnabled){this.OnRadioLabelClick(f)}}if(RD3_Glb.IsTouch()){if(a&&a.ControlType==10&&a.PValue.BlobMime=="size"){a.PValue.ParentField.OnBlobCommand(f,"link")}}if(!d.Locked){if(a.IntCtrl instanceof IDCombo&&a.IsEnabled&&!this.ParentField.CanActivate){if(a.HasWatermark){a.RemoveWatermark()}a.IntCtrl.Open()}else{if(d.HilitedCombo){d.HilitedCombo.HiliteCombo(null,false)}}}if(this.ParentField.IsIDEditorToolbar(e)){if(a&&a.IntCtrl instanceof IDEditor&&a.IsEnabled){a.IntCtrl.OnEditorTouchUp(f,e)}}if(d.HilitedCombo&&(!this.ParentField.IsCombo(e)||!a.IsEnabled||!this.ParentField.VisSlidePad())){d.HilitedCombo.HiliteCombo(null,false)}}else{if(d.PanelMode==RD3_Glb.PANEL_LIST){this.ParentField.ParentPanel.HiliteRow(0)}if(d.HilitedCombo){d.HilitedCombo.HiliteCombo(null,false)}}return true};PValue.prototype.OnSwipe=function(d,a){if(!a){var b=this.ParentField;var c=b.ParentPanel;if(b.InList&&b.ListList&&c.PanelMode==RD3_Glb.PANEL_LIST){c.SetSwipe(true,b,this.Index,d)}}};function ScreenZone(){this.Identifier="";this.Position;this.TabVisibility=RD3_Glb.SCRZONE_AUTTAB;this.ShowPin=true;this.ZoneState=RD3_Glb.SCRZONE_PINNEDZONE;this.SelectedForm=RD3_Glb.SCRZONE_SELECTEDNONE;this.ZoneSize=240;this.VerticalBehavour=RD3_Glb.SCRZONE_VERTICALCOLLAPSE;this.TabPosition;this.HasMobileMenu=false;this.SwipeMode=RD3_Glb.SCRZONE_SWIPECOLLAPSABLE;this.SelectEventDef=RD3_Glb.EVENT_ACTIVE;this.SwipeEventDef=RD3_Glb.EVENT_ACTIVE;this.Realized=false;this.TabView=null;this.ParentContainer=null;this.VisibileZone=false;this.RepinOnSelection=false;this.PortraitShown=false}ScreenZone.prototype.LoadFromXml=function(a){this.LoadProperties(a)};ScreenZone.prototype.ChangeProperties=function(a){this.LoadFromXml(a)};ScreenZone.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"pos":this.SetPosition(parseInt(a));break;case"tvs":this.SetTabVisibility(parseInt(a));break;case"spn":this.SetShowPin(a=="1");break;case"zst":this.SetZoneState(parseInt(a));break;case"sel":this.SetSelectedForm(parseInt(a));break;case"siz":this.SetZoneSize(parseInt(a));break;case"vbh":this.SetVerticalBehaviour(a);break;case"tps":this.SetTabPosition(parseInt(a));break;case"hmm":this.SetHasMobileMenu(a=="1");break;case"swm":this.SetSwipeMode(parseInt(a));break;case"sle":this.SelectEventDef=parseInt(a);break;case"swe":this.SwipeEventDef=parseInt(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};ScreenZone.prototype.SetPosition=function(a){if(a!=undefined){this.Position=a}};ScreenZone.prototype.SetTabVisibility=function(e){if(e!=undefined){this.TabVisibility=e}if(this.Realized){var f=(this.TabVisibility==RD3_Glb.SCRZONE_HIDTAB);if(this.TabVisibility==RD3_Glb.SCRZONE_AUTTAB&&this.ZoneState==RD3_Glb.SCRZONE_PINNEDZONE){var a=this.GetForms();f=(a.length<=1)}var b=this.TabView.HiddenTabs;this.TabView.SetHiddenTabs(f);if(!RD3_Glb.IsMobile()&&b!=this.TabView.HiddenTabs){var g=this.TabView.Tabs.length;for(var c=0;c<g;c++){var d=this.TabView.Tabs[c].Content;if(d&&d.Realized&&d instanceof WebForm){this.RemoveFormBorder(d.FormBox)}}}}};ScreenZone.prototype.SetShowPin=function(a){if(a!=undefined){this.ShowPin=a}};ScreenZone.prototype.SetZoneState=function(a){if(a!=undefined){this.ZoneState=a}if(this.Realized){if(this.ZoneState==RD3_Glb.SCRZONE_HIDDENZONE){this.VisibileZone=false;RD3_DesktopManager.WebEntryPoint.RecalcLayout=true}else{if(this.ZoneState==RD3_Glb.SCRZONE_PINNEDZONE){this.TabView.SetOnlyTabs(false);this.VisibileZone=true;RD3_DesktopManager.WebEntryPoint.RecalcLayout=true}else{if(this.SelectedForm==RD3_Glb.SCRZONE_SELECTEDNONE){this.TabView.SetOnlyTabs(true)}else{this.TabView.SetOnlyTabs(false)}this.VisibileZone=true;RD3_DesktopManager.WebEntryPoint.RecalcLayout=true}}}};ScreenZone.prototype.SetSelectedForm=function(k){var d=this.SelectedForm;if(k!=undefined){this.SelectedForm=k}if(this.Realized){var g=false;var l=0;var c=this.TabView.Tabs.length;for(var h=0;h<c;h++){var j=this.TabView.Tabs[h].Content;if(j&&j.IdxForm==this.SelectedForm){g=this.TabView.Tabs[h].JustAdded;l=h;break}}if(this.SelectedForm==RD3_Glb.SCRZONE_SELECTEDNONE){l=-1}if(!(l==-1&&this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE)){if(this.TabView.SelectedPage==l){this.TabView.SetSelectedPage()}else{this.TabView.SetSelectedPage(l,g)}}RD3_DesktopManager.WebEntryPoint.RecalcLayout=true;if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&d!=this.SelectedForm&&(d==RD3_Glb.SCRZONE_SELECTEDNONE||this.SelectedForm==RD3_Glb.SCRZONE_SELECTEDNONE)){if(this.SelectedForm!=RD3_Glb.SCRZONE_SELECTEDNONE&&this.SelectedForm!=d){this.TabView.SetOnlyTabs(false)}var a=(this.SelectedForm!=RD3_Glb.SCRZONE_SELECTEDNONE);var b=(d!=RD3_Glb.SCRZONE_SELECTEDNONE&&this.SelectedForm!=RD3_Glb.SCRZONE_SELECTEDNONE);if(!RD3_Glb.IsMobile()){var e=new GFX("unpinned",a,this.ParentContainer,b,null,"scroll:250!");e.ZonePos=this.Position;RD3_GFXManager.AddEffect(e)}}}};ScreenZone.prototype.SetZoneSize=function(a){if(a!=undefined){this.ZoneSize=a}if(this.Realized){RD3_DesktopManager.WebEntryPoint.RecalcLayout=true}};ScreenZone.prototype.SetSwipeMode=function(a){if(a!=undefined){this.SwipeMode=a}};ScreenZone.prototype.SetVerticalBehaviour=function(a){if(a!=undefined){this.VerticalBehavour=a}};ScreenZone.prototype.SetTabPosition=function(a){if(a!=undefined){this.TabPosition=a}if(this.Realized){this.TabView.SetPlacement(this.TabPosition)}};ScreenZone.prototype.SetHasMobileMenu=function(a){if(a!=undefined){this.HasMobileMenu=a}if(this.Realized){if(this.HasMobileMenu){this.MenuForm=new WebForm();this.MenuForm.ToolbarPosition=0;this.MenuForm.Identifier="menuform";this.MenuForm.IdxForm=RD3_Glb.SCRZONE_SELECTEDMENU;this.MenuForm.Docked=true;this.MenuForm.DockType=this.Position;this.MenuForm.Caption=RD3_DesktopManager.WebEntryPoint.MainCaption;this.MenuForm.Realize();this.MenuForm.Host(RD3_DesktopManager.WebEntryPoint.SideMenuBox,RD3_DesktopManager.WebEntryPoint.HeaderBox)}}};ScreenZone.prototype.GetForms=function(){var a=new Array();var d=RD3_DesktopManager.WebEntryPoint;var e=d.StackForm.length;for(var b=0;b<e;b++){var c=d.StackForm[b];if(c.Docked&&c.DockType==this.Position){a.push(c)}}if(this.MenuForm&&RD3_DesktopManager.WebEntryPoint.CmdObj.HasMenu()){a.push(this.MenuForm)}return a};ScreenZone.prototype.Realize=function(){switch(this.Position){case RD3_Glb.FORMDOCK_LEFT:this.ParentContainer=RD3_DesktopManager.WebEntryPoint.LeftDockedBox;break;case RD3_Glb.FORMDOCK_TOP:this.ParentContainer=RD3_DesktopManager.WebEntryPoint.TopDockedBox;break;case RD3_Glb.FORMDOCK_RIGHT:this.ParentContainer=RD3_DesktopManager.WebEntryPoint.RightDockedBox;break;case RD3_Glb.FORMDOCK_BOTTOM:this.ParentContainer=RD3_DesktopManager.WebEntryPoint.BottomDockedBox;break}this.TempFrm=new WebForm();this.TempFrm.Identifier=this.Identifier+":"+Math.floor(Math.random()*1000);this.TabView=new TabbedView(this.TempFrm);this.TabView.Identifier=this.Identifier+":tbv:"+Math.floor(Math.random()*1000);this.TabView.ClickEventDef=RD3_Glb.EVENT_CLIENTSIDE;this.TabView.ZoneTabView=true;this.TabView.Realize(this.ParentContainer);if(!RD3_Glb.IsMobile()){this.TabView.ContentBox.onscroll=new Function("ev","return RD3_Glb.NoScroll(ev);")}this.Realized=true;this.SetTabVisibility();this.SetZoneState();this.SetSelectedForm();this.SetTabPosition();this.SetHasMobileMenu()};ScreenZone.prototype.AdaptDocked=function(a){if(this.ZoneSize==-10&&RD3_Glb.IsMobile()){if(this.Position==RD3_Glb.FORMDOCK_LEFT||this.Position==RD3_Glb.FORMDOCK_RIGHT){var e=document.body.offsetHeight>document.body.offsetWidth?document.body.offsetHeight:document.body.offsetWidth;e=Math.floor(e/100*30);this.ZoneSize=e<300?300:e}else{var e=document.body.offsetHeight<document.body.offsetWidth?document.body.offsetHeight:document.body.offsetWidth;e=Math.floor(e/100*30);this.ZoneSize=e<300?300:e}}if(RD3_Glb.IsMobile()){if(this.ea){RD3_Glb.RemoveEndTransaction(this.ParentContainer,this.ea,false)}RD3_Glb.RemoveEndTransaction(this.ParentContainer,this.ea,false);RD3_Glb.RemoveEndTransaction(this.TabView.ContentBox,this.ea,false);RD3_Glb.SetTransitionDuration(this.ParentContainer,"");RD3_Glb.SetTransitionDuration(this.TabView.ContentBox,"");RD3_Glb.SetTransitionProperty(this.ParentContainer,"");RD3_Glb.SetTransitionProperty(this.TabView.ContentBox,"");RD3_Glb.SetTransform(this.ParentContainer,"");RD3_Glb.SetTransform(this.TabView.ContentBox,"");this.ParentContainer.removeAttribute("destDim");this.ParentContainer.removeAttribute("startDim");if(this.AnimTimer){window.clearTimeout(this.AnimTimer);this.AnimTimer=null}}var b=this.ZoneSize;var d="-visible";if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&this.SelectedForm==RD3_Glb.SCRZONE_SELECTEDNONE){b=RD3_ClientParams.ZoneUnpinnedSize(this.Position==RD3_Glb.FORMDOCK_LEFT||this.Position==RD3_Glb.FORMDOCK_RIGHT);if(this.TabVisibility==RD3_Glb.SCRZONE_HIDTAB){b=0}}this.SetTabVisibility();var f=false;if(!RD3_Glb.IsPortrait()){this.PortraitShown=false}if(this.GetForms().length==0){f=true}if(!a&&(this.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALHIDE||this.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALPOPOVER)){RD3_DesktopManager.WebEntryPoint.CmdObj.ShowMenuButton();f=f||(RD3_Glb.IsPortrait()&&!this.PortraitShown)}if(this.ZoneState==RD3_Glb.SCRZONE_HIDDENZONE){b=0;f=true}if(f){b=0;d=""}var c="";switch(this.Position){case RD3_Glb.FORMDOCK_LEFT:c="left";this.ParentContainer.style.width=b+"px";break;case RD3_Glb.FORMDOCK_TOP:c="top";this.ParentContainer.style.height=b+"px";break;case RD3_Glb.FORMDOCK_RIGHT:c="right";this.ParentContainer.style.width=b+"px";break;case RD3_Glb.FORMDOCK_BOTTOM:c="bottom";this.ParentContainer.style.height=b+"px";this.TabView.Height=b;break}this.VisibileZone=!f;var g=this.ZoneState==RD3_Glb.SCRZONE_PINNEDZONE?" zone-pinned":"";g=this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE?" zone-unpinned":g;this.ParentContainer.className=c+"-dock-container"+d+g};ScreenZone.prototype.AdaptLayout=function(){if(this.ZoneState==RD3_Glb.SCRZONE_HIDDENZONE){return}if(this.HasMobileMenu&&this.MenuForm){var c=this.TabView.Tabs.length;for(var b=0;b<c;b++){var a=this.TabView.Tabs[b];if(a.Content==this.MenuForm){a.SetVisible(RD3_DesktopManager.WebEntryPoint.CmdObj.HasMenu())}}}RD3_Glb.AdaptToParent(this.TabView.FrameBox,0,0);this.TabView.Height=this.TabView.FrameBox.clientHeight;this.TabView.Width=this.TabView.FrameBox.clientWidth;this.TabView.AdaptLayout();if(RD3_Glb.IsMobile()&&this.HasMobileMenu&&RD3_DesktopManager.WebEntryPoint.CmdObj.IDScroll){RD3_DesktopManager.WebEntryPoint.CmdObj.IDScroll.CalcLimits()}};ScreenZone.prototype.AddForm=function(b){var a=new Tab(this.TabView);a.Identifier=this.Identifier+":tab:"+Math.floor(Math.random()*1000);RD3_DesktopManager.ObjectMap.add(a.Identifier,a);a.SetContent(b);a.OnClick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTabClick', ev, this);");this.TabView.Tabs.push(a);if(this.Realized){a.Realize(this.TabView.ContentBox,this.TabView.ToolbarBox,true)}this.TabView.SetPlacement();this.SetSelectedForm();a.JustAdded=true;if(b.Realized){this.RemoveFormBorder(b.formBox)}return a.ContentBox};ScreenZone.prototype.RemoveForm=function(e){var g=this.TabView.Tabs.length;var c=null;var a=-1;for(var b=0;b<g;b++){var d=this.TabView.Tabs[b].Content;if(d.IdxForm==e.IdxForm){a=b;c=this.TabView.Tabs[b];break}}if(c){c.DeletePage("",true)}};ScreenZone.prototype.ActivateForm=function(c){if(this.ZoneState==RD3_Glb.SCRZONE_HIDDENZONE){return}if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE){if(this.GetForms().length==1){this.SetSelectedForm(c.IdxForm);var b=new GFX("zone",true,c,false,null,c.DockedAnimDef);b.ZonePos=this.Position;RD3_GFXManager.AddEffect(b)}else{if(this.GetForms().length==2){var e=RD3_GFXManager.ActiveEffects.length;for(var a=0;a<e;a++){var d=RD3_GFXManager.ActiveEffects[a];if(d&&d.Classe=="zone"&&d.ZonePos==this.Position&&!d.Flin){d.SetFinished()}}}}}};ScreenZone.prototype.CloseForm=function(d){var e=RD3_DesktopManager.WebEntryPoint;e.TimerObj.FormClosed(d);if(e.ActiveForm&&e.ActiveForm.Identifier==d.Identifier){e.ActiveForm=null}if(this.GetForms().length==1){var b=new GFX("zone",false,d,false);b.IdxForm=d.Identifier;b.ZonePos=this.Position;b.CloseFormAnimation=true;RD3_GFXManager.AddEffect(b)}else{d.Unrealize();var g=e.StackForm.length;for(var a=0;a<g;a++){var c=e.StackForm[a];if(c.Identifier==d.Identifier){e.StackForm.splice(a,1);break}}}};ScreenZone.prototype.OnTabClick=function(e,c){var f=this.TabView.Tabs.length;for(var b=0;b<f;b++){if(this.TabView.Tabs[b]==c){var a=this.TabView.Tabs[b].Content.IdxForm;var d=new IDEvent("sczsel",this.Identifier,e,this.SelectEventDef,a);if(d.ClientSide&&this.SelectedForm!=a){if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&this.RepinOnSelection&&!RD3_Glb.IsPortrait()){this.SetZoneState(RD3_Glb.SCRZONE_PINNEDZONE)}RD3_DesktopManager.SendEvents();this.SetSelectedForm(a)}}}};ScreenZone.prototype.ConvertPopover=function(a){var b=RD3_DesktopManager.WebEntryPoint.CmdObj;b.ConvertFormPopover(a,this.TempFrm);b.ConvertClassPopover(a);this.PortraitShown=a;this.AdaptDocked(a);this.AdaptLayout();if(a){if(this.Position==RD3_Glb.FORMDOCK_LEFT||this.Position==RD3_Glb.FORMDOCK_RIGHT){this.ParentContainer.style.width="0px"}if(this.Position==RD3_Glb.FORMDOCK_TOP||this.Position==RD3_Glb.FORMDOCK_BOTTOM){this.ParentContainer.style.height="0px"}}};ScreenZone.prototype.OnMouseDown=function(g,e){if(e==undefined){e=false}var a=false;var h=this.ZoneState==RD3_Glb.SCRZONE_PINNEDZONE&&this.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALHIDE&&RD3_Glb.IsPortrait()&&this.VisibileZone;if((this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE||h)&&this.SelectedForm!=RD3_Glb.SCRZONE_SELECTEDNONE){var i=false;if(e==false){var j=(window.event)?window.event.srcElement:g.explicitOriginalTarget;while(j&&j!=document.body){if(j==this.ParentContainer){i=true;break}j=j.parentNode}if(RD3_DDManager.OpenCombo){i=true}}var b=false;if(!i){if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE){var g=new IDEvent("sczsel",this.Identifier,g,this.SelectEventDef,RD3_Glb.SCRZONE_SELECTEDNONE);this.SetSelectedForm(RD3_Glb.SCRZONE_SELECTEDNONE)}else{a=true;b=true}}else{if(h&&this.HasMobileMenu&&this.SelectedForm==RD3_Glb.SCRZONE_SELECTEDMENU){var j=(window.event)?window.event.srcElement:g.explicitOriginalTarget;var d=RD3_KBManager.GetObject(j);if(d&&d instanceof Command&&!d.IsCmdSet){b=true}}}if(b){var f=(this.Position==RD3_Glb.FORMDOCK_LEFT||this.Position==RD3_Glb.FORMDOCK_RIGHT?this.ParentContainer.offsetWidth:this.ParentContainer.offsetHeight);this.PortraitShown=false;this.AdaptDocked(false);this.AdaptLayout();var c=(this.Position==RD3_Glb.FORMDOCK_LEFT||this.Position==RD3_Glb.FORMDOCK_RIGHT?this.ParentContainer.offsetWidth:this.ParentContainer.offsetHeight);this.SlideZone(f,c)}}if(a){return false}else{return true}};ScreenZone.prototype.OnSwipeZone=function(a){if(this.SwipeMode==RD3_Glb.SCRZONE_SWIPENONE){return}switch(this.ZoneState){case RD3_Glb.SCRZONE_PINNEDZONE:if(!a){if(this.SwipeMode==RD3_Glb.SCRZONE_SWIPECOLLAPSABLE){this.SetZoneState(RD3_Glb.SCRZONE_UNPINNEDZONE);this.SetSelectedForm(RD3_Glb.SCRZONE_SELECTEDNONE);this.RepinOnSelection=true}else{this.SetZoneState(RD3_Glb.SCRZONE_HIDDENZONE)}}break;case RD3_Glb.SCRZONE_HIDDENZONE:if(a){if(RD3_Glb.IsPortrait()){this.SetZoneState(RD3_Glb.SCRZONE_UNPINNEDZONE)}else{this.SetZoneState(RD3_Glb.SCRZONE_PINNED);this.SelectFirstForm()}}break;case RD3_Glb.SCRZONE_UNPINNEDZONE:if(a){if(RD3_Glb.IsPortrait()){return}this.SetZoneState(RD3_Glb.SCRZONE_PINNED);this.SelectFirstForm()}break}};ScreenZone.prototype.SelectFirstForm=function(){if(this.SelectedForm==RD3_Glb.SCRZONE_SELECTEDNONE&&this.TabView.Tabs.length>0){var a=this.TabView.Tabs[0].Content.IdxForm;var b=new IDEvent("sczsel",this.Identifier,null,this.SelectEventDef,a);this.SetSelectedForm(a)}};ScreenZone.prototype.SlideZone=function(d,g,f){if(d==g||(d==this.ParentContainer.startDim&&g==this.ParentContainer.destDim)){return}if(this.HasMobileMenu){if((RD3_Glb.IsQuadro()||RD3_Glb.IsMobile7())&&(RD3_Glb.IsIpad()||RD3_Glb.IsIphone())){var k=RD3_DesktopManager.WebEntryPoint.HeaderBox.parentNode;k.removeChild(RD3_DesktopManager.WebEntryPoint.HeaderBox);k.insertBefore(RD3_DesktopManager.WebEntryPoint.HeaderBox,k.firstChild)}var n=this.ZoneState==RD3_Glb.SCRZONE_PINNEDZONE&&this.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALHIDE&&!RD3_Glb.IsPortrait();n=n&&d==0&&g==this.ZoneSize;if(n){return}}if(f==undefined){f=false}var e=g==this.ZoneSize;var j=0;var i=0;var c=0;var b=0;var h="";var a="";switch(this.Position){case RD3_Glb.FORMDOCK_LEFT:h="left";a="width";if(d==0){j=-g}else{if(g==0){c=-d}else{if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE){if(e){c=0;j=d-g}else{c=g-d;j=0}}else{if(this.ZoneState==RD3_Glb.SCRZONE_PINNEDZONE){if(g<d){c=g-d;j=0}else{j=d-g;c=0}}}}}break;case RD3_Glb.FORMDOCK_RIGHT:h="right";a="width";if(d==0){j=g;c=0}else{if(g==0){j=-d;c=0}else{if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE){if(e){j=g;c=0}else{c=0;j=g-d}}}}break;case RD3_Glb.FORMDOCK_TOP:h="top";a="height";if(d==0){i=-g}else{if(g==0){b=-d}else{if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE){if(e){b=0;i=d-g}else{b=g-d;i=0}}}}break;case RD3_Glb.FORMDOCK_BOTTOM:h="bottom";a="height";if(d==0){i=g;b=0}else{if(g==0){i=-d;b=0}else{if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE){if(e){i=g;b=0}else{b=0;i=-g}}}}break}if(d==0){if(this.Position==RD3_Glb.FORMDOCK_RIGHT||this.Position==RD3_Glb.FORMDOCK_LEFT){this.ParentContainer.style.width=g+"px"}if(this.Position==RD3_Glb.FORMDOCK_TOP||this.Position==RD3_Glb.FORMDOCK_BOTTOM){this.ParentContainer.style.height=g+"px"}}else{if(g==0||d>g){if(this.Position==RD3_Glb.FORMDOCK_RIGHT||this.Position==RD3_Glb.FORMDOCK_LEFT){this.ParentContainer.style.width=d+"px"}if(this.Position==RD3_Glb.FORMDOCK_TOP||this.Position==RD3_Glb.FORMDOCK_BOTTOM){this.ParentContainer.style.height=d+"px"}if(this.Position==RD3_Glb.FORMDOCK_RIGHT||this.Position==RD3_Glb.FORMDOCK_BOTTOM){this.ParentContainer.style.overflow="visible";this.TabView.FrameBox.style.overflow="visible"}}}var l="";var m=this.ParentContainer;if(g==0||d==0){RD3_Glb.RemoveClass(this.ParentContainer,h+"-dock-container");RD3_Glb.AddClass(this.ParentContainer,h+"-dock-container-visible");this.AdaptLayout();RD3_Glb.SetTransform(this.ParentContainer,"translate3d("+j+"px,"+i+"px,0px)");l+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.ParentContainer.id+"'), '250ms');";l+="RD3_Glb.SetTransform(document.getElementById('"+this.ParentContainer.id+"'), 'translate3d("+c+"px,"+b+"px,0px)');"}else{this.AdaptLayout();if(this.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE){RD3_Glb.AddClass(this.TabView.ContentBox,"zone-unpinned");this.ParentContainer.style.background="transparent";RD3_Glb.SetTransform(this.TabView.ContentBox,"translate3d("+j+"px,"+i+"px,0px)");if(this.Position==RD3_Glb.FORMDOCK_RIGHT&&!e){this.TabView.ToolbarBox.style.left="0px"}if(this.Position==RD3_Glb.FORMDOCK_BOTTOM&&!e){this.TabView.ToolbarBox.style.top="0px"}}else{if(this.ZoneState==RD3_Glb.SCRZONE_PINNEDZONE){this.ParentContainer.style.background="transparent";RD3_Glb.SetTransform(this.TabView.ContentBox,"translate3d("+j+"px,"+i+"px,0px)")}}l+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.TabView.ContentBox.id+"'), '250ms');";l+="RD3_Glb.SetTransform(document.getElementById('"+this.TabView.ContentBox.id+"'), 'translate3d("+c+"px,"+b+"px,0px)');";m=this.TabView.ContentBox}this.ParentContainer.startDim=d;this.ParentContainer.destDim=g;if(!this.ea){this.ea=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEndAnimation', ev)")}this.PopoverAnim=f;RD3_Glb.AddEndTransaction(m,this.ea,false);this.AnimTimer=window.setTimeout(l,30)};ScreenZone.prototype.OnEndAnimation=function(a){this.ParentContainer.removeAttribute("destDim");this.ParentContainer.removeAttribute("startDim");this.AnimTimer=null;RD3_Glb.RemoveEndTransaction(this.ParentContainer,this.ea,false);RD3_Glb.RemoveEndTransaction(this.TabView.ContentBox,this.ea,false);RD3_Glb.SetTransitionDuration(this.ParentContainer,"");RD3_Glb.SetTransitionDuration(this.TabView.ContentBox,"");RD3_Glb.SetTransitionProperty(this.ParentContainer,"");RD3_Glb.SetTransitionProperty(this.TabView.ContentBox,"");RD3_Glb.SetTransform(this.ParentContainer,"");RD3_Glb.SetTransform(this.TabView.ContentBox,"");RD3_Glb.RemoveClass(this.TabView.ContentBox,"zone-unpinned");this.ParentContainer.style.background="";if(this.Position==RD3_Glb.FORMDOCK_RIGHT||this.Position==RD3_Glb.FORMDOCK_BOTTOM){this.ParentContainer.style.overflow="";this.TabView.FrameBox.style.overflow=""}this.AdaptDocked(this.PopoverAnim);this.AdaptLayout()};ScreenZone.prototype.AfterProcessResponse=function(b){var c=this.TabView.Tabs.length;for(var a=0;a<c;a++){this.TabView.Tabs[a].JustAdded=false}};ScreenZone.prototype.RemoveFormBorder=function(a){if(RD3_Glb.IsMobile()){return}a.style.borderLeft="";a.style.borderTop="";a.style.borderBottom="";a.style.borderRight="";if(this.TabView.HiddenTabs){return}switch(this.TabPosition){case RD3_Glb.TABOR_LEFT:a.style.borderLeft="0px none transparent";break;case RD3_Glb.TABOR_RIGHT:a.style.borderRight="0px none transparent";break;case RD3_Glb.TABOR_BOTTOM:a.style.borderBottom="0px none transparent";break;case RD3_Glb.TABOR_TOP:a.style.borderTop="0px none transparent";break}};function SubForm(a){WebFrame.call(this,a);this.pSubForm=null}SubForm.prototype=new WebFrame();SubForm.prototype.LoadFromXml=function(e){WebFrame.prototype.LoadFromXml.call(this,e);var c=e.childNodes;var f=c.length;for(var d=0;d<f;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"frm":this.pSubForm=new WebForm();this.pSubForm.SubFormObj=this;this.pSubForm.LoadFromXml(b);break}}};SubForm.prototype.LoadProperties=function(e){WebFrame.prototype.LoadProperties.call(this,e);var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"suw":this.SetWidth(parseInt(a));break;case"suh":this.SetHeight(parseInt(a));break;case"csf":this.SetSubForm(parseInt(a),e);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};SubForm.prototype.ChangeProperties=function(a){this.LoadProperties(a)};SubForm.prototype.SetSubForm=function(e,d){if(e==0){if(this.pSubForm){this.pSubForm.Unrealize();this.pSubForm=null}}else{if(this.pSubForm){this.pSubForm.Unrealize()}var a=null;for(var c=0;c<d.childNodes.length;c++){if(d.childNodes.item(c).nodeType==1){a=d.childNodes.item(c);break}}if(this.Realized){var f=a.getAttribute("id");var b=RD3_DesktopManager.ObjectMap[f];if(b){if(b.SubFormObj){b.SubFormObj.SubForm=null}b.Unrealize()}}this.pSubForm=new WebForm();this.pSubForm.SubFormObj=this;this.pSubForm.LoadFromXml(a);if(this.Realized){this.pSubForm.Realize();this.pSubForm.AdaptLayout();RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveFormChanged()}}};SubForm.prototype.Realize=function(a){if(!this.Realized){WebFrame.prototype.Realize.call(this,a)}if(this.pSubForm){this.pSubForm.Realize()}this.Realized=true;this.CanDrag=true;this.CanDrop=true};SubForm.prototype.Unrealize=function(){WebFrame.prototype.Unrealize.call(this);if(this.pSubForm){this.pSubForm.Unrealize()}this.Realized=false};SubForm.prototype.AdaptLayout=function(){WebFrame.prototype.AdaptLayout.call(this);if(this.pSubForm){this.pSubForm.AdaptLayout()}};SubForm.prototype.Tick=function(){if(this.pSubForm){this.pSubForm.Tick()}};SubForm.prototype.Focus=function(){if(this.pSubForm){return this.pSubForm.Focus()}return false};SubForm.prototype.AfterProcessResponse=function(){WebFrame.prototype.AfterProcessResponse.call(this);if(this.pSubForm){this.pSubForm.AfterProcessResponse()}};SubForm.prototype.GetTooltip=function(a,b){if(this.pSubForm){return this.pSubForm.GetTooltip(a,b)}};SubForm.prototype.ComputeDropList=function(b,a){if(this.pSubForm){this.pSubForm.ComputeDropList(b,a)}};function Tab(a){this.Image="";this.Header="";this.Tooltip="";this.Style=0;this.Badge="";this.TabView=a;this.Content=null;this.Selected=false;this.Visible=true;this.RecalcLayout=false;this.Realized=false;this.CaptionBox=null;this.LeftSpan=null;this.LeftImage=null;this.HeaderCont=null;this.TabImg=null;this.HeaderTxt=null;this.RightImage=null;this.BadgeObj=null;this.RefreshExposed=false;this.ContentBox=null;this.AlreadySelected=false}Tab.prototype.LoadFromXml=function(a){this.LoadProperties(a)};Tab.prototype.ChangeProperties=function(a){this.LoadProperties(a)};Tab.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"img":this.SetImage(f.nodeValue);break;case"cap":this.SetHeader(f.nodeValue);break;case"tip":this.SetTooltip(f.nodeValue);break;case"sty":this.SetStyle(parseInt(f.nodeValue));break;case"con":this.SetContent(f.nodeValue);break;case"dcl":this.DeletePage(f.nodeValue);break;case"bdg":this.SetBadge(f.nodeValue);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};Tab.prototype.SetImage=function(c){if(c!=undefined){this.Image=c}if(this.Realized){if(RD3_Glb.IsMobile()){var b=this.Image;if(!RD3_Glb.IsIE(10,true)&&!RD3_Glb.IsEdge()){if(b==""){b=this.Selected?"tabsel.png":"tabunsel.png";if(RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro()){this.TabImg.style.webkitMaskImage="url("+RD3_Glb.GetAbsolutePath()+RD3_Glb.GetImgSrc("images/"+b)+")";this.TabImg.style.webkitMaskSize="25px 25px";this.TabImg.style.width="30px";this.TabImg.style.height="30px"}else{this.TabImg.style.backgroundImage="url("+RD3_Glb.GetAbsolutePath()+RD3_Glb.GetImgSrc("images/"+b)+")"}}else{this.TabImg.style.webkitMaskImage="url("+RD3_Glb.GetAbsolutePath()+RD3_Glb.GetImgSrc("images/"+b)+")";if(RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro()){this.TabImg.style.width="";this.TabImg.style.height="";this.TabImg.style.webkitMaskSize="";if(RD3_Glb.Adapt4Retina(this.Identifier,b,25)){this.TabImg.style.webkitMaskSize="0px 0px"}}}}else{if(b==""){b=this.Selected?"tabsel.png":"tabunsel.png"}if(this.ImgSrc!=b){this.TempImg=document.createElement("img");this.TempImg.src=RD3_Glb.GetImgSrc("images/"+b);if(!RD3_Glb.IsIE(10,false)){this.TempImg.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}else{this.TempImg.onreadystatechange=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}this.ImgSrc=b;return}var a=this.TabImg.getContext("2d");a.globalCompositeOperation="source-over";a.clearRect(0,0,RD3_ClientParams.ComboImageSize,RD3_ClientParams.ComboImageSize);this.TabImg.style.backgroundColor="";a.fillStyle=RD3_Glb.GetStyleProp(this.TabImg,"background-color");this.TabImg.style.backgroundColor="transparent";a.fillRect(0,0,RD3_ClientParams.ComboImageSize,RD3_ClientParams.ComboImageSize);a.globalCompositeOperation="destination-in";a.drawImage(this.TempImg,0,0,30,30)}}else{if(this.Image!=""){this.TabImg.src=RD3_Glb.GetImgSrc("images/"+this.Image);if(!RD3_Glb.IsIE(10,false)){this.TabImg.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}else{this.TabImg.onreadystatechange=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}this.TabImg.style.display=""}else{this.TabImg.style.display="none"}}this.TabView.RecalcLayout=true}};Tab.prototype.SetHeader=function(a){if(a!=undefined){this.Header=a}if(this.Realized){if(this.HeaderTxt){this.HeaderTxt.innerHTML=this.Header}else{this.HeaderCont.innerHTML=this.Header}this.TabView.RecalcLayout=true}};Tab.prototype.SetTooltip=function(a){if(a!=undefined){this.Tooltip=a}if(this.Realized){RD3_TooltipManager.SetObjTitle(this.CaptionBox,this.Tooltip)}};Tab.prototype.SetBadge=function(b){if(b!=undefined){this.Badge=b}if(this.Realized){if(this.Badge==""){if(this.BadgeObj!=null&&this.BadgeObj.parentNode){this.BadgeObj.parentNode.removeChild(this.BadgeObj)}this.BadgeObj=null}else{if(this.BadgeObj==null){var a=RD3_Glb.IsMobile();this.BadgeObj=document.createElement("DIV");this.BadgeObj.className="badge-red"+(a?" badge-min":"");this.BadgeObj.style.position=a?"absolute":"static";if(a){this.BadgeObj.style.top="2px";this.BadgeObj.style.marginLeft=(66-RD3_Glb.GetBadgeWidth(this.Badge,"red badge-min"))+"px";if(!RD3_Glb.IsIE()){this.BadgeObj.style.marginLeft="12px"}this.CaptionBox.appendChild(this.BadgeObj)}else{this.BadgeObj.style.marginLeft="4px";this.HeaderCont.appendChild(this.BadgeObj)}}this.BadgeObj.innerHTML=this.Badge}}};Tab.prototype.SetStyle=function(a){if(a!=undefined){this.Style=a}if(this.Realized){this.SelectPage(this.Selected);this.RecalcLayout=true}};Tab.prototype.SetContent=function(a){this.Content=a};Tab.prototype.Realize=function(d,f,b){var e=RD3_Glb.IsMobile();if(!this.Content.Identifier){this.Content=RD3_DesktopManager.ObjectMap[this.Content]}this.Content.ParentTab=this;this.Content.ParentFrame=this.TabView;this.CaptionBox=document.createElement(e?"div":"span");this.CaptionBox.id=this.Identifier+":cap";this.HeaderCont=document.createElement(e?"div":"span");if(e&&RD3_Glb.IsIE(10,true)){this.TabImg=document.createElement("canvas");this.TabImg.width=RD3_ClientParams.ComboImageSize;this.TabImg.height=RD3_ClientParams.ComboImageSize}else{this.TabImg=document.createElement(e?"div":"img")}if(!e){if(RD3_ServerParams.Theme!="zen"){this.LeftImage=document.createElement("img");this.LeftSpan=document.createElement("span");this.RightImage=document.createElement("img")}this.HeaderTxt=document.createElement("span")}var a="";switch(this.TabView.Placement){case RD3_Glb.TABOR_BOTTOM:a=RD3_Glb.IsMobile()?"":"tabbottom-";break;case RD3_Glb.TABOR_LEFT:a="tableft-";break;case RD3_Glb.TABOR_RIGHT:a=RD3_Glb.IsMobile()?"tabright-":"";break}this.CaptionBox.className="tab-caption-container-"+a+this.Style;this.HeaderCont.className="tab-caption-"+a+this.Style;this.TabImg.className="tab-img-"+this.Style;var c=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev)");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.CaptionBox.ontouchstart=c;this.TabImg.ontouchstart=c}else{if(e){this.CaptionBox.onmousedown=c}else{this.CaptionBox.onclick=c}}this.ContentBox=document.createElement("div");this.ContentBox.className="tab-contentbox-"+this.Style;this.ContentBox.id=this.Identifier;if(!e){if(RD3_ServerParams.Theme!="zen"){this.LeftImage.src=RD3_Glb.GetImgSrc("images/pgleft.gif");this.LeftImage.removeAttribute("width");this.LeftImage.removeAttribute("height");this.RightImage.src=RD3_Glb.GetImgSrc("images/pgright.gif");this.RightImage.removeAttribute("width");this.RightImage.removeAttribute("height");this.LeftSpan.className="tab-left"+a+"-0";this.RightImage.className="tab-right"+a+"-0";if(RD3_Glb.IsTouch()){this.LeftImage.setAttribute("height","32px");this.RightImage.setAttribute("height","32px")}}if(this.TabView.Placement==RD3_Glb.TABOR_LEFT){this.HeaderCont.appendChild(this.HeaderTxt);this.HeaderCont.appendChild(this.TabImg)}else{this.HeaderCont.appendChild(this.TabImg);this.HeaderCont.appendChild(this.HeaderTxt)}if(RD3_ServerParams.Theme!="zen"){this.LeftSpan.appendChild(this.LeftImage);this.CaptionBox.appendChild(this.LeftSpan)}this.CaptionBox.appendChild(this.HeaderCont);if(RD3_ServerParams.Theme!="zen"){this.CaptionBox.appendChild(this.RightImage)}}else{this.CaptionBox.appendChild(this.TabImg);this.CaptionBox.appendChild(this.HeaderCont)}f.appendChild(this.CaptionBox);d.appendChild(this.ContentBox);this.Realized=true;this.SetImage();this.SetHeader();this.SetTooltip();this.SetStyle();this.SetBadge();if(this.Content&&!this.Content.Realized&&!b){this.SetVisible(this.Content.Visible)}};Tab.prototype.Unrealize=function(a){if(!a){if(this.Content.Unrealize){this.Content.Unrealize()}else{RD3_DesktopManager.ObjectMap[this.Content].Unrealize()}}if(this.CaptionBox){this.CaptionBox.parentNode.removeChild(this.CaptionBox);this.ContentBox.parentNode.removeChild(this.ContentBox)}RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.CaptionBox=null;this.LeftSpan=null;this.LeftImage=null;this.HeaderCont=null;this.TabImg=null;this.HeaderTxt=null;this.RightImage=null;this.ContentBox=null;this.BadgeObj=null;this.Realized=false};Tab.prototype.AdaptLayout=function(){if(this.Content.Realized){RD3_Glb.AdaptToParent(this.ContentBox);if(this.Selected){this.Content.AdaptLayout((RD3_Glb.IsMobile()&&this.TabView&&this.TabView.ZoneTabView&&RD3_Glb.IsIE()))}if(this.RefreshExposed){this.RefreshExposition()}this.RecalcLayout=false}};Tab.prototype.SelectPage=function(d){var c=RD3_Glb.IsMobile();this.Selected=d;var a="";switch(this.TabView.Placement){case RD3_Glb.TABOR_BOTTOM:a=RD3_Glb.IsMobile()?"":"tabbottom-";break;case RD3_Glb.TABOR_LEFT:a="tableft-";break;case RD3_Glb.TABOR_RIGHT:a=RD3_Glb.IsMobile()?"tabright-":"";break}var b=(this.TabView.ToolbarBox.className.indexOf("popover")>-1)?"popover-":"";if(this.Selected){this.AlreadySelected=true;this.CaptionBox.className="selected-tab-caption-container-"+b+a+this.Style;this.HeaderCont.className="selected-tab-caption-"+a+this.Style;this.TabImg.className="selected-tab-img-"+this.Style+((c&&RD3_Glb.IsIE()&&RD3_Glb.IsSmartPhone())?"-ie":"");if(!c){this.HeaderTxt.className="selected-tab-text-"+a+this.Style;if(RD3_ServerParams.Theme!="zen"){this.LeftSpan.className="selected-tab-left-"+a+this.Style;this.LeftImage.className="selected-tab-left-img-"+a+this.Style;this.RightImage.className="selected-tab-right-"+a+this.Style}}}else{this.ContentBox.style.display="none";this.CaptionBox.className="tab-caption-container-"+b+a+this.Style;this.HeaderCont.className="tab-caption-"+a+this.Style;this.TabImg.className="tab-img-"+this.Style;if(!c){this.HeaderTxt.className="tab-text-"+a+this.Style;if(RD3_ServerParams.Theme!="zen"){this.LeftSpan.className="tab-left-"+a+this.Style;this.LeftImage.className="tab-left-img-"+a+this.Style;this.RightImage.className="tab-right-"+a+this.Style}}}if(c){if(this.Content.Realized){this.RefreshExposition()}else{this.RefreshExposed=true}}};Tab.prototype.SetVisible=function(a){this.Visible=a;if(this.Realized){if(this.Visible){this.CaptionBox.style.display="";if(this.Selected){this.ContentBox.style.display=""}}else{this.CaptionBox.style.display="none";this.ContentBox.style.display="none"}this.TabView.RecalcLayout=true}};Tab.prototype.OnMouseOverObj=function(c,b){if(!this.Selected&&!RD3_Glb.IsMobile()){var a="";if(this.TabView.Placement==RD3_Glb.TABOR_LEFT){a=" tab-caption-hl-tableft-0"}this.HeaderCont.className="tab-caption-hl-"+this.Style+a}};Tab.prototype.OnMouseOutObj=function(c,b){if(!this.Selected&&!RD3_Glb.IsMobile()){var a="";switch(this.TabView.Placement){case RD3_Glb.TABOR_BOTTOM:a=RD3_Glb.IsMobile()?"":"tabbottom-";break;case RD3_Glb.TABOR_LEFT:a="tableft-";break}this.HeaderCont.className="tab-caption-"+a+this.Style}};Tab.prototype.OnMouseDownObj=function(b,a){};Tab.prototype.OnClick=function(b){if(!this.Selected&&this.Visible&&!RD3_GFXManager.Blocking()){var a=new IDEvent("tab",this.Identifier,b,this.TabView.ClickEventDef,this.TabView.Identifier);if(a.ClientSide&&this.AlreadySelected){RD3_DesktopManager.SendEvents();this.TabView.SetSelectedPage(this.TabView.FindTabIndex(this))}}};Tab.prototype.AfterProcessResponse=function(){if(this.RecalcLayout){this.AdaptLayout()}this.RecalcLayout=false};Tab.prototype.GetTooltip=function(a,b){if(this.Tooltip==""){return false}a.SetObj(this.CaptionBox);b=this.CaptionBox;a.SetTitle(this.Header);a.SetText(this.Tooltip);a.SetAnchor(RD3_Glb.GetScreenLeft(b)+(b.offsetWidth/2),RD3_Glb.GetScreenTop(b));a.SetPosition(0);return true};Tab.prototype.DeletePage=function(c,a){var e=this.TabView.Tabs.length;for(var b=0;b<e;b++){if(this.TabView.Tabs[b]==this){if(this.Content&&this.Content.DeleteFrame&&!a){this.Content.DeleteFrame()}this.TabView.Tabs.splice(b,1);this.Unrealize(a);this.TabView.SetPlacement();var d=RD3_GFXManager.ActiveEffects[RD3_GFXManager.ActiveEffects.length-1];if(d&&d.Classe=="tab"&&d.ObjOut==this){RD3_GFXManager.ActiveEffects.splice(RD3_GFXManager.ActiveEffects.length-1,1);this.TabView.SetSelectedPage()}break}}};Tab.prototype.IsDraggable=function(a){return this.TabView.CanDrag};Tab.prototype.GetDOMObj=function(){return this.CaptionBox};Tab.prototype.DropElement=function(){return this.CaptionBox};Tab.prototype.ComputeDropList=function(b,a){if(!this.Realized){return}if(this!=a){b.push(this);this.AbsLeft=RD3_Glb.GetScreenLeft(this.CaptionBox,true);this.AbsTop=RD3_Glb.GetScreenTop(this.CaptionBox,true);if(!RD3_Glb.IsIE()){this.AbsLeft-=this.TabView.ContentBox.scrollLeft;this.AbsTop-=this.TabView.ContentBox.scrollTop}this.AbsRight=this.AbsLeft+this.CaptionBox.offsetWidth-1;this.AbsBottom=this.AbsTop+this.CaptionBox.offsetHeight-1}};Tab.prototype.RefreshExposition=function(){this.RefreshExposed=false;this.SetImage();var a=this.TabView.WebForm;if(a.Modal==0&&!a.Docked&&this.Selected){if(a.HasBackButton()&&a.BackButtonTxt&&a.BackButtonTxt.length>0){a.CaptureToolbarButton(a.BackButtonCnt)}a.CaptureToolbarButton(RD3_DesktopManager.WebEntryPoint.CmdObj.MenuButton)}if(this.Content&&this.Content.ChangeExpose){this.Content.ChangeExpose(this.Selected)}};Tab.prototype.OnReadyStateChange=function(){if(RD3_Glb.IsMobile()){if(!this.TempImg.readyState||this.TempImg.readyState=="complete"){this.SetImage()}}else{if(!RD3_Glb.IsIE(10,false)||this.TabImg.readyState=="complete"){this.TabView.AdaptLayout()}}};Tab.prototype.OnAdaptRetina=function(a,c,b){if(this.TabImg){this.TabImg.width=a+5;this.TabImg.height=c+5;this.TabImg.style.webkitMaskSize=a+"px "+c+"px"}};function TabbedView(a){WebFrame.call(this,a);this.SelectedPage=0;this.Placement=0;this.HiddenTabs=false;this.AutoSize=false;this.Tabs=new Array();this.OnlyTabs=false;this.ClickEventDef=RD3_Glb.EVENT_ACTIVE;this.Realized=false;this.TabFiller=null}TabbedView.prototype=new WebFrame();TabbedView.prototype.LoadFromXml=function(f){WebFrame.prototype.LoadFromXml.call(this,f);var d=f.childNodes;var g=d.length;for(var e=0;e<g;e++){var b=d.item(e);var a=b.nodeName;switch(a){case"tab":var c=new Tab(this);c.LoadFromXml(b);this.Tabs.push(c);if(this.Realized){c.Realize(this.ContentBox,this.ToolbarBox);this.SetPlacement();if(this.DelayedSelPage<this.Tabs.length){this.SetSelectedPage();this.DelayedSelPage=undefined}}break}}};TabbedView.prototype.ChangeProperties=function(a){this.LoadFromXml(a)};TabbedView.prototype.LoadProperties=function(e){WebFrame.prototype.LoadProperties.call(this,e);var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"sel":this.SetSelectedPage(parseInt(f.nodeValue)-1);break;case"pla":this.SetPlacement(parseInt(f.nodeValue));break;case"hid":this.SetHiddenTabs(f.nodeValue=="1");break;case"asz":this.SetAutoSize(f.nodeValue=="1");break;case"clk":this.ClickEventDef=parseInt(f.nodeValue);break;case"cpa":this.ChangePageAnimDef=a;break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};TabbedView.prototype.SetSelectedPage=function(f,d){if(d==undefined){d=false}var a=this.SelectedPage;if(f!=undefined){this.SelectedPage=f}if(this.Realized&&(a!=this.SelectedPage||f==undefined)){if(this.SelectedPage>=this.Tabs.length){this.DelayedSelPage=this.SelectedPage;return}var e=null;var h=this.Tabs.length;var g=0;for(var b=0;b<h;b++){if(this.Tabs[b].Selected){e=this.Tabs[b];g=b}else{if(b!=this.SelectedPage){this.Tabs[b].SelectPage(false)}}}if(this.SelectedPage!=-1){var c=new GFX("tab",g>=this.SelectedPage,this.Tabs[this.SelectedPage],(f==undefined)||(!e)||(e==this.Tabs[this.SelectedPage])||d,e,this.ChangePageAnimDef);RD3_GFXManager.AddEffect(c)}else{if(e){e.SelectPage(false)}}}};TabbedView.prototype.SetPlacement=function(a){if(a!=undefined){this.Placement=a}if(this.Realized){if(this.Placement==RD3_Glb.TABOR_RIGHT){if(!RD3_Glb.IsMobile()){this.ToolbarBox.style.position="absolute";this.ContentBox.style.position="absolute"}this.ToolbarBox.className="toolstrip-container-right";if(this.TabFiller.parentNode){this.ToolbarBox.removeChild(this.TabFiller)}this.ToolbarBox.appendChild(this.TabFiller)}if(this.Placement==RD3_Glb.TABOR_LEFT){if(!RD3_Glb.IsMobile()){this.ToolbarBox.style.position="absolute";this.ContentBox.style.position="absolute"}this.TabFiller.className="tab-filler-tabbottom";this.ToolbarBox.className="toolstrip-container-left";if(this.TabFiller.parentNode){this.ToolbarBox.removeChild(this.TabFiller)}this.ToolbarBox.appendChild(this.TabFiller)}if(this.Placement==RD3_Glb.TABOR_BOTTOM){var b=this.ToolbarBox.parentNode;b.removeChild(this.ToolbarBox);b.appendChild(this.ToolbarBox);if(!RD3_Glb.IsMobile()){this.TabFiller.className="tab-filler-tabbottom";this.ToolbarBox.style.position="absolute"}if(this.TabFiller.parentNode){this.ToolbarBox.removeChild(this.TabFiller)}this.ToolbarBox.appendChild(this.TabFiller)}if(this.Placement==RD3_Glb.TABOR_TOP){this.ToolbarBox.style.textAlign="";if(this.TabFiller.parentNode){this.ToolbarBox.removeChild(this.TabFiller)}this.ToolbarBox.appendChild(this.TabFiller)}}};TabbedView.prototype.SetHiddenTabs=function(a){if(a!=undefined){this.HiddenTabs=a}if(this.Realized){if(this.HiddenTabs){this.ToolbarBox.style.display="none";this.ContentBox.style.marginTop="0px"}else{this.ToolbarBox.style.display="";this.ContentBox.style.marginTop=RD3_ClientParams.StandardPadding+"px"}}};TabbedView.prototype.SetAutoSize=function(a){if(a!=undefined){this.AutoSize=a}if(this.Realized){}};TabbedView.prototype.SetOnlyTabs=function(a){if(a!=undefined){this.OnlyTabs=a}if(this.Realized){this.ContentBox.style.display=this.OnlyTabs?"none":""}};TabbedView.prototype.SetCollapsible=function(a){if(a!=undefined){this.Collapsible=a}};TabbedView.prototype.SetCollapsed=function(a){if(a!=undefined){this.Collapsed=a}};TabbedView.prototype.SetImage=function(a){if(a!=undefined){this.Image=a}};TabbedView.prototype.SetCaption=function(a){if(a!=undefined){this.Caption=a}};TabbedView.prototype.SetSmallIcon=function(a){if(a!=undefined){this.SmallIcons=a}};TabbedView.prototype.SetWidth=function(a){WebFrame.prototype.SetWidth.call(this,a)};TabbedView.prototype.SetHeight=function(a){WebFrame.prototype.SetHeight.call(this,a)};TabbedView.prototype.Realize=function(b){if(!this.Realized){WebFrame.prototype.Realize.call(this,b)}if(this.ZoneTabView){this.ContentBox.className=this.ContentBox.className+" zone-tab-view"}this.ContentBox.style.marginLeft="0px";this.ContentBox.style.marginRight="0px";this.ContentBox.style.marginBottom="0px";this.ContentBox.style.overflowX="hidden";this.ContentBox.style.overflowY="hidden";var c=this.Tabs.length;for(var a=0;a<c;a++){this.Tabs[a].Realize(this.ContentBox,this.ToolbarBox)}this.TabFiller=document.createElement("span");this.TabFiller.className="tab-filler";this.Realized=true;this.SetSelectedPage();this.SetPlacement();this.SetHiddenTabs();this.SetAutoSize()};TabbedView.prototype.Unrealize=function(){WebFrame.prototype.Unrealize.call(this);var b=this.Tabs.length;for(var a=0;a<b;a++){this.Tabs[a].Unrealize()}};TabbedView.prototype.AdaptLayout=function(){var d=this.Tabs.length;if(this.SendResize){for(var e=0;e<d;e++){var l=this.Tabs[e];if(l.Realized&&l.Content){l.Content.SendResize=true;l.Content.DeltaW+=this.DeltaW;l.Content.DeltaH+=this.DeltaH}}this.DeltaW=0;this.DeltaH=0}this.TabFiller.style.width="0px";WebFrame.prototype.AdaptLayout.call(this);var k=false;var g=0;var j;this.ToolbarBox.style.display="";if(this.Placement==RD3_Glb.TABOR_LEFT){this.ToolbarBox.style.width="";RD3_Glb.AdaptToParent(this.ToolbarBox,-1,0);if(!RD3_Glb.IsMobile()){this.ToolbarBox.style.width=this.ToolbarBox.style.height;this.ToolbarBox.style.height=""}}if(this.Placement==RD3_Glb.TABOR_RIGHT){this.ToolbarBox.style.width="";RD3_Glb.AdaptToParent(this.ToolbarBox,-1,0);if(!RD3_Glb.IsMobile()){this.ToolbarBox.style.width=this.ToolbarBox.style.height;this.ToolbarBox.style.height=""}}g=this.ToolbarBox.clientWidth;var a=0;j=0;for(var e=0;e<d;e++){var h=((k)?RD3_ClientParams.TabWidthThin:RD3_ClientParams.TabWidth);var l=this.Tabs[e];if(l.Content.Visible){a++;l.HeaderCont.style.width="";if(!RD3_Glb.IsMobile()){if(l.HeaderCont.offsetWidth<=h&&l.HeaderCont.offsetWidth>0){l.HeaderCont.style.width=h+"px"}}j+=l.CaptionBox.offsetWidth;if(j>g){if(!k){e=-1;k=true;j=0;continue}else{j=l.CaptionBox.offsetWidth;continue}}}var h=(g-j);if(h<0){h=0}this.TabFiller.style.width=h+"px";var b=((this.TabFiller.scrollWidth>this.TabFiller.offsetWidth&&RD3_Glb.IsIE())?this.TabFiller.scrollWidth:this.TabFiller.offsetWidth);if(b>(g-j)){h=((g-j)-(b-(g-j)));if(h<0){h=0}this.TabFiller.style.width=h+"px"}if(RD3_Glb.IsFirefox()&&this.TabFiller.offsetLeft==0){this.TabFiller.style.width=(parseInt(this.TabFiller.style.width)-1)+"px"}}this.ToolbarBox.style.display=(a>0&&!this.HiddenTabs)?"":"none";RD3_Glb.AdaptToParent(this.ContentBox,this.GetHContentOffset(),this.GetContentOffset());var d=this.Tabs.length;for(var e=0;e<d;e++){this.Tabs[e].AdaptLayout()}if(this.Placement==RD3_Glb.TABOR_BOTTOM){this.ToolbarBox.style.top=(this.Height-this.ToolbarBox.offsetHeight)+"px";if(RD3_Glb.IsMobile()&&this.Switched){this.Switched=false;var c=this.ToolbarBox.nextSibling;var f=this.ToolbarBox.parentNode;f.removeChild(this.ToolbarBox);f.insertBefore(this.ToolbarBox,c)}}if(this.Placement==RD3_Glb.TABOR_LEFT){this.ToolbarBox.style.left=RD3_Glb.IsMobile()?"0px":this.ToolbarBox.offsetHeight+"px";this.ToolbarBox.style.top="0px";if(this.HiddenTabs){this.ContentBox.style.left="0px"}else{this.ContentBox.style.left=RD3_Glb.IsMobile()?this.ToolbarBox.offsetWidth+"px":this.ToolbarBox.offsetHeight+"px"}this.ContentBox.style.top="0px"}if(this.Placement==RD3_Glb.TABOR_RIGHT){this.ToolbarBox.style.left=RD3_Glb.IsMobile()?this.ContentBox.offsetWidth+"px":(this.ContentBox.offsetWidth+this.ToolbarBox.offsetHeight)+"px";this.ToolbarBox.style.top="0px";this.ContentBox.style.left="0px";this.ContentBox.style.top="0px"}};TabbedView.prototype.RealizeToolbar=function(){this.ToolbarBox=document.createElement("div");this.ToolbarBox.setAttribute("id","tl:"+this.Identifier);this.ToolbarBox.className="toolstrip-container";if(this.ZoneTabView&&!RD3_Glb.IsMobile()){this.ToolbarBox.style.paddingTop="0px"}this.FrameBox.appendChild(this.ToolbarBox)};TabbedView.prototype.FindTabIndex=function(b){var c=this.Tabs.length;for(var a=0;a<c;a++){if(this.Tabs[a]==b){return a}}return -1};TabbedView.prototype.AfterProcessResponse=function(){WebFrame.prototype.AfterProcessResponse.call(this);var b=this.Tabs.length;for(var a=0;a<b;a++){this.Tabs[a].AfterProcessResponse()}};TabbedView.prototype.SetChildLayout=function(){};TabbedView.prototype.GetSelectedFrame=function(){var a=this.Tabs[this.SelectedPage];if(a){return a.Content}return null};TabbedView.prototype.OnFrameClick=function(b,i,c,g,f,j,d,h){var a=h?RD3_Glb.GetRD3ObjectId(h):null;var e=new IDEvent("rawclk",this.Identifier,b,i?this.MouseDoubleClickEventDef:this.MouseClickEventDef,i,c,Math.floor(j)+"-"+Math.floor(d),Math.floor(g)+"-"+Math.floor(f),a)};TabbedView.prototype.ComputeDropList=function(c,a){if(!this.Realized){return}if(!this.CanDrop){return}c.push(this);var d=this.ToolbarBox;this.AbsLeft=RD3_Glb.GetScreenLeft(d,true);this.AbsTop=RD3_Glb.GetScreenTop(d,true);if(!RD3_Glb.IsIE()){this.AbsLeft-=this.ToolbarBox.scrollLeft;this.AbsTop-=this.ToolbarBox.scrollTop}this.AbsRight=this.AbsLeft+d.offsetWidth-1;this.AbsBottom=this.AbsTop+d.offsetHeight-1;var e=this.Tabs.length;for(var b=0;b<e;b++){this.Tabs[b].ComputeDropList(c,a)}};TabbedView.prototype.OnMouseUp=function(b){WebFrame.prototype.OnMouseUp.call(this,b);if(RD3_Glb.IsTouch()){var a=this.GetSelectedFrame();if(a){a.OnMouseUp(b)}}};TabbedView.prototype.OnMouseDown=function(b){WebFrame.prototype.OnMouseDown.call(this,b);if(RD3_Glb.IsTouch()){var a=this.GetSelectedFrame();if(a){a.OnMouseDown(b)}}};TabbedView.prototype.GetContentOffset=function(){if(this.Placement==RD3_Glb.TABOR_BOTTOM||this.Placement==RD3_Glb.TABOR_TOP){return this.ToolbarBox.offsetHeight}return 0};TabbedView.prototype.GetHContentOffset=function(){if(this.Placement==RD3_Glb.TABOR_RIGHT||this.Placement==RD3_Glb.TABOR_LEFT){var a=0;if(RD3_Glb.IsMobile()){a=this.ToolbarBox.offsetWidth}else{a=this.ToolbarBox.offsetHeight}if(this.ToolbarBox.style.display=="none"){a=0}return a}return 0};function TimerHandler(){this.TimerList=new Array();this.Identifier="tmh";this.Realized=false}TimerHandler.prototype.LoadFromXml=function(g,e){if(g.nodeName!=this.Identifier){return}var c=g.childNodes;var h=c.length;for(var d=0;d<h;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"tim":var f=RD3_DesktopManager.ObjectMap[b.getAttribute("id")];if(f){if(e){f.Unrealize()}}else{f=new ATimer();this.TimerList.push(f)}f.LoadFromXml(b);if(e){f.Realize()}break}}RD3_DesktopManager.ObjectMap.add(this.Identifier,this)};TimerHandler.prototype.Realize=function(){var b=this.TimerList.length;for(var a=0;a<b;a++){this.TimerList[a].Realize()}this.Realized=true};TimerHandler.prototype.Unrealize=function(){var b=this.TimerList.length;for(var a=0;a<b;a++){this.TimerList[a].Unrealize()}RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.Realized=false};TimerHandler.prototype.ActiveFormChanged=function(){var b=this.TimerList.length;for(var a=0;a<b;a++){this.TimerList[a].ActiveFormChanged()}};TimerHandler.prototype.FormClosed=function(b){var c=this.TimerList.length;for(var a=0;a<c;a++){this.TimerList[a].FormClosed(b)}};function Tree(a){WebFrame.call(this,a);this.PopupMenu=null;this.MultipleSelection=false;this.DragDrop=false;this.ActivateOnExpand=true;this.CheckActive=false;this.ClickEventDef=RD3_Glb.EVENT_ACTIVE;this.ExpandEventDef=RD3_Glb.EVENT_ACTIVE;this.FirstExpandDef=RD3_Glb.EVENT_ACTIVE;this.CheckEventDef=RD3_Glb.EVENT_CLIENTSIDE|RD3_Glb.EVENT_SERVERSIDE;this.RootNodes=new Array();this.SelectedNode=null;this.Prevsel=null;this.NodeBox=null;this.RefreshSelected="";this.RecenterTree=false}Tree.prototype=new WebFrame();Tree.prototype.LoadFromXml=function(e){WebFrame.prototype.LoadFromXml.call(this,e);var c=e.childNodes;var g=c.length;for(var d=0;d<g;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"trn":var f=new TreeNode(this,null);f.LoadFromXml(b);this.RootNodes.push(f);break}}};Tree.prototype.LoadProperties=function(e){WebFrame.prototype.LoadProperties.call(this,e);var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"mul":this.SetMultipleSelection(f.nodeValue=="1");break;case"ded":this.SetDragDrop(f.nodeValue=="1");break;case"aoe":this.SetActivateOnExpand(f.nodeValue=="1");break;case"cms":this.SetPopupMenu(f.nodeValue);break;case"sel":this.SetSelectedNode(f.nodeValue);break;case"act":this.SetCheckActive(f.nodeValue=="1");break;case"clk":this.ClickEventDef=parseInt(f.nodeValue);break;case"xpc":this.ExpandEventDef=parseInt(f.nodeValue);break;case"fex":this.FirstExpandDef=parseInt(f.nodeValue);break;case"chc":this.CheckEventDef=parseInt(f.nodeValue);break;case"exa":this.ExpandAnimDef=a;break}}};Tree.prototype.ChangeProperties=function(e){var a=e.childNodes;var d=RD3_Glb.HasNode(e,"trn");if(a.length>0&&d){this.ResetCache();this.LoadFromXml(e);if(this.Realized){var c=this.ContentBox;if(RD3_Glb.IsMobile()){c=this.NodeBox}var f=this.RootNodes.length;for(var b=0;b<f;b++){this.RootNodes[b].Realize(c)}if(this.SelectedNode){this.SetSelectedNode(this.SelectedNode)}if(RD3_Glb.IsMobile()){for(var b=0;b<f;b++){if(this.RootNodes[b].ExpandSkipped&&this.RootNodes[b].Expanded){this.RootNodes[b].SetExpanded(this.RootNodes[b].Expanded,true,true)}}}}}this.LoadProperties(e)};Tree.prototype.SetMultipleSelection=function(c){var a=this.MultipleSelection;if(c!=undefined){this.MultipleSelection=c}if(a!=this.MultipleSelection&&!this.MultipleSelection){this.ActiveNode=null}if(this.Realized){var d=this.RootNodes.length;for(var b=0;b<d;b++){this.RootNodes[b].MultipleSelectionChanged()}}};Tree.prototype.SetDragDrop=function(a){this.DragDrop=a};Tree.prototype.SetActivateOnExpand=function(a){this.ActivateOnExpand=a};Tree.prototype.SetCheckActive=function(a){this.CheckActive=a;this.CheckEventDef=(this.CheckActive)?RD3_Glb.EVENT_ACTIVE:RD3_Glb.DEFERRED};Tree.prototype.SetPopupMenu=function(a){if(!a.Identifier){this.PopupMenu=RD3_DesktopManager.ObjectMap[a];if(this.PopupMenu==undefined&&a!=undefined){this.PopupMenu=a}}else{this.PopupMenu=a}};Tree.prototype.SetSelectedNode=function(a){if(!this.Prevsel&&this.SelectedNode){this.Prevsel=this.SelectedNode}this.SelectedNode=RD3_DesktopManager.ObjectMap[a];if(this.Realized){if(this.SelectedNode){this.RefreshSelected="";if(this.SelectedNode.NodeText){this.SelectedNode.NodeText.className="tree-selected-node-text"}else{if(RD3_Glb.IsMobile()&&(this.SelectedNode.AlreadyExpanded&&this.SelectedNode.Nodes.length==0)){RD3_Glb.AddClass(this.SelectedNode.CaptionBox,"tree-node-selected-node")}}if(this.Prevsel&&this.Prevsel.Realized&&this.Prevsel.Identifier!=this.SelectedNode.Identifier){if(this.Prevsel.NodeText){this.Prevsel.NodeText.className="tree-node-text"}else{if(RD3_Glb.IsMobile()){RD3_Glb.RemoveClass(this.Prevsel.CaptionBox,"tree-node-selected-node")}}this.Prevsel=null}else{if(this.Prevsel&&!this.Prevsel.Realized){this.Prevsel=null}}this.RecenterTree=true}else{if(a==""){if(this.Prevsel&&this.Prevsel.Realized){if(this.Prevsel.NodeText){this.Prevsel.NodeText.className="tree-node-text"}this.Prevsel=null}}else{this.RefreshSelected=a}}}else{if(!this.SelectedNode){this.SelectedNode=a}}};Tree.prototype.Realize=function(c){WebFrame.prototype.Realize.call(this,c);this.ContentBox.className="tree-container";var b=this.ContentBox;if(RD3_Glb.IsMobile()){this.NodeBox=document.createElement("div");this.NodeBox.setAttribute("id",this.Identifier+":box");this.NodeBox.className="tree-node-container";b=this.NodeBox;this.ContentBox.appendChild(b);this.IDScroll=new IDScroll(this.Identifier,this.NodeBox,this.ContentBox,this)}var d=this.RootNodes.length;for(var a=0;a<d;a++){this.RootNodes[a].Realize(b)}this.Realized=true;this.SetSelectedNode(this.SelectedNode);if(this.PopupMenu!=undefined&&!this.PopupMenu.Identifier){this.SetPopupMenu(this.PopupMenu)}if(RD3_Glb.IsMobile()){for(var a=0;a<d;a++){if(this.RootNodes[a].ExpandSkipped&&this.RootNodes[a].Expanded){this.RootNodes[a].SetExpanded(this.RootNodes[a].Expanded,true,true)}}this.SetScrollbar()}};Tree.prototype.Unrealize=function(){WebFrame.prototype.Unrealize.call(this);var b=this.RootNodes.length;for(var a=0;a<b;a++){this.RootNodes[a].Unrealize()}};Tree.prototype.ResetCache=function(){var d=this.RootNodes.length;var b=RD3_Glb.IsMobile();for(var c=0;c<d;c++){var a=this.RootNodes[c];if(b&&a.Expanded){a.ResetCache()}a.Unrealize()}this.RootNodes.splice(0,this.RootNodes.length)};Tree.prototype.AdaptLayout=function(){WebFrame.prototype.AdaptLayout.call(this);var a=RD3_Glb.IsMobile()?0:4;RD3_Glb.AdaptToParent(this.ContentBox,a,this.GetContentOffset()+a);if(RD3_Glb.IsMobile()){if(this.ActiveNode){this.ActiveNode.SetNodeClass(this.ActiveNode.Expanded)}else{if(this.SelectedNode){this.SelectedNode.SetNodeClass(this.SelectedNode.Expanded)}else{if(this.RootNodes.length>0){this.RootNodes[0].SetNodeClass(false)}}}}};Tree.prototype.ComputeDropList=function(c,a){if((!this.DragDrop&&!this.CanDrop)||!this.Enabled){return}var d=this.RootNodes.length;for(var b=0;b<d;b++){this.RootNodes[b].ComputeDropList(c,a)}};Tree.prototype.SetEnabled=function(b){WebFrame.prototype.SetEnabled.call(this,b);var c=this.RootNodes.length;for(var a=0;a<c;a++){this.RootNodes[a].SetEnabled(b)}};Tree.prototype.AfterProcessResponse=function(){WebFrame.prototype.AfterProcessResponse.call(this);if(this.SelectedNode&&this.RecenterTree&&!RD3_Glb.IsMobile()){this.RecenterTree=false;var a=this.SelectedNode.CaptionBox;var b=a.offsetTop;if(!RD3_Glb.IsIE()){b-=this.ContentBox.offsetTop}if(b<this.ContentBox.scrollTop){this.ContentBox.scrollTop=b-a.offsetHeight}else{if(b+a.offsetHeight>this.ContentBox.scrollTop+this.ContentBox.clientHeight){this.ContentBox.scrollTop=b+(2*a.offsetHeight)-this.ContentBox.clientHeight}}}};Tree.prototype.OnFrameClick=function(b,i,c,g,f,j,d,h){while(h&&h.tagName!="DIV"&&!RD3_Glb.HasClass(h,"tree-node-container")){h=h.parentNode}var a=h?RD3_Glb.GetRD3ObjectId(h):null;var e=new IDEvent("rawclk",this.Identifier,b,i?this.MouseDoubleClickEventDef:this.MouseClickEventDef,i,c,Math.floor(j)+"-"+Math.floor(d),Math.floor(g)+"-"+Math.floor(f),a)};Tree.prototype.GetTooltip=function(a,b){return WebFrame.prototype.GetTooltip.call(this,a,b)};Tree.prototype.OnTouchStart=function(a){WebFrame.prototype.OnTouchStart.call(this,a);if(a.targetTouches.length!=1){return false}a.preventDefault();this.TouchStartX=a.targetTouches[0].clientX;this.TouchStartY=a.targetTouches[0].clientY;this.TouchOrgX=a.targetTouches[0].clientX;this.TouchOrgY=a.targetTouches[0].clientY;this.TouchNode=RD3_DDManager.GetObject(RD3_Glb.ElementFromPoint(this.TouchStartX,this.TouchStartY).id);if(this.TouchNode instanceof TreeNode){this.TouchNode.OnMouseOverObj(a)}this.TouchTimes=new Array();this.TouchPosY=new Array();this.TouchPosX=new Array();this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);this.TouchMoved=false;this.ClearTouchScrollTimer();return false};Tree.prototype.OnTouchMove=function(f){if(this.TouchStartX==-1){return false}f.preventDefault();if(f.targetTouches.length!=1){return false}var d=f.targetTouches[0].clientX-this.TouchStartX;var g=f.targetTouches[0].clientY-this.TouchStartY;var a=new Date();this.TouchStartX=f.targetTouches[0].clientX;this.TouchStartY=f.targetTouches[0].clientY;if(Math.abs(this.TouchStartX-this.TouchOrgX)>RD3_ClientParams.TouchMoveLimit||Math.abs(this.TouchStartY-this.TouchOrgY)>RD3_ClientParams.TouchMoveLimit){this.TouchMoved=true;if(this.TouchNode instanceof TreeNode){this.TouchNode.OnMouseOutObj(f)}}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);if(this.TouchTimes.length>3){this.TouchTimes.shift();this.TouchPosY.shift();this.TouchPosX.shift()}var c=this.ContentBox.scrollLeft;var b=this.ContentBox.scrollTop;this.ContentBox.scrollLeft-=d;this.ContentBox.scrollTop-=g;this.FormScroll=this.FormScroll&&c==this.ContentBox.scrollLeft&&b==this.ContentBox.scrollTop;WebFrame.prototype.OnTouchMove.call(this,f);return false};Tree.prototype.OnTouchEnd=function(f){if(this.TouchNode instanceof TreeNode){this.TouchNode.OnMouseOutObj(f);this.TouchNode=null}if(this.TouchStartX==-1){return false}f.preventDefault();if(f.targetTouches.length!=0&&f.changedTouches.length!=1){return false}if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}if(!this.TouchMoved){var k=f.changedTouches[0].clientX;var j=f.changedTouches[0].clientY;var h=false;this.FormScroll=false;if(new Date()-this.SingleTapTime<300&&Math.abs(k-this.SingleTapX)<16&&Math.abs(j-this.SingleTapY)<16){h=true;this.SingleTapTime=0;this.SingleTapX=-100;this.SingleTapY=-100}else{this.SingleTapTime=new Date();this.SingleTapX=k;this.SingleTapY=j}var a=RD3_Glb.ElementFromPoint(k,j);var d=null;var l=false;if(a){l=(a.tagName=="IMG"||a.tagName=="INPUT");if(a.tagName=="SPAN"){d=RD3_DDManager.GetObject(a.id);if(d instanceof TreeNode){l=true}}}if(l){var c=document.createEvent("MouseEvents");c.initMouseEvent(h?"dblclick":"click",true,true,window,1,k,j,k,j);a.dispatchEvent(c)}}else{if(this.TouchTimes.length==3){var b=this.TouchTimes[2]-this.TouchTimes[0];var n=this.TouchPosX[0]-this.TouchPosX[2];var m=this.TouchPosY[0]-this.TouchPosY[2];if(new Date()-this.TouchTimes[2]<100&&b>0){var g=m/b;var i=n/b;if(Math.abs(i)>0.3||Math.abs(g)>0.3){this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+i+","+g+",0])",10)}}}}WebFrame.prototype.OnTouchEnd.call(this,f);this.TouchStartX=-1;this.TouchStartY=-1;this.TouchMoved=false;this.TouchMove=false;return false};Tree.prototype.TouchScrollTimer=function(d,b){if(b.length==3){var c=b[0];var a=b[1];var e=b[2];this.ContentBox.scrollLeft+=c*10;this.ContentBox.scrollTop+=a*10;if(e<40){c=c*0.97;a=a*0.97;this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+c+","+a+","+(e+1)+"])",10)}}};Tree.prototype.ClearTouchScrollTimer=function(){if(this.TouchScrollTimerId>0){window.clearTimeout(this.TouchScrollTimerId);this.TouchScrollTimerId=0;this.TouchScroll=0}};Tree.prototype.ChangeExpose=function(b){WebFrame.prototype.ChangeExpose.call(this,b);var c=this.RootNodes.length;for(var a=0;a<c;a++){this.RootNodes[a].ChangeExpose(b)}};Tree.prototype.AccentColorChanged=function(b,c){var d=this.RootNodes.length;for(var a=0;a<d;a++){this.RootNodes[a].AccentColorChanged(b,c)}};Tree.prototype.ResetTree=function(){var b=this.RootNodes.length;for(var a=0;a<b;a++){this.RootNodes[a].CollapseBranch()}};function TreeNode(a,b){this.Identifier=null;this.Caption="";this.Tooltip="";this.Image="";this.Selected=false;this.CanBeChecked=true;this.Expanded=false;this.AlreadyExpanded=false;this.Badge="";this.ClassName;this.Nodes=new Array();this.ParentTree=a;this.ParentNode=b;this.WaitForChildren=false;this.ExecuteGFX=true;this.Realized=false;this.NodeBox=null;this.CaptionBox=null;this.ExpandImg=null;this.ChildImg=null;this.CheckBox=null;this.Filler=null;this.NodeContent=null;this.NodeImg=null;this.NodeText=null;this.ChildrenBox=null;this.BadgeObj=null}TreeNode.prototype.LoadFromXml=function(e){this.LoadProperties(e);var c=e.childNodes;var g=c.length;for(var d=0;d<g;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"trn":var f=new TreeNode(this.ParentTree,this);f.LoadFromXml(b);this.Nodes.push(f);break}}};TreeNode.prototype.ChangeProperties=function(d){var a=d.childNodes;var c=RD3_Glb.HasNode(d,"trn");if(a.length>0&&c){this.RemoveChildren();this.LoadFromXml(d);if(this.Realized&&!RD3_Glb.IsMobile()){var e=this.Nodes.length;for(var b=0;b<e;b++){this.Nodes[b].Realize(this.ChildrenBox)}if(!this.ParentTree.SelectedNode&&this.ParentTree.RefreshSelected!=""){this.ParentTree.SetSelectedNode(this.ParentTree.RefreshSelected)}}if(this.WaitForChildren){this.WaitForChildren=false}else{this.ExecuteGFX=false}this.HandleExpandable();this.ExecuteGFX=true;if(RD3_Glb.IsMobile()&&this.Expanded){this.LoadNestedNode(true)}}else{this.LoadProperties(d);if(this.WaitForChildren){this.WaitForChildren=false;this.HandleExpandable()}}};TreeNode.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"aex":this.SetAlreadyExpanded(f.nodeValue=="1");break;case"exp":this.SetExpanded(f.nodeValue=="1");break;case"cap":this.SetCaption(f.nodeValue);break;case"tip":this.SetTooltip(f.nodeValue);break;case"img":this.SetImage(f.nodeValue);break;case"cch":this.SetCanCheck(f.nodeValue=="1");break;case"sel":this.SetSelected(f.nodeValue=="1");break;case"bdg":this.SetBadge(f.nodeValue);break;case"cln":this.SetClassName(f.nodeValue);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};TreeNode.prototype.SetAlreadyExpanded=function(b){var a=this.AlreadyExpanded;this.AlreadyExpanded=b;if(this.Realized&&a!=this.AlreadyExpanded){this.HandleExpandable()}};TreeNode.prototype.SetExpanded=function(d,b,c){var a=this.Expanded;this.Expanded=d;if(this.Realized&&(a!=this.Expanded||c)){this.HandleExpandable();if(RD3_Glb.IsMobile()&&(!this.Expanded||this.Nodes.length>0)){this.LoadNestedNode(this.Expanded,b,c)}if(this.ExpandSkipped){this.ExpandSkipped=false}}else{if(this.Expanded){this.ExpandSkipped=true}}};TreeNode.prototype.SetCaption=function(a){this.Caption=a;if(this.Realized){if(this.NodeText){this.NodeText.innerHTML=this.Caption}else{this.CaptionBox.innerHTML=this.Caption}}};TreeNode.prototype.SetTooltip=function(a){this.Tooltip=a;if(this.Realized){if(RD3_Glb.IsMobile()){if(a!=""){this.CaptionBox.innerHTML=this.Caption+"<div class='tree-node-tooltip'>"+this.Tooltip+"</div>";RD3_Glb.AddClass(this.CaptionBox,"tree-node-with-tooltip")}}else{RD3_TooltipManager.SetObjTitle(this.CaptionBox,this.Tooltip)}}};TreeNode.prototype.SetImage=function(a){this.Image=a;if(this.Realized){if(RD3_Glb.IsMobile()){this.HandleExpandable()}else{if(this.Image!=""){this.NodeImg.style.display="";this.NodeImg.src=RD3_Glb.GetImgSrc("images/"+this.Image)}else{this.NodeImg.style.display="none"}}}};TreeNode.prototype.SetCanCheck=function(a){this.CanBeChecked=a;if(this.Realized){if(RD3_Glb.IsMobile()){this.HandleExpandable()}else{if(this.CanBeChecked&&this.ParentTree.MultipleSelection){this.CheckBox.style.display=""}else{this.CheckBox.style.display="none"}}}};TreeNode.prototype.SetSelected=function(a){this.Selected=a;if(this.Realized){if(RD3_Glb.IsMobile()){this.HandleExpandable(true)}else{if(this.Selected){this.CheckBox.checked=true}else{this.CheckBox.checked=false}}}};TreeNode.prototype.SetBadge=function(a){this.Badge=a;if(this.Realized){if(this.Badge==""&&this.BadgeObj!=null){this.BadgeObj.parentElement.removeChild(this.BadgeObj);this.BadgeObj=null}else{if(this.Badge!=""){if(this.BadgeObj==null){this.BadgeObj=document.createElement("div");this.BadgeObj.setAttribute("id",this.Identifier+":bdg");this.BadgeObj.className="badge-"+(RD3_Glb.IsMobile()?"grey badge-right":"red");if(RD3_Glb.IsMobile()){this.BadgeObj.style.marginRight="10px"}else{this.BadgeObj.style.marginLeft="10px"}this.CaptionBox.appendChild(this.BadgeObj)}this.BadgeObj.innerHTML=this.Badge;this.BadgeObj.style.top=RD3_Glb.IsMobile()?"-4px":"-2px"}}}};TreeNode.prototype.SetClassName=function(b){var a=this.ClassName;if(b){this.ClassName=b}if(this.Realized&&(a!=this.ClassName||!b)){if(a!=""){RD3_Glb.RemoveClass2(this.CaptionBox,a)}if(this.ClassName&&this.ClassName!=""){RD3_Glb.AddClass(this.CaptionBox,this.ClassName)}}};TreeNode.prototype.Realize=function(h){if(RD3_Glb.IsMobile()){this.CaptionBox=document.createElement("div");this.CaptionBox.setAttribute("id",this.Identifier+":cap");this.CaptionBox.className="tree-node-caption";h.appendChild(this.CaptionBox)}else{this.NodeBox=document.createElement("div");this.NodeBox.setAttribute("id",this.Identifier);this.NodeBox.className="tree-node-container";this.CaptionBox=document.createElement("div");this.CaptionBox.setAttribute("id",this.Identifier+":cap");this.CaptionBox.className="tree-node-caption";this.ExpandImg=document.createElement("img");this.ExpandImg.className="tree-exp-img";this.ChildImg=document.createElement("img");this.ChildImg.src=RD3_Glb.GetImgSrc("images/tn.gif");this.ChildImg.className="tree-child-img";this.CheckBox=document.createElement("input");this.CheckBox.type="checkbox";this.CheckBox.className="tree-node-check";this.NodeContent=document.createElement("span");this.NodeImg=document.createElement("img");this.NodeImg.className="tree-node-img";this.NodeText=document.createElement("span");this.NodeText.setAttribute("id",this.Identifier+":txt");this.NodeText.className="tree-node-text";if((RD3_ServerParams.Theme=="seattle"||RD3_ServerParams.Theme=="zen")&&this.ParentNode){var j=0;var e=0;var g=0;var b=true;var a=this.ParentNode;while(a&&a.Nodes){j++;if(a.IsLastChild()){if(b){g++}else{e++}}else{b=false}a=a.ParentNode}if(j){this.Filler=document.createElement("img");if(RD3_Glb.IsFirefox()&&j-e-g==0&&(e||g)){this.Filler.style.width="1px";this.Filler.style.marginLeft=(e*19-1)+"px"}else{this.Filler.style.width=((j-e-g)*19)+"px";this.Filler.style.marginLeft=(e*19)+"px"}this.Filler.style.marginRight=(g*19)+"px";this.Filler.src=RD3_Glb.GetImgSrc("images/empty.gif");this.Filler.className="tree-node-filler";this.CaptionBox.appendChild(this.Filler)}}this.NodeContent.appendChild(this.NodeImg);this.NodeContent.appendChild(this.NodeText);this.CaptionBox.appendChild(this.ExpandImg);this.CaptionBox.appendChild(this.ChildImg);this.CaptionBox.appendChild(this.CheckBox);this.CaptionBox.appendChild(this.NodeContent);this.ChildrenBox=document.createElement("div");this.ChildrenBox.setAttribute("id",this.Identifier+":chi");this.ChildrenBox.className="tree-node-children";this.NodeBox.appendChild(this.CaptionBox);this.NodeBox.appendChild(this.ChildrenBox);var f=this;this.CaptionBox.onclick=function(i){f.OnClickNode(i)};this.ExpandImg.onclick=function(i){f.OnExpandNode(i)};this.CheckBox.onclick=function(i){f.OnCheckNode(i)};this.CheckBox.onkeypress=function(i){f.OnKeyPress(i)};h.appendChild(this.NodeBox);var c=this.Nodes.length;for(var d=0;d<c;d++){this.Nodes[d].Realize(this.ChildrenBox)}}this.Realized=true;this.HandleExpandable();this.SetCaption(this.Caption);this.SetTooltip(this.Tooltip);this.SetExpanded(this.Expanded);this.SetAlreadyExpanded(this.AlreadyExpanded);this.SetImage(this.Image);this.SetExpanded(this.Expanded);this.SetCanCheck(this.CanBeChecked);this.SetSelected(this.Selected);this.SetEnabled(this.ParentTree.Enabled);this.SetBadge(this.Badge);this.SetClassName()};TreeNode.prototype.OnClickNode=function(b){if(!this.ParentTree.Enabled){return}if(window.event&&b==undefined){b=window.event}var a=new IDEvent("clk",this.Identifier,b,this.ParentTree.ClickEventDef);if(a.ClientSide){this.ParentTree.SetSelectedNode(this.Identifier)}};TreeNode.prototype.OnRightClick=function(d){if(!this.ParentTree.Enabled){return false}if(RD3_Glb.IsTouch()){var a=RD3_Glb.GetScreenLeft(this.NodeText);var b=this.NodeText.offsetWidth;if(d.clientX<a||d.clientX>a+b){return false}}if(this.ParentTree.PopupMenu){this.ParentTree.TouchMoved=true;this.ParentTree.TouchStartX=-1;var c=new IDEvent("rclk",this.Identifier,d,this.ParentTree.ClickEventDef,"",this.ParentTree.PopupMenu.Identifier);this.OnMouseOutObj(d);return true}return false};TreeNode.prototype.OnMouseOverObj=function(b,a){if(this.CaptionBox&&!RD3_Glb.IsMobile()){RD3_Glb.SwitchClass(this.CaptionBox,"tree-node-caption","tree-node-caption-hl",true)}};TreeNode.prototype.OnMouseOutObj=function(b,a){if(this.CaptionBox&&!RD3_Glb.IsMobile()){RD3_Glb.SwitchClass(this.CaptionBox,"tree-node-caption-hl","tree-node-caption",true)}};TreeNode.prototype.OnExpandNode=function(b){if(!this.ParentTree.Enabled){return}if(window.event&&b==undefined){b=window.event}if(!this.AlreadyExpanded||this.Nodes.length==0){var a=new IDEvent("trnexp",this.Identifier,b,this.ParentTree.FirstExpandDef);this.WaitForChildren=true;if(this.ExpandImg){this.ExpandImg.src=RD3_Glb.GetImgSrc("images/trnload.gif");this.ExpandImg.className="tree-node-loading-img"}}else{var a=new IDEvent("trnexp",this.Identifier,b,this.ParentTree.ExpandEventDef);if(a.ClientSide){this.SetExpanded(!this.Expanded)}}RD3_DesktopManager.WebEntryPoint.OnClick(b);RD3_Glb.StopEvent(b);return false};TreeNode.prototype.OnCheckNode=function(d){if(!this.ParentTree.Enabled){return}if(window.event&&d==undefined){d=window.event}var c;var b=this.ParentTree.CheckEventDef;if(RD3_Glb.IsMobile()){c=this.Selected?"":"on";b=RD3_Glb.EVENT_ACTIVE}else{c=this.CheckBox.checked?"on":""}var a=new IDEvent("chg",this.Identifier,d,b,"check",c);if(d.stopPropagation){d.stopPropagation()}else{d.cancelBubble=true}return true};TreeNode.prototype.OnKeyPress=function(a){if(window.event&&a==undefined){a=window.event}if(a.keyCode==13){RD3_DesktopManager.SendEvents()}};TreeNode.prototype.RemoveChildren=function(){var b=this.Nodes.length;for(var a=0;a<b;a++){this.Nodes[a].Unrealize()}};TreeNode.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier);var b=this.Nodes.length;for(var a=0;a<b;a++){this.Nodes[a].Unrealize()}if(RD3_Glb.IsMobile()&&this.CaptionBox&&this.CaptionBox.parentNode){this.CaptionBox.parentNode.removeChild(this.CaptionBox)}if(this.NodeBox&&this.NodeBox.parentNode){this.NodeBox.parentNode.removeChild(this.NodeBox)}if(this.BackArrowImg&&this.BackArrowImg.parentNode){this.BackArrowImg.parentNode.removeChild(this.BackArrowImg)}if(this.BackImg&&this.BackImg.parentNode){this.BackImg.parentNode.removeChild(this.BackImg)}this.NodeBox=null;this.CaptionBox=null;this.ExpandImg=null;this.ChildImg=null;this.CheckBox=null;this.NodeImg=null;this.NodeText=null;this.ChildrenBox=null;this.BadgeObj=null;this.Realized=false};TreeNode.prototype.IsDraggable=function(b){var a=(b.substr(b.length-4)!=":txt"?true:false);if(RD3_Glb.IsMobile()&&b.substr(b.length-4)==":cap"){a=false}if(a){return false}return(this.ParentTree.DragDrop||this.ParentTree.CanDrag)&&this.ParentTree.Enabled};TreeNode.prototype.OnDrop=function(c,b){if(this.CanDrop||!this.ParentTree.Enabled||!this.ParentTree.DragDrop||!(c instanceof TreeNode)){return false}var a=new IDEvent("drp",this.Identifier,b,RD3_Glb.EVENT_ACTIVE,c.Identifier);return true};TreeNode.prototype.HandleExpandable=function(f){if(this.Realized&&RD3_Glb.IsMobile()){var i="";var a="";var h="";var b="";var m="";var c=48;var l=7;var k=true;if(this.CanBeChecked){if(this.ParentTree.MultipleSelection){c=40;i="url("+RD3_Glb.GetAbsolutePath()+"images/chk"+(this.Selected?1:0)+".png)";a=l+"px";h=c+"px";m="25px 25px";c+=38;l+=31;k=false;if(this.Selected||(this==this.ParentTree.ActiveNode&&!f)){RD3_Glb.AddClass(this.CaptionBox,"tree-node-selected")}else{RD3_Glb.RemoveClass(this.CaptionBox,"tree-node-selected")}}else{if(this.Selected){RD3_Glb.RemoveClass(this.CaptionBox,"tree-node-selected")}}}if(this.Image!=""){if(i!=""){i+=",";a+=",";m+=","}i+="url("+RD3_Glb.GetAbsolutePath()+"images/"+encodeURI(this.Image)+")";a+=l+"px";h=c+"px";m+="IMGSIZE"}if(this.Nodes.length>0||!this.AlreadyExpanded){if(i!=""){i+=",";a+=",";m+=","}i+="url("+RD3_Glb.GetAbsolutePath()+"images/detail"+(this.IsActiveNode()&&k?"w":"")+".png)";a+=(this.ParentTree.Width-20)+"px";m+="10px 16px";b="24px"}if(k&&this.IsActiveNode()){if(i!=""){i+=",";a+=",";m+=","}if(RD3_Glb.IsIE(10,true)){i+="linear-gradient(180deg, "+RD3_ClientParams.GetColorHL1()+", "+RD3_ClientParams.GetColorHL2()+")"}else{i+="-webkit-gradient(linear, 0% 0%, 0% 100%, from("+RD3_ClientParams.GetColorHL1()+"), to("+RD3_ClientParams.GetColorHL2()+"))"}a+="0px 0px";m+="100%"}if(this.CaptionBox.parentNode.style.display==""){var o=this.CaptionBox.style;o.backgroundImage=i;o.backgroundPosition=a;o.paddingLeft=h;o.paddingRight=b;if(RD3_Glb.IsMobile7()||RD3_Glb.IsQuadro()){o.backgroundRepeat="no-repeat";if(RD3_Glb.Adapt4Retina(this.Identifier,this.Image,43,m)){o.backgroundSize="0px 0px"}else{o.backgroundSize=m.replace("IMGSIZE","25px 25px")}}}}if(this.Realized&&!RD3_Glb.IsMobile()){var g=true;var d=this.Nodes.length;if(!this.AlreadyExpanded||(!this.Expanded&&d>0)){this.ExpandImg.style.display="";this.ChildImg.style.display="none";g=false}else{if(this.AlreadyExpanded&&this.Expanded&&d>0){this.ExpandImg.style.display="";this.ChildImg.style.display="none";g=true}else{this.ExpandImg.style.display="none";this.ChildImg.style.display="";g=false}}var j="";if(RD3_ServerParams.Theme=="seattle"||RD3_ServerParams.Theme=="zen"){if(!this.ParentNode){j="f"}if(this.IsLastChild()){j+="l"}if(j=="fl"){j="f"}}if(!this.WaitForChildren){var e=new GFX("tree",g,this.ChildrenBox,(d<=0)||(!this.ExecuteGFX),null,this.ParentTree.ExpandAnimDef);RD3_GFXManager.AddEffect(e)}if(g){this.ExpandImg.src=RD3_Glb.GetImgSrc("images/tm"+j+".gif")}else{this.ExpandImg.src=RD3_Glb.GetImgSrc("images/tp"+j+".gif")}if(!this.WaitForChildren){this.ExpandImg.className="tree-exp-img"}this.ChildImg.src=RD3_Glb.GetImgSrc("images/tn"+j+".gif")}};TreeNode.prototype.MultipleSelectionChanged=function(){this.SetCanCheck(this.CanBeChecked);var b=this.Nodes.length;for(var a=0;a<b;a++){this.Nodes[a].MultipleSelectionChanged()}if(!this.ParentTree.MultipleSelection){this.SetNodeClass(false,true)}};TreeNode.prototype.ResetCache=function(){if(RD3_Glb.IsMobile()){var a=this.ParentTree.SelectedNode;while(a&&a!=this){a=a.ParentNode}if(a==this){this.SetExpanded(false,true)}}this.RemoveChildren();this.Nodes.splice(0,this.Nodes.length)};TreeNode.prototype.GetDOMObj=function(){return this.NodeText?this.NodeText:this.CaptionBox};TreeNode.prototype.DropElement=function(){return this.NodeContent?this.NodeContent:this.CaptionBox};TreeNode.prototype.ComputeDropList=function(c,a){if(!this.Realized){return}if(this!=a){c.push(this);var d=(this.NodeContent?this.NodeContent:this.CaptionBox);this.AbsLeft=RD3_Glb.GetScreenLeft(d,true);this.AbsTop=RD3_Glb.GetScreenTop(d,true);if(!RD3_Glb.IsIE(10,false)){this.AbsLeft-=this.ParentTree.ContentBox.scrollLeft;this.AbsTop-=this.ParentTree.ContentBox.scrollTop}this.AbsRight=this.AbsLeft+d.offsetWidth-1;this.AbsBottom=this.AbsTop+d.offsetHeight-1}if(this.Expanded&&this.Nodes){var e=this.Nodes.length;for(var b=0;b<e;b++){this.Nodes[b].ComputeDropList(c,a)}}};TreeNode.prototype.GetParentFrame=function(){return this.ParentTree};TreeNode.prototype.SetEnabled=function(b){if(this.CheckBox){this.CheckBox.disabled=!b}if(this.CaptionBox){RD3_Glb.ApplyCursor(this.CaptionBox,b?"pointer":"default")}var c=this.Nodes.length;for(var a=0;a<c;a++){this.Nodes[a].SetEnabled(b)}};TreeNode.prototype.IsLastChild=function(){if(this.ParentNode){if(this.ParentNode.Nodes&&this==this.ParentNode.Nodes[this.ParentNode.Nodes.length-1]){return true}}else{if(this.ParentTree.RootNodes&&this==this.ParentTree.RootNodes[this.ParentTree.RootNodes.length-1]){return true}}return false};TreeNode.prototype.AccountOverFlowX=function(){return RD3_Glb.IsIE(10,false)?0:this.ParentTree.ContentBox.scrollLeft};TreeNode.prototype.AccountOverFlowY=function(){return RD3_Glb.IsIE(10,false)?0:this.ParentTree.ContentBox.scrollTop};TreeNode.prototype.GetTooltip=function(a,b){if(this.Tooltip==""||RD3_Glb.IsMobile()){return false}a.SetObj(this.NodeBox);a.SetTitle(this.Caption);a.SetText(this.Tooltip);a.SetAutoAnchor(true);a.SetPosition(2);return true};TreeNode.prototype.OnTouchDown=function(a){if(!this.ParentTree.Expanding){if(this.ParentTree.Enabled){this.ParentTree.ActiveNode=this}this.SetNodeClass(false,true);return true}};TreeNode.prototype.OnTouchUp=function(b,a){if(!this.ParentTree.Expanding){if(a&&this.ParentTree.Enabled){if(this.CanBeChecked&&this.ParentTree.MultipleSelection){this.OnCheckNode(b)}else{if(!this.AlreadyExpanded||this.Nodes.length>0){this.OnExpandNode(b)}else{this.OnClickNode(b)}}this.ParentTree.ActiveNode=null;this.SetNodeClass(false,true)}else{this.ParentTree.ActiveNode=null;this.SetNodeClass(false,true)}return true}};TreeNode.prototype.SetNodeClass=function(b,c){var a=null;if(c){a=new Array(this)}else{if(b){a=this.Nodes}else{if(this.ParentNode){a=this.ParentNode.Nodes}else{a=this.ParentTree.RootNodes}}}var f=a.length;for(var d=0;d<f;d++){var e=a[d].CaptionBox;if(e){if(this.CanBeChecked&&this.ParentTree.MultipleSelection){}else{if(a[d]==this.ParentTree.ActiveNode){RD3_Glb.AddClass(e,"tree-node-hover")}else{RD3_Glb.RemoveClass(e,"tree-node-hover")}}a[d].HandleExpandable()}}};TreeNode.prototype.IsActiveNode=function(){return this.ParentTree.ActiveNode==this};TreeNode.prototype.LoadNestedNode=function(flInner,immediate,recursive){var parentContext=this;if(flInner&&!this.NodeBox){this.NodeBox=document.createElement("div");this.NodeBox.setAttribute("id",this.Identifier+":box");this.NodeBox.className="tree-node-container";this.ParentTree.ContentBox.appendChild(this.NodeBox);if(this.Ea==null){this.Ea=function(ev){parentContext.OnEndAnimation(ev)}}var n=this.Nodes.length;for(var i=0;i<n;i++){this.Nodes[i].Realize(this.NodeBox)}var btncnt=this.ParentTree.WebForm.GetFirstToolbar();if(btncnt){var supp=btncnt.className.indexOf("popover")>-1;this.BackArrowImg=document.createElement("div");this.BackArrowImg.setAttribute("id",this.Identifier+":bka");this.BackArrowImg.className=supp?"popover-back-button-arrow":"menu-back-button-arrow";if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.BackArrowImg.ontouchend=function(ev){parentContext.OnBack(ev)}}else{this.BackArrowImg.onclick=function(ev){parentContext.OnBack(ev)}}btncnt.appendChild(this.BackArrowImg);this.BackImg=document.createElement("div");this.BackImg.setAttribute("id",this.Identifier+":bk");this.BackImg.className=supp?"popover-back-button":"menu-back-button";var obj=RD3_KBManager.GetObject(btncnt,true);if(obj&&obj.Caption){this.BackImg.innerHTML=this.ParentNode?this.ParentNode.Caption:obj.Caption}if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.BackImg.ontouchend=function(ev){parentContext.OnBack(ev)}}else{this.BackImg.onclick=function(ev){parentContext.OnBack(ev)}}btncnt.appendChild(this.BackImg)}}var boxp=(this.ParentNode)?this.ParentNode.NodeBox:this.ParentTree.NodeBox;var boxn=this.NodeBox;if(boxn&&boxp){if(this.ParentNode&&this.ParentNode.MobExpanding){this.ParentNode.EndMOBAnimation()}this.MobExpanding=true;if(this.Ea){RD3_Glb.AddEndTransaction(this.NodeBox,this.Ea,false)}boxn.style.display="";boxp.style.display="";RD3_Glb.SetTransitionProperty(boxn,"-webkit-transform");RD3_Glb.SetTransitionProperty(boxp,"-webkit-transform");RD3_Glb.SetTransitionDuration(boxn,"0ms");RD3_Glb.SetTransitionDuration(boxp,"0ms");RD3_Glb.SetTransitionTimingFunction(boxn,"ease");RD3_Glb.SetTransitionTimingFunction(boxp,"ease");this.ParentTree.Expanding=true;var w=this.ParentTree.ContentBox.offsetWidth;var p1ini=flInner?w:0;var p2ini=flInner?0:-w;var p1fin=flInner?0:w;var p2fin=flInner?-w:0;var y1=RD3_Glb.TranslateY(boxn);var y2=RD3_Glb.TranslateY(boxp);RD3_Glb.SetTransform(boxn,"translate3d("+p1ini+"px,"+y1+"px,0px)");RD3_Glb.SetTransform(boxp,"translate3d("+p2ini+"px,"+y2+"px,0px)");var duration=(immediate&&recursive?0:250);var sc="";sc+="RD3_Glb.SetTransitionDuration(document.getElementById('"+boxn.id+"'), '"+duration+"ms');";sc+="RD3_Glb.SetTransitionDuration(document.getElementById('"+boxp.id+"'), '"+duration+"ms');";sc+="RD3_Glb.SetTransform(document.getElementById('"+boxn.id+"'), 'translate3d("+p1fin+"px,"+y1+"px,0px)');";sc+="RD3_Glb.SetTransform(document.getElementById('"+boxp.id+"'), 'translate3d("+p2fin+"px,"+y2+"px,0px)');";if(this.BackImg){var sepp=(this.ParentNode)?this.ParentNode.BackImg:null;var sepi=(this.ParentNode)?this.ParentNode.BackArrowImg:null;if(sepp){RD3_Glb.SetTransform(sepp,"translate3d("+p2fin+"px,0px,0px)")}if(sepi){RD3_Glb.SetTransform(sepi,"translate3d("+p2fin+"px,0px,0px) rotate(45deg)")}var p3=this.BackImg.parentNode.offsetWidth/2-this.BackImg.offsetWidth/2;var p4=0;var p5=1;if(flInner){RD3_Glb.SetTransform(this.BackImg,"translate3d("+p3+"px,0px,0px)");RD3_Glb.SetTransitionProperty(this.BackImg,"-webkit-transform, opacity");RD3_Glb.SetTransform(this.BackArrowImg,"translate3d("+p3+"px,0px,0px) rotate(45deg)");RD3_Glb.SetTransitionProperty(this.BackArrowImg,"-webkit-transform ,opacity")}else{p4=p3;p5=0}this.BackImg.style.display="";this.BackArrowImg.style.display="";sc+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.BackArrowImg.id+"'), '"+duration+"ms');";sc+="RD3_Glb.SetTransform(document.getElementById('"+this.BackArrowImg.id+"'), 'translate3d("+p4+"px,0px,0px) rotate(45deg)');";sc+="document.getElementById('"+this.BackArrowImg.id+"').style.opacity="+p5+";";sc+="RD3_Glb.SetTransitionDuration(document.getElementById('"+this.BackImg.id+"'), '"+duration+"ms');";sc+="RD3_Glb.SetTransform(document.getElementById('"+this.BackImg.id+"'), 'translate3d("+p4+"px,0px,0px)');";sc+="document.getElementById('"+this.BackImg.id+"').style.opacity="+p5+";"}if(this.ParentTree.IDScroll&&duration!=0){this.ParentTree.IDScroll.SetDisableTimer(300)}if(immediate){eval(sc);this.OnEndAnimation()}else{this.MOBFunct=sc;this.MOBAnimTimer=window.setTimeout(sc,30)}var pn=this.ParentNode;var ok=true;while(ok&&pn){if(!pn.Expanded){ok=false}pn=pn.ParentNode}if(ok){this.ParentTree.IDScroll.SetBox(flInner?boxn:boxp)}if(recursive){var n=this.Nodes.length;for(var i=0;i<n;i++){if(this.Nodes[i].ExpandSkipped&&this.Nodes[i].Expanded){this.Nodes[i].SetExpanded(this.Nodes[i].Expanded,immediate,true)}}}}};TreeNode.prototype.OnBack=function(a){this.OnExpandNode(a)};TreeNode.prototype.OnEndAnimation=function(b){if(RD3_Glb.GetTransitionDuration(this.NodeBox)=="0ms"&&b){return}if(this.Expanded){if(this.ParentNode){this.ParentNode.NodeBox.style.display="none"}else{this.ParentTree.NodeBox.style.display="none"}}else{this.ParentTree.ActiveNode=null;this.SetNodeClass(false,true);this.NodeBox.style.display="none";if(this.BackImg){this.BackImg.style.display="none"}if(this.BackArrowImg){this.BackArrowImg.style.display="none"}}if(this.Realized&&this.BackImg){var d=(this.Expanded)?this.Caption:this.BackImg.textContent;var a=RD3_KBManager.GetObject(this.BackImg.parentNode,true);if(a&&a.SetWebCaption){a.SetWebCaption(d);a.AdaptToolbarLayout()}else{if(a&&a.SetCaption){a.SetCaption(d)}}}this.ParentTree.Expanding=false;this.MobExpanding=false;this.MOBAnimTimer=null;this.MOBFunct=null;if(this.Ea){RD3_Glb.RemoveEndTransaction(this.NodeBox,this.Ea,false)}};TreeNode.prototype.EndMOBAnimation=function(evento){if(!this.MobExpanding){return}if(this.MOBAnimTimer){window.clearTimeout(this.MOBAnimTimer);this.MOBAnimTimer=null;if(this.MOBFunct){eval(this.MOBFunct)}this.MOBFunct=null}var boxp=(this.ParentNode)?this.ParentNode.NodeBox:this.ParentTree.NodeBox;var boxn=this.NodeBox;if(boxn&&boxp){RD3_Glb.SetTransitionDuration(boxn,"0ms");RD3_Glb.SetTransitionDuration(boxp,"0ms");if(this.BackImg){RD3_Glb.SetTransitionDuration(this.BackArrowImg,"0ms");RD3_Glb.SetTransitionDuration(this.BackImg,"0ms")}this.OnEndAnimation()}};TreeNode.prototype.ChangeExpose=function(b){if(this.Expanded){if(this.BackImg){this.BackImg.style.display=b?"":"none"}if(this.BackArrowImg){this.BackArrowImg.style.display=b?"":"none"}var c=this.Nodes.length;for(var a=0;a<c;a++){this.Nodes[a].ChangeExpose(b)}}};TreeNode.prototype.AccentColorChanged=function(d,e){if(this.Nodes){var f=this.Nodes.length;for(var a=0;a<f;a++){this.Nodes[a].AccentColorChanged(d,e)}}if(this.CaptionBox){var c=this.CaptionBox.style.cssText;var b=c.replace(d,e);if(c!=b){this.CaptionBox.style.cssText=b}}};TreeNode.prototype.CollapseBranch=function(){if(this.Expanded){var b=this.Nodes.length;for(var a=0;a<b;a++){this.Nodes[a].CollapseBranch()}this.SetExpanded(false,true,false,true)}};TreeNode.prototype.OnAdaptRetina=function(a,c,b){if(this.CaptionBox){this.CaptionBox.style.backgroundSize=b.replace("IMGSIZE",a+"px "+c+"px")}};function ValueList(){this.ItemList=new Array();this.Identifier=Math.random()+":lv";this.Headers=new Array();this.DecodeColumn=0}ValueList.prototype.LoadFromXml=function(d){var l=d.attributes;var c=l.length;for(var f=0;f<c;f++){var g=l.item(f);var a=g.nodeName;var h=g.nodeValue;switch(a){case"hdr":this.Headers=h.split("|");break;case"dcc":this.DecodeColumn=parseInt(h);break}}var k=d.childNodes;var c=k.length;for(var f=0;f<c;f++){var e=k.item(f);var a=e.nodeName;switch(a){case"vli":var b=new ValueListItem();b.LoadFromXml(e);this.ItemList.push(b);if(this.DecodeColumn>0){var j=b.OrgNames.split("|");if(this.DecodeColumn<=j.length){b.Name=b.OrgNames.split("|")[this.DecodeColumn-1]}}break}}};ValueList.prototype.FindItemsByValue=function(e,d,k){var h=new Array();var f=e.split(k);for(var b=0;b<f.length;b++){var g=f[b];var a=this.ItemList.length;for(var c=0;c<a;c++){if((!d&&this.ItemList[c].Value==g)||(d&&this.ItemList[c].Name==g)){h.push(this.ItemList[c]);break}}}return h};ValueList.prototype.FindItemsByArray=function(b,h){var g=new Array();var e=b.length;var a=this.ItemList.length;for(var c=0;c<e;c++){var f=b[c];for(var d=0;d<a;d++){if((!h&&this.ItemList[d].Value==f.Value)||(h&&this.ItemList[d].Name==f.Name)){g.push(this.ItemList[d]);break}}}return g};ValueList.prototype.FindItemsLKE=function(){var c=new Array();var d=this.ItemList.length;for(var a=0;a<d;a++){var b=this.ItemList[a];if(b.Value=="LKEPREC"||b.Value=="LKENULL"||b.Value=="LKEMORE"){continue}if(parseInt(b.Value.substring(3))>1000){c.push(b)}}return c};ValueList.prototype.SetCheck=function(d,b,c){var a=(b==this.ItemList[0].Value);if(RD3_Glb.IsMobile()){if(RD3_Glb.IsQuadro()){var e=d.firstChild;RD3_Glb.SetTransform(e,"translate3d("+(a?0:-53)+"px, 0px, 0px)")}else{if(RD3_Glb.IsMobile7()){var e=d.firstChild;RD3_Glb.SetTransform(e,"translate3d("+(a?22:0)+"px, 0px, 0px)");d.style.backgroundColor=a?"":"transparent";d.style.borderColor=a?"#4cd864":""}else{d.style.backgroundPosition=(a?"0%":"100%")+" -27px"}}}if(c&&b==="---"){d.indeterminate=true;d.setAttribute("checkstatus","1")}else{d.checked=a;d.indeterminate=false;d.setAttribute("checkstatus",a?"0":"2")}};ValueList.prototype.RealizeOption=function(e,b,g,a,f,c){var h=this.ItemList.length;for(var d=0;d<h;d++){this.ItemList[d].RealizeOption(e,b,g,a,f,c,this)}};ValueList.prototype.SetOption=function(f,e){var d=RD3_Glb.IsMobile();var h=f.getElementsByTagName("input");if(h.length>0){var g=this.ItemList.length;for(var a=0;a<g;a++){var b=this.ItemList[a];h[a].checked=(b.Value==e);if(d){RD3_Glb.SetClass(h[a].nextSibling,"radio-checked",b.Value==e)}}}};ValueList.prototype.SetOptionClass=function(d,e){var g=d.getElementsByTagName("span");if(g.length>0){var f=this.ItemList.length;for(var a=0;a<f;a++){var b=this.ItemList[a];RD3_Glb.SetClass(g[a],"radio-checked",g[a]==e)}}};ValueList.prototype.GetOption=function(d){if(d.tagName=="INPUT"){d=d.parentNode}var f=d.getElementsByTagName("input");if(f.length>0){var e=this.ItemList.length;for(var a=0;a<e;a++){var b=this.ItemList[a];if(f[a].checked){return b.Value}}}return""};ValueList.prototype.EnableOption=function(f,a,e){var j=f.getElementsByTagName("input");if(j.length>0){var h=this.ItemList.length;for(var b=0;b<h;b++){var d=this.ItemList[b];var g=j[b];g.disabled=!a;g.style.visibility=(e?"":"hidden");if(g.nextSibling){g.nextSibling.style.visibility=(e?"":"hidden")}}}};ValueList.prototype.RealizeCombo=function(c,q,s,u,b,l,a){var w=null;if(c.previousSibling){w=c.previousSibling;w.style.display=(this.Headers.length>0?"":"none");if(w.rows.length>0){w.deleteRow(0)}}else{if(this.Headers.length>0){w=document.createElement("THEAD");c.parentNode.insertBefore(w,c)}}var z=false;var r=this.Headers.length;if(r>0){var p=this.ItemList.length;for(var v=0;v<p;v++){if(this.ItemList[v].Image!=""){z=true;break}}var e=document.createElement("TR");e.className="combo-header";w.appendChild(e);var h=document.createElement("TH");h.style.padding="0px";w.firstChild.appendChild(h);var g=document.createElement("TH");if(z){g.className="combo-td-multi"}g.style.padding="0px";w.firstChild.appendChild(g);for(var v=0;v<r;v++){var x=document.createElement("TH");x.className="combo-header-column combo-td-multi";x.innerHTML=this.Headers[v];w.firstChild.appendChild(x)}}while(c.rows.length>0){c.deleteRow(0)}var d="";r=this.ItemList.length;for(var v=0;v<r;v++){var m=this.ItemList[v];if(!m.Visible){continue}if(m.Group!=d&&m.Group!=""){var y=document.createElement("TR");var h=document.createElement("TD");var g=document.createElement("TD");var x=document.createElement("TD");if(this.Headers.length>1){x.colSpan=this.Headers.length}x.innerHTML=m.Group;y.className="combo-group-header";h.style.padding="0px";g.style.padding="0px";y.appendChild(h);y.appendChild(g);y.appendChild(x);c.appendChild(y);d=m.Group}var k=u.length;var o=false;for(var t=0;t<k&&!o;t++){o=(u[t].Value==m.Value)}if(!l){l=m}var f=(l.Value==m.Value);m.RealizeCombo(c,q,v,s,o,b,f,a,z)}};ValueList.prototype.SetComboItemsVisible=function(){var c=this.ItemList.length;for(var a=0;a<c;a++){var b=this.ItemList[a];b.Visible=true;b.HtmlNames=RD3_Glb.HTMLEncode(b.OrgNames)}};ValueList.prototype.AddComboItemClass=function(d,a,b){try{if(this.ItemList[parseInt(a,10)].Enabled){var e=this.GetTR(d,parseInt(a));if(e){RD3_Glb.AddClass(e,"combo-option-hiligth")}}}catch(c){}};ValueList.prototype.RemoveComboItemClass=function(d,a,b){try{if(this.ItemList[parseInt(a,10)].Enabled){var e=this.GetTR(d,parseInt(a));if(e){RD3_Glb.RemoveClass(e,"combo-option-hiligth")}}}catch(c){}};ValueList.prototype.FilterComboItem=function(a,e,b){if(b){var h=this.ItemList.length;for(var c=0;c<h;c++){var d=this.ItemList[c];d.Matches(a,2,e)}return h}var g=0;var f=0;while(f<3){var h=this.ItemList.length;for(var c=0;c<h;c++){var d=this.ItemList[c];d.Visible=d.Matches(a,f,e);if(d.Visible){g++}}if(g>0){break}f++}return g};ValueList.prototype.GetNextVisibleItem=function(d,e,g){var h=this.ItemList.length;var f=-1;if(d){for(var c=0;c<h;c++){if(this.ItemList[c]==d){f=c;break}}}if(f==-1&&e){f=h-1}f+=(e?-1:1)*(g?10:1);var b=-1;for(var a=0;a<2;a++){if(e&&f<h){for(var c=f;c>=0;c--){if(this.ItemList[c].Visible&&this.ItemList[c].Enabled){b=c;break}}}else{if(!e&&f>=0){for(var c=f;c<h;c++){if(this.ItemList[c].Visible&&this.ItemList[c].Enabled){b=c;break}}}}if(b!=-1){break}f=(e?h-1:0)}if(b==-1&&d&&d.Visible&&d.Enabled){return d}if(b>=0&&b<h){return this.ItemList[b]}return null};ValueList.prototype.GetItemIndex=function(d){var e=this.ItemList.length;var a=0;for(var b=0;b<e;b++){var c=this.ItemList[b];if(c==d){return a}if(c.Visible){a++}}return -1};ValueList.prototype.EnsureItemVisible=function(d,a){if(a<0||a>=this.ItemList.length){return}var c=this.GetTR(d,a);if(!c){return}var b=c.offsetTop;if(RD3_Glb.IsMobile()){}else{if(b<d.scrollTop){d.scrollTop=b-(d.clientHeight/2)}else{if(b+c.offsetHeight>d.scrollTop+d.clientHeight){d.scrollTop=b+(d.clientHeight/2)-d.clientHeight}}}};ValueList.prototype.GetTooltipCombo=function(e,d,f){while(f&&f.tagName!="TR"){f=f.parentNode}var h=e.getElementsByTagName("TR");if(f&&h.length>0){var g=this.ItemList.length;for(var a=0;a<g;a++){var b=this.ItemList[a];if(h[a]==f){if(b.Tooltip!=""){d.SetObj(f);d.SetText(b.Tooltip);d.SetAnchor(RD3_Glb.GetScreenLeft(f)+f.offsetWidth,RD3_Glb.GetScreenTop(f)+(f.offsetHeight/2));d.SetPosition(1);return true}else{return false}}}}return false};ValueList.prototype.GetTooltipOption=function(f,e,g){var j=f.getElementsByTagName("input");var d=f.getElementsByTagName("span");if(j.length>0){var h=this.ItemList.length;for(var a=0;a<h;a++){var b=this.ItemList[a];if(j[a]==g||d[a]==g){if(b.Tooltip.length>0){e.SetTitle(b.Name);e.SetText(b.Tooltip);e.SetAnchor(RD3_Glb.GetScreenLeft(g)+g.offsetWidth,RD3_Glb.GetScreenTop(g)+(g.offsetHeight/2));e.SetPosition(1);return true}}}}return false};ValueList.prototype.GetTR=function(b,a){var j=b.getElementsByTagName("TR");var h=j.length;var e=0;for(var d=0;d<h;d++){var f=j[d];if(f){var g=f.className;if(g.indexOf("combo-group-header")==-1&&g.indexOf("combo-header")==-1){if(e==a){return f}else{e++}}}}};ValueList.prototype.Equals=function(e){if(this==e){return true}if(this.ItemList.length!=e.ItemList.length){return false}var d=this.ItemList.length;for(var c=0;c<d;c++){var b=this.ItemList[c];var a=e.ItemList[c];if((b.Name!=a.Name)||(b.Value!=a.Value)){return false}}return true};function ValueListItem(){this.Name="";this.HtmlNames="";this.OrgNames="";this.Value="";this.Tooltip="";this.Image="";this.Visible=true;this.Enabled=true;this.Group="";this.VisualStyle=null}ValueListItem.prototype.LoadFromXml=function(a){this.LoadProperties(a)};ValueListItem.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"txt":this.Name=a;this.OrgNames=this.Name;break;case"val":this.Value=a;break;case"img":this.Image=a;break;case"tip":this.Tooltip=a;break;case"ena":this.Enabled=(a=="-1")?true:false;break;case"gru":this.Group=a;break;case"sty":this.VisualStyle=RD3_DesktopManager.ObjectMap["vis:"+parseInt(a)];break}}};ValueListItem.prototype.RealizeOption=function(t,d,p,b,q,a,r){var w=t.Identifier+((q)?":l":"");var n=RD3_Glb.IsIE(10,false);var e=r.ItemList[0]==this;var k=r.ItemList[r.ItemList.length-1]==this;var l;if(n){var m="<input type=radio name='"+w+"' "+((this.Value==p)?"CHECKED":"")+">";l=document.createElement(m)}else{l=document.createElement("input");l.type="radio";l.name=w;l.checked=(this.Value==p)}l.disabled=!a;l.className="book-span-radio"+(RD3_Glb.IsIE(10,true)?" radio-ie":"");var h=document.createElement("span");var g="book-span-radio-text";var c="";if(RD3_Glb.IsMobile()){if(b){g+="-vertical";if(e){h.style.marginTop="-12px"}}else{h.style.width=Math.floor(100/r.ItemList.length)+"%";var v=(RD3_Glb.IsQuadro()?2:8)+"px";if(e){RD3_Glb.SetBorderRadius(h,v+" 0px 0px "+v);h.style.marginLeft="0px"}if(k){RD3_Glb.SetBorderRadius(h,"0px "+v+" "+v+" 0px")}}}h.className=g;h.innerHTML=RD3_Glb.HTMLEncode(this.Name);if(RD3_Glb.IsMobile()&&this.Value==p){RD3_Glb.AddClass(h,"radio-checked")}RD3_TooltipManager.SetObjTitle(l,this.Tooltip);RD3_TooltipManager.SetObjTitle(h,this.Tooltip);d.appendChild(l);d.appendChild(h);if(b&&!RD3_Glb.IsMobile()){d.appendChild(document.createElement("br"))}var o=new Function("ev","return RD3_KBManager.IDRO_OnChange(ev)");l.onclick=o;if(t.OnRadioLabelClick){var j=new Function("ev","RD3_DesktopManager.CallEventHandler('"+t.Identifier+"','OnRadioLabelClick',ev);");h.onclick=j}if(!n){var f=new Function("ev","return RD3_KBManager.IDRO_GetFocus(ev)");var i=new Function("ev","return RD3_KBManager.IDRO_LostFocus(ev)");l.onfocus=f;l.onblur=i;if(RD3_Glb.IsFirefox(3)){var u=new Function("ev","return RD3_KBManager.IDRO_DoubleClick(ev)");l.ondblclick=u}}};ValueListItem.prototype.RealizeCombo=function(c,p,n,t,r,b,d,a,z){var l=document.createElement("TR");l.className="combo-option";if(!RD3_Glb.IsMobile()){l.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+p+"', 'OnOptionMouseOver', ev,"+n+")");l.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+p+"', 'OnOptionMouseOut', ev,"+n+")");l.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+p+"', 'OnOptionClick', ev,"+n+")")}l.id=p+":"+n;c.appendChild(l);this.TR=l;var k=this.HtmlNames.split("|");var g=k.length;var w=c.previousSibling;var o=(w&&w.style.display=="");if(this.VisualStyle){t=this.VisualStyle}if(w&&w.style.display!="none"){g=w.firstChild.childNodes.length-2}var f=document.createElement("TD");l.appendChild(f);if(b&&this.Value!=""&&this.Enabled&&(!a||(this.Value!="LKEPREC"&&this.Value!="LKENULL"&&this.Value!="LKEMORE"&&this.Value!="LKEPLUS"))){var q=document.createElement("input");q.type="checkbox";q.className="combo-option-check";f.appendChild(q);q.checked=r;f.style.paddingLeft="2px";f.style.paddingRight="4px";f.style.width="12px";f.style.cursor="default"}else{f.style.padding="0px"}var e=document.createElement("TD");l.appendChild(e);var y=null;if(this.Image!=""){y=document.createElement("IMG");y.className="combo-option-img"+(o&&z?" combo-td-multi":"");y.src=RD3_Glb.GetImgSrc("images/"+this.Image);e.appendChild(y);if(RD3_Glb.IsIE(10,false)){y.onreadystatechange=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+p+"', 'OnComboImageLoaded', ev)")}else{y.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+p+"', 'OnComboImageLoaded', ev)")}e.style.width=RD3_ClientParams.ComboImageSize+"px";if(RD3_Glb.IsMobile()){e.style.paddingLeft="4px"}}else{e.style.padding="0px"}for(var v=0;v<g;v++){var x=document.createElement("TD");if(o){x.className="combo-td-multi"}l.appendChild(x);var u=document.createElement("SPAN");u.className="combo-option-name";u.innerHTML=k[v];x.appendChild(u);var m=u.style;var h=t.GetFont(1);var j=h.split(",");m.fontFamily=j[0];m.fontWeight=(j[1].indexOf("B")>-1)?"bold":"normal";m.fontStyle=(j[1].indexOf("I")>-1)?"italic":"normal";m.textDecoration=(j[1].indexOf("U")>-1)?"underline":"none";m.textDecoration=(j[1].indexOf("S")>-1)?"line-through":"none";m.fontSize=j[2]+"pt";if(this.Enabled){m.color=t.GetColor(1)}if(!r&&this.Enabled){u.style.cursor="pointer"}if(v==0&&this.Image!=""&&RD3_Glb.IsMobile()){m.paddingLeft=RD3_ClientParams.ComboImageSize+10+"px"}if(v==0&&g>k.length){x.colSpan=g;break}}if(r){if(!b||this.Value!=""){l.style.backgroundColor=t.GetColor(9);RD3_Glb.AddClass(l,"combo-option-selected")}}else{l.style.backgroundColor=t.GetColor(5);RD3_Glb.RemoveClass(l,"combo-option-selected");if(this.Enabled){l.style.cursor="pointer";if(y){y.style.cursor="pointer"}}else{RD3_Glb.AddClass(l,"combo-option-disabled")}}if(d&&b){RD3_Glb.AddClass(l,"combo-option-hiligth")}};ValueListItem.prototype.Matches=function(a,d,c){this.HtmlNames=RD3_Glb.HTMLEncode(this.OrgNames);if(a==""){return true}var b=false;switch(d){case 0:b=(this.OrgNames.toLowerCase().indexOf(a.toLowerCase())==0);if(b&&c){this.HtmlNames="<span class=combo-option-name-hl>"+RD3_Glb.HTMLEncode(this.OrgNames.substring(0,a.length))+"</span>"+RD3_Glb.HTMLEncode(this.OrgNames.substring(a.length))}break;case 1:var e=this.OrgNames.toLowerCase().indexOf(" "+a.toLowerCase());b=(e!=-1);if(b&&c){e++;this.HtmlNames=RD3_Glb.HTMLEncode(this.OrgNames.substring(0,e))+"<span class=combo-option-name-hl>"+RD3_Glb.HTMLEncode(this.OrgNames.substring(e,e+a.length))+"</span>"+RD3_Glb.HTMLEncode(this.OrgNames.substring(e+a.length))}break;case 2:var e=this.OrgNames.toLowerCase().indexOf(a.toLowerCase());b=(e!=-1);if(b&&c){this.HtmlNames=RD3_Glb.HTMLEncode(this.OrgNames.substring(0,e))+"<span class=combo-option-name-hl>"+RD3_Glb.HTMLEncode(this.OrgNames.substring(e,e+a.length))+"</span>"+RD3_Glb.HTMLEncode(this.OrgNames.substring(e+a.length))}break}return b};function VisAttrList(){this.VSList=new Array();this.Identifier="vsl";this.Realized=false}VisAttrList.prototype.LoadFromXml=function(e){this.LoadProperties(e);var c=e.childNodes;var g=c.length;for(var d=0;d<g;d++){var b=c.item(d);var a=b.nodeName;switch(a){case"vis":var f=new VisAttrObj();f.LoadFromXml(b);this.VSList.push(f);if(this.Realized){f.Realize()}break}}};VisAttrList.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};VisAttrList.prototype.ChangeProperties=function(a){this.LoadFromXml(a)};VisAttrList.prototype.Realize=function(){var b=this.VSList.length;for(var a=0;a<b;a++){this.VSList[a].Realize()}this.Realized=true};VisAttrList.prototype.Unrealize=function(){var b=this.VSList.length;for(var a=0;a<b;a++){this.VSList[a].Unrealize()}RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.Realized=false};VisAttrList.prototype.Tick=function(){var b=new Date();var c=this.VSList.length;for(var a=0;a<c;a++){if(this.VSList[a].Tick()){if(new Date()-b>20){return}}}};function VisAttrObj(){this.Alignments=new Array();this.BorderTypes=new Array();this.Color=new Array();this.Font=new Array();this.CustomColors=new Array();this.CustomWidth=new Array();this.CustomType=new Array();this.CustomPadding=new Array();this.GradColor=new Array();this.GradDir=new Array();this.Opacity=new Array();this.ContrType=-1;this.Cursor=-1;this.Mask=-1;this.RowOffset=-1;this.HeaderOffset=-1;this.Flags=-1;this.LetterSpacing=-1;this.WordSpacing=-1;this.HorizontalScale=-1;this.Derived=null;this.Identifier="";this.iShowHTML=null;this.iClassName=null;this.iClassHeader=null;this.iProto=null;this.iBoxProto=null;this.iBoxProtoCollection=new Array();this.iBoxProtoQty=0;this.iBoxProtoPtr=0}VisAttrObj.prototype.LoadFromXml=function(a){this.LoadProperties(a)};VisAttrObj.prototype.ChangeProperties=function(a){this.LoadProperties(a);this.iProto=null};VisAttrObj.prototype.LoadProperties=function(f){var b=f.attributes;var h=b.length;for(var e=0;e<h;e++){var g=b.item(e);var c=g.nodeName;var a=g.nodeValue;var d=0;if(c.length>3){d=parseInt(c.substring(3,c.length));c=c.substring(0,3)}switch(c){case"con":this.SetContrType(parseInt(a));break;case"msk":this.SetMask(a);break;case"cur":this.SetCursor(a);break;case"off":this.SetRowOffset(parseInt(a));break;case"hof":this.SetHeaderOffset(parseInt(a));break;case"fla":this.SetFlag(parseInt(a));break;case"les":this.SetLetterSpacing(parseInt(a));break;case"wos":this.SetWordSpacing(parseInt(a));break;case"hor":this.SetHorizontalScale(parseInt(a));break;case"der":this.SetDerived(parseInt(a));break;case"cln":this.SetClassName(a);break;case"clh":this.SetClassHeader(a);break;case"ali":this.SetAlignment(parseInt(a),d);break;case"bor":this.SetBorderType(parseInt(a),d);break;case"col":this.SetColor(a,d);break;case"fon":this.SetFont(a,d);break;case"ccl":this.SetCustomColor(a,d);break;case"cwd":this.SetCustomWidth(parseInt(a),d);break;case"cty":this.SetCustomType(parseInt(a),d);break;case"cpd":this.SetCustomPadding(parseInt(a),d);break;case"gco":this.SetGradientColor(a,d);break;case"gdi":this.SetGradientDirection(parseInt(a),d);break;case"opa":this.SetOpacity(parseInt(a),d);break;case"id":this.SetIdentifier(a);break}}};VisAttrObj.prototype.SetContrType=function(a){this.ContrType=a};VisAttrObj.prototype.SetMask=function(a){this.Mask=a;this.iShowHTML=null};VisAttrObj.prototype.SetCursor=function(a){this.Cursor=a};VisAttrObj.prototype.SetRowOffset=function(a){this.RowOffset=a};VisAttrObj.prototype.SetHeaderOffset=function(a){this.HeaderOffset=a};VisAttrObj.prototype.SetFlag=function(a){this.Flags=a};VisAttrObj.prototype.SetLetterSpacing=function(a){this.LetterSpacing=a};VisAttrObj.prototype.SetWordSpacing=function(a){this.WordSpacing=a};VisAttrObj.prototype.SetHorizontalScale=function(a){this.HorizontalScale=a};VisAttrObj.prototype.SetDerived=function(a){this.Derived=a};VisAttrObj.prototype.SetAlignment=function(b,a){this.Alignments[a]=b};VisAttrObj.prototype.SetBorderType=function(b,a){this.BorderTypes[a]=b};VisAttrObj.prototype.SetColor=function(b,a){this.Color[a]=b};VisAttrObj.prototype.SetFont=function(b,a){this.Font[a]=b};VisAttrObj.prototype.SetCustomColor=function(b,a){this.CustomColors[a]=b};VisAttrObj.prototype.SetCustomWidth=function(b,a){this.CustomWidth[a]=b};VisAttrObj.prototype.SetCustomType=function(b,a){this.CustomType[a]=b};VisAttrObj.prototype.SetCustomPadding=function(b,a){this.CustomPadding[a]=b};VisAttrObj.prototype.SetGradientColor=function(b,a){this.GradColor[a]=b};VisAttrObj.prototype.SetGradientDirection=function(b,a){this.GradDir[a]=b};VisAttrObj.prototype.SetOpacity=function(b,a){this.Opacity[a]=b};VisAttrObj.prototype.SetIdentifier=function(a){this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this)};VisAttrObj.prototype.SetClassName=function(a){this.iClassName=a};VisAttrObj.prototype.SetClassHeader=function(a){this.iClassHeader=a};VisAttrObj.prototype.Realize=function(){if(this.Derived!=null&&!this.Derived.Identifier){if(this.Derived>=0){this.Derived=RD3_DesktopManager.ObjectMap["vis:"+this.Derived]}}};VisAttrObj.prototype.Unrealize=function(){RD3_DesktopManager.ObjectMap.remove(this.Identifier)};VisAttrObj.prototype.GetAlignment=function(b){var a=this.Alignments[b];if(a==null){a=-1}if(a==-1&&this.Derived){a=this.Derived.GetAlignment(b);this.Alignments[b]=a}return a};VisAttrObj.prototype.GetBorders=function(b){var a=this.BorderTypes[b];if(a==null){a=-1}if(a==-1&&this.Derived){a=this.Derived.GetBorders(b);this.BorderTypes[b]=a}return a};VisAttrObj.prototype.GetColor=function(b){var a=this.Color[b];if(a==null){a=-2}if(a==-2&&this.Derived){a=this.Derived.GetColor(b);this.Color[b]=a}return a};VisAttrObj.prototype.GetFont=function(b){var a=this.Font[b];if(a==null){a=-1}if(a==-1&&this.Derived){a=this.Derived.GetFont(b);this.Font[b]=a}return a};VisAttrObj.prototype.GetCustomColor=function(b){var a=this.CustomColors[b];if(a==null){a=this.Derived?-2:"#D0D0D0"}if(a==-2){a=this.Derived.GetCustomColor(b);this.CustomColors[b]=a}return a};VisAttrObj.prototype.GetCustomWidth=function(a){var b=this.CustomWidth[a];if(b==null){b=this.Derived?-1:1}if(b==-1){b=this.Derived.GetCustomWidth(a);this.CustomWidth[a]=b}return b};VisAttrObj.prototype.GetCustomType=function(a){var b=this.CustomType[a];if(b==null){b=this.Derived?-1:1}if(b==-1){b=this.Derived.GetCustomType(a);this.CustomType[a]=b}return b};VisAttrObj.prototype.GetCustomStyle=function(a){var b=this.GetCustomType(a);switch(b){case 1:return"solid";case 2:return"dotted";case 3:return"dashed";case 4:return"double"}return"none"};VisAttrObj.prototype.GetCustomPadding=function(a){var b=this.CustomPadding[a];if(b==null){b=this.Derived?-1:1}if(b==-1){b=this.Derived.GetCustomPadding(a);this.CustomPadding[a]=b}return b};VisAttrObj.prototype.GetGradColor=function(a){var b=this.GradColor[a];if(b==null){b=-1}if(b==-1&&this.Derived){b=this.Derived.GetGradColor(a);this.GradColor[a]=b}return b};VisAttrObj.prototype.GetGradDir=function(b){var a=this.GradDir[b];if(a==null){a=this.Derived?-1:1}if(a==-1){a=this.Derived.GetGradDir(b);this.GradDir[b]=a}return a};VisAttrObj.prototype.GetOpacity=function(a){var b=this.Opacity[a];if(b==null){b=this.Derived?-1:100}if(b==-1){b=this.Derived.GetOpacity(a);this.Opacity[a]=b}return b};VisAttrObj.prototype.GetContrType=function(){if(this.ContrType==-1&&this.Derived){this.ContrType=this.Derived.GetContrType()}return this.ContrType};VisAttrObj.prototype.GetMask=function(){if(this.Mask==-1&&this.Derived){this.Mask=this.Derived.GetMask()}return this.Mask};VisAttrObj.prototype.GetCursor=function(){if(this.Cursor==-1&&this.Derived){this.Cursor=this.Derived.GetCursor()}return this.Cursor};VisAttrObj.prototype.GetRowOffset=function(){if(this.RowOffset==-1&&this.Derived){this.RowOffset=this.Derived.GetRowOffset()}return this.RowOffset};VisAttrObj.prototype.GetHeaderOffset=function(){if(this.HeaderOffset==-1&&this.Derived){this.HeaderOffset=this.Derived.GetHeaderOffset()}return this.HeaderOffset};VisAttrObj.prototype.GetFlags=function(){if(this.Flags==-1&&this.Derived){this.Flags=this.Derived.GetFlags()}return this.Flags};VisAttrObj.prototype.GetLetterSpacing=function(){if(this.LetterSpacing==-1&&this.Derived){this.LetterSpacing=this.Derived.GetLetterSpacing()}return this.LetterSpacing};VisAttrObj.prototype.GetWordSpacing=function(){if(this.WordSpacing==-1&&this.Derived){this.WordSpacing=this.Derived.GetWordSpacing()}return this.WordSpacing};VisAttrObj.prototype.GetHorizontalScale=function(){if(this.HorizontalScale==-1&&this.Derived){this.HorizontalScale=this.Derived.GetHorizontalScale()}return this.HorizontalScale};VisAttrObj.prototype.GetClassName=function(){if(this.iClassName==null&&this.Derived){this.iClassName=this.Derived.GetClassName()}return this.iClassName};VisAttrObj.prototype.GetClassHeader=function(){if(this.iClassHeader==null&&this.Derived){this.iClassHeader=this.Derived.GetClassHeader()}return this.iClassHeader};VisAttrObj.prototype.ApplyStyle=function(q,j,o,k,g,n,w,y){var K=g+"|"+n+"|"+w;var N=this.Identifier+"*"+(j?"1":"0")+"$"+k+"|"+K;var B=q.getAttribute("vsign");if(B==N){return}var d=false;if(B){var t=B.substr(0,B.indexOf("*"));var f=N.substr(0,N.indexOf("*"));d=(t==f);if(d){var D=B.substr(B.indexOf("$")+1);D=D.substr(D.indexOf("|")+1);d=(D==K)}}q.setAttribute("vsign",N);var F=q.style;var e=(j)?5:4;var M=this.GetColor(e);var l=this.GetGradColor(e);var p=this.GetGradDir(e);if(k!=undefined&&k!=""){M=k}if("INPUT-TEXTAREA".indexOf(q.tagName)==-1){if(j&&M=="transparent"){M=this.GetColor(4)}if(j&&p==1&&l==-1){l=this.GetGradColor(4);p=this.GetGradDir(4)}if(p<=1){F.backgroundColor=M}}var x=this.GetOpacity(e);if(x<100){F.filter="Alpha(opacity="+x+")"}else{if(F.removeAttribute){F.removeAttribute("filter")}}F.opacity=x/100;if(p>1&&M!="transparent"&&l!=-1){if(RD3_Glb.IsIE(10,false)){F.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType="+(p==2?1:0)+",StartColorStr="+M+",EndColorStr="+l+")";if(q.tagName=="DIV"){F.backgroundColor=M}}else{if(RD3_Glb.IsWebKit()){F.backgroundColor="transparent";F.background="-webkit-gradient(linear, "+(p==2?"left center, right center":"center top, center bottom")+", from("+M+"), to("+l+"))"}else{if(RD3_Glb.IsFirefox()){F.background="-moz-linear-gradient("+(p==2?"left":"top")+", "+M+", "+l+")"}else{if(RD3_Glb.IsIE(10,true)){F.background="linear-gradient("+(p==2?"90deg":"180deg")+", "+M+", "+l+")"}}}}}else{if(RD3_Glb.IsIE(10,false)){if(F.filter.indexOf("progid:DXImageTransform.Microsoft.Gradient")>=0){F.removeAttribute("filter")}}else{if(RD3_Glb.IsWebKit()){if(F.background.indexOf("-webkit-gradient")>=0){F.background=M}}else{if(RD3_Glb.IsFirefox()||RD3_Glb.IsIE(10,true)){if(F.background.indexOf("linear-gradient")>=0){F.background=M}}}}}if(d){return}var r=o?o:"left";switch(this.GetAlignment(1)){case 2:r="left";break;case 3:r="center";break;case 4:r="right";break;case 5:r="justify";break}F.textAlign=r;var J=this.GetMask();if(w!=undefined&&w!=""){J=w}if(J==">"){F.textTransform="uppercase"}else{if(J=="<"){F.textTransform="lowercase"}else{F.textTransform=""}}var c=this.GetCursor();if(c!=""){RD3_Glb.ApplyCursor(q,c)}if(q.tagName=="DIV"){RD3_Glb.SetClass(q,"book-box-clickable",(this.HasHyperLink()||y)&&this.GetContrType()!=RD3_Glb.VISCTRL_BUTTON)}var z=this.GetColor(1);if(g!=undefined&&g!=""){z=g}F.color=z;var u=this.GetLetterSpacing();if(u>0||u<-1){F.letterSpacing=(u/100)+"pt"}var L=this.GetWordSpacing();if(L>0||L<-1){F.wordSpacing=(L/100)+"pt"}var I=this.GetHorizontalScale();if(I>0&&I!=100){if(RD3_Glb.IsIE(10,false)){F.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+I/100+")"}}if("INPUT-TEXTAREA-SPAN".indexOf(q.tagName)==-1){var H="none";var E="0px";var M=this.GetColor(11);var G=this.GetBorders(1);var i=false;switch(G){case 2:F.borderColor=M;F.borderStyle="solid";F.borderTopWidth="1px";F.borderRightWidth="0px";F.borderBottomWidth="1px";F.borderLeftWidth="0px";i=true;break;case 3:F.borderColor=M;F.borderStyle="solid";F.borderTopWidth="0px";F.borderRightWidth="1px";F.borderBottomWidth="0px";F.borderLeftWidth="1px";i=true;break;case 4:H="solid";E="1px";break;case 5:H="inset";E="2px";break;case 6:H="outset";E="2px";break;case 7:H="groove";E="2px";break;case 8:H="ridge";E="2px";break;case 9:var h=0;F.borderTopStyle=this.GetCustomStyle(1);h=this.GetCustomWidth(1)/4;F.borderTopWidth=((h<0.75&&h>0)?"0.75":h)+"pt";F.borderTopColor=this.GetCustomColor(1);F.paddingTop=(this.GetCustomPadding(1)/4)+"pt";F.borderRightStyle=this.GetCustomStyle(2);h=this.GetCustomWidth(2)/4;F.borderRightWidth=((h<0.75&&h>0)?"0.75":h)+"pt";F.borderRightColor=this.GetCustomColor(2);F.paddingRight=(this.GetCustomPadding(2)/4)+"pt";F.borderBottomStyle=this.GetCustomStyle(3);h=this.GetCustomWidth(3)/4;F.borderBottomWidth=((h<0.75&&h>0)?"0.75":h)+"pt";F.borderBottomColor=this.GetCustomColor(3);F.paddingBottom=(this.GetCustomPadding(3)/4)+"pt";F.borderLeftStyle=this.GetCustomStyle(4);h=this.GetCustomWidth(4)/4;F.borderLeftWidth=((h<0.75&&h>0)?"0.75":h)+"pt";F.borderLeftColor=this.GetCustomColor(4);F.paddingLeft=(this.GetCustomPadding(4)/4)+"pt";i=true;break}if(!i){F.border=E+" "+H+" "+M}}var v=this.GetFont(1);var a=v.split(",");if(n!=undefined&&n!=""){a[1]=n}F.fontFamily=this.ConvertFont(a[0]);F.fontWeight=(a[1].indexOf("B")>-1)?"bold":"normal";F.fontStyle=(a[1].indexOf("I")>-1)?"italic":"normal";var b="none";if(a[1].indexOf("U")>-1){b="underline"}else{if(a[1].indexOf("S")>-1){b="line-through"}}F.textDecoration=b;F.fontSize=this.ConvertSize(a[2]);var C=this.GetClassName();var A=q.getAttribute("vsclass");if(A!==C){if(A!=""){RD3_Glb.RemoveClass2(q,A)}if(C&&C!=""){RD3_Glb.AddClass(q,C)}q.setAttribute("vsclass",C?C:"")}};VisAttrObj.prototype.ApplyValueStyle=function(r,v,d,l,C,D,O,e,o,R,a,g,A,t){if(!A){var V=this.GetSign(v,l,C,D,O,e,o,R,a);var G=r.getAttribute("vsign");if(G==V){return}var g=false;if(G){var w=G.substr(0,G.indexOf("$"));var i=V.substr(0,V.indexOf("$"));g=(w==i)}r.setAttribute("vsign",V)}var K=r.style;var x=true;var U="";while(x){x=false;var h=l?5:4;if(R){h=14}else{if(d){h=(v)?7:17}else{if(O){h=22}else{if(e){h=23}else{if(D){h=C?16:(l?18:15)}else{if(C){h=9}}}}}}U=this.GetColor(h);if(l&&U=="transparent"){l=false;x=true}}if(t&&U=="transparent"){if(K.removeAttribute){K.removeAttribute("backgroundColor")}else{K.removeProperty("background-color")}}else{K.backgroundColor=U}var B=this.GetOpacity(h);if(B<100){K.filter="Alpha(opacity="+B+")"}else{if(K.removeAttribute){K.removeAttribute("filter")}}K.opacity=B/100;var n=this.GetGradColor(h);var q=this.GetGradDir(h);if(q>1&&U!="transparent"&&n!=-1){if(RD3_Glb.IsIE(10,false)){if(r.className!="panel-field-caption-list"||RD3_ServerParams.Theme!="seattle"){K.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType="+(q==2?1:0)+",StartColorStr="+U+",EndColorStr="+n+")"}}else{if(RD3_Glb.IsWebKit()){K.background="-webkit-gradient(linear, "+(q==2?"left center, right center":"center top, center bottom")+", from("+U+"), to("+n+"))"}else{if(RD3_Glb.IsFirefox()){K.background="-moz-linear-gradient("+(q==2?"left":"top")+", "+U+", "+n+")"}else{if(RD3_Glb.IsIE(10,true)){K.background="linear-gradient("+(q==2?"90deg":"180deg")+", "+U+", "+n+")"}}}}}else{if(RD3_Glb.IsIE(10,false)){if(K.filter.indexOf("progid:DXImageTransform.Microsoft.Gradient")>=0){K.removeAttribute("filter")}}else{if(RD3_Glb.IsWebKit()){if(K.background.indexOf("-webkit-gradient")>=0){K.background=U}}else{if(RD3_Glb.IsFirefox()||RD3_Glb.IsIE(10,true)){if(K.background.indexOf("linear-gradient")>=0){K.background=U}}}}if("INPUT-TEXTAREA".indexOf(r.tagName)==-1&&d&&v&&K.backgroundColor!=""&&K.backgroundColor!="transparent"){K.backgroundImage="none"}}if(g){return}var J=1;if(d){J=(v)?2:3}var u=o?o:"left";switch(this.GetAlignment(J)){case 2:u="left";break;case 3:u="center";break;case 4:u="right";break;case 5:u="justify";break}K.textAlign=u;if(!d){var Q=this.GetMask();if(Q==">"){K.textTransform="uppercase"}else{if(Q=="<"){K.textTransform="lowercase"}else{K.textTransform=""}}}var f=this.GetCursor();if(f!=""){RD3_Glb.ApplyCursor(r,f)}var S=1;if(d){S=2}else{if(O){S=20}else{if(e){S=21}}}if(a){S=19}var E=this.GetColor(S);if(E=="transparent"){switch(S){case 19:E=this.GetColor(2);break;case 20:case 21:E=this.GetColor(1);break}}K.color=E;var y=this.GetLetterSpacing();if(y>0||y<-1){K.letterSpacing=(y/100)+"pt"}var T=this.GetWordSpacing();if(T>0||T<-1){K.wordSpacing=(T/100)+"pt"}var P=this.GetHorizontalScale();if(P>0&&P!=100){K.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+P/100+")"}var M="none";var I="0px";var U=this.GetColor(11);var p=(v)?1:6;if(d){p=(v)?2:4}var L=this.GetBorders(p);var k=false;switch(L){case 2:K.borderColor=U;K.borderStyle="solid";K.borderTopWidth=(v)?"1px":"0px";K.borderRightWidth="0px";K.borderBottomWidth="1px";K.borderLeftWidth="0px";k=true;break;case 3:K.borderColor=U;K.borderStyle="solid";K.borderTopWidth="0px";K.borderRightWidth="1px";K.borderBottomWidth="0px";K.borderLeftWidth="1px";k=true;break;case 4:M="solid";I="1px";break;case 5:M="inset";I="2px";break;case 6:M="outset";I="2px";break;case 7:M="groove";I="2px";break;case 8:M="ridge";I="2px";break;case 9:var j=0;K.borderTopStyle=this.GetCustomStyle(1);j=this.GetCustomWidth(1)/4;K.borderTopWidth=((j<0.75&&j>0)?"0.75":j)+"pt";K.borderTopColor=this.GetCustomColor(1);K.paddingTop=(this.GetCustomPadding(1)/4)+"pt";K.borderRightStyle=this.GetCustomStyle(2);j=this.GetCustomWidth(2)/4;K.borderRightWidth=((j<0.75&&j>0)?"0.75":j)+"pt";K.borderRightColor=this.GetCustomColor(2);K.paddingRight=(this.GetCustomPadding(2)/4)+"pt";K.borderBottomStyle=this.GetCustomStyle(3);j=this.GetCustomWidth(3)/4;K.borderBottomWidth=((j<0.75&&j>0)?"0.75":j)+"pt";K.borderBottomColor=this.GetCustomColor(3);K.paddingBottom=(this.GetCustomPadding(3)/4)+"pt";K.borderLeftStyle=this.GetCustomStyle(4);j=this.GetCustomWidth(4)/4;K.borderLeftWidth=((j<0.75&&j>0)?"0.75":j)+"pt";K.borderLeftColor=this.GetCustomColor(4);K.paddingLeft=(this.GetCustomPadding(4)/4)+"pt";k=true;break}if(!k){if(M=="none"){if(t){if(K.removeAttribute){K.removeAttribute("border")}else{K.removeProperty("border")}}else{K.border="none"}}else{K.border=I+" "+M+" "+U}}var N;if(d){N=2}else{N=1;if(O){N=4}else{if(e){N=5}else{if(a){N=6}}}}var z=this.GetFont(N);var b=z.split(",");K.fontFamily=this.ConvertFont(b[0]);K.fontWeight=(b[1].indexOf("B")>-1)?"bold":"normal";K.fontStyle=(b[1].indexOf("I")>-1)?"italic":"normal";var c="none";if(b[1].indexOf("U")>-1){c="underline"}else{if(b[1].indexOf("S")>-1){c="line-through"}}K.textDecoration=c;K.fontSize=this.ConvertSize(b[2]);var H=d?this.GetClassHeader():this.GetClassName();var F=r.getAttribute("vsclass");if(F!==H){if(F!=""){RD3_Glb.RemoveClass2(r,F)}if(H&&H!=""){RD3_Glb.AddClass(r,H)}r.setAttribute("vsclass",H?H:"")}};VisAttrObj.prototype.ApplyGroupStyle=function(b,o,q){var n=b.style;if(q){var d=(o)?8:12;var f=this.GetColor(d);n.backgroundColor=f}var k=this.GetOpacity(d);if(k<100){n.filter="Alpha(opacity="+k+")"}else{if(n.removeAttribute){n.removeAttribute("filter")}}n.opacity=k/100;var u=this.GetGradColor(d);var v=this.GetGradDir(d);if(v>1&&f!="transparent"&&u!=-1){if(RD3_Glb.IsIE(10,false)){if(b.className!="group-list-box"||RD3_ServerParams.Theme!="seattle"){n.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType="+(v==2?1:0)+",StartColorStr="+f+",EndColorStr="+u+")"}}else{if(RD3_Glb.IsWebKit()){n.backgroundColor="transparent";n.background="-webkit-gradient(linear, "+(v==2?"left center, right center":"center top, center bottom")+", from("+f+"), to("+u+"))"}else{if(RD3_Glb.IsFirefox()){n.background="-moz-linear-gradient("+(v==2?"left":"top")+", "+f+", "+u+")"}else{if(RD3_Glb.IsIE(10,true)){n.background="linear-gradient("+(v==2?"90deg":"180deg")+", "+f+", "+u+")"}}}}}else{if(RD3_Glb.IsIE(10,false)){if(n.filter.indexOf("progid:DXImageTransform.Microsoft.Gradient")>=0){n.removeAttribute("filter")}}else{if(RD3_Glb.IsWebKit()){if(n.background.indexOf("-webkit-gradient")>=0){n.background=f}}else{if(RD3_Glb.IsFirefox()||RD3_Glb.IsIE(10,true)){if(n.background.indexOf("linear-gradient")>=0){n.background=f}}}}if(o&&q&&n.backgroundColor!=""&&n.backgroundColor!="transparent"){n.backgroundImage="none"}}var e="left";var l=(o)?2:3;switch(this.GetAlignment(l)){case 3:e="center";break;case 4:e="right";break;case 5:e="justify";break}n.textAlign=e;var r=this.GetMask();if(r==">"){n.textTransform="uppercase"}else{if(r=="<"){n.textTransform="lowercase"}else{n.textTransform=""}}var g=(o)?3:13;var p=this.GetColor(g);n.color=p;var h=this.GetLetterSpacing();if(h>0||h<-1){n.letterSpacing=(h/100)+"pt"}var a=this.GetWordSpacing();if(a>0||a<-1){n.wordSpacing=(a/100)+"pt"}var w=this.GetHorizontalScale();if(w>0&&w!=100){n.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+w/100+")"}var i=this.GetFont(3);var j=i.split(",");n.fontFamily=this.ConvertFont(j[0]);n.fontWeight=(j[1].indexOf("B")>-1)?"bold":"normal";n.fontStyle=(j[1].indexOf("I")>-1)?"italic":"normal";n.textDecoration=(j[1].indexOf("U")>-1)?"underline":"none";n.textDecoration=(j[1].indexOf("S")>-1)?"line-through":"none";n.fontSize=this.ConvertSize(j[2]);var c=this.GetClassName();var t=b.getAttribute("vsclass");if(t!==c){if(t!=""){RD3_Glb.RemoveClass2(b,t)}if(c&&c!=""){RD3_Glb.AddClass(b,c)}b.setAttribute("vsclass",c?c:"")}};VisAttrObj.prototype.ApplyListGroupStyle=function(b,w,i,z){var o=b.style;var d=8;var x=this.GetGradDir(d);if(x>1){var v=this.GetGradColor(d);o.backgroundColor=v}else{var f=this.GetColor(d);o.backgroundColor=f}var l=this.GetOpacity(d);if(l<100){o.filter="Alpha(opacity="+l+")"}else{if(o.removeAttribute){o.removeAttribute("filter")}}o.opacity=l/100;var f=this.GetColor(11);var u=this.GetBorders(1);if(!RD3_Glb.IsMobile()){u=2}if(u!=9&&RD3_Glb.IsMobile()){u=2}switch(u){case 2:o.borderColor=f;o.borderStyle="solid";o.borderTopWidth=i?"0px":"1px";o.borderRightWidth="0px";o.borderBottomWidth=i?"0px":"1px";o.borderLeftWidth=w?"1px":"0px";break;case 9:var q=0;o.borderTopStyle=this.GetCustomStyle(1);q=this.GetCustomWidth(1)/4;o.borderTopWidth=((q<0.75&&q>0)?"0.75":q)+"pt";o.borderTopColor=this.GetCustomColor(1);o.paddingTop=(this.GetCustomPadding(1)/4)+"pt";o.borderRightStyle=this.GetCustomStyle(2);q=this.GetCustomWidth(2)/4;o.borderRightWidth=((q<0.75&&q>0)?"0.75":q)+"pt";o.borderRightColor=this.GetCustomColor(2);o.paddingRight=(this.GetCustomPadding(2)/4)+"pt";o.borderBottomStyle=this.GetCustomStyle(3);q=this.GetCustomWidth(3)/4;o.borderBottomWidth=((q<0.75&&q>0)?"0.75":q)+"pt";o.borderBottomColor=this.GetCustomColor(3);o.paddingBottom=(this.GetCustomPadding(3)/4)+"pt";o.borderLeftStyle=this.GetCustomStyle(4);q=this.GetCustomWidth(4)/4;o.borderLeftWidth=((q<0.75&&q>0)?"0.75":q)+"pt";o.borderLeftColor=this.GetCustomColor(4);o.paddingLeft=(this.GetCustomPadding(4)/4)+"pt";break}var e=(i||w)?"left":(z?z:"left");var n=2;switch(this.GetAlignment(n)){case 3:e="center";break;case 4:e="right";break;case 5:e="justify";break}o.textAlign=e;var r=this.GetMask();if(r==">"){o.textTransform="uppercase"}else{if(r=="<"){o.textTransform="lowercase"}else{o.textTransform=""}}var g=3;var p=this.GetColor(g);o.color=p;var h=this.GetLetterSpacing();if(h>0||h<-1){o.letterSpacing=(h/100)+"pt"}var a=this.GetWordSpacing();if(a>0||a<-1){o.wordSpacing=(a/100)+"pt"}var y=this.GetHorizontalScale();if(y>0&&y!=100){o.filter="progid:DXImageTransform.Microsoft.Matrix(M11="+y/100+")"}var j=this.GetFont(3);var k=j.split(",");o.fontFamily=this.ConvertFont(k[0]);o.fontWeight=(k[1].indexOf("B")>-1)?"bold":"normal";o.fontStyle=(k[1].indexOf("I")>-1)?"italic":"normal";o.textDecoration=(k[1].indexOf("U")>-1)?"underline":"none";o.textDecoration=(k[1].indexOf("S")>-1)?"line-through":"none";o.fontSize=this.ConvertSize(k[2]);var c=this.GetClassName();var t=b.getAttribute("vsclass");if(t!==c){if(t!=""){RD3_Glb.RemoveClass2(b,t)}if(c&&c!=""){RD3_Glb.AddClass(b,c)}b.setAttribute("vsclass",c?c:"")}};VisAttrObj.prototype.ApplyBorderStyle=function(a,c){var j=a.style;var h="none";var f="0px";var e=this.GetColor(11);var d=1;switch(c){case 9:case 10:d=6;break;case 11:d=2;break;case 12:d=4;break;case 13:d=5;break}var g=this.GetBorders(d);var b=false;switch(g){case 2:j.borderColor=e;j.borderStyle="solid";j.borderTopWidth=(c==9||c==10||c==12)?"0px":"1px";j.borderRightWidth="0px";j.borderBottomWidth=(c==13)?"0px":"1px";j.borderLeftWidth="0px";b=true;break;case 3:j.borderColor=e;j.borderStyle="solid";j.borderTopWidth="0px";j.borderRightWidth=(c==13)?"0px":"1px";j.borderBottomWidth="0px";j.borderLeftWidth="1px";b=true;break;case 4:h="solid";f="1px";break;case 5:h="inset";f="2px";break;case 6:h="outset";f="2px";break;case 7:h="groove";f="2px";break;case 8:h="ridge";f="2px";break;case 9:var i=0;j.borderTopStyle=this.GetCustomStyle(1);i=this.GetCustomWidth(1)/4;j.borderTopWidth=((i<0.75&&i>0)?"0.75":i)+"pt";j.borderTopColor=this.GetCustomColor(1);j.paddingTop=(this.GetCustomPadding(1)/4)+"pt";j.borderRightStyle=this.GetCustomStyle(2);i=this.GetCustomWidth(2)/4;j.borderRightWidth=((i<0.75&&i>0)?"0.75":i)+"pt";j.borderRightColor=this.GetCustomColor(2);j.paddingRight=(this.GetCustomPadding(2)/4)+"pt";j.borderBottomStyle=this.GetCustomStyle(3);i=this.GetCustomWidth(3)/4;j.borderBottomWidth=((i<0.75&&i>0)?"0.75":i)+"pt";j.borderBottomColor=this.GetCustomColor(3);j.paddingBottom=(this.GetCustomPadding(3)/4)+"pt";j.borderLeftStyle=this.GetCustomStyle(4);i=this.GetCustomWidth(4)/4;j.borderLeftWidth=((i<0.75&&i>0)?"0.75":i)+"pt";j.borderLeftColor=this.GetCustomColor(4);j.paddingLeft=(this.GetCustomPadding(4)/4)+"pt";b=true;break}if(!b){j.border=f+" "+h+" "+e}};VisAttrObj.prototype.ApplyMUPStyle=function(b,l){var n=b.style;var c=l?7:4;var g=this.GetColor(c);n.backgroundColor=g;var m=this.GetOpacity(c);if(m<100){n.filter="Alpha(opacity="+m+")"}else{if(n.removeAttribute){n.removeAttribute("filter")}}n.opacity=m/100;var i=this.GetGradColor(c);var j=this.GetGradDir(c);if(j>1&&g!="transparent"&&i!=-1){if(RD3_Glb.IsIE(10,false)){if(b.className!="panel-field-caption-list"||RD3_ServerParams.Theme!="seattle"){n.filter="progid:DXImageTransform.Microsoft.Gradient(GradientType="+(j==2?1:0)+",StartColorStr="+g+",EndColorStr="+i+")"}}else{if(RD3_Glb.IsWebKit()){n.backgroundColor="transparent";n.background="-webkit-gradient(linear, "+(j==2?"left center, right center":"center top, center bottom")+", from("+g+"), to("+i+"))"}else{if(RD3_Glb.IsFirefox()){n.background="-moz-linear-gradient("+(j==2?"left":"top")+", "+g+", "+i+")"}else{if(RD3_Glb.IsIE(10,true)){n.background="linear-gradient("+(j==2?"90deg":"180deg")+", "+g+", "+i+")"}}}}}else{if(RD3_Glb.IsIE(10,false)){if(n.filter.indexOf("progid:DXImageTransform.Microsoft.Gradient")>=0){n.removeAttribute("filter")}}else{if(RD3_Glb.IsWebKit()){if(n.background.indexOf("-webkit-gradient")>=0){n.background=g}}else{if(RD3_Glb.IsFirefox()||RD3_Glb.IsIE(10,true)){if(n.background.indexOf("linear-gradient")>=0){n.background=g}}}}if(l&&n.backgroundColor!=""&&n.backgroundColor!="transparent"){n.backgroundImage="none"}}n.color=this.GetColor(l?2:1);var a=(l)?2:1;var h=this.GetFont(a);var k=h.split(",");n.fontFamily=this.ConvertFont(k[0]);n.fontWeight=(k[1].indexOf("B")>-1)?"bold":"normal";n.fontStyle=(k[1].indexOf("I")>-1)?"italic":"normal";var e="none";if(k[1].indexOf("U")>-1){e="underline"}else{if(k[1].indexOf("S")>-1){e="line-through"}}n.textDecoration=e;n.fontSize=this.ConvertSize(k[2]);var d=l?this.GetClassHeader():this.GetClassName();var f=b.getAttribute("vsclass");if(f!==d){if(f!=""){RD3_Glb.RemoveClass2(b,f)}if(d&&d!=""){RD3_Glb.AddClass(b,d)}b.setAttribute("vsclass",d?d:"")}};VisAttrObj.prototype.IsPassword=function(){return(this.GetFlags()&65536)!=0};VisAttrObj.prototype.HasHyperLink=function(){return(this.GetFlags()&2097152)!=0};VisAttrObj.prototype.ShowImage=function(){return(this.GetFlags()&524288)!=0};VisAttrObj.prototype.ShowDescription=function(){return(this.GetFlags()&262144)!=0};VisAttrObj.prototype.ShowHTML=function(){if(this.iShowHTML==null){this.iShowHTML=this.GetMask()=="="}return this.iShowHTML};VisAttrObj.prototype.ComputeMask=function(d,e,i){var b=this.GetMask();if(b=="="||b==">"||b=="<"){return""}if(b==""){switch(d){case 6:b=RD3_ServerParams.DateMask;break;case 7:b=RD3_ServerParams.TimeMask;break;case 8:b=RD3_ServerParams.DateMask+" "+RD3_ServerParams.TimeMask;break;case 4:case 3:b=RD3_ServerParams.CurrencyMask;break;case 2:b=RD3_ServerParams.FloatMask;break;case 1:for(var k=0;k<e-1;k++){b+="#"}b+="0";break}}if(b!=""){switch(d){case 1:case 2:case 3:case 4:if(d!=2){var c=b.lastIndexOf(".");var f=i;if(d==4){f=b.length-c-1}if(d==1){f=0}var j=e-f;if(j>0){if(c==-1){c=b.length}for(var h=c-1;h>=0;h--){var a=b.charAt(h);if(a=="0"||a=="#"){j--;if(j==0&&h>0){b=b.substr(h);break}}}}c=b.lastIndexOf(".");if(c>-1&&f>=0){if(f=0){b=b.substring(0,c-1)}else{var g=b.length;for(var h=c+1;h<g;h++){var a=b.charAt(h);if(a=="0"||a=="#"){f--;if(f==0){b=b.substring(0,h);break}}}}}}var g=b.length;for(var h=0;h<g;h++){var a=b.charAt(h);if(a=="."){break}if(a=="0"){b=b.substr(0,h)+"#"+b.substring(h+1)}}if(!RD3_DesktopManager.WebEntryPoint.UseDecimalDot){var c=b.lastIndexOf(".");b=b.replace(/,/g,".");if(c>-1){b=b.substr(0,c)+","+b.substring(c+1)}}break;case 5:case 9:case 12:if(b.length>e){b=b.substr(0,e)}break}}return b};VisAttrObj.prototype.ComputeMaskType=function(a){switch(a){case 1:case 2:case 3:case 4:return"N";case 6:case 7:case 8:return"D";default:return"A"}};VisAttrObj.prototype.SetProto=function(a){if(this.iProto==null){this.iProto=new PCell();this.iProto.CloneFrom(a)}};VisAttrObj.prototype.GetOffset=function(c,e,f,a){var h=e;if(!f){switch(h){case 1:h=6;break;case 2:h=4;break;case 3:h=5;break}}var b=this.GetBorders(h);var g=0;var d=0;switch(b){case 2:d=2;break;case 3:g=2;break;case 4:g=2;d=2;break;case 5:case 6:case 7:case 8:g=4;d=4;break;case 9:d=((this.GetCustomWidth(1)+this.GetCustomWidth(3))*96/288);g=((this.GetCustomWidth(2)+this.GetCustomWidth(4))*96/288);break}if(b==9&&!a){d+=((this.GetCustomPadding(1)+this.GetCustomPadding(3))*96/288);g+=((this.GetCustomPadding(2)+this.GetCustomPadding(4))*96/288)}if(c){return g}else{return d}};VisAttrObj.prototype.AdaptRect=function(c,b,d){var e=this.GetOffset(true,b,d);var a=this.GetOffset(false,b,d);if(e>0){c.w-=(e-1)}if(a>0){c.h-=(a-1)}if(c.w<0){c.w=0}if(c.h<0){c.h=0}};VisAttrObj.prototype.AdaptCaptionRect=function(h,d,a,o,l){var n=o?1:2;if(!d){switch(n){case 1:n=6;break;case 2:n=4;break}}var m=this.GetBorders(n);if(m==9){var c=0;var g=0;c=this.GetOffset(true,o?1:2,d,true);g=this.GetOffset(false,o?1:2,d,true);if(!l){h.pxl=this.GetCustomPadding(4)*96/288;h.pxr=this.GetCustomPadding(2)*96/288;h.pyt=this.GetCustomPadding(1)*96/288;h.pyb=this.GetCustomPadding(3)*96/288;h.w-=(h.pxl+h.pxr);h.h-=(h.pyt+h.pyb)}else{h.pxl=0;h.pxr=0;h.pyt=0;h.pyb=0}h.w-=(c-1);h.h-=(g-1);if(h.w<0){h.w=0}if(h.h<0){h.h=0}return}var b=0;var e=0;var f=0;var k=0;var f=this.GetOffset(true,1,d,l);var k=this.GetOffset(false,1,d,l);if(o){b=f;e=k;if(b==0){b=-2;h.w--}if(e==0){e=-2;h.h--}}else{b=this.GetOffset(true,2,d,l);e=this.GetOffset(false,2,d,l)}if(!l){f+=4;k+=4;var j=2;var i=2;if(a){j=2}else{i=(k-e)/2}if(j<0){j=0}if(i<0){i=0}h.pxl=j;h.pxr=j;h.pyt=i;h.pyb=i;if(b<0){b=0}if(e<0){e=0}b+=2*j;e+=2*i}else{h.pxl=0;h.pxr=0;h.pyt=0;h.pyb=0}h.w-=(b-1);h.h-=(e-1);if(h.w<0){h.w=0}if(h.h<0){h.h=0}};VisAttrObj.prototype.SetBoxProto=function(b){if(this.iBoxProto==null){this.iBoxProto=b.cloneNode(false);if(this.iBoxProto.style.backgroundImage.substr(0,4)=="url("){this.iBoxProto.style.backgroundImage=""}if(this.iBoxProto.className!="book-box"){var a=this.GetClassName();if(a){this.iBoxProto.className="book-box "+a;this.iBoxProto.setAttribute("vsclass",a)}else{this.iBoxProto.className="book-box";this.iBoxProto.setAttribute("vsclass","")}}}};VisAttrObj.prototype.GetBoxProto=function(){if(this.iBoxProto!=null){if(this.iBoxProtoPtr>0){return this.iBoxProtoCollection[--this.iBoxProtoPtr]}this.iBoxProtoQty++;return this.iBoxProto.cloneNode(false)}};VisAttrObj.prototype.HasBoxProto=function(){return this.iBoxProto!=null};VisAttrObj.prototype.Tick=function(){if(this.HasBoxProto()&&this.iBoxProtoPtr<this.iBoxProtoQty){var b=this.iBoxProtoCollection;var d=this.iBoxProto;var e=this.iBoxProtoQty-this.iBoxProtoPtr;e=(e>100)?100:e;for(var c=0;c<e;c++){b[this.iBoxProtoPtr++]=d.cloneNode(false)}return true}return false};VisAttrObj.prototype.GetBookOffset=function(a,c){var d=new Rect(0,0,0,0);if(c==undefined){c=1}var b=this.GetBorders(c);switch(b){case 2:d.y=1;d.h=1;break;case 3:d.x=1;d.w=1;break;case 4:d.x=1;d.y=1;d.w=1;d.h=1;break;case 5:case 6:case 7:case 8:d.x=2;d.y=2;d.w=2;d.h=2;break;case 9:d.y=this.GetCustomWidth(1)*96/288;d.w=this.GetCustomWidth(2)*96/288;d.h=this.GetCustomWidth(3)*96/288;d.x=this.GetCustomWidth(4)*96/288;if(!a){d.y+=this.GetCustomPadding(1)*96/288;d.w+=this.GetCustomPadding(2)*96/288;d.h+=this.GetCustomPadding(3)*96/288;d.x+=this.GetCustomPadding(4)*96/288}break}return d};VisAttrObj.prototype.GetSign=function(g,e,c,f,h,d,a,b,i){return this.Identifier+"*"+(h?"1":"0")+(d?"1":"0")+(i?"1":"0")+"$"+(e?"1":"0")+(c?"1":"0")+(f?"1":"0")+(b?"1":"0")};VisAttrObj.prototype.ConvertFont=function(a){if(RD3_Glb.IsMobile()&&(a=="Tahoma"||a=="Arial")){return"HelveticaNeue,"+a}else{return a}};VisAttrObj.prototype.ConvertSize=function(a){if(RD3_Glb.IsMobile()&&(a=="14"||a=="15")){return"20px"}else{return a+"pt"}};function VoiceHandler(){this.Identifier="voice";this.Enabled=false;this.Listening=false;this.Realized=false;this.StartTimestamp=null;this.Recognition=null;this.AutoCommitTimer=0;this.FakeWords=0;this.MicroExt=null;this.MicroInt=null;this.Bubble=null;this.BubbleWhisker=null;this.TextNode=null;this.MITimer1=0;this.HMTimer1=0;this.HMTimer2=0;this.MessageBoxDlg=null;this.COLOR_WELCOME="gray";this.COLOR_SPEECH="black";this.COLOR_COMMAND="blue";this.COLOR_RESPONSE="green";this.COLOR_ERROR="red";this.TIMEOUT_RESPONSE=5000}VoiceHandler.VoiceLanguages={ITA:"it_IT",ENG:"en_US"};VoiceHandler.prototype.LoadFromXml=function(a){if(a.nodeName!=this.Identifier){return}this.LoadProperties(a)};VoiceHandler.prototype.ChangeProperties=function(a){this.LoadProperties(a)};VoiceHandler.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"lst":this.SetListening(a=="1");break;case"rsp":this.SetResponse(a);break;case"ena":this.Enabled=(a=="1");break;case"say":this.Say(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};VoiceHandler.prototype.SetListening=function(c,b){if(!this.Enabled){return}var a=this.Listening;if(c!=undefined){this.Listening=c}if(b&&a!=this.Listening){var d=new IDEvent("voice",this.Identifier,null,RD3_Glb.EVENT_ACTIVE,"","lst",(this.Listening?"1":"0"))}if(this.Realized&&(c==undefined||a!=this.Listening)){if(this.Listening){this.ShowMicro();this.ShowMessage(ClientMessages.IDV_WELCOME_MSG,this.COLOR_WELCOME);if(RD3_ShellObject.IsInsideShell()){RD3_ShellObject.StartListen(VoiceHandler.VoiceLanguages[RD3_AppLanguage],2,1)}else{this.Recognition.start()}}else{this.HideMicro();if(RD3_ShellObject.IsInsideShell()){RD3_ShellObject.StopListen()}else{this.Recognition.stop()}}}};VoiceHandler.prototype.SetResponse=function(a){if(this.Realized){this.ShowMessage(a,this.COLOR_RESPONSE,this.TIMEOUT_RESPONSE);this.HideMessage(this.TIMEOUT_RESPONSE)}};VoiceHandler.prototype.Say=function(a){if(RD3_ShellObject.IsInsideShell()){RD3_ShellObject.Say(a,VoiceHandler.VoiceLanguages[RD3_AppLanguage],0.2);return}try{var b=new SpeechSynthesisUtterance();b.text=a;b.lang=VoiceHandler.VoiceLanguages[RD3_AppLanguage];speechSynthesis.speak(b)}catch(c){WriteToConsole("Unsupported feature (SAY)","error")}};VoiceHandler.prototype.Realize=function(){if(!this.Enabled){return}if(!RD3_ShellObject.IsInsideShell()){if(!("webkitSpeechRecognition" in window)){return}this.Recognition=new webkitSpeechRecognition();this.Recognition.continuous=true;this.Recognition.interimResults=true;this.Recognition.lang=(RD3_AppLanguage=="ITA")?"it_IT":"en"}this.MicroExt=document.createElement("div");this.MicroExt.setAttribute("id",this.Identifier+"-microext");this.MicroExt.className="voice-microext";this.MicroExt.style.display="none";RD3_DesktopManager.WebEntryPoint.WepBox.appendChild(this.MicroExt);this.MicroInt=document.createElement("div");this.MicroInt.setAttribute("id",this.Identifier+"-microint");this.MicroInt.className="voice-microint";this.MicroExt.appendChild(this.MicroInt);this.Bubble=document.createElement("div");this.Bubble.setAttribute("id",this.Identifier+"-bubble");this.Bubble.className="voice-bubble";this.Bubble.style.display="none";RD3_DesktopManager.WebEntryPoint.WepBox.appendChild(this.Bubble);this.TextNode=document.createElement("span");this.Bubble.appendChild(this.TextNode);this.BubbleWhisker=document.createElement("div");this.BubbleWhisker.setAttribute("id",this.Identifier+"-bubblewhisker");this.BubbleWhisker.className="voice-bubble-whisker";this.Bubble.appendChild(this.BubbleWhisker);this.Realized=true;RD3_DesktopManager.ObjectMap.add(this.Identifier,this);if(!RD3_ShellObject.IsInsideShell()){this.Recognition.onresult=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnResult', ev)");this.Recognition.onaudiostart=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnAudioStart', ev)");this.Recognition.onerror=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnError', ev)");this.Recognition.onstart=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnStart', ev)");this.Recognition.onend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEnd', ev)")}var b=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseDown', ev)");var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnKeyDown', ev)");if(document.addEventListener){document.addEventListener("mousedown",b,false);document.body.addEventListener("keydown",a,true)}this.SetListening()};VoiceHandler.prototype.Unrealize=function(){if(!this.Enabled){return}RD3_DesktopManager.ObjectMap[this.Identifier]=null;RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.Realized=false};VoiceHandler.prototype.AdaptLayout=function(){if(!this.Enabled){return}if(this.Realized){var a=window.innerWidth;var h=window.innerHeight;if(this.TextNode.offsetHeight>0){this.Bubble.style.height=this.TextNode.offsetHeight+"px"}var g=this.MicroExt.offsetWidth;var d=this.MicroExt.offsetHeight;var f=this.Bubble.offsetWidth;var c=this.Bubble.offsetHeight;var e=this.BubbleWhisker.offsetWidth;var b=this.BubbleWhisker.offsetHeight;this.MicroExt.style.left=(a/2-g/2)+"px";this.MicroExt.style.top=(h-d-20)+"px";this.Bubble.style.left=(a/2-f/2)+"px";this.Bubble.style.top=(h-d-20-c-30)+"px";this.BubbleWhisker.style.left=(f/2-e/2-2)+"px";this.BubbleWhisker.style.top=(c-b/2-4)+"px"}};VoiceHandler.prototype.OnStart=function(a){this.StartTimestamp=a.timeStamp;this.AutoCommitTimer=window.setTimeout("RD3_DesktopManager.WebEntryPoint.VoiceObj.OnAutoCommit()",RD3_ClientParams.VoiceAutoCommitDelay)};VoiceHandler.prototype.OnResult=function(c){if(!this.Enabled){return}if(!this.Listening){return}var a="";var f=false;if(typeof(c.results)!="undefined"){for(var b=c.resultIndex;b<c.results.length;++b){a+=c.results[b][0].transcript;if(c.results[b].isFinal){f=true}}if(this.AutoCommitTimer&&!c.autoCommit){window.clearTimeout(this.AutoCommitTimer);if(!f){this.AutoCommitTimer=window.setTimeout("RD3_DesktopManager.WebEntryPoint.VoiceObj.OnAutoCommit()",RD3_ClientParams.VoiceAutoCommitDelay)}}}if(this.FakeWords>0&&!c.autoCommit){a=a.split(/\b\s+/).splice(this.FakeWords).join(" ")}if(a!=""){this.ShowMessage(a,f?this.COLOR_COMMAND:this.COLOR_SPEECH)}if(f&&a!=""){if(this.MessageBoxDlg){this.MessageBoxDlg.OnVoiceCommand(a)}else{var d=new IDEvent("voice",this.Identifier,c,RD3_Glb.EVENT_ACTIVE,"","txt",a)}}if(f){if(c.autoCommit){this.FakeWords+=a.split(/\b\s+/).length}else{this.FakeWords=0}}};VoiceHandler.prototype.OnAutoCommit=function(){var a=this.TextNode.innerHTML;var b=this.Bubble.style.color;if(a!=""&&b==this.COLOR_SPEECH){var c={results:{0:{0:{transcript:a},isFinal:true},length:1},resultIndex:0,autoCommit:1};this.OnResult(c)}};VoiceHandler.prototype.OnAudioStart=function(a){};VoiceHandler.prototype.OnError=function(b){var a;if(b.error=="no-speech"){a=ClientMessages.IDV_ERROR_SILENCE}if(b.error=="audio-capture"){a=ClientMessages.IDV_ERROR_NOMICRO}if(b.error=="not-allowed"){if(b.timeStamp-this.StartTimestamp<100){a=ClientMessages.IDV_ERROR_BLOCKED}else{a=ClientMessages.IDV_ERROR_DENIED}}if(a!=""){this.ShowMessage(a,this.COLOR_ERROR)}this.HideMessage(this.TIMEOUT_RESPONSE);if(this.AutoCommitTimer){window.clearTimeout(this.AutoCommitTimer);this.AutoCommitTimer=0}};VoiceHandler.prototype.OnEnd=function(a){if(this.Listening){this.SetListening(false,true)}if(this.AutoCommitTimer){window.clearTimeout(this.AutoCommitTimer);this.AutoCommitTimer=0}};VoiceHandler.prototype.OnKeyDown=function(c){if(!this.Enabled){return}var a=(window.event)?window.event:c;var b=(a.charCode)?a.charCode:a.keyCode;if(a.ctrlKey&&b==32&&!this.Listening){this.SetListening(true,true);RD3_Glb.StopEvent(c)}else{if(b==27&&this.Listening){this.SetListening(false,true);RD3_Glb.StopEvent(c)}}};VoiceHandler.prototype.OnMouseDown=function(a){if(!this.Enabled){return}var b=(window.event)?window.event.srcElement:a.explicitOriginalTarget;while(b){if(b==this.MicroExt||b==this.Bubble){return}b=b.parentNode}if(!RD3_ShellObject.IsInsideShell()){this.SetListening(false,true)}};VoiceHandler.prototype.HandleMessageBox=function(d,c,b,a){if(!this.Enabled){return}if(a){this.MessageBoxDlg=a}else{this.ShowMessage(d,this.COLOR_RESPONSE)}this.Say(d)};VoiceHandler.prototype.OnCloseMessageBox=function(a){if(!this.Enabled){return}if(this.MessageBoxDlg==a){this.MessageBoxDlg=null}};VoiceHandler.prototype.ShowMicro=function(){window.clearTimeout(this.MITimer1);this.MITimer1=0;this.MicroExt.style.display="";var a="RD3_Glb.SetTransform(document.getElementById('"+this.MicroExt.id+"'), 'scale3d(1,1,1)');";a+="document.getElementById('"+this.MicroExt.id+"').style.opacity=1;";window.setTimeout(a,30)};VoiceHandler.prototype.HideMicro=function(){this.HideMessage(0);this.MicroExt.style.webkitTransform="scale3d(2,2,1)";this.MicroExt.style.opacity=0;var a="document.getElementById('"+this.MicroExt.id+"').style.display='none';";this.MITimer1=window.setTimeout(a,250)};VoiceHandler.prototype.ShowMessage=function(a,b){window.clearTimeout(this.HMTimer1);window.clearTimeout(this.HMTimer2);this.HMTimer1=0;this.HMTimer2=0;if(!this.Listening){return}this.Bubble.style.display="";this.TextNode.innerHTML=a;this.Bubble.style.color=b;this.AdaptLayout();if(this.Bubble.style.opacity!=1){var c="document.getElementById('"+this.Bubble.id+"').style.opacity=1;";window.setTimeout(c,150)}};VoiceHandler.prototype.HideMessage=function(a){if(a==0){this.Bubble.style.display="none"}else{var b="document.getElementById('"+this.Bubble.id+"').style.opacity=0;";this.HMTimer1=window.setTimeout(b,a);b="document.getElementById('"+this.Bubble.id+"').style.display='none';";this.HMTimer2=window.setTimeout(b,a+250)}};function WebEntryPoint(){this.Identifier="wep";this.MainCaption="";this.MainImage="";this.HelpFile="";this.DebugType=0;this.CmdPrompt="Cmd: ";this.ProgressBarFile="";this.EntryPoint="";this.SessionID="";this.Language="ITA";this.ShowLogoff=true;this.SideMenuWidth=160;this.CanOWA=false;this.VisualFlags=3839;this.RefreshInterval=0;this.RefreshLocation=0;this.WidgetMode=false;this.ActiveForm=null;this.UseDecimalDot=false;this.WelcomePage="qhelp.htm";this.HandledKeys=0;this.AccentColor=RD3_Glb.IsMobile7()?"rgb(21, 125, 251)":"rgb(0, 129, 194)";this.MenuType=RD3_Glb.MENUTYPE_LEFTSB;this.MotionThreshold={accel:999,rot:999};this.CmdObj=new CommandList();this.VSList=new VisAttrList();this.IndObj=new IndHandler();this.TimerObj=new TimerHandler();this.VoiceObj=new VoiceHandler();this.StackForm=new Array();this.CustomCommands=new Array();this.CommandZones=new Array();this.DelayDialog=new PopupDelay();this.ExecuteRitardati=new Array();this.ScreenZones=new Array();this.RefreshTimerId=0;this.FocusBoxTimerId=0;this.ResizeTimerId=0;this.Redirecting=false;this.CloseFormId="";this.MenuScrollDir=0;this.WatchLocationId=0;this.LastWatchTime=0;this.DisableOnClick=0;this.CloseAllEventDef=RD3_Glb.EVENT_SERVERSIDE|RD3_Glb.EVENT_IMMEDIATE;this.CloseAppEventDef=RD3_Glb.EVENT_SERVERSIDE|RD3_Glb.EVENT_IMMEDIATE;this.Realized=false;this.InResponse=false;this.RefreshCommands=false;this.RecalcLayout=false;this.WepBox=null;this.HeaderBox=null;this.SideMenuBox=null;this.StatusBarBox=null;this.ToolBarBox=null;this.FormsBox=null;this.LeftDockedBox=null;this.TopDockedBox=null;this.RightDockedBox=null;this.BottomDockedBox=null;this.WelcomeBox=null;this.WelcomeForm=null;this.TrayletBox=null;this.CalPopup=null;this.BlobFrame=null;this.MenuBox=null;this.MenuScrollUp=null;this.MenuScrollDown=null;this.FormListBox=null;this.FormListHeader=null;this.FormListTitle=null;this.CloseAllBox=null;this.CloseAllButton=null;this.CloseAllImg=null;this.CloseAllTxt=null;this.SuppressMenuBox=null;this.MainImageBox=null;this.MainCaptionBox=null;this.DividerBox=null;this.DebugImageBox=null;this.HelpFileBox=null;this.CommandBox=null;this.CloseAppBox=null;this.CommandCaption=null;this.CommandInput=null;this.ComImg=null;this.TaskbarTable=null;this.TaskbarStartCell=null;this.TaskbarQuickCell=null;this.TaskbarFormListCell=null;this.TaskbarTrayCell=null;this.TaskbarMenuBox=null;this.FocusBox=null;this.HeaderH=0;this.SideMenuBoxW=0;this.StatusBarBoxH=0;this.ToolBarBoxH=0;this.LeftDockW=0;this.RightDockW=0;this.TopDockH=0;this.TopDockH=0;for(var a=0;a<48;a++){this.CommandZones[a]=0}this.DeferAfterProcess=true;this.AfterStart=false;this.ScrollMobilePage=false;this.CloseAllVisible=true;this.WelcomeBoxVisible=true}WebEntryPoint.prototype.LoadFromXml=function(e){if(e.nodeName!=this.Identifier){return}this.LoadProperties(e);var j=e.childNodes;var d=j.length;for(var h=0;h<d;h++){var g=j.item(h);var a=g.nodeName;switch(a){case"vsl":this.VSList.LoadFromXml(g);break;case"cmh":this.CmdObj.LoadFromXml(g);break;case"inh":this.IndObj.LoadFromXml(g);break;case"tmh":this.TimerObj.LoadFromXml(g);break;case"voice":this.VoiceObj.LoadFromXml(g);break;case"par":RD3_ServerParams.LoadFromXml(g);break;case"frm":var f=new WebForm();f.LoadFromXml(g);this.StackForm.push(f);break;case"ccm":var b=new Command();b.LoadFromXml(g);this.CustomCommands.push(b);break;case"scz":if(!this.UseZones()){break}var c=new ScreenZone();c.LoadFromXml(g);this.ScreenZones.push(c);break}}};WebEntryPoint.prototype.ChangeProperties=function(a){this.LoadProperties(a)};WebEntryPoint.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;if(c.substr(0,2)=="cz"){this.CommandZones[parseInt(c.substr(2))]=parseInt(a)}switch(c){case"cap":this.SetMainCaption(a);break;case"img":this.SetMainImage(a);break;case"hlp":this.SetHelpFile(a);break;case"dbi":this.SetDebugType(parseInt(a));break;case"cmd":this.SetCmdPrompt(a);break;case"met":this.SetMenuType(a);break;case"rfi":this.SetRefreshInterval(parseInt(a));break;case"rlo":this.SetRefreshLocation(parseInt(a));break;case"wid":this.SetWidgetMode(a=="1");break;case"dec":this.SetUseDecimalDot(a=="1");break;case"act":this.ActivateForm(a);break;case"wel":this.SetWelcomePage(a);break;case"prg":this.SetProgressFile(a);break;case"ent":this.SetEntryPoint(a);break;case"vfl":this.SetVisualFlags(parseInt(a));break;case"sid":this.SessionID=a;break;case"lan":this.SetLanguage(a);break;case"owa":this.SetCanOWA(a=="1");break;case"clo":this.CloseAllEventDef=parseInt(f.nodeValue);break;case"cla":this.CloseAppEventDef=parseInt(f.nodeValue);break;case"snd":this.SetEnableSound(a=="1");break;case"shl":this.SetShowLogoff(a=="1");break;case"smw":this.SetSideMenuWidth(parseInt(a));break;case"acc":this.SetAccentColor(a);break;case"hks":this.SetHandledKeys(parseInt(a));break;case"ena":RD3_ClientParams.EnableGFX=(a=="1");break;case"sta":RD3_ClientParams.GFXDef.start=a;break;case"eca":RD3_ClientParams.GFXDef.menu=a;break;case"pma":RD3_ClientParams.GFXDef.popup=a;break;case"sfa":RD3_ClientParams.GFXDef.form=a;break;case"oma":RD3_ClientParams.GFXDef.modal=a;break;case"msa":RD3_ClientParams.GFXDef.message=a;break;case"lma":RD3_ClientParams.GFXDef.lastmessage=a;break;case"cfa":RD3_ClientParams.GFXDef.frame=a;break;case"eta":RD3_ClientParams.GFXDef.tree=a;break;case"cya":RD3_ClientParams.GFXDef.list=a;break;case"qta":RD3_ClientParams.GFXDef.qbetip=a;break;case"cta":RD3_ClientParams.GFXDef.tab=a;break;case"sga":RD3_ClientParams.GFXDef.graph=a;break;case"cba":RD3_ClientParams.GFXDef.book=a;break;case"rda":RD3_ClientParams.GFXDef.redirect=a;break;case"pra":RD3_ClientParams.GFXDef.preview=a;break;case"dka":RD3_ClientParams.GFXDef.docked=a;break;case"ppr":RD3_ClientParams.GFXDef.popupres=a;break;case"ttp":RD3_ClientParams.GFXDef.tooltip=a;break;case"tsk":RD3_ClientParams.GFXDef.taskbar=a;break;case"cmb":RD3_ClientParams.GFXDef.combo=a;break;case"tme":RD3_TooltipManager.SetEnabled(a=="1");break;case"cns":RD3_ClientParams.ComboNameSeparator=a;break;case"mth":this.SetMotionThreshold(a);break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};WebEntryPoint.prototype.SetRefreshInterval=function(a){if(a!=undefined){this.RefreshInterval=a}if(this.Realized){if(this.TimerId!=0){window.clearInterval(this.TimerId);this.TimerId=0}if(this.RefreshInterval>0){this.TimerId=window.setInterval("RD3_DesktopManager.WebEntryPoint.RefreshIntervalTick()",this.RefreshInterval)}}};function RD3_LocationChange(c){var a=c.coords.latitude+"|";a+=c.coords.longitude+"|";a+=c.coords.accuracy+"|";a+=c.coords.altitude+"|";a+=c.coords.altitudeAccuracy+"|";a+=c.coords.heading+"|";a+=c.coords.speed+"|";if(RD3_Glb.IsChrome()&&c.timestamp.getTime){a+=c.timestamp.getTime()+"|"}else{a+=c.timestamp+"|"}var b=new IDEvent("chgloc","wep",undefined,RD3_Glb.EVENT_ACTIVE,"loc",a,null,null,null,(RD3_DesktopManager.WebEntryPoint.LastWatchTime==0)?1:RD3_DesktopManager.WebEntryPoint.RefreshLocation);RD3_DesktopManager.WebEntryPoint.LastWatchTime=new Date()}function RD3_DeviceOrientation(a){RD3_DesktopManager.WebEntryPoint.LastOrientationEvent=a}function RD3_DeviceMotion(d){if(d){var a=RD3_DesktopManager.WebEntryPoint.MotionThreshold;var c=Math.abs(d.acceleration.x)>=a.accel;c=c||Math.abs(d.acceleration.y)>=a.accel;c=c||Math.abs(d.acceleration.z)>=a.accel;c=c||Math.abs(d.rotationRate.alpha)>=a.rot;c=c||Math.abs(d.rotationRate.beta)>=a.rot;c=c||Math.abs(d.rotationRate.gamma)>=a.rot;if(c&&!RD3_DesktopManager.MessagePump.GetEvent("wep","chgmot")){var b=d.acceleration.x+"|";b+=d.acceleration.y+"|";b+=d.acceleration.z+"|";b+=d.accelerationIncludingGravity.x+"|";b+=d.accelerationIncludingGravity.y+"|";b+=d.accelerationIncludingGravity.z+"|";b+=d.rotationRate.alpha+"|";b+=d.rotationRate.beta+"|";b+=d.rotationRate.gamma+"|";var e=RD3_DesktopManager.WebEntryPoint.LastOrientationEvent;if(e){b+=e.alpha+"|";b+=e.beta+"|";b+=e.gamma+"|";if(e.webkitCompassHeading){b+=e.webkitCompassHeading+"|";b+=e.webkitCompassAccuracy+"|"}else{b+="||"}}else{b+="|||||"}b+=(new Date()).getTime()+"|";var d=new IDEvent("chgmot","wep",undefined,RD3_Glb.EVENT_ACTIVE,"mot",b,null,null,null,100)}}else{var b=Math.random()*10+"|";b+=Math.random()*10+"|";b+=Math.random()*10+"|";b+=Math.random()*20+"|";b+=Math.random()*20+"|";b+=Math.random()*20+"|";b+=Math.random()*30+"|";b+=Math.random()*30+"|";b+=Math.random()*30+"|";b+=Math.random()*90+"|";b+=Math.random()*90+"|";b+=Math.random()*90+"|";b+=Math.random()*360+"|";b+=Math.random()*30+"|";b+=(new Date()).getTime()+"|";var d=new IDEvent("chgmot","wep",undefined,RD3_Glb.EVENT_ACTIVE,"mot",b,null,null,null,100)}}function RD3_LocationError(b){var a=new IDEvent("chgloc","wep",undefined,RD3_Glb.EVENT_ACTIVE,"err",b.code)}WebEntryPoint.prototype.SetRefreshLocation=function(a){if(a!=undefined){this.RefreshLocation=a}if(this.Realized){if(this.RefreshLocation>0&&this.WatchLocationId==0&&navigator.geolocation){this.WatchLocationId=navigator.geolocation.watchPosition(RD3_LocationChange,RD3_LocationError,{enableHighAccuracy:true,refreshLocation:this.RefreshLocation})}if(this.RefreshLocation<=0&&this.WatchLocationId!=0){navigator.geolocation.clearWatch(this.WatchLocationId);this.WatchLocationId=0}}};WebEntryPoint.prototype.SetMotionThreshold=function(b){if(b!=undefined){var a=b.split("|");this.MotionThreshold.accel=parseFloat(a[0]);this.MotionThreshold.rot=parseFloat(a[1])}if(this.Realized){if(this.MotionThreshold.accel!=999||this.MotionThreshold.rot!=999){if(RD3_Glb.IsTouch()){window.addEventListener("devicemotion",RD3_DeviceMotion);window.addEventListener("deviceorientation",RD3_DeviceOrientation)}else{this.MotionTimerID=window.setInterval(RD3_DeviceMotion,1000*this.MotionThreshold.accel)}}else{if(window.removeEventListener){window.removeEventListener("devicemotion",RD3_DeviceMotion);window.removeEventListener("deviceorientation",RD3_DeviceOrientation)}window.clearInterval(this.MotionTimerID);RD3_DesktopManager.WebEntryPoint.LastOrientationEvent=null}}};WebEntryPoint.prototype.SetWidgetMode=function(b){var a=this.WidgetMode;if(b!=undefined){this.WidgetMode=b}if(this.Realized&&(this.WidgetMode!=a||b==undefined)){this.HeaderBox.style.display=(!this.HasCaption()||(this.CmdObj.SuppressMenu&&RD3_Glb.IsMobile()))?"none":"";this.StatusBarBox.style.display=this.HasStatusBar()?"":"none";this.ToolBarBox.style.display=this.HasToolbar()?"":"none";this.CmdObj.SetSuppressMenu()}};WebEntryPoint.prototype.SetVisualFlags=function(c){var b=this.VisualFlags;var d=this.HasToolbar();var a=this.HasStatusBar();if(c!=undefined){this.VisualFlags=c}if(this.Realized&&(this.VisualFlags!=b||c==undefined)&&!RD3_Glb.IsMobile()){this.HeaderBox.style.display=(this.HasCaption()?"":"none");this.SuppressMenuBox.style.display=(this.HasMenuButton()?"":"none");this.MainImageBox.style.display=(this.HasIcon()?"":"none");this.MainCaptionBox.style.display=(this.HasTitle()?"":"none");this.DebugImageBox.style.display=(this.HasDebugButton()?"":"none");this.HelpFileBox.style.display=(this.HasHelpButton()?"":"none");this.CommandBox.style.display=(this.HasCommandBox()?"":"none");this.CloseAppBox.style.display=(this.HasCloseButton()?"":"none");this.ComImg.style.display=(this.HasAjaxInd()?"":"none");this.ToolBarBox.style.display=(this.HasToolbar()?"":"none");this.StatusBarBox.style.display=(this.HasStatusBar()?"":"none");this.MainImageBox.style.cursor=(this.IsIconActive()?"pointer":"");if(c!=undefined){if(d!=this.HasToolbar()||a!=this.HasStatusBar){this.AdaptLayout()}else{this.AdaptHeader()}}}};WebEntryPoint.prototype.HasCaption=function(){return(this.VisualFlags&1)&&!this.WidgetMode};WebEntryPoint.prototype.HasMenuButton=function(){return(this.VisualFlags&2)};WebEntryPoint.prototype.HasIcon=function(){return(this.VisualFlags&4)&&this.MainImage!=""};WebEntryPoint.prototype.HasTitle=function(){return(this.VisualFlags&8)};WebEntryPoint.prototype.HasCommandBox=function(){return(this.VisualFlags&16)&&this.CmdPrompt!=""};WebEntryPoint.prototype.HasCloseButton=function(){return(this.VisualFlags&32)&&this.ShowLogoff};WebEntryPoint.prototype.HasHelpButton=function(){return(this.VisualFlags&64)&&this.HelpFile!=""};WebEntryPoint.prototype.HasDebugButton=function(){return(this.VisualFlags&128)&&this.DebugType!=0};WebEntryPoint.prototype.IsIconActive=function(){return(this.VisualFlags&256)};WebEntryPoint.prototype.HasAjaxInd=function(){return(this.VisualFlags&512)};WebEntryPoint.prototype.HasToolbar=function(){return(this.VisualFlags&1024)&&!this.WidgetMode};WebEntryPoint.prototype.HasStatusBar=function(){return(this.VisualFlags&2048)&&!this.WidgetMode};WebEntryPoint.prototype.SetAccentColor=function(o){var l=this.AccentColor;if(o!=undefined){this.AccentColor=o}if(this.AccentColor!=l||o==undefined){var a=new RegExp(l.replace("(","\\(").replace(")","\\)"),"g");for(var g=0;g<document.styleSheets.length;g++){var k="";if(document.styleSheets[g]["rules"]){k="rules"}if(document.styleSheets[g]["cssRules"]){k="cssRules"}var d=document.styleSheets[g][k];if(!d){continue}for(var e=0;e<d.length;e++){var c=d[e];if(!c.style){continue}var p=c.style.cssText;var m=p.replace(a,this.AccentColor);if(p!=m){c.style.cssText=m}}}if(this.Realized){this.CmdObj.AccentColorChanged(a,this.AccentColor);var b=this.StackForm.length;for(var g=0;g<b;g++){var h=this.StackForm[g];for(var e=0;e<h.Frames.length;e++){h.Frames[e].AccentColorChanged(a,this.AccentColor)}}}}};WebEntryPoint.prototype.SetEnableSound=function(a){if(a!=undefined){RD3_ClientParams.EnableSound=a;if(!a){this.SoundAction("","stopall")}}};WebEntryPoint.prototype.SetShowLogoff=function(a){if(a!=undefined){this.ShowLogoff=a}if(this.Realized){this.CloseAppBox.style.display=this.HasCloseButton()?"":"none";if(a!=undefined){this.AdaptHeader()}}};WebEntryPoint.prototype.SetSideMenuWidth=function(b){var d=this.SideMenuWidth;if(b!=undefined){this.SideMenuWidth=b}if(this.Realized&&(this.SideMenuWidth!=d||b==undefined)){if(this.SideMenuWidth==0){if(RD3_Glb.IsSmartPhone()){this.SideMenuWidth=window.innerWidth}else{var c=document.body.offsetHeight>document.body.offsetWidth?document.body.offsetHeight:document.body.offsetWidth;c=Math.floor(c/100*30);this.SideMenuWidth=c<300?300:c}}this.SideMenuBox.style.width=this.SideMenuWidth+"px";var a=RD3_ServerParams.Theme=="seattle"?this.SideMenuWidth-2:this.SideMenuWidth;this.MenuBox.style.width=a+"px";if(this.FormListBox){this.FormListBox.style.width=a+"px"}if(this.MenuScrollDown){this.MenuScrollDown.style.width=a+"px"}if(this.MenuScrollUp){this.MenuScrollUp.style.width=a+"px"}if(b!=undefined&&b!=0&&!this.InResponse){this.AdaptLayout()}}};WebEntryPoint.prototype.SetHandledKeys=function(a){if(a!=undefined){this.HandledKeys=a}};WebEntryPoint.prototype.SetUseDecimalDot=function(a){if(a!=undefined){this.UseDecimalDot=a}if(this.UseDecimalDot){glbDecSep=".";glbThoSep=","}else{glbDecSep=",";glbThoSep="."}};WebEntryPoint.prototype.Tick=function(){var c=this.StackForm.length;for(var a=0;a<c;a++){var b=this.StackForm[a];if(b&&b.Realized&&b.Visible){b.Tick()}}};WebEntryPoint.prototype.SetMainCaption=function(a){if(a!=undefined){this.MainCaption=a}if(this.Realized&&this.MainCaptionBox){this.MainCaptionBox.innerHTML=this.MainCaption;document.title=this.MainCaptionBox.innerText;if(this.DividerBox){this.DividerBox.style.paddingRight="0px"}if(!RD3_Glb.IsMobile()){RD3_Glb.AdaptToParent(this.HeaderBox,0,-1)}this.AdaptHeader()}};WebEntryPoint.prototype.SetMainImage=function(b){var a=this.MainImage;if(b!=undefined){this.MainImage=b}if(this.Realized&&this.MainImageBox){if(this.MainImage==""){this.MainImageBox.style.display="none"}else{this.MainImageBox.src=RD3_Glb.GetImgSrc("images/"+this.MainImage);this.MainImageBox.style.display=""}if(this.MainImage!=a){this.AdaptHeader()}}};WebEntryPoint.prototype.SetHelpFile=function(a){if(a!=undefined){this.HelpFile=a}if(this.Realized&&this.HelpFileBox){if(!this.HasHelpButton()){this.HelpFileBox.style.display="none"}else{this.HelpFileBox.style.display="";this.HelpFileBox.src=RD3_Glb.GetImgSrc("images/help.gif")}}};WebEntryPoint.prototype.SetDebugType=function(d){if(d!=undefined){this.DebugType=d}if(this.Realized&&this.DebugImageBox){var c=this.HasDebugButton()?"":"none";var b="";switch(this.DebugType){case 0:c="none";break;case 1:b="images/bug.gif";break;case 2:b="images/dtthelp.gif";break}this.DebugImageBox.style.display=c;if(b!=""&&!RD3_Glb.IsMobile()){this.DebugImageBox.src=RD3_Glb.GetImgSrc(b)}if(RD3_Glb.IsMobile()&&this.DebugType==1&&window.top!=window){var a=window.top.document.getElementById("debug");if(a){a.style.display=""}}}};WebEntryPoint.prototype.SetCmdPrompt=function(a){if(a!=undefined){this.CmdPrompt=a}if(this.Realized&&this.CommandBox){if(!this.HasCommandBox()){this.CommandBox.style.display="none"}else{this.CommandBox.style.display="";this.CommandCaption.nodeValue=this.CmdPrompt}}};WebEntryPoint.prototype.SetMenuType=function(a){if(a!=undefined){if(a==RD3_Glb.MENUTYPE_GROUPED){a=RD3_Glb.MENUTYPE_LEFTSB;this.CmdObj.ShowGroups=true}this.MenuType=a}};WebEntryPoint.prototype.SetWelcomePage=function(a){if(a!=undefined){this.WelcomePage=a}if(this.Realized&&this.WelcomePage!=""){if(this.WelcomeForm){this.WelcomeForm.SetPage(this.WelcomePage,this.MainCaption)}if(this.WelcomeBox){this.WelcomeBox.src=this.WelcomePage}}};WebEntryPoint.prototype.SetProgressFile=function(a){if(a!=undefined){this.ProgressBarFile=a}};WebEntryPoint.prototype.SetEntryPoint=function(a){if(a!=undefined){this.EntryPoint=a}};WebEntryPoint.prototype.SetCanOWA=function(a){if(a!=undefined){this.CanOWA=a}};WebEntryPoint.prototype.SetLanguage=function(a){if(a!=undefined){this.Language=a}if(!ClientMessagesSet[this.Language]){this.Language="ENG"}this.ApplyLanguage()};WebEntryPoint.prototype.ApplyLanguage=function(){ClientMessages=ClientMessagesSet[this.Language];MonthNames=ClientMessages.WEP_CAL_MonthNames;DayNames=ClientMessages.WEP_CAL_DayNames;CloseCaption=ClientMessages.WEP_CAL_CloseButtonCaption};WebEntryPoint.prototype.Realize=function(d){if(typeof(RD3_AccentColor)!="undefined"){this.SetAccentColor(RD3_AccentColor)}this.RealizeWep(d);this.RealizeHeader(this.HeaderBox);this.VSList.Realize();this.CmdObj.Realize(this.MenuBox,this.ToolBarBox);this.TimerObj.Realize();this.IndObj.Realize(this.StatusBarBox);this.VoiceObj.Realize();var c=this.ScreenZones.length;for(var b=0;b<c;b++){this.ScreenZones[b].Realize()}var e=this.StackForm.length;for(var a=0;a<e;a++){if(!this.StackForm[a].Modal){this.StackForm[a].Realize()}}this.Realized=true;this.SetMainCaption();this.SetMainImage();this.SetHelpFile();this.SetDebugType();this.SetCmdPrompt();this.SetRefreshInterval();this.SetWidgetMode();this.SetWelcomePage();this.SetShowLogoff();this.SetSideMenuWidth();this.SetRefreshLocation();this.SetMotionThreshold();this.SetVisualFlags();d.appendChild(this.WepBox);var e=this.StackForm.length;for(var a=0;a<e;a++){if(this.StackForm[a].Modal){this.StackForm[a].Realize()}}if(this.ActiveForm==null){this.ActiveForm=this.GetLastForm()}this.ActivateForm(this.ActiveForm)};WebEntryPoint.prototype.RealizeWep=function(k){this.FocusBox=document.createElement("div");this.FocusBox.setAttribute("id","focus-box");this.WepBox=document.createElement("div");this.WepBox.setAttribute("id",this.Identifier);this.WepBox.style.visibility="hidden";this.HeaderBox=document.createElement("div");this.HeaderBox.setAttribute("id","header-container");this.HeaderBox.className="header-container";this.SideMenuBox=document.createElement("div");this.SideMenuBox.setAttribute("id","side-menu-container");if(this.CmdObj.ShowGroups){RD3_Glb.AddClass(this.SideMenuBox,"menu-group-back")}if(RD3_Glb.IsChrome()){this.SideMenuBox.style.webkitTransformStyle="flat"}if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){RD3_Glb.AddClass(this.SideMenuBox,"side-menu-right")}if(this.MenuType==RD3_Glb.MENUTYPE_MENUBAR){RD3_Glb.AddClass(this.SideMenuBox,"side-menu-upbar")}if(this.MenuType==RD3_Glb.MENUTYPE_TASKBAR){RD3_Glb.AddClass(this.SideMenuBox,"side-menu-taskbar")}this.StatusBarBox=document.createElement("div");this.StatusBarBox.setAttribute("id","status-bar-container");this.ToolBarBox=document.createElement("div");this.ToolBarBox.setAttribute("id","toolbar-container");this.FormsBox=document.createElement("div");this.FormsBox.setAttribute("id","forms-container");if(RD3_Glb.IsMobile()){this.WelcomeForm=new WebForm();this.WelcomeForm.ToolbarPosition=0;this.WelcomeForm.Identifier="welcome";this.WelcomeForm.Realize()}else{var e=false;try{if(RD3_Glb.IsIE(10,false)){this.WelcomeBox=document.createElement("<iframe id='welcome-container' frameBorder='0' onload='RD3_DesktopManager.WebEntryPoint.OnWelcomeBoxLoad();'></iframe>");e=true}}catch(i){}if(!e){this.WelcomeBox=document.createElement("iframe");this.WelcomeBox.setAttribute("id","welcome-container");this.WelcomeBox.frameBorder=0;this.WelcomeBox.onload=new Function("RD3_DesktopManager.WebEntryPoint.OnWelcomeBoxLoad();")}}this.LeftDockedBox=document.createElement("div");this.LeftDockedBox.setAttribute("id","left-dock-container");this.LeftDockedBox.className="left-dock-container";this.TopDockedBox=document.createElement("div");this.TopDockedBox.setAttribute("id","top-dock-container");this.TopDockedBox.className="top-dock-container";this.RightDockedBox=document.createElement("div");this.RightDockedBox.setAttribute("id","right-dock-container");this.RightDockedBox.className="right-dock-container";this.BottomDockedBox=document.createElement("div");this.BottomDockedBox.setAttribute("id","bottom-dock-container");this.BottomDockedBox.className="bottom-dock-container";if(this.MenuType==RD3_Glb.MENUTYPE_TASKBAR){this.TaskbarTable=document.createElement("TABLE");this.TaskbarTable.setAttribute("id","taskbar-table");var a=document.createElement("TBODY");this.TaskbarTable.appendChild(a);var f=document.createElement("TR");a.appendChild(f);f.setAttribute("id","taskbar-trow");this.TaskbarStartCell=document.createElement("TD");f.appendChild(this.TaskbarStartCell);this.TaskbarStartCell.setAttribute("id","taskbar-start-cell");this.TaskbarStartCell.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnStartClick', ev)");this.TaskbarQuickCell=document.createElement("TD");f.appendChild(this.TaskbarQuickCell);this.TaskbarQuickCell.setAttribute("id","taskbar-quick-cell");this.TaskbarFormListCell=document.createElement("TD");f.appendChild(this.TaskbarFormListCell);this.TaskbarFormListCell.setAttribute("id","taskbar-formlist-cell");this.TaskbarTrayCell=document.createElement("TD");f.appendChild(this.TaskbarTrayCell);this.TaskbarTrayCell.setAttribute("id","taskbar-tray-cell");this.TaskbarMenuBox=document.createElement("div");this.TaskbarMenuBox.setAttribute("id","taskbar-menu-box");this.SideMenuBox.appendChild(this.TaskbarTable)}if(this.MenuType!=RD3_Glb.MENUTYPE_MENUBAR&&!RD3_Glb.IsMobile()){var n=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseWheel', ev)");var g=(this.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?this.TaskbarMenuBox:this.SideMenuBox;g.onmousewheel=n;if(g.addEventListener){g.addEventListener("DOMMouseScroll",n,true)}}this.WepBox.appendChild(this.HeaderBox);this.WepBox.appendChild(this.SideMenuBox);this.WepBox.appendChild(this.FormsBox);this.WepBox.appendChild(this.LeftDockedBox);this.WepBox.appendChild(this.TopDockedBox);this.WepBox.appendChild(this.RightDockedBox);this.WepBox.appendChild(this.BottomDockedBox);if(this.TaskbarMenuBox){this.WepBox.appendChild(this.TaskbarMenuBox)}if(this.WelcomeBox){this.FormsBox.appendChild(this.WelcomeBox)}this.MenuBox=document.createElement("div");this.MenuBox.setAttribute("id","menu-container");this.MenuBox.className="menu-container";if(this.MenuType==RD3_Glb.MENUTYPE_MENUBAR){RD3_Glb.AddClass(this.MenuBox,"menu-container-upbar")}if(this.MenuType!=RD3_Glb.MENUTYPE_TASKBAR){this.WepBox.appendChild(this.StatusBarBox);this.WepBox.appendChild(this.ToolBarBox);this.SideMenuBox.appendChild(this.MenuBox)}else{this.TaskbarMenuBox.appendChild(this.MenuBox);this.TaskbarTrayCell.appendChild(this.StatusBarBox);this.TaskbarQuickCell.appendChild(this.ToolBarBox);this.ToolBarBox.setAttribute("id","taskbar-toolbar-container");this.StatusBarBox.setAttribute("id","taskbar-status-container")}if(this.HasSideMenu()&&!RD3_Glb.IsMobile()){this.FormListBox=document.createElement("div");this.FormListBox.setAttribute("id","form-list-container");this.SideMenuBox.appendChild(this.FormListBox);this.FormListHeader=document.createElement("div");this.FormListHeader.className="form-list-header";this.FormListHeader.setAttribute("id","form-list-header");this.FormListHeader.appendChild(document.createTextNode(RD3_ServerParams.VideateAperte));this.FormListBox.appendChild(this.FormListHeader);this.FormListTitle=document.createElement("div");this.FormListTitle.className="form-list-entry-container";this.FormListBox.appendChild(this.FormListTitle);this.CloseAllBox=document.createElement("div");this.CloseAllBox.className="form-list-close-all-box";this.CloseAllBox.setAttribute("id","form-list-close-all-box");if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){RD3_Glb.AddClass(this.CloseAllBox,"form-list-close-all-box-right")}this.RealizeCloseAll(this.CloseAllBox);this.FormListBox.appendChild(this.CloseAllBox)}if(this.MenuType!=RD3_Glb.MENUTYPE_MENUBAR&&!RD3_Glb.IsMobile()){this.MenuScrollUp=document.createElement("div");this.MenuScrollUp.setAttribute("id","menusbup");this.MenuScrollUp.className="menu-scrollbox-up";this.MenuScrollUp.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollMenuOver', ev)");this.MenuScrollUp.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollMenuOut', ev)");this.MenuScrollDown=document.createElement("div");this.MenuScrollDown.setAttribute("id","menusbdn");this.MenuScrollDown.className="menu-scrollbox-dn";this.MenuScrollDown.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollMenuOver', ev)");this.MenuScrollDown.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollMenuOut', ev)");if(this.MenuType!=RD3_Glb.MENUTYPE_TASKBAR){this.MenuScrollUp.style.zIndex=0;this.MenuScrollDown.style.zIndex=0}if(this.HasSideMenu()){this.SideMenuBox.appendChild(this.MenuScrollUp);this.SideMenuBox.appendChild(this.MenuScrollDown)}else{this.WepBox.appendChild(this.MenuScrollUp);this.WepBox.appendChild(this.MenuScrollDown)}}var o=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnResize', ev)");if(this.WepBox.addEventListener){window.addEventListener("resize",o,false)}else{this.WepBox.onresize=o}if(RD3_Glb.IsMobile()){if(RD3_Glb.IsIphone(7)||RD3_Glb.IsIpad(7)){if(!RD3_ShellObject.IsInsideShell()){document.body.style.height=window.innerHeight+"px";document.body.style.width=window.innerWidth+"px"}else{var j=RD3_Glb.IsPortrait(true);if(j){document.body.style.height=(screen.height>screen.width?screen.height:screen.width)+"px";document.body.style.width=(screen.height>screen.width?screen.width:screen.height)+"px"}else{document.body.style.height=(screen.height>screen.width?screen.width:screen.height)+"px";document.body.style.width=(screen.height>screen.width?screen.height:screen.width)+"px"}var d=document.getElementById("wait-cell");if(d){d.style.position="absolute";d.style.top=((j?screen.height:screen.width)-d.offsetHeight)/2+"px";d.style.left=((j?screen.width:screen.height)-d.offsetWidth)/2+"px"}}}if(RD3_Glb.IsAndroid()&&!window.lastHeight){window.lastHeight=window.innerHeight;window.lastWidth=window.innerWidth}}if(RD3_Glb.IsTouch()){window.addEventListener("orientationchange",o,false)}var b=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClick', ev)");this.WepBox.onclick=b;if(RD3_Glb.IsMobile()){this.WepBox.onscroll=new Function("ev","return RD3_Glb.NoScroll(ev);")}var l=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnBeforeUnload', ev)");if(document.body.addEventListener){document.body.addEventListener("beforeunload",l,false)}else{document.body.onbeforeunload=l}if(RD3_Glb.IsMobile()&&this.UseZones()&&!RD3_Glb.IsSmartPhone()){var c=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTouchDown', ev)");var m=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTouchMove', ev)");var h=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTouchUp', ev)");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.WepBox.addEventListener("touchstart",c,true);this.WepBox.addEventListener("touchmove",m,true);this.WepBox.addEventListener("touchend",h,true);this.WepBox.addEventListener("touchcancel",h,true)}else{if(RD3_Glb.IsIE(10,true)){this.WepBox.addEventListener("mousedown",c,true);this.WepBox.addEventListener("mousemove",m,true);this.WepBox.addEventListener("mouseup",h,true)}}}if(!RD3_Glb.IsMobile()){this.TrayletBox=document.createElement("div");this.TrayletBox.setAttribute("id","traylet-frame");document.body.appendChild(this.TrayletBox);this.CalPopup=document.createElement("iframe");this.CalPopup.setAttribute("id","calpopup");this.CalPopup.style.display="none";this.CalPopup.style.zIndex=100;this.CalPopup.style.position="absolute";this.CalPopup.style.margin="0px";this.CalPopup.marginWidth="0px";this.CalPopup.marginHeight="0px";if(RD3_Glb.IsTouch()){this.CalPopup.style.width="224px";this.CalPopup.style.height="212px";this.CalPopup.src="calpopupip.htm"}else{this.CalPopup.style.width=(RD3_ServerParams.Theme=="zen"?"220px":"157px");this.CalPopup.style.height=(RD3_ServerParams.Theme=="zen"?"240px":"162px");this.CalPopup.src="calpopup.htm"}this.CalPopup.frameBorder="no";this.CalPopup.scrolling="no";document.body.appendChild(this.CalPopup);var e=false;try{if(RD3_Glb.IsIE(10,false)){this.BlobFrame=document.createElement("<iframe name='blobframe' onload='RD3_DesktopManager.WebEntryPoint.OnBlobUpload();'></iframe>");e=true}}catch(i){}if(!e){this.BlobFrame=document.createElement("iframe");this.BlobFrame.setAttribute("id","blobframe");this.BlobFrame.setAttribute("name","blobframe");this.BlobFrame.onload=new Function("RD3_DesktopManager.WebEntryPoint.OnBlobUpload();")}this.BlobFrame.style.display="none";this.BlobFrame.src="about:blank";document.body.appendChild(this.BlobFrame)}};WebEntryPoint.prototype.OnWelcomeBoxLoad=function(){try{if(!this.WelcomeBox.contentWindow||!this.WelcomeBox.contentWindow.document){return}}catch(b){return}var c=new Function("ev","return RD3_DDManager.OnMouseMove(ev)");var a=new Function("ev","return RD3_DDManager.OnMouseUp(ev)");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.WelcomeBox.contentWindow.document.addEventListener("touchmove",c,false);this.WelcomeBox.contentWindow.document.addEventListener("touchend",a,false)}else{if(this.WelcomeBox.contentWindow.document.addEventListener){this.WelcomeBox.contentWindow.document.addEventListener("mousemove",c,true);this.WelcomeBox.contentWindow.document.addEventListener("mouseup",a,true)}else{this.WelcomeBox.contentWindow.document.attachEvent("onmousemove",c);this.WelcomeBox.contentWindow.document.attachEvent("onmouseup",a)}}};WebEntryPoint.prototype.RealizeHeader=function(b){var c=RD3_Glb.IsMobile();this.SuppressMenuBox=document.createElement("img");this.SuppressMenuBox.setAttribute("id","header-suppress-menu");this.SuppressMenuBox.className="header-suppress-menu-hl"+((this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB)?"-right":"");this.SuppressMenuBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.CmdObj.Identifier+"', 'OnClick', ev)");if(this.MenuType==RD3_Glb.MENUTYPE_LEFTSB){b.appendChild(this.SuppressMenuBox)}this.MainImageBox=document.createElement("img");this.MainImageBox.setAttribute("id","header-main-image");this.MainImageBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnIconClick', ev)");b.appendChild(this.MainImageBox);this.MainCaptionBox=document.createElement("span");this.MainCaptionBox.setAttribute("id","header-main-caption");this.MainCaptionBox.className="header-main-caption";b.appendChild(this.MainCaptionBox);if(!RD3_Glb.IsMobile()){this.DividerBox=document.createElement("span");this.DividerBox.setAttribute("id","header-divider");b.appendChild(this.DividerBox)}this.ComImg=document.createElement("img");this.ComImg.setAttribute("id","header-ajax-indicator");this.ComImg.src=RD3_Glb.GetImgSrc("images/ajload.gif");this.ComImg.style.visibility="hidden";b.appendChild(this.ComImg);this.CommandBox=document.createElement("span");this.CommandBox.setAttribute("id","header-command-box");if(RD3_Glb.IsIE(10,false)&&RD3_ServerParams.Theme=="seattle"){this.CommandBox.style.verticalAlign="auto"}b.appendChild(this.CommandBox);this.CommandCaption=document.createTextNode("");this.CommandBox.appendChild(this.CommandCaption);this.CommandInput=document.createElement("input");this.CommandInput.setAttribute("id","header-command-input");this.CommandInput.maxLength=6;this.CommandInput.accessKey="C";var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCommand', ev)");if(document.addEventListener){this.CommandInput.addEventListener("keypress",a,true)}else{this.CommandInput.attachEvent("onkeypress",a)}this.CommandBox.appendChild(this.CommandInput);this.HelpFileBox=document.createElement("img");this.HelpFileBox.setAttribute("id","header-help-button");this.HelpFileBox.className="header-help-button-hl";this.HelpFileBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnHelpButton', ev)");b.appendChild(this.HelpFileBox);this.DebugImageBox=document.createElement("img");this.DebugImageBox.setAttribute("id","header-debug-image");this.DebugImageBox.className="header-debug-image-hl";this.DebugImageBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnDebug', ev)");b.appendChild(this.DebugImageBox);if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){b.appendChild(this.SuppressMenuBox)}this.CloseAppBox=document.createElement("img");this.CloseAppBox.setAttribute("id","header-close-app");this.CloseAppBox.className="header-close-app-hl";if(!c){this.CloseAppBox.src=RD3_Glb.GetImgSrc("images/closex.gif")}this.CloseAppBox.removeAttribute("width");this.CloseAppBox.removeAttribute("height");RD3_TooltipManager.SetObjTitle(this.CloseAppBox,RD3_ServerParams.ChiudiAppl);this.CloseAppBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCloseApp', ev)");b.appendChild(this.CloseAppBox);if(!RD3_Glb.IsIE(10,false)){this.ComImg.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)");this.HelpFileBox.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)");this.DebugImageBox.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)");this.CloseAppBox.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnReadyStateChange', ev)")}this.CustomizeHeader(b)};WebEntryPoint.prototype.CustomizeHeader=function(a){};WebEntryPoint.prototype.RealizeCloseAll=function(a){var b=RD3_Glb.IsMobile();this.CloseAllButton=document.createElement("span");this.CloseAllButton.setAttribute("id","wep:clo");this.CloseAllImg=document.createElement("img");this.CloseAllTxt=document.createElement("span");this.CloseAllButton.className="form-list-close-all-button";if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){RD3_Glb.AddClass(this.CloseAllButton,"form-list-close-all-button-right")}this.CloseAllImg.className="form-list-close-all-img";if(!b){this.CloseAllImg.src=RD3_Glb.GetImgSrc("images/clall.gif")}this.CloseAllTxt.appendChild(document.createTextNode(RD3_ServerParams.ChiudiTutto));this.CloseAllTxt.className="form-list-close-all-text";this.CloseAllButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCloseAll', ev)");this.CloseAllButton.appendChild(this.CloseAllImg);this.CloseAllButton.appendChild(this.CloseAllTxt);a.appendChild(this.CloseAllButton);this.HandleCloseAllVisibility()};WebEntryPoint.prototype.AdaptFormListBox=function(){if(this.FormListBox){RD3_Glb.AdaptToParent(this.FormListBox,-1,this.MenuBox.offsetHeight);var b=this.FormListHeader.offsetHeight+this.CloseAllBox.offsetHeight+this.FormListTitle.offsetHeight;if(b>this.FormListBox.offsetHeight){this.FormListBox.style.height=(b+10)+"px"}else{this.SideMenuBox.style.overflowY="hidden"}}if(this.TaskbarFormListCell){var f=this.StackForm.length;var e=0;for(var a=0;a<f;a++){if(this.StackForm[a].FLBox){e++}}if(this.TaskbarFormListCell.scrollHeight>this.SideMenuBox.offsetHeight&&e>0){var d=Math.floor(this.TaskbarFormListCell.clientWidth/e)-10;for(var a=0;a<f;a++){if(this.StackForm[a].FLBox){this.StackForm[a].FLBox.style.width=d+"px"}}}else{for(var a=0;a<f;a++){if(this.StackForm[a].FLBox){this.StackForm[a].FLBox.style.width=""}}}}};WebEntryPoint.prototype.AdaptLayout=function(){if(!this.UseZones()){if(RD3_Glb.IsMobile()&&this.CmdObj.AutoSuppress){var g=RD3_Glb.IsPortrait();var u=this.GetDockedForm(RD3_Glb.FORMDOCK_LEFT,g);if(u&&u.Visible==g){u.SetVisible(!g)}var j=this.CmdObj.SuppressMenu;this.CmdObj.SetSuppressMenu("auto");this.CmdObj.ShowMenuButton()}}else{if(RD3_Glb.IsMobile()){if(RD3_Glb.IsPortrait()){var v=this.ScreenZones.length;for(var q=0;q<v;q++){var A=this.ScreenZones[q];if(A&&A.ZoneState==RD3_Glb.SCRZONE_PINNEDZONE&&A.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALCOLLAPSE){A.OldZoneState=A.ZoneState;A.OldSelectedForm=A.SelectedForm;A.SetZoneState(RD3_Glb.SCRZONE_UNPINNEDZONE)}if(A&&A.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&A.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALHIDE){A.OldZoneState=A.ZoneState;A.OldSelectedForm=A.SelectedForm;A.SetZoneState(RD3_Glb.SCRZONE_PINNEDZONE);A.SelectFirstForm()}}}else{var v=this.ScreenZones.length;for(var q=0;q<v;q++){var A=this.ScreenZones[q];if(A&&A.OldZoneState!=null){A.SetZoneState(A.OldZoneState);A.OldZoneState=null;if(A.SelectedForm==RD3_Glb.SCRZONE_SELECTEDNONE){A.SetSelectedForm(A.OldSelectedForm)}A.OldSelectedForm=null}}}}}if(RD3_Glb.IsMobile()){if(!window.lastHeight&&RD3_Glb.IsIE(10,true)){window.lastHeight=window.innerHeight;window.lastWidth=window.innerWidth}if(RD3_Glb.IsSmartPhone()){var G=this.SideMenuWidth;this.SetSideMenuWidth(0);if(this.SideMenuWidth!=G){if(this.CmdObj.ActiveCommand){this.CmdObj.ActiveCommand.SetMenuClass()}}}this.HeaderBox.style.width=this.SideMenuWidth+"px"}if(this.HasSideMenu()){var C=this.WepBox.offsetHeight-this.HeaderBox.offsetHeight;var c=RD3_Glb.GetStyleProp(this.SideMenuBox,"paddingTop");var b=RD3_Glb.GetStyleProp(this.SideMenuBox,"paddingBottom");C=C-(c?parseInt(c):0)-(b?parseInt(b):0);if(C<0){C=0}this.SideMenuBox.style.height=C+"px";this.CmdObj.AdaptLayout();this.AdaptFormListBox();this.AdaptScrollBox()}else{var C=this.WepBox.offsetHeight-this.HeaderBox.offsetHeight-this.SideMenuBox.offsetHeight;RD3_Glb.AdaptToParent(this.SideMenuBox,0,-1);if(this.MenuType==RD3_Glb.MENUTYPE_TASKBAR){this.SideMenuBox.style.marginTop=C+"px"}this.CmdObj.AdaptLayout()}var a=this.SideMenuBox.offsetWidth;var H=0;var K=this.HeaderBox.offsetHeight;var o=0;if(this.UseZones()&&RD3_Glb.IsMobile()){if(this.MenuType==RD3_Glb.MENUTYPE_LEFTSB){a=0}if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){H=this.SideMenuBox.offsetWidth}K=0}else{if(this.MenuType!=RD3_Glb.MENUTYPE_LEFTSB){a=0}if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){H=this.SideMenuBox.offsetWidth}if(this.MenuType==RD3_Glb.MENUTYPE_MENUBAR){K+=this.SideMenuBox.offsetHeight}if(this.MenuType==RD3_Glb.MENUTYPE_TASKBAR){o+=this.SideMenuBox.offsetHeight}}if(this.MenuType!=RD3_Glb.MENUTYPE_TASKBAR){this.StatusBarBox.style.top=K+"px";this.StatusBarBox.style.left=a+"px";RD3_Glb.AdaptToParent(this.StatusBarBox,a+H+1,-1);if(this.HasStatusBar()){this.IndObj.AdaptLayout()}if(this.StatusBarBox.offsetHeight>0&&RD3_ServerParams.Theme=="seattle"){this.ToolBarBox.style.paddingTop="2px"}var p=K;if(this.HasStatusBar()){p=this.StatusBarBox.offsetTop+this.StatusBarBox.offsetHeight}if(RD3_Glb.IsIE(6)&&this.StatusBarBox.offsetHeight==2){p-=2}this.ToolBarBox.style.top=p+"px";this.ToolBarBox.style.left=a+"px";RD3_Glb.AdaptToParent(this.ToolBarBox,a+H+1,-1)}else{this.IndObj.AdaptLayout()}var z=K;if(this.HasToolbar()){z=this.ToolBarBox.offsetTop+this.ToolBarBox.offsetHeight}else{if(this.HasStatusBar()){z=this.StatusBarBox.offsetTop+this.StatusBarBox.offsetHeight}}if(this.HasToolbar()&&this.ToolBarBox.offsetTop==0&&this.MenuType!=RD3_Glb.MENUTYPE_TASKBAR){if(this.HasStatusBar()){z=this.StatusBarBox.offsetTop+this.StatusBarBox.offsetHeight+this.ToolBarBox.offsetHeight}else{z=K+this.ToolBarBox.offsetHeight}}var d=0;if(this.HasStatusBar()){d=this.StatusBarBox.offsetHeight+this.ToolBarBox.offsetHeight}if(RD3_Glb.IsIE(6)){if(this.ToolBarBox.offsetHeight==2){z-=2;d-=2}if(this.StatusBarBox.offsetHeight==2){d-=2}}if(this.MenuType==RD3_Glb.MENUTYPE_TASKBAR){z=K;d=0}if(RD3_Glb.IsMobile()){z=0;d=0}var s=this.LeftDockedBox.offsetWidth;var y=this.TopDockedBox.offsetHeight;var l=this.RightDockedBox.offsetWidth;var k=this.BottomDockedBox.offsetHeight;if(!this.UseZones()){var x=this.StackForm.length;for(var B=0;B<x;B++){var E=this.StackForm[B];E.AdaptDocked()}}else{var F=this.ScreenZones.length;for(var e=0;e<F;e++){var r=this.ScreenZones[e];r.AdaptDocked()}}try{this.TopDockedBox.style.top=z+"px";this.TopDockedBox.style.left=a+"px";RD3_Glb.AdaptToParent(this.TopDockedBox,a+H+1,-1);var p=this.WepBox.offsetHeight-this.BottomDockedBox.offsetHeight-o;if(RD3_Glb.IsIE(6)&&this.BottomDockedBox.offsetHeight==2){p+=2}this.BottomDockedBox.style.top=p+"px";this.BottomDockedBox.style.left=this.TopDockedBox.style.left;RD3_Glb.AdaptToParent(this.BottomDockedBox,a+H+1,-1)}catch(D){}try{var p=this.TopDockedBox.offsetTop+this.TopDockedBox.offsetHeight;if(this.UseZones()){var A=this.GetScreenZone(RD3_Glb.FORMDOCK_TOP);if(A.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&this.TopDockedBox.offsetHeight>RD3_ClientParams.ZoneUnpinnedSize(false)){p=this.TopDockedBox.offsetTop+RD3_ClientParams.ZoneUnpinnedSize(false)}if(RD3_Glb.IsAndroid()){p=p>0?p+1:p}}if(RD3_Glb.IsIE(6)&&this.TopDockedBox.offsetHeight==2){p-=2}this.LeftDockedBox.style.top=p+"px";this.LeftDockedBox.style.left=a+"px";var I=this.BottomDockedBox.offsetHeight;if(this.UseZones()){var A=this.GetScreenZone(RD3_Glb.FORMDOCK_BOTTOM);if(A.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE){I=I==0?0:RD3_ClientParams.ZoneUnpinnedSize(false)-1}else{I=I==0?0:I-1}if(RD3_Glb.IsAndroid()){I=I>0?I+1:I}}RD3_Glb.AdaptToParent(this.LeftDockedBox,-1,p+1+o+I);var m=this.WepBox.offsetWidth-this.RightDockedBox.offsetWidth-H;if(RD3_Glb.IsIE(6)&&this.RightDockedBox.offsetWidth==2){m+=2}this.RightDockedBox.style.top=this.LeftDockedBox.style.top;this.RightDockedBox.style.left=m+"px";var p=this.TopDockedBox.offsetTop+this.TopDockedBox.offsetHeight;if(this.UseZones()&&RD3_Glb.IsAndroid()){p=p>0?p+1:p}if(RD3_Glb.IsIE(6)&&this.TopDockedBox.offsetHeight==2){p-=2}RD3_Glb.AdaptToParent(this.RightDockedBox,-1,p+1+o+I)}catch(D){}try{var p=this.TopDockedBox.offsetTop+this.TopDockedBox.offsetHeight;var m=this.LeftDockedBox.offsetLeft+this.LeftDockedBox.offsetWidth;if(this.UseZones()){var A=this.GetScreenZone(RD3_Glb.FORMDOCK_TOP);if(A.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&this.TopDockedBox.offsetHeight>RD3_ClientParams.ZoneUnpinnedSize(false)){p=this.TopDockedBox.offsetTop+RD3_ClientParams.ZoneUnpinnedSize(false)}if(RD3_Glb.IsAndroid()){p=p>0?p+1:p}A=this.GetScreenZone(RD3_Glb.FORMDOCK_LEFT);if(A.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&this.LeftDockedBox.offsetWidth>RD3_ClientParams.ZoneUnpinnedSize(true)){m=this.LeftDockedBox.offsetLeft+RD3_ClientParams.ZoneUnpinnedSize(true)}else{if(A.HasMobileMenu&&(A.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALHIDE||A.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALPOPOVER)&&RD3_Glb.IsPortrait()){m=0}}if(RD3_Glb.IsAndroid()){m=m>0?m+1:m}}if(RD3_Glb.IsSmartPhone()){p=0;m=0}if(RD3_Glb.IsIE(6)){if(this.TopDockedBox.offsetHeight==2){p-=2}if(this.LeftDockedBox.offsetWidth==2){m-=2}}this.FormsBox.style.top=p+"px";this.FormsBox.style.left=m+"px";m=this.LeftDockedBox.offsetWidth+this.RightDockedBox.offsetWidth;p=this.BottomDockedBox.offsetHeight+this.TopDockedBox.offsetHeight;if(this.UseZones()){p=0;m=0;var A=this.GetScreenZone(RD3_Glb.FORMDOCK_BOTTOM);if(A.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&this.BottomDockedBox.offsetHeight>RD3_ClientParams.ZoneUnpinnedSize(false)){p+=RD3_ClientParams.ZoneUnpinnedSize(false)}else{p+=this.BottomDockedBox.offsetHeight}A=this.GetScreenZone(RD3_Glb.FORMDOCK_TOP);if(A.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&this.TopDockedBox.offsetHeight>RD3_ClientParams.ZoneUnpinnedSize(false)){p+=RD3_ClientParams.ZoneUnpinnedSize(false)}else{p+=this.TopDockedBox.offsetHeight}if(RD3_Glb.IsAndroid()){p=p>0?p+1:p}A=this.GetScreenZone(RD3_Glb.FORMDOCK_LEFT);if(A.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&this.LeftDockedBox.offsetWidth>RD3_ClientParams.ZoneUnpinnedSize(true)){m+=RD3_ClientParams.ZoneUnpinnedSize(true)}else{if(A.HasMobileMenu&&(A.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALHIDE||A.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALPOPOVER)&&RD3_Glb.IsPortrait()){m+=0}else{m+=this.LeftDockedBox.offsetWidth}}A=this.GetScreenZone(RD3_Glb.FORMDOCK_RIGHT);if(A.ZoneState==RD3_Glb.SCRZONE_UNPINNEDZONE&&this.RightDockedBox.offsetWidth>RD3_ClientParams.ZoneUnpinnedSize(true)){m+=RD3_ClientParams.ZoneUnpinnedSize(true)}else{if(A.HasMobileMenu&&(A.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALHIDE||A.VerticalBehavour==RD3_Glb.SCRZONE_VERTICALPOPOVER)&&RD3_Glb.IsPortrait()){m+=0}else{m+=this.RightDockedBox.offsetWidth}}if(RD3_Glb.IsAndroid()){m=m>0?m+1:m}}if(RD3_Glb.IsIE(6)){if(this.LeftDockedBox.offsetWidth==2){m-=2}if(this.RightDockedBox.offsetWidth==2){m-=2}if(this.TopDockedBox.offsetHeight==2){p-=2}if(this.BottomDockedBox.offsetHeight==2){p-=2}}if(!RD3_Glb.IsMobile()){d+=K+1}if(RD3_Glb.IsSmartPhone()){RD3_Glb.AdaptToParent(this.FormsBox,0,0)}else{RD3_Glb.AdaptToParent(this.FormsBox,a+H+m+1,p+d+o)}if(this.WelcomeBox){RD3_Glb.AdaptToParent(this.WelcomeBox)}}catch(D){}this.AdaptHeader();this.SendResize();if(this.UseZones()){var F=this.ScreenZones.length;for(var e=0;e<F;e++){var r=this.ScreenZones[e];r.AdaptLayout()}}var x=this.StackForm.length;for(var B=0;B<x;B++){var E=this.StackForm[B];if(E.Modal&&E.WindowState==RD3_Glb.WS_MAXIMIZE){E.SetWindowState()}E.AdaptLayout()}this.AdaptFormListBox();this.VoiceObj.AdaptLayout();if(RD3_Glb.IsMobile()&&this.UseZones()){var J=this.GetScreenZone(RD3_Glb.FORMDOCK_LEFT);J.SlideZone(s,this.LeftDockedBox.offsetWidth);J=this.GetScreenZone(RD3_Glb.FORMDOCK_RIGHT);J.SlideZone(l,this.RightDockedBox.offsetWidth);J=this.GetScreenZone(RD3_Glb.FORMDOCK_TOP);J.SlideZone(y,this.TopDockedBox.offsetHeight);J=this.GetScreenZone(RD3_Glb.FORMDOCK_BOTTOM);J.SlideZone(k,this.BottomDockedBox.offsetHeight)}};WebEntryPoint.prototype.AdaptHeader=function(){if(this.DividerBox){this.DividerBox.style.paddingRight="0px"}if(!RD3_Glb.IsMobile()){RD3_Glb.AdaptToParent(this.HeaderBox,0,-1)}if(this.DividerBox){var h=this.HeaderBox.childNodes.length;var f=-10000;var a=null;for(var b=0;b<h;b++){var g=this.HeaderBox.childNodes[b];if(g!==this.DividerBox&&(g.offsetLeft>=this.DividerBox.offsetLeft)&&(g.style.display!="none")){var e=g.offsetLeft+g.offsetWidth;if(!isNaN(parseFloat(RD3_Glb.GetStyleProp(g,"marginRight"),10))){e+=parseFloat(RD3_Glb.GetStyleProp(g,"marginRight"),10)}if(f<e){f=e;a=g}}}this.CommandBox.style.marginRight=(a==this.CommandBox)?"8px":"";if(a==this.CommandBox){f+=8}var d=this.HeaderBox.clientWidth-f;if(d<8){d=8}this.DividerBox.style.paddingRight=(d-8)+"px"}};WebEntryPoint.prototype.Unrealize=function(){if(window.removeEventListener){window.removeEventListener("devicemotion",RD3_DeviceMotion);window.removeEventListener("deviceorientation",RD3_DeviceOrientation)}this.WepBox.parentNode.removeChild(this.WepBox);RD3_DesktopManager.ObjectMap[this.Identifier]=null;this.IndObj.Unrealize();this.CmdObj.Unrealize();this.TimerObj.Unrealize();this.VSList.Unrealize();this.VoiceObj.Unrealize();var b=this.StackForm.length;for(var a=0;a<b;a++){this.StackForm[a].Unrealize()}this.DelayDialog.Unrealize();this.WepBox=null;this.HeaderBox=null;this.SideMenuBox=null;this.StatusBarBox=null;this.ToolBarBox=null;this.FormsBox=null;this.MenuBox=null;this.FormListBox=null;this.FormListHeader=null;this.FormListTitle=null;this.CloseAllBox=null;this.CloseAllButton=null;this.Realized=false};WebEntryPoint.prototype.BeforeProcessResponse=function(){if(this.Realized){this.InResponse=true;this.HeaderH=this.HeaderBox.offsetHeight;this.SideMenuBoxW=this.SideMenuBox.offsetWidth;this.StatusBarBoxH=this.StatusBarBox.offsetHeight;this.ToolBarBoxH=this.ToolBarBox.offsetHeight;this.LeftDockW=this.LeftDockedBox.offsetWidth;this.RightDockW=this.RightDockedBox.offsetWidth;this.TopDockH=this.TopDockedBox.offsetHeight;this.BottomDockH=this.BottomDockedBox.offsetHeight}};WebEntryPoint.prototype.AfterProcessResponse=function(force){if(this.DeferAfterProcess||RD3_GFXManager.Animating()){this.DeferAfterProcess=false;window.setTimeout("RD3_DesktopManager.WebEntryPoint.AfterProcessResponse("+force+")",20);return}if(this.InResponse||force){var recalc=false;recalc=recalc||(this.HeaderH!=this.HeaderBox.offsetHeight);recalc=recalc||(this.SideMenuBoxW!=this.SideMenuBox.offsetWidth);recalc=recalc||(this.StatusBarBoxH!=this.StatusBarBox.offsetHeight);recalc=recalc||(this.ToolBarBoxH!=this.ToolBarBox.offsetHeight);recalc=recalc||(this.LeftDockW!=this.LeftDockedBox.offsetWidth);recalc=recalc||(this.RightDockW!=this.RightDockedBox.offsetWidth);recalc=recalc||(this.TopDockH!=this.TopDockedBox.offsetHeight);recalc=recalc||(this.BottomDockH!=this.BottomDockedBox.offsetHeight);recalc=recalc||this.RecalcLayout;if(this.RefreshCommands){this.CmdObj.ActiveFormChanged();this.IndObj.ActiveFormChanged();this.RefreshCommands=false}this.RecalcLayout=false;if(recalc||force){this.AdaptLayout()}if(RD3_Glb.IsMobile()&&this.WelcomeForm&&this.WelcomeForm.Realized&&this.WelcomeForm.AdaptToolbar){this.WelcomeForm.AdaptToolbarLayout()}var n=this.StackForm.length;for(var i=0;i<n;i++){this.StackForm[i].AfterProcessResponse()}RD3_KBManager.AfterProcessResponse();if(this.UseZones()){for(var szi=0;szi<this.ScreenZones.length;szi++){this.ScreenZones[szi].AfterProcessResponse()}}if(this.WepBox.style.visibility=="hidden"){this.WepBox.style.visibility="";if(typeof(WaitTimer)!="undefined"&&WaitTimer){window.clearTimeout(WaitTimer);WaitTimer=null}var wb=document.getElementById("wait-box");if(wb){if(RD3_Glb.IsMobile()){this.WepBox.style.opacity=1;wb.style.opacity=0;window.setTimeout("document.getElementById('wait-box').parentNode.removeChild(document.getElementById('wait-box'))",500)}else{wb.parentNode.removeChild(wb)}}if(!RD3_Glb.IsMobile()){var fx=new GFX("start",true,document.body,false);RD3_GFXManager.AddEffect(fx)}this.SoundAction("login","play");if(RD3_Glb.IsSafari()||RD3_Glb.IsChrome()||RD3_Glb.IsFirefox(4)||RD3_Glb.IsIE(8)){this.OnResize()}RD3_KBManager.CheckFocus=true}while(this.ExecuteRitardati.length>0){try{eval(this.ExecuteRitardati.shift())}catch(e){console.error(e)}}RD3_KBManager.ActiveButton=null;this.InResponse=false}};WebEntryPoint.prototype.OnResize=function(a){if(RD3_Glb.IsMobile()){if(RD3_Glb.IsIphone(7)||RD3_Glb.IsIpad(7)){if(!RD3_ShellObject.IsInsideShell()){document.body.style.height=window.innerHeight+"px";document.body.style.width=window.innerWidth+"px";document.body.scrollTop=0}else{var f=RD3_Glb.IsPortrait(true);var d=parseInt(document.body.style.height);var g=parseInt(document.body.style.width);var b=d>g?d:g;var c=d>g?g:d;if(f){document.body.style.height=b+"px";document.body.style.width=c+"px"}else{document.body.style.height=c+"px";document.body.style.width=b+"px"}}}if(RD3_Glb.IsAndroid()||RD3_Glb.IsIE(10,true)){var i=false;if(!window.lastHeight){window.lastHeight=window.innerHeight;window.lastWidth=window.innerWidth}else{i=(window.innerWidth==window.lastWidth&&window.innerHeight<window.lastHeight)}if(window.pageYOffset>0||i){if(document.activeElement){var e=RD3_Glb.GetScreenTop(document.activeElement,true)+document.activeElement.offsetHeight;var j=window.innerHeight;if(e>j&&this.WepBox.scrollTop!=e-j){this.ScrollMobilePage=true;this.WepBox.scrollTop=e-j}}this.openKeyboard=true;return}else{window.lastHeight=window.innerHeight;window.lastWidth=window.innerWidth;if(this.WepBox.scrollTop!=0){this.ScrollMobilePage=true;this.WepBox.scrollTop=0}if(RD3_Glb.IsMobile()&&RD3_DDManager.OpenCombo&&this.openKeyboard){this.notCloseComboOnResize=true}this.openKeyboard=false}}else{if(window.pageYOffset>0&&RD3_ShellObject.IsInsideShell()){return}}}this.CmdObj.ClosePopup();if(RD3_Glb.IsMobile()&&!RD3_Glb.IsIE()){this.TickResize()}else{if(this.ResizeTimerId>0){window.clearTimeout(this.ResizeTimerId)}this.ResizeTimerId=window.setTimeout("RD3_DesktopManager.WebEntryPoint.TickResize()",200)}};WebEntryPoint.prototype.TickResize=function(a){if(a==undefined){a=false}if(this.ResizeTimerId){window.clearTimeout(this.ResizeTimerId)}this.ResizeTimerId=0;if(!this.InResponse){if(RD3_Glb.IsAndroid()&&!a){this.ResizeTimerId=window.setTimeout("RD3_DesktopManager.WebEntryPoint.TickResize(true)",250);return}var b=RD3_KBManager.ActiveElement;this.WepBox.focus();this.InResize=true;this.AdaptLayout();this.InResize=false;if(RD3_DDManager.OpenCombo&&!this.notCloseComboOnResize){if(RD3_Glb.IsMobile()&&!RD3_DDManager.OpenCombo.UsePopover){RD3_DDManager.OpenCombo.AdaptMobileCombo()}else{RD3_DDManager.OpenCombo.Close()}}else{if(RD3_DDManager.OpenCombo&&this.notCloseComboOnResize){if(RD3_DDManager.OpenCombo.ComboPopupInput){RD3_DDManager.OpenCombo.ComboPopupInput.blur()}RD3_KBManager.activeElement=null}}RD3_DDManager.ClosePopup();RD3_KBManager.ActiveElement=b;this.notCloseComboOnResize=false}else{this.ResizeTimerId=window.setTimeout("RD3_DesktopManager.WebEntryPoint.TickResize()",50)}};WebEntryPoint.prototype.SendResize=function(){var f=0;var c=0;var e=0;var b=0;try{f=parseInt(RD3_Glb.GetStyleProp(this.FormsBox,"paddingRight"));c=parseInt(RD3_Glb.GetStyleProp(this.FormsBox,"paddingLeft"));e=parseInt(RD3_Glb.GetStyleProp(this.FormsBox,"paddingTop"));b=parseInt(RD3_Glb.GetStyleProp(this.FormsBox,"paddingBottom"))}catch(a){}var d=new IDEvent("resize",this.Identifier,null,RD3_Glb.EVENT_SERVERSIDE,null,this.FormsBox.clientWidth-f,this.FormsBox.clientHeight-b,RD3_Glb.GetScreenLeft(this.FormsBox)+c,RD3_Glb.GetScreenTop(this.FormsBox)+e,null,false,this.WepBox.clientWidth,this.WepBox.clientHeight)};WebEntryPoint.prototype.OpenForm=function(a,g){var e=new WebForm();if(this.CloseFormId!=""&&this.CloseFormId==a.getAttribute("id")){var j=RD3_DesktopManager.ObjectMap[this.CloseFormId];if(j){j.Unrealize()}var h=this.StackForm.length;for(var b=0;b<h;b++){var d=this.StackForm[b];if(d.Identifier==this.CloseFormId){this.StackForm.splice(b,1);break}}if(this.ActiveForm&&this.ActiveForm.Identifier==this.CloseFormId){this.ActiveForm=null}if(this.VisibleForm&&this.VisibleForm.Identifier==this.CloseFormId){this.VisibleForm=null}this.CloseFormId=""}if(a.getAttribute("mod")!="0"){RD3_GFXManager.FinishModalClosing(a.getAttribute("id"))}e.LoadFromXml(a);this.StackForm.push(e);if(g){e.Modal=g}e.Realize();if(e.Visible){this.SoundAction("open","play");if(this.UseZones()&&e.Docked){this.ActivateForm(e,true)}else{var c=(e.Owner&&e.HasBackButton()?RD3_DesktopManager.ObjectMap[e.Owner]:null);if(c&&c.Modal==0&&e.Modal==0){e.AdaptLayout();RD3_DesktopManager.WebEntryPoint.AnimateForms(c.Identifier,e.Identifier,true)}else{this.ActivateForm(e,true)}}}if(RD3_Glb.IsMobile()){this.CmdObj.SetSuppressMenu("auto")}};WebEntryPoint.prototype.CloseForm=function(d){var e=this.StackForm.length;for(var a=0;a<e;a++){var c=this.StackForm[a];if(c.Identifier==d){if(this.UseZones()&&c.Docked){this.CloseForm2(c);break}else{var b=(c.Owner&&c.HasBackButton()?RD3_DesktopManager.ObjectMap[c.Owner]:null);if(b&&b.Realized&&b.Modal==0&&c.Modal==0&&this.ActiveForm&&c.Identifier==this.ActiveForm.Identifier){this.AnimateForms(b.Identifier,c.Identifier,false)}else{this.CloseForm2(c)}break}}}};WebEntryPoint.prototype.CloseForm2=function(e){var c=0;for(c=0;c<this.StackForm.length;c++){if(this.StackForm[c]==e){break}}if((!e.Docked&&!e.Modal)&&e.FormBox.style.display!="none"){if(RD3_Glb.IsMobile()&&this.CloseFormId!=""&&this.CloseFormId!=e.Identifier&&(!this.ActiveForm||this.ActiveForm.Identifier!=this.CloseFormId)){var b=0;var g;for(b=0;b<this.StackForm.length;b++){if(this.StackForm[b].Identifier==this.CloseFormId){g=this.StackForm[b];break}}if(g){this.TimerObj.FormClosed(g);g.Unrealize();this.StackForm.splice(b,1)}}this.CloseFormId=e.Identifier}else{if(e.Modal){this.StackForm.splice(c,1);if(this.ActiveForm&&this.ActiveForm.Identifier==e.Identifier){this.ActiveForm=null;this.CmdObj.ActiveFormChanged();this.IndObj.ActiveFormChanged()}if(RD3_Glb.IsMobile()){e.PopupFrame.Close()}else{var d=new GFX("modal",false,e,false,null,e.ModalAnimDef);d.CloseFormAnimation=true;RD3_GFXManager.AddEffect(d)}}if(e.Docked){if(!this.UseZones()){this.TimerObj.FormClosed(e);if(this.ActiveForm&&this.ActiveForm.Identifier==e.Identifier){this.ActiveForm=null}var d=new GFX("docked",false,e,false);d.IdxForm=e.Identifier;d.CloseFormAnimation=true;RD3_GFXManager.AddEffect(d)}else{var a=this.GetScreenZone(e.DockType);a.CloseForm(e)}}if(!e.Docked&&!e.Modal){this.TimerObj.FormClosed(e);if(this.ActiveForm&&this.ActiveForm.Identifier==e.Identifier){this.ActiveForm=null}e.Unrealize();this.StackForm.splice(c,1)}}this.SoundAction("close","play")};WebEntryPoint.prototype.ActivateForm=function(k,a){if(this.AniForm1){this.FormToActivate=k;var g=(k&&k.Identifier)?k:RD3_DesktopManager.ObjectMap[k];if(g&&g.Realized){if(RD3_Glb.IsMobile()&&g.Modal==0&&!g.Docked){g.CaptureToolbarButton(RD3_DesktopManager.WebEntryPoint.CmdObj.MenuButton);if(RD3_DesktopManager.WebEntryPoint.InResponse){g.AdaptToolbar=true}else{g.AdaptToolbarLayout()}}}return}if(!a){a=false}if(this.Realized){var g=(k&&k.Identifier)?k:RD3_DesktopManager.ObjectMap[k];if(RD3_Glb.IsMobile()&&g&&!g.Docked){RD3_DDManager.ClosePopup()}if(g==this.ActiveForm&&this.ActiveForm){return}var s=g?g.Modal!=0:false;var z=g?g.Docked:false;if(s){this.ActiveForm=g;var c=new GFX("modal",true,g,!a,null,g.ModalAnimDef);RD3_GFXManager.AddEffect(c);return}if(z){this.ActiveForm=g;if(!this.UseZones()){if(this.ActiveForm&&this.WepBox.style.visibility!="hidden"){if(RD3_Glb.IsMobile()&&!RD3_Glb.IsSmartPhone()&&this.CmdObj.PopupObj!=null&&this.ActiveForm.DockType==RD3_Glb.FORMDOCK_LEFT){var r=this.CmdObj.PopupObj;this.ActiveForm.SetVisible(false);this.CmdObj.ConvertFormPopover(true,this.ActiveForm);this.CmdObj.SetMenuButtonCaption(this.ActiveForm.Caption);try{if(r.OrgContentParent){while(r.ContentBox.firstChild){var B=r.ContentBox.firstChild;r.ContentBox.removeChild(B);r.OrgContentParent.appendChild(B)}}if(r.OrgHeaderParent){var l=r.CaptionBox.firstChild;r.CaptionBox.removeChild(l);r.OrgHeaderParent.insertBefore(l,r.OrgHeaderSibling)}}catch(y){}r.HostForm(this.ActiveForm)}else{var c=new GFX("docked",true,g,false,null,g.DockedAnimDef);RD3_GFXManager.AddEffect(c)}}else{g.SetActive(true,true);this.CmdObj.ActiveFormChanged();this.IndObj.ActiveFormChanged();this.TimerObj.ActiveFormChanged();this.HandleCloseAllVisibility();if(this.ActiveForm){RD3_DesktopManager.HandleFocus2(this.ActiveForm.Identifier,0)}}}else{var u=this.GetScreenZone(g.DockType);u.ActivateForm(g)}return}if(!s&&!z){var e=1000;var b=0;this.ActiveForm=g;var x=g;var A=this.VisibleForm;if(!x&&this.WelcomeBox&&this.WelcomeBox.style.display=="none"){x=this.WelcomeBox;e=-1000}if(!x&&this.WelcomeForm){x=this.WelcomeForm;e=-1000;if(RD3_Glb.IsSmartPhone()){this.RecalcLayout=true}}if(!A&&this.WelcomeBox&&this.WelcomeBox.style.display!="none"){A=this.WelcomeBox}var p=this.StackForm.length;for(var v=0;v<p;v++){var w=this.StackForm[v];if(w==x){e=v}if(w==A){b=v}}var q=false;if((x==A)||!A||!x){q=true}if(x&&this.WepBox.style.visibility!="hidden"){var o=true;if(A){o=(e<b)}var c=new GFX("form",o,x,q,(A?A:null),x.ShowAnimDef);if(this.CloseFormId!=""){c.CloseFormAnimation=true}RD3_GFXManager.AddEffect(c)}else{if(g){var p=this.StackForm.length;for(var v=0;v<p;v++){var h=this.StackForm[v];if(!h.Modal&&!h.Docked){h.SetActive(false,true)}}g.SetActive(true,true);if(!s&&!z){this.VisibleForm=g}this.ActiveForm=g;this.ActiveForm.Animating=true;var g=this.StackForm.length;for(var j=0;j<g;j++){if(this.StackForm[j].Docked){this.StackForm[j].Animating=true}}this.CmdObj.ActiveFormChanged();this.IndObj.ActiveFormChanged();this.TimerObj.ActiveFormChanged();this.HandleCloseAllVisibility();RD3_DesktopManager.HandleFocus2(this.ActiveForm.Identifier,0)}}}}else{this.ActiveForm=k}};WebEntryPoint.prototype.OnCloseAll=function(b){var a=new IDEvent("claclk",this.Identifier,b,this.CloseAllEventDef)};WebEntryPoint.prototype.OnCloseApp=function(b){var a=new IDEvent("clk","cloapp",b,this.CloseAppEventDef)};WebEntryPoint.prototype.OnHelpButton=function(b){var a=RD3_ClientEvents.OnHelp(this);if(a){RD3_DesktopManager.OpenDocument(this.HelpFile,"help","")}};WebEntryPoint.prototype.HandleCloseAllVisibility=function(){var d=this.GetLastForm();var a=this.GetLastForm(true);var c=a?true:false;var b=d?false:true;if(c!=this.CloseAllVisible){if(this.CloseAllBox){this.CloseAllBox.style.display=c?"":"none"}this.CloseAllVisible=c}if(b!=this.WelcomeBoxVisible){if(this.WelcomeBox){this.WelcomeBox.style.display=b?"":"none"}if(this.WelcomeForm){this.WelcomeForm.SetVisible(b);this.WelcomeForm.SetActive(b)}this.WelcomeBoxVisible=b}this.AdaptFormListBox()};WebEntryPoint.prototype.GetLastForm=function(a){var d=this.StackForm.length;for(var b=d-1;b>=0;b--){var c=this.StackForm[b];if(c.Modal!=0&&!a){continue}if(!c.IsModalPopup()&&!c.Docked&&c.Visible){return c}}return null};WebEntryPoint.prototype.OnBeforeUnload=function(a){if(!this.Redirecting){return RD3_ServerParams.UnloadMessage}};WebEntryPoint.prototype.OnDebug=function(b){var a=RD3_ClientEvents.OnDebug(this);if(a){if(b.ctrlKey){RD3_Debugger.Show()}else{switch(this.DebugType){case 1:if(window.RD4_Enabled){var b=new IDEvent("IWDTT","",b,RD3_Glb.EVENT_ACTIVE)}else{RD3_DesktopManager.OpenDocument("?WCI=IWDTT&WCE=","debug","")}break;case 2:var b=new IDEvent("cmd",this.Identifier,b,RD3_Glb.EVENT_ACTIVE,"DTTHELP");break}}}};WebEntryPoint.prototype.OnClick=function(a){if(this.DisableOnClick>0){this.DisableOnClick--;return}var b=(window.event)?window.event.srcElement:a.explicitOriginalTarget;if(b==this.TaskbarMenuBox){return}this.CmdObj.ClosePopup()};WebEntryPoint.prototype.Focus=function(){var a=false;var b=this.ActiveForm;if(b&&!b.Identifier){b=RD3_DesktopManager.ObjectMap[b]}if(b){a=b.Focus()}if(!a){if(this.CommandInput){this.CommandInput.focus();a=(RD3_KBManager.GetActiveElement()==this.CommandInput)}}return a};WebEntryPoint.prototype.OnBlobUpload=function(a){var d="";if(a){d=a}else{try{var c=RD3_DesktopManager.WebEntryPoint.BlobFrame.contentWindow.document.body;if(c.innerText){d=c.innerText}if(c.textContent){d=c.textContent}}catch(b){}}if(d&&d!=""){d=d.substr(256,d.length-256);this.DelayDialog.Close();RD3_DesktopManager.ProcessXmlText(d)}};WebEntryPoint.prototype.OnCommand=function(c){var b=(c.charCode)?c.charCode:c.keyCode;if(b==13){var a=this.CommandInput.value.toUpperCase();if(a=="JSDEB"){IEDebug()}if(a=="ANI-"||a=="ANIOFF"){RD3_ClientParams.EnableGFX=false}if(a=="AWK-"||a=="AWKOFF"){RD3_ClientParams.UseWebKitGFX=false}if(a=="ANI+"||a=="ANION"){RD3_ClientParams.EnableGFX=true}if(a=="AWK+"||a=="AWKON"){RD3_ClientParams.UseWebKitGFX=true}if(a=="SOUND-"||a=="SND-"||a=="SNDOFF"){RD3_ClientParams.EnableSound=false}if(a=="SOUND+"||a=="SND+"||a=="SNDON"){RD3_ClientParams.EnableSound=true}var c=new IDEvent("cmd",this.Identifier,c,RD3_Glb.EVENT_ACTIVE,a);this.CommandInput.value=""}};WebEntryPoint.prototype.HandleFunctionKeys=function(b){var c=(b.charCode)?b.charCode:b.keyCode;var a=false;a=RD3_DesktopManager.WebEntryPoint.CmdObj.HandleFunctionKeys(b,-1,-1);return a};WebEntryPoint.prototype.Focus=function(){if(this.ActiveForm&&this.ActiveForm.Focus&&this.ActiveForm.Focus()){return true}var b=false;try{this.CommandInput.focus();b=true}catch(a){}return b};WebEntryPoint.prototype.SetHideFocusBox=function(){this.FocusBoxTimerId=window.setTimeout("RD3_DesktopManager.WebEntryPoint.HideFocusBox();",200)};WebEntryPoint.prototype.ResetHideFocusBox=function(){window.clearTimeout(this.FocusBoxTimerId)};WebEntryPoint.prototype.HideFocusBox=function(){if(this.FocusBox.parentNode){this.FocusBox.parentNode.removeChild(this.FocusBox)}};WebEntryPoint.prototype.OnScrollMenuOver=function(b){if(this.SuppressMenu){return}var a=(window.event)?window.event.srcElement:b.explicitOriginalTarget;if(a==this.MenuScrollDown){this.ScrollMenu(1)}else{if(a==this.MenuScrollUp){this.ScrollMenu(-1)}}};WebEntryPoint.prototype.OnScrollMenuOut=function(a){this.ScrollMenu(0)};WebEntryPoint.prototype.ScrollMenu=function(a){this.MenuScrollDir=a;if(a==0){this.AdaptScrollBox()}};WebEntryPoint.prototype.ScrollingMenu=function(){if(this.MenuScrollDir==0){return}var b=(this.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?this.TaskbarMenuBox:this.SideMenuBox;var a=b.scrollTop;b.scrollTop+=this.MenuScrollDir*(RD3_Glb.IsIE()?8:4);if(b.scrollTop==a){this.ScrollMenu(0)}};WebEntryPoint.prototype.AdaptScrollBox=function(){if(this.MenuType==RD3_Glb.MENUTYPE_MENUBAR){return}var a=(this.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?this.TaskbarMenuBox:this.SideMenuBox;if(!this.SuppressMenu&&a.scrollHeight-1>a.clientHeight){if(this.MenuScrollDown){if(!this.SuppressMenu&&a.scrollHeight-a.scrollTop>a.clientHeight+4){this.MenuScrollDown.style.display="block";this.MenuScrollDown.style.top=(a.offsetHeight+a.offsetTop-this.MenuScrollDown.offsetHeight)+"px";this.MenuScrollDown.style.width=(this.MenuBox.offsetWidth)+"px"}else{this.MenuScrollDown.style.display="none"}}if(this.MenuScrollUp){if(!this.SuppressMenu&&a.scrollTop>0){this.MenuScrollUp.style.display="block";this.MenuScrollUp.style.top=a.offsetTop+"px";this.MenuScrollUp.style.width=(this.MenuBox.offsetWidth)+"px"}else{this.MenuScrollUp.style.display="none"}}}else{if(this.MenuScrollDown){this.MenuScrollDown.style.display="none"}if(this.MenuScrollUp){this.MenuScrollUp.style.display="none"}if(a){a.scrollTop=0}}};WebEntryPoint.prototype.OnReadyStateChange=function(){this.AdaptHeader()};WebEntryPoint.prototype.OnMouseOverObj=function(a,b){if(b==this.SuppressMenuBox){this.SuppressMenuBox.className="header-suppress-menu-hover"+((this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB)?"-right":"")}if(b==this.DebugImageBox){this.DebugImageBox.className="header-debug-image-hover"}if(b==this.HelpFileBox){this.HelpFileBox.className="header-help-button-hover"}if(b==this.CloseAppBox){this.CloseAppBox.className="header-close-app-hover"}if(b==this.CloseAllButton||b==this.CloseAllImg||b==this.CloseAllTxt){this.CloseAllImg.className="form-list-close-all-img-hover";this.CloseAllButton.className="form-list-close-all-button-hl";if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){RD3_Glb.AddClass(this.CloseAllButton,"form-list-close-all-button-right")}}};WebEntryPoint.prototype.OnMouseOutObj=function(a,b){if(b==this.SuppressMenuBox){this.SuppressMenuBox.className="header-suppress-menu-hl"+((this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB)?"-right":"")}if(b==this.DebugImageBox){this.DebugImageBox.className="header-debug-image-hl"}if(b==this.HelpFileBox){this.HelpFileBox.className="header-help-button-hl"}if(b==this.CloseAppBox){this.CloseAppBox.className="header-close-app-hl"}if(b==this.CloseAllButton||b==this.CloseAllImg||b==this.CloseAllTxt){this.CloseAllImg.className="form-list-close-all-img";this.CloseAllButton.className="form-list-close-all-button";if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){RD3_Glb.AddClass(this.CloseAllButton,"form-list-close-all-button-right")}}};WebEntryPoint.prototype.OnMouseDownObj=function(a,b){if(b==this.SuppressMenuBox){this.SuppressMenuBox.className="header-suppress-menu-down"+((this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB)?"-right":"")}if(b==this.DebugImageBox){this.DebugImageBox.className="header-debug-image-down"}if(b==this.HelpFileBox){this.HelpFileBox.className="header-help-button-down"}if(b==this.CloseAppBox){this.CloseAppBox.className="header-close-app-down"}if(b==this.CloseAllButton||b==this.CloseAllImg||b==this.CloseAllTxt){this.CloseAllImg.className="form-list-close-all-img-down"}};WebEntryPoint.prototype.OnMouseWheel=function(d){var c=(this.MenuType==RD3_Glb.MENUTYPE_TASKBAR)?this.TaskbarMenuBox:this.SideMenuBox;if(!c){return false}if(this.SuppressMenu||c.scrollHeight-1<=c.clientHeight){return false}var b=window.event?window.event:d;var a=b.srcElement?b.srcElement:b.target;var e=window.event?b.wheelDelta:(b.detail!=0?-b.detail*40:b.wheelDelta);c.scrollTop-=e/2;this.AdaptScrollBox();RD3_Glb.StopEvent(d);return false};WebEntryPoint.prototype.HandleFormStack=function(){if(this.StackForm.length>0){var a=this.ActiveForm?this.ActiveForm.IsModalPopup():false;var e=this.ActiveForm?this.ActiveForm.Docked:false;var h=this.ActiveForm?this.ActiveForm.Modal==0:true;var g=this.StackForm.length;for(var b=0;b<g;b++){var c=this.StackForm[b];if(c==this.ActiveForm){c.SetActive(true,true);this.ActiveForm.AlreadyVisible=true;if(c.Modal==0&&!e){this.VisibleForm=c}}else{c.SetActive(false,h)}}}this.HandleCloseAllVisibility();this.AdaptScrollBox()};WebEntryPoint.prototype.GetMaximizeArea=function(){if(false){var b=new Rect(0,0,document.body.clientWidth,document.body.clientHeight);return b}else{var a=0;var c=4;if(RD3_ServerParams.Theme=="seattle"){a=5;c=10}else{if(RD3_ServerParams.Theme=="zen"){a=10;c=22}}var d=this.FormsBox;var b=new Rect(RD3_Glb.GetScreenLeft(d)+a,RD3_Glb.GetScreenTop(d)+a,d.clientWidth-c,d.clientHeight-c);return b}};WebEntryPoint.prototype.HasSideMenu=function(){return this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB||this.MenuType==RD3_Glb.MENUTYPE_LEFTSB};WebEntryPoint.prototype.OnStartClick=function(c){if(this.TaskbarMenuBox.style.display=="block"){this.CmdObj.ClosePopup()}else{this.CmdObj.ClosePopup();this.TaskbarMenuBox.style.display="block";var a=this.SideMenuBox.offsetTop-this.HeaderBox.offsetHeight-10;var b=this.MenuBox.offsetHeight;if(b<300){b=300}if(b>a){b=a}this.TaskbarMenuBox.style.height=b+"px";this.TaskbarMenuBox.style.top=(this.SideMenuBox.offsetTop-this.TaskbarMenuBox.offsetHeight)+"px";this.TaskbarMenuBox.scrollTop=0;if(RD3_Glb.IsTouch()){this.TaskbarStartCell.style.backgroundPosition="0px -40px"}else{this.TaskbarStartCell.style.backgroundPosition="0px -30px"}this.MenuBox.style.width="100%";this.CmdObj.AdaptLayout();var d=new GFX("taskbar",true,this.TaskbarMenuBox,false);RD3_GFXManager.AddEffect(d)}RD3_Glb.StopEvent(c)};WebEntryPoint.prototype.GetTooltip=function(a,b){if(b==this.CloseAppBox){a.SetTitle(ClientMessages.TIP_TITLE_ChiudiAppl);a.SetText(RD3_ServerParams.ChiudiAppl);a.SetAnchor(RD3_Glb.GetScreenLeft(b),RD3_Glb.GetScreenTop(b)+(b.offsetHeight/2));a.SetPosition(3);return true}if(b==this.SuppressMenuBox){if(this.CmdObj.SuppressMenu){a.SetTitle(ClientMessages.TIP_TITLE_MostraMenu);a.SetText(RD3_ServerParams.MostraMenu)}else{a.SetTitle(ClientMessages.TIP_TITLE_NascondiMenu);a.SetText(RD3_ServerParams.NascondiMenu)}a.SetAnchor(RD3_Glb.GetScreenLeft(b)+b.offsetWidth,RD3_Glb.GetScreenTop(b)+(b.offsetHeight/2));if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){a.SetPosition(3)}else{a.SetPosition(1)}return true}else{if(b==this.DebugImageBox){}else{if(b==this.HelpFileBox){}}}return false};WebEntryPoint.prototype.SoundAction=function(e,o,q,g,f,h,d,c){if(!RD3_ClientParams.EnableSound){return}var v=RD3_ClientParams.SoundDef[e];if(!v){v=e}if(v.indexOf(".")>0&&v.indexOf("/")==-1){var n=window.location.href;var m=n.lastIndexOf("/");if(m>0){n=n.substr(0,m)+"/mmedia/"}v=n+v}if(v.indexOf(".")==-1&&v.indexOf("/")==-1){return}if(RD3_Glb.IsIpad()){return}if(!window.soundManager||!soundManager.supported()){return}if(c){var k=document.getElementById(c);if(!k){var i=RD3_DesktopManager.ObjectMap[c];if(i&&i.GetDOMObj){k=i.GetDOMObj()}}if(k){var b=document.getElementById("sm2-container");if(b){b.style.left=RD3_Glb.GetScreenLeft(k)+"px";b.style.top=RD3_Glb.GetScreenTop(k)+"px";b.style.width=k.clientWidth+"px";b.style.height=k.clientHeight+"px"}}}switch(o){case"play":var r=(c)?soundManager.createVideo({id:e,url:v}):soundManager.createSound({id:e,url:v});if(!r){return}if(q!=undefined&&q!=null){r.setVolume(q)}var u;if(g!=undefined&&g!=null){u=new Function("this.setPosition("+g+");");if(c){r.unload()}r.setPosition(g)}var t;if((f!=undefined&&f!=null)||d){var j="";if((f!=undefined&&f!=null)){j+="if (this.position>"+f+") this.stop();"}if(d){j+="var e = new IDEvent('sound',this.url,null,RD3_Glb.EVENT_ACTIVE,'progress',this.position,this.duration,null,null,1000);"}t=new Function(j)}var a;if(h){a=new Function("var e = new IDEvent('sound',this.url,null,RD3_Glb.EVENT_ACTIVE,'finish');")}r.play({onload:u,whileplaying:t,onfinish:a,onstop:a});break;case"stop":soundManager.stop(e);var b=document.getElementById("sm2-container");if(b){b.style.left="-9999px";b.style.top="-9999px"}break;case"pause":soundManager.pause(e);break;case"continue":soundManager.resume(e);break;case"stopall":soundManager.stopAll();var b=document.getElementById("sm2-container");if(b){b.style.left="-9999px";b.style.top="-9999px"}break}};WebEntryPoint.prototype.SoundAction5=function(k,b,f,h,g,l,a,j){var e=this.GetSoundObject5(k,b=="play");switch(b){case"play":if(e){if(f!=undefined&&f!=null){if(f>1){f=f/100}if(f>1){f=1}if(f<0){f=0}e.volume=f}var d=document.createEvent("MouseEvents");d.initEvent("click",true,true);e.dispatchEvent(d)}break;case"pause":if(e){e.pause()}break;case"stop":if(e){e.pause()}break;case"continue":if(e){e.play()}break;case"stopall":var c;for(c=0;c<this.SoundObjects.length;c++){this.SoundObjects.getItem(c).pause()}break}};function RD3_AudioPlay(b){try{b.srcElement.currentTime=0}catch(a){}b.srcElement.play()}WebEntryPoint.prototype.GetSoundObject5=function(a,b){if(!this.SoundObjects){this.SoundObjects=new HashTable(true)}var c=this.SoundObjects[a];if(!c&&b){c=new Audio(a);c.style.display="none";c.style.position="absolute";c.style.left="0px";c.style.top="0px";c.addEventListener("click",RD3_AudioPlay,true);document.body.appendChild(c);this.SoundObjects[a]=c}return c};WebEntryPoint.prototype.GetDropList=function(b){var c=new Array();var d=new Array();if(this.ActiveForm&&this.ActiveForm.IsModalPopup()){c.push(this.ActiveForm)}else{var h=this.StackForm.length;for(var e=0;e<h;e++){var g=this.StackForm[e];if(g&&g.Realized&&g.FormBox.style.display!="none"){c.push(g)}}}var h=c.length;for(var e=0;e<h;e++){c[e].ComputeDropList(d,b)}this.CmdObj.ComputeDropList(d,b);return d};WebEntryPoint.prototype.OnDrop=function(g,e,c){if(!g||!e){return}var d=g.GetDOMObj().id;var m=e.GetDOMObj().id;var k=c.button;if(RD3_Glb.IsIE()){if(k&1){k=0}else{if(k&2){k=2}else{if(k&4){k=1}}}}var n=c.clientX;var f=c.clientY;var l=n;var j=f;if(g.GetParentFrame){var i=g.GetParentFrame();l=n-RD3_Glb.GetScreenLeft(i.FrameBox);j=f-RD3_Glb.GetScreenTop(i.FrameBox)}if(g instanceof BookBox){l=n-RD3_Glb.GetScreenLeft(g.BoxBox);j=f-RD3_Glb.GetScreenTop(g.BoxBox);var a=new Rect(l,j,0,0);g.AdaptCoords(a);l=a.x;j=a.y}var h=new IDEvent("gdd",d,c,RD3_Glb.EVENT_ACTIVE,m,k,Math.floor(n),Math.floor(f),Math.floor(l),null,false,Math.floor(j));return true};WebEntryPoint.prototype.CompleteCloseFormAnimation=function(b,c){this.TimerObj.FormClosed(b);for(var a=0;a<this.StackForm.length;a++){if(this.StackForm[a]==b){this.StackForm.splice(a,1);break}}b.Unrealize();if(c){this.VisibleForm=null;this.ActiveForm=null}this.CloseFormId=""};WebEntryPoint.prototype.HandleFinishFormAnimation=function(b){this.HandleFormStack();this.CmdObj.ActiveFormChanged();this.IndObj.ActiveFormChanged();this.TimerObj.ActiveFormChanged();var a=this.ActiveForm;if(a){if(b){a.RecalcLayout=true}if(RD3_Glb.IsMobile()&&b&&!this.InResponse){a.AdaptLayout()}if(!RD3_KBManager.DontCheckFocus&&!RD3_Glb.IsMobile()){RD3_DesktopManager.HandleFocus2(a.Identifier,0)}}};WebEntryPoint.prototype.IsTransformable=function(a){if((a=="forms-container"||a.indexOf("dock-container")!=-1)&&RD3_ServerParams.EnableFrameResize){return true}else{return false}};WebEntryPoint.prototype.DragObj=function(b,g,m,i){if(b=="forms-container"||b.indexOf("dock-container")!=-1){var d=m-RD3_Glb.GetScreenLeft(g);var c=i-RD3_Glb.GetScreenTop(g);var j=0;if(d<=10){j=RD3_Glb.FORMDOCK_LEFT}else{if(d>=(g.offsetWidth-10)){j=RD3_Glb.FORMDOCK_RIGHT}else{if(c<=10){j=RD3_Glb.FORMDOCK_TOP}else{if(c>=(g.offsetHeight-10)){j=RD3_Glb.FORMDOCK_BOTTOM}}}}var n=j;if(b.indexOf("left")!=-1&&n!=RD3_Glb.FORMDOCK_TOP&&n!=RD3_Glb.FORMDOCK_BOTTOM){j=RD3_Glb.FORMDOCK_LEFT}else{if(b.indexOf("bottom")!=-1&&n!=RD3_Glb.FORMDOCK_LEFT&&n!=RD3_Glb.FORMDOCK_RIGHT){j=RD3_Glb.FORMDOCK_BOTTOM}else{if(b.indexOf("right")!=-1&&n!=RD3_Glb.FORMDOCK_TOP&&n!=RD3_Glb.FORMDOCK_BOTTOM){j=RD3_Glb.FORMDOCK_RIGHT}else{if(b.indexOf("top")!=-1&&n!=RD3_Glb.FORMDOCK_LEFT&&n!=RD3_Glb.FORMDOCK_RIGHT){j=RD3_Glb.FORMDOCK_TOP}}}}var l=null;var e=this.StackForm.length;for(var o=0;o<e;o++){var h=this.StackForm[o];if(h.Docked&&h.DockType==j){l=h;break}}var k=null;switch(j){case RD3_Glb.FORMDOCK_LEFT:if(b=="forms-container"){if(l){k=l.CanResize()!=0?l:null}else{k=(this.MenuType==RD3_Glb.MENUTYPE_LEFTSB&&RD3_ClientParams.SideMenuResizable)?this:null}}else{if(b.indexOf("dock-container")!=-1&&b.indexOf("right")==-1&&this.MenuType==RD3_Glb.MENUTYPE_LEFTSB&&n==RD3_Glb.FORMDOCK_LEFT){k=RD3_ClientParams.SideMenuResizable?this:null}else{if(b=="left-dock-container"){k=l.CanResize()!=0?l:null}}}break;case RD3_Glb.FORMDOCK_RIGHT:if(b=="forms-container"){if(l){k=l.CanResize()!=0?l:null}else{k=(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB&&RD3_ClientParams.SideMenuResizable)?this:null}}else{if(b.indexOf("dock-container")!=-1&&b.indexOf("left")==-1&&this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB&&n==RD3_Glb.FORMDOCK_RIGHT){k=RD3_ClientParams.SideMenuResizable?this:null}else{if(b=="right-dock-container"){k=l.CanResize()!=0?l:null}}}break;case RD3_Glb.FORMDOCK_TOP:if(b=="forms-container"&&l&&l.CanResize()!=0){k=l}else{if(b.indexOf("dock-container")!=-1&&(b.indexOf("left")==-1||b.indexOf("right")==-1)&&l&&l.CanResize()!=0){k=l}}break;case RD3_Glb.FORMDOCK_BOTTOM:if(b=="forms-container"&&l&&l.CanResize()!=0){k=l}else{if(b.indexOf("dock-container")!=-1&&(b.indexOf("left")==-1||b.indexOf("right")==-1)&&l&&l.CanResize()!=0){k=l}}break}return k}};WebEntryPoint.prototype.DropElement=function(){return this.SideMenuBox};WebEntryPoint.prototype.ApplyCursor=function(e){if(this.MenuType==RD3_Glb.MENUTYPE_LEFTSB){var d=false;var c=RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var a=0;a<c;a++){var b=RD3_DesktopManager.WebEntryPoint.StackForm[a];if(b.Docked){switch(b.DockType){case RD3_Glb.FORMDOCK_LEFT:d=true;this.LeftDockedBox.style.cursor=e;break;case RD3_Glb.FORMDOCK_TOP:this.TopDockedBox.style.cursor=e;break;case RD3_Glb.FORMDOCK_BOTTOM:this.BottomDockedBox.style.cursor=e;break}}}if(!d){this.FormsBox.style.cursor=e}this.SideMenuBox.style.cursor=e}if(this.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){var d=false;var c=RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var a=0;a<c;a++){var b=RD3_DesktopManager.WebEntryPoint.StackForm[a];if(b.Docked){switch(b.DockType){case RD3_Glb.FORMDOCK_RIGHT:d=true;this.RightDockedBox.style.cursor=e;break;case RD3_Glb.FORMDOCK_TOP:this.TopDockedBox.style.cursor=e;break;case RD3_Glb.FORMDOCK_BOTTOM:this.BottomDockedBox.style.cursor=e;break}}}if(!d){this.FormsBox.style.cursor=e}this.SideMenuBox.style.cursor=e}};WebEntryPoint.prototype.CanResizeW=function(){return true};WebEntryPoint.prototype.CanResizeH=function(){return false};WebEntryPoint.prototype.CanResizeL=function(){return true};WebEntryPoint.prototype.CanResizeR=function(){return true};WebEntryPoint.prototype.CanResizeT=function(){return false};WebEntryPoint.prototype.CanResizeD=function(){return false};WebEntryPoint.prototype.OnTransform=function(a,f,b,c,e){if(b<RD3_ClientParams.SideMenuMinWidth){b=RD3_ClientParams.SideMenuMinWidth}var d=new IDEvent("menures",this.Identifier,e,RD3_Glb.EVENT_SERVERSIDE,b);this.SetSideMenuWidth(b)};WebEntryPoint.prototype.RefreshIntervalTick=function(){var a=new IDEvent("rfi",this.Identifier,null,RD3_Glb.EVENT_ACTIVE)};WebEntryPoint.prototype.GetDockedForm=function(a,d){for(var b=0;b<this.StackForm.length;b++){var c=this.StackForm[b];if(c.Docked&&c.DockType==a){if(!d||c.Visible){return c}}}};WebEntryPoint.prototype.AnimateForms=function(e,f,j){var c=RD3_DesktopManager.ObjectMap[e];var b=RD3_DesktopManager.ObjectMap[f];c.EnableIDScroll(false);b.EnableIDScroll(false);c.FormBox.style.display="";b.FormBox.style.display="";RD3_Glb.SetTransitionProperty(c.FormBox,"-webkit-transform");RD3_Glb.SetTransitionProperty(b.FormBox,"-webkit-transform");RD3_Glb.SetTransitionDuration(c.FormBox,"0ms");RD3_Glb.SetTransitionDuration(b.FormBox,"0ms");var i=0;var g=0;var d=0;var a=0;if(j){f1ini=0;f1fin=-this.FormsBox.offsetWidth;f2ini=this.FormsBox.offsetWidth;f2fin=0}else{f1ini=-this.FormsBox.offsetWidth;f1fin=0;f2ini=0;f2fin=this.FormsBox.offsetWidth}RD3_Glb.SetTransform(c.FormBox,"translate3d("+f1ini+"px,0px,0px)");RD3_Glb.SetTransform(b.FormBox,"translate3d("+f2ini+"px,0px,0px)");var h="RD3_Glb.SetTransitionDuration(document.getElementById('"+c.FormBox.id+"'), '250ms');";h+="RD3_Glb.SetTransitionDuration(document.getElementById('"+b.FormBox.id+"'), '250ms');";h+="RD3_Glb.SetTransform(document.getElementById('"+c.FormBox.id+"'), 'translate3d("+f1fin+"px,0px,0px)');";h+="RD3_Glb.SetTransform(document.getElementById('"+b.FormBox.id+"'), 'translate3d("+f2fin+"px,0px,0px)');";if(!this.ea){this.ea=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnEndAnimation', ev)")}RD3_Glb.AddEndTransaction(c.FormBox,this.ea,false);window.setTimeout(h,30);this.AniForm1=c;this.AniForm2=b;this.AniMode=j};WebEntryPoint.prototype.OnEndAnimation=function(b){if(RD3_Glb.GetTransitionDuration(this.AniForm1.FormBox)=="0ms"){return}RD3_Glb.RemoveEndTransaction(this.AniForm1.FormBox,this.ea,false);RD3_Glb.SetTransitionProperty(this.AniForm1.FormBox,"");RD3_Glb.SetTransitionProperty(this.AniForm2.FormBox,"");RD3_Glb.SetTransitionDuration(this.AniForm1.FormBox,"");RD3_Glb.SetTransitionDuration(this.AniForm2.FormBox,"");RD3_Glb.SetTransform(this.AniForm1.FormBox,"");RD3_Glb.SetTransform(this.AniForm2.FormBox,"");this.AniForm1.EnableIDScroll(true);this.AniForm2.EnableIDScroll(true);if(this.AniMode){this.ActivateForm(this.AniForm2,true)}else{this.CloseForm2(this.AniForm2);for(var a=0;a<this.AniForm1.Frames.length;a++){if(this.AniForm1.Frames[a] instanceof IDPanel){this.AniForm1.Frames[a].HiliteRow(0)}}}this.AniForm1=undefined;this.AniForm2=undefined;this.AniMode=undefined;if(this.FormToActivate){var c=this.FormToActivate;this.FormToActivate=null;this.ActivateForm(c)}};WebEntryPoint.prototype.OnBackButton=function(){var a=RD3_DesktopManager.MessagePump;if(window.RD4_Enabled){a=RD3_DesktopManager.MessagePumpRD4}if(a.DelayDlg.Opened){return true}if(RD3_DDManager.OpenCombo){RD3_DDManager.OpenCombo.Close();return true}var d=this.WepBox.lastChild.id;if(d.substr(0,6)=="MSGBOX"||d.substr(0,5)=="POPUP"){var c=RD3_DesktopManager.ObjectMap[d.substr(0,d.lastIndexOf(":"))];if(c instanceof MessageBox){if(c.Type==RD3_Glb.MSG_BOX){c.OnOKClick({})}else{if(c.CancelButton&&c.CancelButton.style.display==""){c.OnCancelClick({})}}return true}if(c instanceof PopupControl){c.Close();return true}}if(RD3_Glb.IsSmartPhone()&&this.SideMenuBox&&this.SideMenuBox.style.display==""){if(this.CmdObj.ActiveCommand&&this.CmdObj.ActiveCommand.IsCmdSet){this.CmdObj.ActiveCommand.OnBack({});return true}if(this.CmdObj.HandleBackButton()){return true}}if(!RD3_Glb.IsSmartPhone()&&this.CmdObj.MenuButton&&this.CmdObj.MenuButton.style.display==""){for(var b=0;b<RD3_DDManager.iOpenPopup.length;b++){if(RD3_DDManager.iOpenPopup[b].ObjToAttach==this.CmdObj.MenuButton){if(this.CmdObj.ActiveCommand&&this.CmdObj.ActiveCommand.IsCmdSet){this.CmdObj.ActiveCommand.OnBack({});return true}else{RD3_DDManager.iOpenPopup[b].OnClickOut({});return true}}}}if(this.ActiveForm&&this.ActiveForm.OnBackButton()){return true}if(!RD3_Glb.IsSmartPhone()&&this.SideMenuBox&&this.SideMenuBox.style.display==""){if(this.CmdObj.ActiveCommand&&this.CmdObj.ActiveCommand.IsCmdSet){this.CmdObj.ActiveCommand.OnBack({});return true}}if(RD3_ShellObject.IsInsideShell()){RD3_ShellObject.SendCmd("EXIT")}else{top.close()}};WebEntryPoint.prototype.GetScreenZone=function(c){for(var b=0;b<this.ScreenZones.length;b++){var a=this.ScreenZones[b];if(a&&a.Position==c){return a}}return null};WebEntryPoint.prototype.OnIconClick=function(a){if(this.IsIconActive()){RD3_SendCommand("IconClick")}};WebEntryPoint.prototype.OnTouchDown=function(c){var b=0;var a=0;if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){b=c.targetTouches[0].screenX;a=c.targetTouches[0].screenY}else{if(RD3_Glb.IsIE(10,true)){b=(window.event)?window.event.screenX:c.screenX;a=(window.event)?window.event.screenY:c.screenY}}if(b<=40){this.SwipeSide=RD3_Glb.SWIPE_LEFT;this.SwipeIn=true}else{if(b>=this.WepBox.offsetWidth-40){this.SwipeSide=RD3_Glb.SWIPE_RIGHT;this.SwipeIn=true}else{if(a<=40){this.SwipeSide=RD3_Glb.SWIPE_TOP;this.SwipeIn=true}else{if(a>=this.WepBox.offsetHeight-40){this.SwipeSide=RD3_Glb.SWIPE_BOTTOM;this.SwipeIn=true}else{if(b<=300){if(a>=0&&a<=300){this.SwipeSide=RD3_Glb.SWIPE_TOPLEFT}else{if(a>=this.WepBox.offsetHeight-300){this.SwipeSide=RD3_Glb.SWIPE_BOTTOMLEFT}else{this.SwipeSide=RD3_Glb.SWIPE_LEFT}}this.SwipeIn=false}else{if(b>=this.WepBox.offsetWidth-300){if(a<=300){this.SwipeSide=RD3_Glb.SWIPE_TOPRIGHT}else{if(a>=this.WepBox.offsetHeight-300){this.SwipeSide=RD3_Glb.SWIPE_BOTTOMRIGHT}else{this.SwipeSide=RD3_Glb.SWIPE_RIGHT}}this.SwipeIn=false}else{if(a<=300){this.SwipeSide=RD3_Glb.SWIPE_TOP;this.SwipeIn=false}else{if(a>=this.WepBox.offsetHeight-300){this.SwipeSide=RD3_Glb.SWIPE_BOTTOM;this.SwipeIn=false}}}}}}}}if(this.SwipeSide&&(this.SwipeSide>=RD3_Glb.SWIPE_LEFT&&this.SwipeSide<=RD3_Glb.SWIPE_BOTTOMRIGHT)){this.TouchOrgX=b;this.TouchOrgY=a;this.TrackMove=true}return true};WebEntryPoint.prototype.OnTouchMove=function(h){if(this.TrackMove){var g=0;var e=0;if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){g=h.targetTouches[0].screenX;e=h.targetTouches[0].screenY}else{if(RD3_Glb.IsIE(10,true)){g=(window.event)?window.event.screenX:h.screenX;e=(window.event)?window.event.screenY:h.screenY}}if(this.SwipeIn){switch(this.SwipeSide){case RD3_Glb.SWIPE_LEFT:if((g-this.TouchOrgX>RD3_Glb.SwipeDelta)&&(e>=this.TouchOrgY-RD3_Glb.SwipeLimit&&e<=this.TouchOrgY+RD3_Glb.SwipeLimit)){this.TrackMove=false;var a=this.GetScreenZone(RD3_Glb.FORMDOCK_LEFT);if(a){a.OnSwipeZone(this.SwipeIn)}}break;case RD3_Glb.SWIPE_RIGHT:if((g<=this.TouchOrgX-RD3_Glb.SwipeDelta)&&(e>=this.TouchOrgY-RD3_Glb.SwipeLimit&&e<=this.TouchOrgY+RD3_Glb.SwipeLimit)){this.TrackMove=false;var a=this.GetScreenZone(RD3_Glb.FORMDOCK_RIGHT);if(a){a.OnSwipeZone(this.SwipeIn)}}break;case RD3_Glb.SWIPE_TOP:if((e-this.TouchOrgY>RD3_Glb.SwipeDelta)&&(g>=this.TouchOrgX-RD3_Glb.SwipeLimit&&g<=this.TouchOrgX+RD3_Glb.SwipeLimit)){this.TrackMove=false;var a=this.GetScreenZone(RD3_Glb.FORMDOCK_TOP);if(a){a.OnSwipeZone(this.SwipeIn)}}break;case RD3_Glb.SWIPE_BOTTOM:if((e<=this.TouchOrgY-RD3_Glb.SwipeDelta)&&(g>=this.TouchOrgX-RD3_Glb.SwipeLimit&&g<=this.TouchOrgX+RD3_Glb.SwipeLimit)){this.TrackMove=false;var a=this.GetScreenZone(RD3_Glb.FORMDOCK_BOTTOM);if(a){a.OnSwipeZone(this.SwipeIn)}}break}}else{switch(this.SwipeSide){case RD3_Glb.SWIPE_LEFT:if((this.TouchOrgX-g>=RD3_Glb.SwipeDelta)&&(e>=this.TouchOrgY-RD3_Glb.SwipeLimit&&e<=this.TouchOrgY+RD3_Glb.SwipeLimit)){this.TrackMove=false;var a=this.GetScreenZone(RD3_Glb.FORMDOCK_LEFT);if(a){a.OnSwipeZone(this.SwipeIn)}}break;case RD3_Glb.SWIPE_RIGHT:if((g-this.TouchOrgX>=RD3_Glb.SwipeDelta)&&(e>=this.TouchOrgY-RD3_Glb.SwipeLimit&&e<=this.TouchOrgY+RD3_Glb.SwipeLimit)){this.TrackMove=false;var a=this.GetScreenZone(RD3_Glb.FORMDOCK_RIGHT);if(a){a.OnSwipeZone(this.SwipeIn)}}break;case RD3_Glb.SWIPE_TOP:if((this.TouchOrgY-e>=RD3_Glb.SwipeDelta)&&(g>=this.TouchOrgX-RD3_Glb.SwipeLimit&&g<=this.TouchOrgX+RD3_Glb.SwipeLimit)){this.TrackMove=false;var a=this.GetScreenZone(RD3_Glb.FORMDOCK_TOP);if(a){a.OnSwipeZone(this.SwipeIn)}}break;case RD3_Glb.SWIPE_BOTTOM:if((e-this.TouchOrgY>=RD3_Glb.SwipeDelta)&&(g>=this.TouchOrgX-RD3_Glb.SwipeLimit&&g<=this.TouchOrgX+RD3_Glb.SwipeLimit)){this.TrackMove=false;var a=this.GetScreenZone(RD3_Glb.FORMDOCK_BOTTOM);if(a){a.OnSwipeZone(this.SwipeIn)}}break;case RD3_Glb.SWIPE_TOPLEFT:var d=this.TouchOrgX-g;var c=this.TouchOrgY-e;if(d>=RD3_Glb.SwipeDelta){this.SwipeSide=RD3_Glb.SWIPE_LEFT;this.OnTouchMove(h)}else{if(c>=RD3_Glb.SwipeDelta){this.SwipeSide=RD3_Glb.SWIPE_TOP;this.OnTouchMove(h)}}break;case RD3_Glb.SWIPE_BOTTOMLEFT:var d=this.TouchOrgX-g;var b=e-this.TouchOrgY;if(d>=RD3_Glb.SwipeDelta){this.SwipeSide=RD3_Glb.SWIPE_LEFT;this.OnTouchMove(h)}else{if(b>=RD3_Glb.SwipeDelta){this.SwipeSide=RD3_Glb.SWIPE_BOTTOM;this.OnTouchMove(h)}}break;case RD3_Glb.SWIPE_TOPRIGHT:var f=g-this.TouchOrgX;var c=this.TouchOrgY-e;if(f>=RD3_Glb.SwipeDelta){this.SwipeSide=RD3_Glb.SWIPE_RIGHT;this.OnTouchMove(h)}else{if(c>=RD3_Glb.SwipeDelta){this.SwipeSide=RD3_Glb.SWIPE_TOP;this.OnTouchMove(h)}}break;case RD3_Glb.SWIPE_BOTTOMRIGHT:var f=g-this.TouchOrgX;var b=e-this.TouchOrgY;if(f>=RD3_Glb.SwipeDelta){this.SwipeSide=RD3_Glb.SWIPE_RIGHT;this.OnTouchMove(h)}else{if(b>=RD3_Glb.SwipeDelta){this.SwipeSide=RD3_Glb.SWIPE_BOTTOM;this.OnTouchMove(h)}}break}}}return true};WebEntryPoint.prototype.OnTouchUp=function(a){this.TrackMove=false;this.SwipeSide=null;return true};WebEntryPoint.prototype.UseZones=function(){return RD3_ServerParams.UseZones&&!RD3_Glb.IsSmartPhone()};function WebForm(){this.Identifier="";this.IdxForm=0;this.Caption="";this.WebCaption="";this.Image="";this.Modal=0;this.Docked=false;this.DockType=0;this.Visible=true;this.ToolbarPosition=RD3_Glb.FORMTOOL_LEFT;this.BorderType=RD3_Glb.BORDER_THICK;this.WindowState=RD3_Glb.WS_NORMAL;this.VisualFlags=-1;this.FormLeft=-1;this.FormTop=-1;this.FormWidth=-1;this.FormHeight=-1;this.NormalLeft=null;this.NormalTop=null;this.NormalWidth=null;this.NormalHeight=null;this.NormalWindowState=null;this.ResModeW=RD3_Glb.FRESMODE_NONE;this.ResModeH=RD3_Glb.FRESMODE_NONE;this.PreviewFrame=null;this.HandledKeys=0;this.BackButtonTxt=null;this.CloseOnSelection=false;this.Frames=new Array();this.Messages=new Array();this.AlreadyVisible=false;this.Animating=false;this.OpenX=0;this.OpenY=0;this.PopupResAnim=false;this.PopupResAnimating=false;this.PopupRect=new Rect(-1,-1,-1,-1);this.ClickEventDef=RD3_Glb.EVENT_ACTIVE;this.ClickFLEventDef=RD3_Glb.EVENT_ACTIVE;this.ResizeEventDef=RD3_Glb.EVENT_ACTIVE;this.Realized=false;this.RecalcLayout=false;this.AdaptToolbar=false;this.NoOpacity=true;this.RecalcCommands=false;this.AfterPopupResizeHide=false;this.FormBox=null;this.CaptionBox=null;this.ImgIcon=null;this.CloseBtn=null;this.ConfirmBtn=null;this.MinBtn=null;this.MaxBtn=null;this.HelpBtn=null;this.DebugBtn=null;this.CaptionTxt=null;this.FramesBox=null;this.MessagesBox=null;this.PopupFrame=null;this.FLBox=null;this.FLImg=null;this.FLCaption=null}WebForm.prototype.LoadFromXml=function(e){this.LoadProperties(e);var m=e.childNodes;var c=m.length;for(var h=0;h<c;h++){var g=m.item(h);var a=g.nodeName;switch(a){case"msg":var d=new Message(this);d.LoadFromXml(g);var k=false;var o=this.Messages.length;for(var l=0;l<o;l++){if(this.Messages[l].EqualsTo(d)){k=true;this.Messages[l].Request=RD3_DesktopManager.CurrentRequest}}if(!k){this.Messages.push(d)}break;case"wfr":var b=new WebFrame(this);this.Frames.push(b);b.LoadFromXml(g);break;case"bbr":var b=new ButtonBar(this);b.LoadFromXml(g);this.Frames.push(b);break;case"tre":var b=new Tree(this);b.LoadFromXml(g);this.Frames.push(b);break;case"book":var b=new Book(this);b.LoadFromXml(g);this.Frames.push(b);break;case"pan":var b=new IDPanel(this);this.Frames.push(b);b.LoadFromXml(g);break;case"suf":var b=new SubForm(this);this.Frames.push(b);b.LoadFromXml(g);break;case"gra":var b=new Graph(this);b.LoadFromXml(g);this.Frames.push(b);break;case"tbv":var b=new TabbedView(this);b.LoadFromXml(g);this.Frames.push(b);break;case"tmh":RD3_DesktopManager.WebEntryPoint.TimerObj.LoadFromXml(g,true);break;case"cmh":RD3_DesktopManager.WebEntryPoint.CmdObj.LoadFromXml(g,true);break}}if(!this.Realized){var c=this.Frames.length;for(var h=0;h<c;h++){var j=this.Frames[h];if(j.ChildFrame1&&(typeof j.ChildFrame1=="string")){j.ChildFrame1=RD3_DesktopManager.ObjectMap[j.ChildFrame1]}if(j.ChildFrame2&&(typeof j.ChildFrame2=="string")){j.ChildFrame2=RD3_DesktopManager.ObjectMap[j.ChildFrame2]}}}};WebForm.prototype.ChangeProperties=function(a){this.LoadFromXml(a);this.RealizeMessages();this.PopupPreview()};WebForm.prototype.LoadProperties=function(e){var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"idx":this.SetFormIndex(parseInt(a));break;case"cap":this.SetCaption(a);break;case"wcp":this.SetWebCaption(a);break;case"img":this.SetImage(a);break;case"mod":this.SetModal(parseInt(a));break;case"doc":this.SetDocked(a=="1");break;case"dot":this.SetDockType(parseInt(a));break;case"vis":this.SetVisible(a=="1",true);break;case"tbp":this.SetToolbarPosition(parseInt(a));break;case"bdt":this.SetBorderType(parseInt(a));break;case"vfl":this.SetVisualFlags(parseInt(a));break;case"wst":this.SetWindowState(parseInt(a));break;case"lef":this.SetFormLeft(parseInt(a));break;case"top":this.SetFormTop(parseInt(a));break;case"wid":this.SetFormWidth(parseInt(a));break;case"hei":this.SetFormHeight(parseInt(a));break;case"rew":this.SetResModeW(parseInt(a));break;case"reh":this.SetResModeH(parseInt(a));break;case"pre":this.SetPreview(a);break;case"hks":this.SetHandledKeys(parseInt(a));break;case"bbt":this.SetBackButtonText(a);break;case"cln":this.SetClassName(a);break;case"clk":this.ClickEventDef=parseInt(a);break;case"flc":this.ClickFLEventDef=parseInt(a);break;case"res":this.ResizeEventDef=parseInt(a);break;case"cls":this.CloseOnSelection=(a=="1");break;case"sha":this.ShowAnimDef=a;break;case"mda":this.ModalAnimDef=a;break;case"mga":this.MessageAnimDef=a;break;case"lma":this.LastMessageAnimDef=a;break;case"pra":this.PreviewAnimDef=a;break;case"dka":this.DockedAnimDef=a;break;case"ppr":this.PopResAnimDef=a;break;case"own":this.Owner=a;break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}};WebForm.prototype.SetFormIndex=function(a){this.IdxForm=a};WebForm.prototype.SetModal=function(a){this.Modal=a};WebForm.prototype.SetDocked=function(a){this.Docked=a};WebForm.prototype.SetDockType=function(d){var a=this.DockType;this.DockType=d;if(this.DockType!=a&&this.Realized&&RD3_DesktopManager.WebEntryPoint.UseZones()){var e=RD3_DesktopManager.WebEntryPoint;if(a!=0){var b=e.GetScreenZone(a);b.RemoveForm(this)}else{if(this.FLBox&&this.FLBox.parentNode){this.FLBox.parentNode.removeChild(this.FLBox)}}var f=e.GetScreenZone(this.DockType);var c=f.AddForm(this);c.appendChild(this.FormBox);if(this.ParentTab){this.ParentTab.SetHeader(RD3_Glb.RemoveTags(this.Caption))}}};WebForm.prototype.SetToolbarPosition=function(a){this.ToolbarPosition=a};WebForm.prototype.SetBorderType=function(a){this.BorderType=a};WebForm.prototype.SetVisualFlags=function(a){this.VisualFlags=a};WebForm.prototype.SetResModeW=function(a){this.ResModeW=a};WebForm.prototype.SetResModeH=function(a){this.ResModeH=a};WebForm.prototype.SetCaption=function(a){if(a!=undefined){this.Caption=a}if(this.Realized){if(this.Caption!=""&&this.HasCaption()){if(this.FLCaption){this.FLCaption.innerHTML=RD3_Glb.RemoveTags(this.Caption);if(this.FLCaption.clientWidth>0){this.AdaptFormListLayout()}}if(this.FLBox){this.FLBox.style.display=""}}else{if(this.FLBox){this.FLBox.style.display="none"}}if(this.ParentTab){this.ParentTab.SetHeader(RD3_Glb.RemoveTags(this.Caption))}}};WebForm.prototype.SetWebCaption=function(d){if(d!=undefined){this.WebCaption=d}if(this.Realized){if(this.WebCaption!=""&&this.HasCaption()){this.CaptionTxt.innerHTML=this.WebCaption;var a=this.CaptionTxt.childNodes;var e=a.length;for(var c=0;c<e;c++){try{a.item(c).id=this.CaptionTxt.id}catch(b){}}this.CaptionBox.style.display="";this.FramesBox.style.paddingTop=""}else{this.CaptionBox.style.display="none";this.FramesBox.style.paddingTop="0px"}this.AdaptToolbar=true}};WebForm.prototype.SetImage=function(a){if(a!=undefined){this.Image=a}if(this.Realized&&this.ImgIcon){if(this.Image==""){this.ImgIcon.style.display="none";if(this.FLImg&&this.FLImg.tagName=="IMG"){this.FLImg.style.display="none"}}else{this.ImgIcon.src=RD3_Glb.GetImgSrc("images/"+this.Image);this.ImgIcon.style.display="";if(this.FLImg&&this.FLImg.tagName=="IMG"){this.FLImg.style.display="";this.FLImg.src=this.ImgIcon.src}if(RD3_Glb.Adapt4Retina(this.Identifier,this.Image,43)){if(this.ImgIcon){this.ImgIcon.style.display="none"}if(this.FLImg&&this.FLImg.tagName=="IMG"){this.FLImg.style.display="none"}}}this.AdaptToolbar=true;if(this.ParentTab){this.ParentTab.SetImage(this.Image)}}};WebForm.prototype.SetWindowState=function(f){var b=this.WindowState;if(f!=undefined){this.WindowState=f}if(this.Realized&&(b!=this.WindowState||f==undefined)){if(this.Modal){switch(this.WindowState){case RD3_Glb.WS_NORMAL:this.PopupFrame.SetVisible(true);if(this.NormalLeft!=null){this.SetFormLeft(this.NormalLeft,false);this.SetFormTop(this.NormalTop,false);this.SetFormWidth(this.NormalWidth,false);this.SetFormHeight(this.NormalHeight,false)}else{if(f!=undefined){this.AdaptLayout()}}if(this.MaxBtn){this.MaxBtn.src=RD3_Glb.GetImgSrc("images/fmax.gif")}if(f!=undefined){var e=new IDEvent("repos",this.Identifier,null,this.ResizeEventDef,null,this.FormLeft,this.FormTop)}break;case RD3_Glb.WS_MAXIMIZE:this.PopupFrame.ShowThickBorders(false);this.PopupFrame.SetVisible(true);if(b==RD3_Glb.WS_NORMAL){this.NormalLeft=this.FormLeft;this.NormalTop=this.FormTop;this.NormalWidth=this.FormWidth;this.NormalHeight=this.FormHeight}if(this.MaxBtn){this.MaxBtn.src=RD3_Glb.GetImgSrc("images/fnor.gif")}var d=RD3_DesktopManager.WebEntryPoint.GetMaximizeArea();var g=new Rect(this.FormLeft,this.FormTop,this.FormWidth,this.FormHeight);this.SetFormLeft(d.x,false);this.SetFormTop(d.y,false);this.SetFormWidth(d.w,false);this.SetFormHeight(d.h,false);if(d.x!=this.FormLeft||d.y!=this.FormTop||d.w!=this.FormWidth||d.h!=this.FormHeight){var e=new IDEvent("repos",this.Identifier,null,this.ResizeEventDef,null,this.FormLeft,this.FormTop)}break;case RD3_Glb.WS_MINIMIZE:this.NormalWindowState=b;if(b==RD3_Glb.WS_NORMAL){this.NormalLeft=this.FormLeft;this.NormalTop=this.FormTop;this.NormalWidth=this.FormWidth;this.NormalHeight=this.FormHeight}var a=0;var c=0;if(this.Modal==2&&this.FLBox){a=RD3_Glb.GetScreenLeft(this.FLBox)+Math.floor(this.FLBox.offsetWidth/2);c=RD3_Glb.GetScreenTop(this.FLBox)+Math.floor(this.FLBox.offsetHeight/2);if(c>document.body.offsetHeight){c=document.body.offsetHeight-10}if(a>document.body.offsetWidth){a=document.body.offsetWidth-10}}else{switch(RD3_DesktopManager.WebEntryPoint.MenuType){case RD3_Glb.MENUTYPE_LEFTSB:a=0;c=Math.floor(document.body.offsetHeight/2);break;case RD3_Glb.MENUTYPE_RIGHTSB:a=document.body.offsetWidth;c=Math.floor(document.body.offsetHeight/2);break;case RD3_Glb.MENUTYPE_MENUBAR:a=Math.floor(document.body.offsetWidth/2);c=0;break;case RD3_Glb.MENUTYPE_TASKBAR:a=Math.floor(document.body.offsetWidth/2);c=document.body.offsetHeight;break}}if(RD3_Glb.IsTouch()){c=-20;a=0}this.SetFormLeft(a,false);this.SetFormTop(c,false);this.SetFormWidth(1,false);this.SetFormHeight(1,false);this.AfterPopupResizeHide=true;break}}else{this.WindowState=RD3_Glb.WS_NORMAL}}};WebForm.prototype.AfterPopupResizeFinish=function(){if(this.AfterPopupResizeHide){this.AfterPopupResizeHide=false;this.PopupFrame.SetVisible(false);return false}return true};WebForm.prototype.SetVisible=function(d,b){var a=this.Visible;if(d!=undefined){this.Visible=d}if(this.Realized&&(a!=this.Visible||d==undefined)){if(b){if(this.Docked){var c=new GFX("docked",this.Visible,this,false);c.CloseFormAnimation=false;RD3_GFXManager.AddEffect(c);return}if(this.Modal==0){if(this.FLBox){this.FLBox.style.display=this.Visible?"":"none";if(this.Visible){this.AdaptFormListLayout()}}return}if(this.Modal!=0){var c=new GFX("modal",this.Visible,this,false);c.CloseFormAnimation=false;RD3_GFXManager.AddEffect(c);if(this.FLBox){this.FLBox.style.display=this.Visible?"":"none";if(this.Visible){this.AdaptFormListLayout()}}}}else{this.FormBox.style.display=this.Visible?"":"none";if(this.FLBox){this.FLBox.style.display=this.Visible?"":"none";if(this.Visible){this.AdaptFormListLayout()}}}}};WebForm.prototype.SetFormLeft=function(c,d){if(c!=undefined){var a=this.FormLeft;this.FormLeft=c;this.PopupRect.x=(d)?this.FormLeft:a}if(this.Realized&&this.Modal){if(d){var b=true;if(RD3_Glb.IsMobile()&&this.PopupFrame.ObjToAttach&&this.FormLeft==-1){b=false}if(b){this.PopupFrame.SetLeft(this.FormLeft)}}else{this.PopupResAnim=true}}};WebForm.prototype.SetFormTop=function(c,d){if(c!=undefined){var a=this.FormTop;this.FormTop=c;this.PopupRect.y=(d)?this.FormTop:a}if(this.Realized&&this.Modal){if(d){var b=true;if(RD3_Glb.IsMobile()&&this.PopupFrame.ObjToAttach&&this.FormLeft==-1){b=false}if(b){this.PopupFrame.SetTop(this.FormTop)}}else{this.PopupResAnim=true}}};WebForm.prototype.SetFormWidth=function(b,c){if(b!=undefined){var a=this.FormWidth;this.FormWidth=b;this.PopupRect.w=(c)?this.FormWidth:a}if(this.Realized&&this.FormWidth>0){if(this.Modal){if(c){this.PopupFrame.SetWidth(this.FormWidth);this.RecalcLayout=true}else{this.PopupResAnim=true}}else{if(this.Docked&&b!=undefined){this.OnTransform(0,0,this.FormWidth,this.FormHeight)}}}};WebForm.prototype.SetFormHeight=function(b,c){if(b!=undefined){var a=this.FormHeight;this.FormHeight=b;this.PopupRect.h=(c)?this.FormHeight:a}if(this.Realized&&this.FormHeight>0){if(this.Modal){if(c){this.PopupFrame.SetHeight(this.FormHeight);this.RecalcLayout=true}else{this.PopupResAnim=true}}else{if(this.Docked&&b!=undefined){this.OnTransform(0,0,this.FormWidth,this.FormHeight)}}}};WebForm.prototype.SetHandledKeys=function(a){if(a!=undefined){this.HandledKeys=a}};WebForm.prototype.SetBackButtonText=function(b){if(b!=undefined){this.BackButtonTxt=b}if(this.Realized&&this.BackButtonCnt){var a=false;if(this.HasBackButton()&&this.BackButtonTxt&&this.BackButtonTxt.length>0){this.CaptureToolbarButton(this.BackButtonCnt);this.BackButton.textContent=this.BackButtonTxt;a=true}else{if(this.BackButtonCnt.parentNode){this.BackButtonCnt.parentNode.removeChild(this.BackButtonCnt);a=true}}if(a){if(this.HasCaption()){this.AdaptToolbar=true}else{this.GetFirstToolbar(true)}}}};WebForm.prototype.SetClassName=function(b){var a=this.ClassName;if(b!=undefined){this.ClassName=b}if(this.Realized){if(a){RD3_Glb.RemoveClass(this.FormBox,a)}if(this.ClassName){RD3_Glb.AddClass(this.FormBox,this.ClassName)}}};WebForm.prototype.SetPreview=function(a){this.PreviewFrame=a};WebForm.prototype.PopupPreview=function(){if(this.PreviewFrame&&!this.PreviewFrame.Identifier){if(!RD3_DesktopManager.WebEntryPoint.Realized){return}this.PreviewFrame=RD3_DesktopManager.ObjectMap[this.PreviewFrame];if(this.PreviewFrame){this.PreviewFrame.IsPreview=true;if(this.Frames[0].FrameBox){this.Frames[0].FrameBox.style.display="none"}else{this.Frames[0].ChildBox1.style.display="none";this.Frames[0].ChildBox2.style.display="none"}this.PreviewFrame.Realize(this.FramesBox);RD3_Glb.AdaptToParent(this.PreviewFrame.FrameBox,0,2);if(this.PreviewFrame instanceof Book&&this.PreviewFrame.Pages.length>0){var c=this.PreviewFrame.Pages[this.PreviewFrame.ActivePage].PageBox;var d=c.offsetHeight+1;var b=c.offsetWidth+6;if(!this.PreviewFrame.HideBorder){d+=4;b+=4}var a=this.PreviewFrame.FrameBox.offsetHeight;var f=this.PreviewFrame.FrameBox.offsetWidth;if(a>(d+32)){this.PreviewFrame.FrameBox.style.height=(d+32)+"px"}else{b+=18}if(f>b){this.PreviewFrame.FrameBox.style.width=b+"px"}}this.PreviewFrame.FrameBox.style.zIndex=100;this.PreviewFrame.AdaptLayout();var e=new GFX("preview",true,this,false,null,this.PreviewAnimDef);RD3_GFXManager.AddEffect(e)}}};WebForm.prototype.ClosePreview=function(){if(this.PreviewFrame){var a=new GFX("preview",false,this,false,null,this.PreviewAnimDef);RD3_GFXManager.AddEffect(a)}};WebForm.prototype.Realize=function(){var n;var m=RD3_Glb.IsMobile();var c=RD3_Glb.IsMobile7();if(this.SubFormObj){if(this.SubFormObj instanceof SubForm){n=this.SubFormObj.ContentBox}else{if(this.SubFormObj instanceof BookBox){n=this.SubFormObj.BoxBox}}}else{n=RD3_DesktopManager.WebEntryPoint.FormsBox}if(this.Modal){this.PopupFrame=new PopupFrame(this);if(this.Modal==2){if(m){this.PopupFrame.AutoClose=true}else{this.PopupFrame.Modal=false}}if(this.Modal==1&&m&&this.CloseOnSelection){this.PopupFrame.AutoClose=true}this.LastActiveObject=RD3_KBManager.ActiveObject;this.LastActiveElement=RD3_KBManager.ActiveElement;if(this.FormLeft!=-1){this.PopupFrame.SetLeft(this.FormLeft)}if(this.FormTop!=-1){this.PopupFrame.SetTop(this.FormTop)}if(this.FormWidth!=-1){this.PopupFrame.SetWidth(this.FormWidth)}if(this.FormHeight!=-1){this.PopupFrame.SetHeight(this.FormHeight)}this.PopupFrame.HasCaption=false;this.PopupFrame.Borders=this.BorderType;this.PopupFrame.Realize(this.Modal==2?"-popover":"-modal");n=this.PopupFrame.ContentBox;this.OpenX=RD3_DesktopManager.MessagePump.XPos;this.OpenY=RD3_DesktopManager.MessagePump.YPos}if(this.Docked){if(!RD3_DesktopManager.WebEntryPoint.UseZones()){if(this.DockType==RD3_Glb.FORMDOCK_LEFT){n=RD3_DesktopManager.WebEntryPoint.LeftDockedBox;n.className="left-dock-container-visible"}if(this.DockType==RD3_Glb.FORMDOCK_TOP){n=RD3_DesktopManager.WebEntryPoint.TopDockedBox;n.className="top-dock-container-visible"}if(this.DockType==RD3_Glb.FORMDOCK_RIGHT){n=RD3_DesktopManager.WebEntryPoint.RightDockedBox;n.className="right-dock-container-visible"}if(this.DockType==RD3_Glb.FORMDOCK_BOTTOM){n=RD3_DesktopManager.WebEntryPoint.BottomDockedBox;n.className="bottom-dock-container-visible"}}else{var d=RD3_DesktopManager.WebEntryPoint.GetScreenZone(this.DockType);n=d.AddForm(this)}var i=RD3_DesktopManager.WebEntryPoint.ActiveForm;if(!i||(i&&i.IdxForm!=this.IdxForm)){RD3_DesktopManager.WebEntryPoint.RefreshCommands=true}}this.FormBox=document.createElement("div");this.FormBox.setAttribute("id",this.Identifier);this.FormBox.className="form-container";this.FormBox.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseDownForm', ev)");if(this.PopupFrame||this.SubFormObj){this.FormBox.style.border="none"}if(!m&&this.Docked&&RD3_DesktopManager.WebEntryPoint.UseZones()){var d=RD3_DesktopManager.WebEntryPoint.GetScreenZone(this.DockType);d.RemoveFormBorder(this.FormBox)}this.FramesBox=document.createElement("div");this.FramesBox.setAttribute("id",this.Identifier+":frs");this.FramesBox.className="form-frames-container";this.MessagesBox=document.createElement("div");this.MessagesBox.setAttribute("id",this.Identifier+":msg");this.MessagesBox.className="form-message-container";if(m){var f=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMessageBarMouseMove', ev)");var k=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMessageBarMouseDown', ev)");var p=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMessageBarMouseUp', ev)");this.MessagesBox.addEventListener(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)?"touchmove":"mousemove",f,true);this.MessagesBox.addEventListener(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)?"touchstart":"mousedown",k,true);this.MessagesBox.addEventListener(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)?"touchend":"mouseup",p,true);this.MessagesBox.addEventListener(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)?"touchcancel":"mouseout",p,true)}this.CaptionBox=document.createElement("div");this.CaptionBox.setAttribute("id",this.Identifier+":cap");this.CaptionBox.className="form-caption-container";this.CaptionBox.ondblclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMaximize', ev)");var a=(m?".png":".gif");var o=!(RD3_Glb.IsAndroid()||RD3_Glb.IsIE()||RD3_Glb.IsEdge())||RD3_Glb.IsAndroid(4,4,0);if(!o&&c){a="-i"+a}if(this.HasCloseButton()){this.CloseBtn=document.createElement("img");this.CloseBtn.setAttribute("id",this.Identifier+":clo");if(m){if(c&&o){this.CloseBtn.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/mno"+a)+"')";this.CloseBtn.style.webkitMaskRepeat="no-repeat";this.CloseBtn.style.webkitMaskSize="25px 25px"}else{this.CloseBtn.src=RD3_Glb.GetImgSrc("images/mno"+a)}}else{this.CloseBtn.src=RD3_Glb.GetImgSrc("images/closef"+a)}this.CloseBtn.className="form-caption-image close-button";this.CloseBtn.removeAttribute("width");this.CloseBtn.removeAttribute("height");RD3_TooltipManager.SetObjTitle(this.CloseBtn,RD3_ServerParams.ChiudiForm+RD3_KBManager.GetFKTip(RD3_ClientParams.FKCloseForm));this.CloseBtn.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClose', ev)");if(!RD3_Glb.IsIE(10,false)){this.CloseBtn.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'AdaptToolbarLayout', ev)")}}if(this.HasIcon()){this.ImgIcon=document.createElement("img");this.ImgIcon.setAttribute("id",this.Identifier+":ico");this.ImgIcon.className="form-caption-icon";this.ImgIcon.removeAttribute("width");this.ImgIcon.removeAttribute("height");this.ImgIcon.ondblclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClose', ev)");if(!RD3_Glb.IsIE(10,false)){this.ImgIcon.onload=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'AdaptToolbarLayout', ev)")}}if(this.Modal){if(this.CloseBtn){if(c&&o){this.CloseBtn.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/mno"+a)+"')";this.CloseBtn.style.webkitMaskRepeat="no-repeat";this.CloseBtn.style.webkitMaskSize="25px 25px"}else{this.CloseBtn.src=RD3_Glb.GetImgSrc("images/mno"+a)}RD3_TooltipManager.SetObjTitle(this.CloseBtn,RD3_ServerParams.ModalChiudiForm);this.CloseBtn.className="form-caption-modal-image close-button";this.CloseBtn.removeAttribute("width");this.CloseBtn.removeAttribute("height")}if(this.HasConfirmButton()){this.ConfirmBtn=document.createElement("img");this.ConfirmBtn.setAttribute("id",this.Identifier+":con");this.ConfirmBtn.className="form-caption-modal-image accept-button";if(c&&o){this.ConfirmBtn.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/myes"+a)+"')";this.ConfirmBtn.style.webkitMaskRepeat="no-repeat";this.ConfirmBtn.style.webkitMaskSize="25px 25px"}else{this.ConfirmBtn.src=RD3_Glb.GetImgSrc("images/myes"+a)}this.ConfirmBtn.removeAttribute("width");this.ConfirmBtn.removeAttribute("height");RD3_TooltipManager.SetObjTitle(this.ConfirmBtn,RD3_ServerParams.ModalConfirm);this.ConfirmBtn.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnConfirm', ev)")}if(this.HasMinButton()){this.MinBtn=document.createElement("img");this.MinBtn.setAttribute("id",this.Identifier+":min");this.MinBtn.className="form-caption-modal-image min-button";this.MinBtn.src=RD3_Glb.GetImgSrc("images/fmin"+a);this.MinBtn.removeAttribute("width");this.MinBtn.removeAttribute("height");this.MinBtn.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMinimize', ev)")}if(this.HasMaxButton()){this.MaxBtn=document.createElement("img");this.MaxBtn.setAttribute("id",this.Identifier+":max");this.MaxBtn.className="form-caption-modal-image max-button";this.MaxBtn.src=RD3_Glb.GetImgSrc("images/fmax"+a);this.MaxBtn.removeAttribute("width");this.MaxBtn.removeAttribute("height");this.MaxBtn.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMaximize', ev)")}if(this.HasHelpButton()){this.HelpBtn=document.createElement("img");this.HelpBtn.setAttribute("id",this.Identifier+":hlp");this.HelpBtn.className="form-caption-modal-image help-button";this.HelpBtn.src=RD3_Glb.GetImgSrc("images/help"+a);this.HelpBtn.removeAttribute("width");this.HelpBtn.removeAttribute("height");this.HelpBtn.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('wep', 'OnHelpButton', ev)")}if(this.HasDebugButton()){this.DebugBtn=document.createElement("img");this.DebugBtn.setAttribute("id",this.Identifier+":dbg");this.DebugBtn.className="form-caption-modal-image debug-button";this.DebugBtn.src=RD3_DesktopManager.WebEntryPoint.DebugImageBox.src;this.DebugBtn.removeAttribute("width");this.DebugBtn.removeAttribute("height");this.DebugBtn.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('wep', 'OnDebug', ev)")}}if(this.HasBackButton()){this.BackButtonCnt=document.createElement("div");this.BackButtonCnt.setAttribute("id",this.Identifier+":bcn");this.BackButtonCnt.className="panel-formlist-container";this.BackButton=document.createElement("div");this.BackButton.setAttribute("id",this.Identifier+":bb");this.BackButton.className="panel-toolbar-button panel-formlist-button";this.BackButtonImg=document.createElement("div");this.BackButtonImg.setAttribute("id",this.Identifier+":bba");this.BackButtonImg.className="panel-formlist-arrow";this.BackButtonCnt.appendChild(this.BackButtonImg);this.BackButtonCnt.appendChild(this.BackButton);if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.BackButtonCnt.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClose', ev)")}else{this.BackButtonCnt.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnClose', ev)")}}this.CaptionTxt=document.createElement("span");this.CaptionTxt.setAttribute("id",this.Identifier+":txt");this.CaptionTxt.className="form-caption-text";if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.CaptionTxt.ontouchend=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCaptionClick', ev)")}else{this.CaptionTxt.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCaptionClick', ev)")}this.RealizeToolbar();this.FormBox.appendChild(this.CaptionBox);if(!m){this.FormBox.appendChild(this.MessagesBox);this.FormBox.appendChild(this.FramesBox)}else{this.FormBox.appendChild(this.FramesBox);this.FormBox.appendChild(this.MessagesBox)}this.RealizeFormList();if(this.Frames[0]){this.Frames[0].Realize(this.FramesBox)}if(this.Modal==2&&(RD3_KBManager.ActiveElement||RD3_KBManager.ActiveButton)&&m){var l=this.FormWidth>0?this.FormWidth:this.Frames[0].CalcWidth();var j=this.FormHeight>0?this.FormHeight:this.Frames[0].CalcHeight();var e=RD3_DesktopManager.WebEntryPoint.WepBox;if(RD3_Glb.IsSmartPhone()){l=e.offsetWidth;if(j>e.offsetHeight*0.8){j=e.offsetHeight*0.8}}else{if(l>e.offsetWidth/2){l=e.offsetWidth/2}if(j>e.offsetHeight/2){j=e.offsetHeight/2}}if(j<88){j=88}this.PopupFrame.SetWidth(l);this.PopupFrame.SetHeight(j);var b=RD3_KBManager.ActiveButton==null?RD3_KBManager.ActiveElement:RD3_KBManager.ActiveButton;this.PopupFrame.AttachTo(b);this.PopupFrame.Centered=false;RD3_DesktopManager.WebEntryPoint.CmdObj.ConvertFormPopover(true,this);this.PopupFrame.ContentBox.style.paddingTop="0px";this.PopupFrame.ContentBox.style.marginBottom="2px";var g=this.GetFirstToolbar();if(g){RD3_Glb.SetBorderRadius(g,"4px 4px 0px 0px")}}this.RealizeMessages();this.Realized=true;this.SetImage();this.SetCaption();this.SetWebCaption();this.SetVisible();this.SetWindowState();this.SetFormLeft(null,true);this.SetFormTop(null,true);this.SetFormWidth(null,true);this.SetFormHeight(null,true);this.SetBackButtonText();this.SetClassName();n.appendChild(this.FormBox);this.PopupPreview()};WebForm.prototype.RealizeMessages=function(){if(!this.Realized){return}if(!this.ShowMessages()){return}var b=this.Messages.length;var a=0;for(var g=0;g<b;g++){if(!this.Messages[g].Realized){this.Messages[g].Realize(this.MessagesBox);a++}}var j=RD3_Glb.IsMobile();if(!j||a>0){this.RemoveTemporaryMessages()}b=this.Messages.length;var h=0;for(var g=0;g<b;g++){h+=this.Messages[g].MyBox.offsetHeight;if(g>=2&&!j){break}}if(j){this.MessagesBox.style.visibility=(this.Messages.length==0)?"hidden":"";var f=this.FormBox.offsetHeight*0.8;if(h>f){h=f}this.MessagesBox.style.height=h+"px";if(!this.MessageBarOpen()){this.OpenMessageBar(a);if(a>0){if(this.MessageBarTimerId!=0){window.clearTimeout(this.MessageBarTimerId)}this.MessageBarTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OpenMessageBar', -1)",5000)}}}else{var d=true;if(b==0&&this.HasInfoMessages()){h=RD3_ClientParams.MinMessagesBoxHeight}var c=this.MessagesBox.offsetHeight;c=c<=0?0:c-(RD3_ServerParams.Theme=="zen"?0:1);d=c<=h;if(h!=c&&!this.Animating){var e=new GFX("message",d,this,this.Animating,null,this.MessageAnimDef);e.NewHeight=h;e.OldHeight=c;RD3_GFXManager.AddEffect(e)}if(this.Animating){this.MessagesBox.style.height=h+"px";this.MessagesBox.style.borderBottomWidth=h==0?"0px":""}}};WebForm.prototype.IsModalPopup=function(){return(this.Modal==1||this.Modal==-1)};WebForm.prototype.RealizeFormList=function(){if(!this.HasFormList()||RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_MENUBAR){return}var a=null;if(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR){var a=RD3_DesktopManager.WebEntryPoint.TaskbarFormListCell;this.FLBox=document.createElement("span");this.FLImg=document.createElement("img");this.FLCaption=document.createElement("span");this.FLBox.className="taskbar-form-list-item";this.FLImg.className="taskbar-form-list-img";this.FLCaption.className="taskbar-form-list-caption";this.FLBox.setAttribute("id",this.Identifier+":frl");this.FLBox.appendChild(this.FLImg);this.FLBox.appendChild(this.FLCaption)}else{var a=RD3_DesktopManager.WebEntryPoint.FormListTitle;this.FLBox=document.createElement("div");this.FLImg=document.createElement("span");this.FLCaption=document.createElement("span");this.FLBox.className="form-list-item";this.FLImg.className="form-list-img";this.FLCaption.className="form-list-caption";this.FLBox.setAttribute("id",this.Identifier+":frl");if(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_LEFTSB){this.FLBox.appendChild(this.FLImg);this.FLBox.appendChild(this.FLCaption)}else{this.FLBox.appendChild(this.FLCaption);this.FLBox.appendChild(this.FLImg);RD3_Glb.AddClass(this.FLImg,"form-list-img-right")}}this.FLBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnFLClick', ev)");if(a){a.appendChild(this.FLBox)}};WebForm.prototype.AdaptLayout=function(d){if(this.HostPage){RD3_Glb.AdaptToParent(this.FormBox,0,0);RD3_Glb.AdaptToParent(this.ContentObj,0,this.CaptionBox.offsetHeight);return}var H=false;var m=false;var K=RD3_Glb.IsMobile();var y=K&&RD3_DesktopManager.WebEntryPoint.InResize;var g=K&&this.Docked&&this.DockType==RD3_Glb.FORMDOCK_LEFT&&this.FramesBox.parentNode!=this.FormBox;var k=g?this.FramesBox.clientWidth:this.FormBox.clientWidth;var t=g?this.FramesBox.clientHeight:this.FormBox.clientHeight;if(k==0&&t==0&&this.Modal==0&&!d){this.RecalcLayout=true;return}if(this.PopupFrame){if(RD3_Glb.IsSmartPhone()&&this.Modal!=2){var p=RD3_DesktopManager.WebEntryPoint.WepBox;this.SetFormWidth(p.clientWidth,true);this.SetFormLeft(0,true);this.SetFormHeight(p.clientHeight,true);this.SetFormTop(0,true)}if(y&&this.WasAdapted&&!RD3_Glb.IsSmartPhone()){if(this.Modal!=2){var s=this.CaptionBox.offsetHeight;var F=this.MessagesBox.offsetHeight;if(F==0||F==1){F=25}if(!this.ShowMessages()||K){F=0}var p=RD3_DesktopManager.WebEntryPoint.WepBox;var r=this.FormWidth==-1?this.FramesBox.scrollWidth:this.FormWidth;var C=this.FormHeight==-1?this.FramesBox.scrollHeight+F+s:this.FormHeight;if(r>p.clientWidth*0.9){r=p.clientWidth*0.9}if(C>p.clientHeight*0.9){C=p.clientHeight*0.9}this.SetFormLeft(Math.floor((p.clientWidth-r)/2),true);this.SetFormTop(Math.floor((p.clientHeight-C)/2),true);this.SetFormWidth(r,true);this.SetFormHeight(C,true);var E=new IDEvent("repos",this.Identifier,null,this.ResizeEventDef,null,this.FormLeft,this.FormTop)}else{this.PopupFrame.AttachTo()}}if(!this.NormalLeft&&this.FormLeft>0&&this.WindowState==RD3_Glb.WS_MAXIMIZE){this.NormalLeft=this.FormLeft;this.NormalTop=this.FormTop;this.NormalWidth=this.FormWidth;this.NormalHeight=this.FormHeight}this.PopupFrame.AdaptLayout();if(this.PopupFrame.Centered){if(this.FormWidth==-1&&this.ResModeW==RD3_Glb.FRESMODE_STRETCH){this.ResModeW=RD3_Glb.FRESMODE_NONE;H=true}if(this.FormHeight==-1&&this.ResModeH==RD3_Glb.FRESMODE_STRETCH){this.ResModeH=RD3_Glb.FRESMODE_NONE;m=true}}}else{this.AdaptFormListLayout()}if(!K){if(this.Messages.length==0||(!this.ShowMessages()&&this.Modal!=0)){if(this.HasInfoMessages()&&this.ShowMessages()){this.MessagesBox.style.height=RD3_ClientParams.MinMessagesBoxHeight+"px"}else{this.MessagesBox.style.height="0px";this.MessagesBox.style.borderBottomWidth="0px"}}this.RealizeMessages()}var l=this.FramesBox.clientWidth<this.FramesBox.scrollWidth;var b=this.FramesBox.clientHeight<this.FramesBox.scrollHeight;var u=0;var G=0;var z=RD3_Glb.IsMobile()&&RD3_DesktopManager.WebEntryPoint.UseZones();if(this.Docked&&(this.DockType==RD3_Glb.FORMDOCK_LEFT||this.DockType==RD3_Glb.FORMDOCK_RIGHT)&&!z){u=parseFloat(RD3_Glb.GetStyleProp(this.FormBox,"borderLeftWidth"))+parseFloat(RD3_Glb.GetStyleProp(this.FormBox,"borderRightWidth"));if(!u){u=0}if(RD3_Glb.IsMobile()&&u==0){u=2}}if(this.Docked&&this.DockType==RD3_Glb.FORMDOCK_TOP){var D=RD3_Glb.GetCurrentStyle(RD3_DesktopManager.WebEntryPoint.TopDockedBox);G=parseInt("0"+D.paddingTop)+parseInt("0"+D.paddingBottom);if(!G){G=0}}var f=(this.Docked&&K&&RD3_Glb.HasClass(this.CaptionBox,"popover"))?0:this.CaptionBox.offsetHeight;RD3_Glb.AdaptToParent(this.FormBox,u,G);RD3_Glb.AdaptToParent(this.FramesBox,0,f+(K?0:this.MessagesBox.offsetHeight));this.AdaptToolbar=true;var B=this.FramesBox.scrollTop;var x=this.FramesBox.style.overflowX;var v=this.FramesBox.style.overflowY;this.FramesBox.style.overflowX="hidden";this.FramesBox.style.overflowY="hidden";var j=RD3_Glb.GetCurrentStyle(this.FramesBox);var q=this.FramesBox.clientWidth-parseInt("0"+j.paddingLeft)-parseInt("0"+j.paddingRight);var e=this.FramesBox.clientHeight-parseInt("0"+j.paddingTop)-parseInt("0"+j.paddingBottom);this.SaveSize();this.Frames[0].Resize(q,e);this.FramesBox.style.overflowX=x;this.FramesBox.style.overflowY=v;if(B&&(RD3_Glb.IsSafari()||RD3_Glb.IsChrome())&&!K){this.FramesBox.scrollTop=0;this.FramesBox.scrollTop=B}var i=this.FramesBox.clientWidth<this.Frames[0].Width;var J=this.FramesBox.clientHeight<this.Frames[0].Height;if((i||J)&&!K){this.ResetSize();if(i){e-=17}if(J){q-=17}this.Frames[0].Resize(q,e)}if(K){var r=this.FormBox.offsetWidth*0.6;if(r<320){r=320}if(r>this.FormBox.offsetWidth){r=this.FormBox.offsetWidth}this.MessagesBox.style.width=r+"px";this.MessagesBox.style.left=((this.FormBox.offsetWidth-r)/2)+"px";if(!this.ShowMessages()){this.MessagesBox.style.height="0px";this.MessagesBox.style.borderBottomWidth="0px";this.MessagesBox.style.borderWidth="0px"}this.RealizeMessages()}this.Frames[0].AdaptLayout();if(this.PreviewFrame&&this.PreviewFrame.FrameBox){RD3_Glb.AdaptToParent(this.PreviewFrame.FrameBox,0,2);if(this.PreviewFrame instanceof Book&&this.PreviewFrame.Pages.length>0){var o=this.PreviewFrame.Pages[this.PreviewFrame.ActivePage].PageBox;var C=o.offsetHeight;var r=o.offsetWidth;var a=this.PreviewFrame.FrameBox.offsetHeight;var A=this.PreviewFrame.FrameBox.offsetWidth;if(a>(C+32)){this.PreviewFrame.FrameBox.style.height=(C+32)+"px"}if(A>(r+32)){this.PreviewFrame.FrameBox.style.width=(r+32)+"px"}}this.PreviewFrame.AdaptLayout()}if(this.PopupFrame){var s=this.CaptionBox.offsetHeight;var F=this.MessagesBox.offsetHeight;if(F==0||F==1){F=25}if(!this.ShowMessages()||K){F=0}var p=RD3_DesktopManager.WebEntryPoint.WepBox;var r=this.FormWidth==-1?this.FramesBox.scrollWidth:this.FormWidth;var C=this.FormHeight==-1?this.FramesBox.scrollHeight+F+s:this.FormHeight;if(r>p.clientWidth*0.9){r=p.clientWidth*0.9}if(C>p.clientHeight*0.9){C=p.clientHeight*0.9}if(this.PopupFrame.Centered){if(this.FormLeft==-1){this.SetFormLeft(Math.floor((p.clientWidth-r)/2),true)}else{this.SetFormLeft(null,true)}if(this.FormTop==-1){this.SetFormTop(Math.floor((p.clientHeight-C)/2),true)}else{this.SetFormTop(null,true)}if(this.FormWidth==-1){this.SetFormWidth(r,true)}else{this.SetFormWidth(null,true)}if(this.FormHeight==-1){this.SetFormHeight(C,true)}else{this.SetFormHeight(null,true)}this.PopupFrame.Centered=false;this.PopupResAnim=false;var E=new IDEvent("repos",this.Identifier,null,this.ResizeEventDef,null,this.FormLeft,this.FormTop)}var c=this.FramesBox.style.overflow;this.FramesBox.style.overflow="hidden";this.PopupFrame.AdaptLayout();RD3_Glb.AdaptToParent(this.FormBox);RD3_Glb.AdaptToParent(this.FramesBox,0,this.CaptionBox.offsetHeight+(K?0:this.MessagesBox.offsetHeight));this.AdaptToolbar=true;this.FramesBox.style.overflow=c}if(!RD3_DesktopManager.WebEntryPoint.UseZones()){this.AdaptDocked()}var I=this.PopupFrame?this.PopupFrame.PopupBox.clientWidth:this.FramesBox.clientWidth;var n=this.PopupFrame?this.PopupFrame.PopupBox.clientHeight:this.FramesBox.clientHeight;if(this.lastclw!=I||this.lastclh!=n){var E=new IDEvent("resize",this.Identifier,null,this.ResizeEventDef,null,I,n);this.lastclw=I;this.lastclh=n}this.RecalcLayout=false;this.WasAdapted=true;if(H){this.ResModeW=RD3_Glb.FRESMODE_STRETCH}if(m){this.ResModeH=RD3_Glb.FRESMODE_STRETCH}};WebForm.prototype.AdaptToolbarLayout=function(){this.AdaptToolbar=false;if(RD3_Glb.IsMobile()){var y=(RD3_DDManager.OpenCombo&&!RD3_DDManager.OpenCombo.IsPopOver()&&RD3_DDManager.OpenCombo.Owner.ParentField.ParentPanel.WebForm==this);var q=y?"none":"";var l=y?"hidden":"";if(this.CloseBtn){this.CloseBtn.style.display=q}if(this.ConfirmBtn){this.ConfirmBtn.style.display=q}if(this.BackButtonCnt&&this.BackButtonCnt.parentNode==this.CaptionBox){this.BackButtonCnt.style.visibility=l;l=l==""?"hidden":l}var t=RD3_DesktopManager.WebEntryPoint.CmdObj.MenuButton;if(t&&t.parentNode==this.CaptionBox){if(l==""&&RD3_Glb.IsSmartPhone()){if(!this.HasBackButton()){l="hidden"}else{if(this.BackButtonTxt){RD3_DesktopManager.WebEntryPoint.CmdObj.SetMenuButtonCaption(this.BackButtonTxt)}}}t.style.visibility=l}else{if(!RD3_DesktopManager.WebEntryPoint.InResponse){for(var x=0;x<this.Frames.length;x++){var e=this.Frames[x];if(!e.ChildFrame1&&!e.OnlyContent&&e instanceof IDPanel&&e.Realized&&e.RefreshToolbar){e.UpdateToolbar();break}}}}var a=this.GetCustomToolbar();if(a){a.style.display=q}var s=0;if(this.ToolbarPosition==RD3_Glb.FORMTOOL_DISTRIB){if(this.CloseBtn){this.CloseBtn.style.left="8px"}if(this.ConfirmBtn){this.ConfirmBtn.style.left=(this.CaptionBox.offsetWidth-50)+"px"}s+=50}if(this.ToolbarPosition==RD3_Glb.FORMTOOL_RIGHT){var k=50;if(this.ConfirmBtn){this.ConfirmBtn.style.left=(this.CaptionBox.offsetWidth-k)+"px";k-=50;s+=50}if(this.CloseBtn){this.CloseBtn.style.left=(this.CaptionBox.offsetWidth-k)+"px";s+=50}var a=this.GetCustomToolbar();if(a){a.style.right=s+"px"}}if(a){RD3_Glb.AdjustCustomToolbar(a,this.CaptionBox)}if((RD3_Glb.IsQuadro()||(RD3_Glb.IsMobile7()&&!RD3_Glb.IsSmartPhone()))&&this.HasIcon()&&this.ImgIcon&&this.Image!=""&&(!RD3_Glb.IsSmartPhone()||this.HasBackButton)){this.ImgIcon.style.marginLeft="100px"}RD3_Glb.AdjustCaptionPosition(this.CaptionBox,this.CaptionTxt);if((RD3_Glb.IsQuadro()||(RD3_Glb.IsMobile7()&&!RD3_Glb.IsSmartPhone()))&&this.HasIcon()&&this.ImgIcon&&this.Image!=""&&(!RD3_Glb.IsSmartPhone()||this.HasBackButton)){this.ImgIcon.style.marginLeft=this.CaptionTxt.style.marginLeft;this.CaptionTxt.style.marginLeft=""}return}var r=this.CaptionBox.childNodes.length;var v=-1;var c=0;var d=0;var g=RD3_Glb.IsTouch()?2:0;for(var x=0;x<r;x++){var p=this.CaptionBox.childNodes[x];if(v==-1){if(p==this.CaptionTxt){v=x}else{if(p.offsetWidth){c=p.offsetLeft+p.offsetWidth+g}}}else{d+=p.offsetWidth+g}}if(d>0&&this.CaptionTxt){d+=2;this.CaptionTxt.style.paddingLeft="";this.CaptionTxt.style.paddingRight="";this.CaptionTxt.style.width="";var u=(this.CaptionBox.offsetWidth-d-c-this.CaptionTxt.offsetWidth);if(RD3_ServerParams.Theme=="zen"){if(this.ToolbarPosition==RD3_Glb.FORMTOOL_RIGHT){u-=16}else{if(this.ToolbarPosition==RD3_Glb.FORMTOOL_DISTRIB){u-=6}}}if(u>0){if(this.ToolbarPosition==RD3_Glb.FORMTOOL_DISTRIB){var b=Math.floor(u/2);var f=b;if(b*2<u){b++}this.CaptionTxt.style.paddingRight=b+"px";this.CaptionTxt.style.paddingLeft=f+"px"}else{this.CaptionTxt.style.paddingRight=u+"px"}}else{var h=this.CaptionTxt.offsetWidth+u-8;if(h>=0){this.CaptionTxt.style.width=h+"px"}}}};WebForm.prototype.AdaptDocked=function(){var d=RD3_Glb.IsMobile();var e=d?0:2;var a=0;if(this.Docked){if(this.DockType==RD3_Glb.FORMDOCK_LEFT){a=parseFloat(RD3_Glb.GetStyleProp(this.FormBox,"borderLeftWidth"))+parseFloat(RD3_Glb.GetStyleProp(this.FormBox,"borderRightWidth"));if(!a){a=0}RD3_DesktopManager.WebEntryPoint.LeftDockedBox.style.width=this.Visible?this.Frames[0].Width+e+a+"px":"0px"}if(this.DockType==RD3_Glb.FORMDOCK_TOP){var c=this.Frames[0].Height+this.CaptionBox.offsetHeight+(d?0:this.MessagesBox.offsetHeight)+e;var b=RD3_Glb.GetCurrentStyle(this.FramesBox);c+=parseInt("0"+b.paddingTop)+parseInt("0"+b.paddingBottom);b=RD3_Glb.GetCurrentStyle(RD3_DesktopManager.WebEntryPoint.TopDockedBox);c+=parseInt("0"+b.paddingTop)+parseInt("0"+b.paddingBottom);RD3_DesktopManager.WebEntryPoint.TopDockedBox.style.height=this.Visible?c+"px":"0px"}if(this.DockType==RD3_Glb.FORMDOCK_RIGHT){a=parseFloat(RD3_Glb.GetStyleProp(this.FormBox,"borderLeftWidth"))+parseFloat(RD3_Glb.GetStyleProp(this.FormBox,"borderRightWidth"));if(!a){a=0}RD3_DesktopManager.WebEntryPoint.RightDockedBox.style.width=this.Visible?this.Frames[0].Width+e+a+"px":"0px"}if(this.DockType==RD3_Glb.FORMDOCK_BOTTOM){var c=this.Frames[0].Height+this.CaptionBox.offsetHeight+(d?0:this.MessagesBox.offsetHeight)+e;var b=RD3_Glb.GetCurrentStyle(this.FramesBox);c+=parseInt("0"+b.paddingTop)+parseInt("0"+b.paddingBottom);RD3_DesktopManager.WebEntryPoint.BottomDockedBox.style.height=this.Visible?c+"px":"0px"}}};WebForm.prototype.AdaptFormListLayout=function(){if(this.FLCaption&&!RD3_DesktopManager.WebEntryPoint.CmdObj.SuppressMenu){RD3_Glb.AdaptToParent(this.FLCaption,this.FLImg.offsetWidth,-1);var b=this.FLCaption.style.width;var a=this.FLCaption.clientWidth;this.FLCaption.style.width="auto";this.FLCaption.style.lineHeight="";this.FLCaption.style.whiteSpace="";if(this.FLCaption.clientWidth>a){if(this.FLCaption.clientWidth>1.9*a){RD3_TooltipManager.SetObjTitle(this.FLCaption,RD3_Glb.RemoveTags(this.Caption))}else{RD3_TooltipManager.SetObjTitle(this.FLCaption,"")}this.FLCaption.style.lineHeight="100%";this.FLCaption.style.whiteSpace="normal"}this.FLCaption.style.width=b}};WebForm.prototype.Unrealize=function(){if(this.FormBox){this.FormBox.parentNode.removeChild(this.FormBox)}RD3_DesktopManager.ObjectMap[this.Identifier]=null;if(this.IdxForm>65536){RD3_DesktopManager.WebEntryPoint.CmdObj.CloseMultipleForm(this.IdxForm)}this.Frames[0].Unrealize();var b=this.Messages.length;for(var g=0;g<b;g++){this.Messages[g].Unrealize()}if(this.FLBox&&this.FLBox.parentNode){this.FLBox.parentNode.removeChild(this.FLBox)}if(this.PopupFrame){this.PopupFrame.Unrealize();RD3_KBManager.ActiveObject=this.LastActiveObject;RD3_KBManager.ActiveElement=this.LastActiveElement;if(RD3_Glb.IsIE()){try{RD3_KBManager.ActiveElement.focus()}catch(j){}}RD3_KBManager.CheckFocus=true}if(this.Docked){if(!RD3_DesktopManager.WebEntryPoint.UseZones()){var a=true;var d=RD3_DesktopManager.WebEntryPoint.StackForm.length;for(var l=0;l<d;l++){var h=RD3_DesktopManager.WebEntryPoint.StackForm[l];if(h.Docked&&h.DockType==this.DockType&&h!=this){a=false}}if(this.DockType==RD3_Glb.FORMDOCK_LEFT){var k=RD3_DesktopManager.WebEntryPoint.LeftDockedBox;if(a){k.className="left-dock-container";k.style.width=""}}if(this.DockType==RD3_Glb.FORMDOCK_TOP){var k=RD3_DesktopManager.WebEntryPoint.TopDockedBox;if(a){k.className="top-dock-container";k.style.height=""}}if(this.DockType==RD3_Glb.FORMDOCK_RIGHT){var k=RD3_DesktopManager.WebEntryPoint.RightDockedBox;if(a){k.className="right-dock-container";k.style.width=""}}if(this.DockType==RD3_Glb.FORMDOCK_BOTTOM){var k=RD3_DesktopManager.WebEntryPoint.BottomDockedBox;if(a){k.className="bottom-dock-container";k.style.height=""}}}else{var c=RD3_DesktopManager.WebEntryPoint.GetScreenZone(this.DockType);c.RemoveForm(this)}var e=RD3_DesktopManager.WebEntryPoint.ActiveForm;if(e&&e.IdxForm!=this.IdxForm){RD3_DesktopManager.WebEntryPoint.RefreshCommands=true}}this.FormBox=null;this.CaptionBox=null;this.CloseBtn=null;this.ConfirmBtn=null;this.CaptionTxt=null;this.FramesBox=null;this.ImgIcon=null;this.FLBox=null;this.FLImg=null;this.FLCaption=null;this.Realized=false};WebForm.prototype.OnClose=function(b){var a=new IDEvent("close",this.Identifier,b,this.ClickEventDef);RD3_Glb.StopEvent(b);RD3_DesktopManager.WebEntryPoint.CmdObj.ClosePopup()};WebForm.prototype.OnConfirm=function(b){var a=new IDEvent("confirm",this.Identifier,b,this.ClickEventDef)};WebForm.prototype.OnMaximize=function(c){if(!this.HasMaxButton()){return}var a=(this.WindowState==RD3_Glb.WS_NORMAL)?RD3_Glb.WS_MAXIMIZE:RD3_Glb.WS_NORMAL;var b=new IDEvent("chgwst",this.Identifier,c,this.ResizeEventDef,null,a);if(b.ClientSide){if(this.Modal){this.SetWindowState(a)}}};WebForm.prototype.OnMinimize=function(b){if(this.Modal&&this.WindowState!=RD3_Glb.WS_MINIMIZE){var a=new IDEvent("chgwst",this.Identifier,b,this.ResizeEventDef,null,RD3_Glb.WS_MINIMIZE);if(a.ClientSide){this.SetWindowState(RD3_Glb.WS_MINIMIZE)}}RD3_Glb.StopEvent(b);RD3_DesktopManager.WebEntryPoint.CmdObj.ClosePopup()};WebForm.prototype.DontMinimize=function(b){if(this.Modal&&this.WindowState==RD3_Glb.WS_MINIMIZE&&this.NormalWindowState!=null){var a=new IDEvent("chgwst",this.Identifier,b,this.ResizeEventDef,null,this.NormalWindowState);if(a.ClientSide){this.SetWindowState(this.NormalWindowState)}}};WebForm.prototype.SetActive=function(b,a){if(!this.Realized){return}if(this.PopupFrame){if(b){RD3_Glb.RemoveClass(this.CaptionBox,"form-caption-inactive")}else{RD3_Glb.AddClass(this.CaptionBox,"form-caption-inactive")}this.PopupFrame.SetActive(b)}if(this.IsModalPopup()){return}if(this.Docked){return}if(!a){a=false}if(b&&this.Visible){if(this.FLBox){if(RD3_DesktopManager.WebEntryPoint.HasSideMenu()){this.FLBox.className="form-list-active-item";this.FLImg.className="form-list-active-img";this.FLCaption.className="form-list-active-caption"}else{RD3_Glb.AddClass(this.FLBox,"taskbar-form-list-active")}}if(a&&this.Modal==0){this.FormBox.style.display=""}if(this.PopupFrame){this.PopupFrame.BringToFront()}}else{if(this.FLBox){if(RD3_DesktopManager.WebEntryPoint.HasSideMenu()){this.FLBox.className="form-list-item";this.FLImg.className="form-list-img";this.FLCaption.className="form-list-caption"}else{RD3_Glb.RemoveClass(this.FLBox,"taskbar-form-list-active")}}this.AlreadyVisible=false;if(a&&this.Modal==0){this.FormBox.style.display="none"}}if(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){RD3_Glb.AddClass(this.FLImg,"form-list-img-right")}if(RD3_Glb.IsMobile()&&this.Modal==0&&b&&!this.Docked){this.CaptureToolbarButton(RD3_DesktopManager.WebEntryPoint.CmdObj.MenuButton);if(RD3_DesktopManager.WebEntryPoint.InResponse){this.AdaptToolbar=true}else{this.AdaptToolbarLayout()}}};WebForm.prototype.CaptureToolbarButton=function(b){if(!b){return}var a=this.GetFirstToolbar(true);if(a){if(b.parentNode){b.parentNode.removeChild(b)}a.insertBefore(b,a.firstChild)}};WebForm.prototype.OnFLClick=function(d,f,b){if(this.SubFormObj){return}var c=true;if(this.Modal&&this.WindowState==RD3_Glb.WS_MINIMIZE&&!f){this.DontMinimize();c=false}var e=RD3_DesktopManager.WebEntryPoint;if(e.ActiveForm==this||e.ActiveForm==this.Identifier){if(!f&&c&&this.HasMinButton()&&this.Modal&&!this.IsModalPopup()){this.OnMinimize(d)}return}var a=new IDEvent("flclk",this.Identifier,d,this.ClickFLEventDef);if(a.ClientSide&&!RD3_GFXManager.Blocking()&&!b){e.ActivateForm(this.Identifier);e.CmdObj.ClosePopup()}};WebForm.prototype.StartPopupResizeGFX=function(){if(this.PopupFrame){this.Animating=true;var a=new GFX("popupres",true,this,false,null,this.PopResAnimDef);RD3_GFXManager.AddEffect(a)}this.PopupResAnim=false};WebForm.prototype.AfterProcessResponse=function(){if(this.RecalcLayout&&!this.PopupResAnim){this.AdaptLayout()}if(this.PopupResAnim){this.StartPopupResizeGFX()}if(this.RecalcCommands){RD3_DesktopManager.WebEntryPoint.CmdObj.ActiveFormChanged();this.RecalcCommands=false}if(this.AdaptToolbar&&this.Realized){this.AdaptToolbarLayout()}var b=this.Frames.length;for(var a=0;a<b;a++){this.Frames[a].AfterProcessResponse()}};WebForm.prototype.Focus=function(f,e){var a=0;var d=0;if(e!=undefined){d=e?1:-1}if(f){var g=this.Frames.length;for(var c=0;c<g;c++){if(this.Frames[c]==f){a=c+d;break}}}var g=this.Frames.length;if(f&&e!=undefined){if(e){for(var c=a;c<g;c++){if(this.Frames[c].HandlesTabFocus()&&this.Frames[c].Focus(e)){return true}}}else{for(var c=a;c>=0;c--){if(this.Frames[c].HandlesTabFocus()&&this.Frames[c].Focus(e)){return true}}}if(this.SubFormObj){var b=null;if(this.SubFormObj instanceof SubForm){b=this.SubFormObj.WebForm}if(b){return b.Focus(this.SubFormObj,e)}}a=e?0:g-1}for(var c=0;c<g;c++){if(this.Frames[(c+a)%g].Focus(e)){return true}}return false};WebForm.prototype.HandleFunctionKeys=function(c){var d=(c.charCode)?c.charCode:c.keyCode;var b=false;b=RD3_DesktopManager.WebEntryPoint.CmdObj.HandleFunctionKeys(c,this.IdxForm,-1);if(b){return b}var a=(d-111)+(c.shiftKey?12:0)+(c.ctrlKey?24:0);if(a==RD3_ClientParams.FKCloseForm){b=true;this.OnClose(c)}if(!b){b=RD3_DesktopManager.WebEntryPoint.HandleFunctionKeys(c)}return b};WebForm.prototype.GetFrameIndex=function(c){var d=this.Frames.length;for(var b=0;b<d;b++){var a=this.Frames[b];if(a==c){return b}}return -1};WebForm.prototype.HasInfoMessages=function(){var b=this.Frames.length;for(var a=0;a<b;a++){if(this.Frames[a].InfoMessage){return true}}};WebForm.prototype.IsTransformable=function(){if(this.SubFormObj&&this.SubFormObj instanceof BookBox){return this.SubFormObj.IsTransformable()}return(this.PopupFrame!=null&&(this.CanResize()||this.CanMove()))||(this.Docked&&this.CanResize()&&RD3_ServerParams.EnableFrameResize)};WebForm.prototype.IsDraggable=function(){if(this.SubFormObj&&this.SubFormObj instanceof BookBox){return this.SubFormObj.IsDraggable()}return false};WebForm.prototype.DragObj=function(a){if(this.SubFormObj&&this.SubFormObj instanceof BookBox){if(a.substr(a.length-4)==":cap"||a.substr(a.length-4)==":txt"){return this.SubFormObj}else{return null}}else{return this}};WebForm.prototype.IsMoveable=function(){return this.PopupFrame!=null&&this.CanMove()};WebForm.prototype.IsResizable=function(){return(this.PopupFrame!=null&&this.CanResize())||(this.Docked&&this.CanResize())};WebForm.prototype.DropElement=function(){if(this.Modal){return this.PopupFrame.PopupBox}else{if(this.Docked){return this.FormBox}}};WebForm.prototype.OnTransform=function(g,e,j,c,b){var i=RD3_Glb.IsMobile();if(this.PopupFrame){if(e<0){e=0}if(e>document.body.clientHeight-this.CaptionBox.offsetHeight){e=document.body.clientHeight-this.CaptionBox.offsetHeight}if(g<0&&g+this.FormWidth<20){g=0-this.FormWidth+20}if(g>document.body.clientWidth-20){g=document.body.clientWidth-20}var a=(this.FormHeight==c&&this.FormWidth==j&&this.FormTop!=e&&this.FormLeft!=e);this.SetFormTop(e,true);this.SetFormLeft(g,true);if(this.BorderType==RD3_Glb.BORDER_THICK){this.SetFormHeight(c,true);this.SetFormWidth(j,true)}if(!a){this.AdaptLayout()}var f=new IDEvent("repos",this.Identifier,null,this.ResizeEventDef,null,this.FormLeft,this.FormTop)}else{if(this.Docked){if((this.DockType==RD3_Glb.FORMDOCK_LEFT||this.DockType==RD3_Glb.FORMDOCK_RIGHT)&&this.Frames[0].Width!=j){if(j<RD3_ClientParams.DockedMinResize){j=RD3_ClientParams.DockedMinResize}this.Frames[0].SetWidth(j)}if(this.DockType==RD3_Glb.FORMDOCK_TOP||this.DockType==RD3_Glb.FORMDOCK_BOTTOM){if(c<RD3_ClientParams.DockedMinResize){c=RD3_ClientParams.DockedMinResize}var d=c-this.CaptionBox.offsetHeight-(i?0:this.MessagesBox.offsetHeight)-2;if(d>0){this.Frames[0].SetHeight(d)}}if(RD3_DesktopManager.WebEntryPoint.InResponse){RD3_DesktopManager.WebEntryPoint.RecalcLayout=true}else{RD3_DesktopManager.WebEntryPoint.AdaptLayout()}}}};WebForm.prototype.ApplyCursor=function(a){if(this.Realized&&a!="move"){if(this.PopupFrame){this.PopupFrame.ApplyCursor(a)}else{if(this.Docked){RD3_DesktopManager.WebEntryPoint.FormsBox.style.cursor=a;switch(this.DockType){case RD3_Glb.FORMDOCK_LEFT:break;case RD3_Glb.FORMDOCK_RIGHT:RD3_DesktopManager.WebEntryPoint.RightDockedBox.style.cursor=a;break;case RD3_Glb.FORMDOCK_TOP:RD3_DesktopManager.WebEntryPoint.LeftDockedBox.style.cursor=a;RD3_DesktopManager.WebEntryPoint.RightDockedBox.style.cursor=a;break;case RD3_Glb.FORMDOCK_BOTTOM:RD3_DesktopManager.WebEntryPoint.LeftDockedBox.style.cursor=a;RD3_DesktopManager.WebEntryPoint.RightDockedBox.style.cursor=a;RD3_DesktopManager.WebEntryPoint.BottomDockedBox.style.cursor=a;break}}}}};WebForm.prototype.SaveSize=function(){var b=this.Frames.length;for(var a=0;a<b;a++){this.Frames[a].SaveSize()}};WebForm.prototype.ResetSize=function(){var b=this.Frames.length;for(var a=0;a<b;a++){this.Frames[a].ResetSize()}};WebForm.prototype.OnMouseOverObj=function(b,a){if(!this.Realized){return}if((a==this.FLBox||a==this.FLImg||a==this.FLCaption)&&RD3_DesktopManager.WebEntryPoint.HasSideMenu()){if(RD3_DesktopManager.WebEntryPoint.ActiveForm){var c=RD3_DesktopManager.WebEntryPoint.ActiveForm.Identifier;if(c!=this.Identifier){this.FLCaption.className="form-list-caption-hl";this.FLImg.className="form-list-img-hl";if(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){RD3_Glb.AddClass(this.FLImg,"form-list-img-hl-right")}}}}if(a.parentNode==this.CaptionBox){RD3_Glb.AddClass(a,"form-caption-hover")}if((a==this.PopupTextCell||a==this.PopupText)){RD3_Glb.AddClass(this.PopupTextCell,"popup-menu-hover")}};WebForm.prototype.OnMouseOutObj=function(c,b){if(!this.Realized){return}if((b==this.FLBox||b==this.FLImg||b==this.FLCaption)&&RD3_DesktopManager.WebEntryPoint.HasSideMenu()){if(RD3_DesktopManager.WebEntryPoint.ActiveForm){var d=RD3_DesktopManager.WebEntryPoint.ActiveForm.Identifier;if(d!=this.Identifier){var a=RD3_DesktopManager.WebEntryPoint.MenuType;this.FLCaption.className="form-list-caption";this.FLImg.className="form-list-img";if(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_RIGHTSB){RD3_Glb.AddClass(this.FLImg,"form-list-img-right")}}}}if(b.parentNode==this.CaptionBox){RD3_Glb.RemoveClass(b,"form-caption-hover");RD3_Glb.RemoveClass(b,"form-caption-press")}if(b==this.PopupTextCell){RD3_Glb.RemoveClass(this.PopupTextCell,"popup-menu-hover")}if(RD3_Glb.IsMobile()){if(b==this.BackButton||b==this.BackButtonImg){RD3_Glb.RemoveClass(this.BackButton,"panel-button-press");RD3_Glb.RemoveClass(this.BackButtonImg,"panel-button-press")}}};WebForm.prototype.OnMouseDownObj=function(b,a){if(a==this.FLBox||a==this.FLImg||a==this.FLCaption){}if(a.parentNode==this.CaptionBox){RD3_Glb.AddClass(a,"form-caption-press")}if(RD3_Glb.IsMobile()){if(a==this.BackButton||a==this.BackButtonImg){RD3_Glb.AddClass(this.BackButton,"panel-button-press");RD3_Glb.AddClass(this.BackButtonImg,"panel-button-press")}}};WebForm.prototype.HasCaption=function(){return this.VisualFlags&1};WebForm.prototype.CanResize=function(){return(this.VisualFlags&2)&&((this.Modal&&this.WindowState==RD3_Glb.WS_NORMAL&&this.BorderType==RD3_Glb.BORDER_THICK)||this.Docked)};WebForm.prototype.CanMove=function(){return this.VisualFlags&4&&this.Modal&&this.WindowState==RD3_Glb.WS_NORMAL};WebForm.prototype.HasMinButton=function(){return this.VisualFlags&8&&this.Modal&&!this.IsModalPopup()&&this.ToolbarPosition!=0};WebForm.prototype.HasMaxButton=function(){return(this.VisualFlags&16)&&this.Modal&&this.ToolbarPosition!=0};WebForm.prototype.HasCloseButton=function(){return(this.VisualFlags&32)&&this.ToolbarPosition!=0};WebForm.prototype.HasConfirmButton=function(){return(this.VisualFlags&64)&&this.IsModalPopup()&&this.ToolbarPosition!=0};WebForm.prototype.HasHelpButton=function(){return(this.VisualFlags&128)&&RD3_DesktopManager.WebEntryPoint.HelpFileBox.style.display!="none"&&this.ToolbarPosition!=0};WebForm.prototype.HasDebugButton=function(){return(this.VisualFlags&256)&&RD3_DesktopManager.WebEntryPoint.DebugImageBox.style.display!="none"&&this.ToolbarPosition!=0};WebForm.prototype.HasIcon=function(){return(this.VisualFlags&512)};WebForm.prototype.ShowMessages=function(){return(this.VisualFlags&1024)};WebForm.prototype.HasBackButton=function(){return(this.VisualFlags&2048)&&RD3_Glb.IsMobile()};WebForm.prototype.SetButtonVisibility=function(a){if(this.CloseBtn){this.CloseBtn.style.visibility=a}if(this.ConfirmBtn){this.ConfirmBtn.style.visibility=a}if(this.MinBtn){this.MinBtn.style.visibility=a}if(this.MaxBtn){this.MaxBtn.style.visibility=a}if(this.HelpBtn){this.HelpBtn.style.visibility=a}if(this.DebugBtn){this.DebugBtn.style.visibility=a}if(this.ImgIcon){this.ImgIcon.style.visibility=a}};WebForm.prototype.AttachToolbar=function(a){if(!a.MyToolBox){return}if(a.MyToolBox.parentNode){if(a.MyToolBox.parentNode==this.CaptionBox){return}a.MyToolBox.parentNode.removeChild(a.MyToolBox)}switch(this.ToolbarPosition){case RD3_Glb.FORMTOOL_NONE:case RD3_Glb.FORMTOOL_LEFT:case RD3_Glb.FORMTOOL_RIGHT:this.CaptionBox.insertBefore(a.MyToolBox,this.CaptionTxt.nextSibling);break;case RD3_Glb.FORMTOOL_DISTRIB:this.CaptionBox.insertBefore(a.MyToolBox,this.CaptionTxt);break}this.AdaptToolbar=true};WebForm.prototype.Tick=function(){var c=this.Frames.length;for(var a=0;a<c;a++){var b=this.Frames[a];if(b&&b.Realized&&b.Visible){b.Tick()}}};WebForm.prototype.RealizeFormListPopup=function(a,b){if(!this.HasFormList()){return}this.PopupItemBox=document.createElement("tr");this.PopupItemBox.setAttribute("id",this.Identifier+":tr");this.PopupItemBox.className="popup-menu-item";this.PopupItemBox.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnFLClick', ev)");this.PopupIconCell=document.createElement("td");this.PopupIconCell.setAttribute("id",this.Identifier+":tdi");this.PopupIconCell.className="popup-cell-icon";this.PopupImageBox=document.createElement("img");this.PopupImageBox.setAttribute("id",this.Identifier+":pm");this.PopupImageBox.className="popup-menu-image";if(this.Image!=""){this.PopupImageBox.src=RD3_Glb.GetImgSrc("images/"+this.Image)}else{this.PopupImageBox.style.display="none"}this.PopupTextCell=document.createElement("td");this.PopupTextCell.setAttribute("id",this.Identifier+":txt");this.PopupTextCell.className="popup-cell-text";this.PopupText=document.createElement("span");this.PopupText.setAttribute("id",this.Identifier+":cap");this.PopupText.className="popup-menu-text";this.PopupText.innerHTML="<u>"+b+"</u>&nbsp;"+RD3_Glb.RemoveTags(this.Caption);this.PopupIconCell.appendChild(this.PopupImageBox);this.PopupTextCell.appendChild(this.PopupText);this.PopupItemBox.appendChild(this.PopupIconCell);this.PopupItemBox.appendChild(this.PopupTextCell);a.appendChild(this.PopupItemBox)};WebForm.prototype.HasFormList=function(){return !this.IsModalPopup()&&!this.Docked&&this.HasCaption()&&!this.SubFormObj};WebForm.prototype.GetTooltip=function(b,c){var a=false;if(c==this.CloseBtn){b.SetTitle(ClientMessages.TIP_TITLE_ChiudiForm);b.SetText((this.Modal?RD3_ServerParams.ModalChiudiForm:RD3_ServerParams.ChiudiForm)+RD3_KBManager.GetFKTip(RD3_ClientParams.FKCloseForm));a=true}else{if(c==this.ConfirmBtn){b.SetTitle(ClientMessages.TIP_TITLE_ModalConfirm);b.SetText(RD3_ServerParams.ModalConfirm);a=true}else{if(c==this.FLCaption||c==this.FLImg||c==this.FLBox){if(RD3_DesktopManager.WebEntryPoint.MenuType==RD3_Glb.MENUTYPE_TASKBAR){b.SetImage("");b.SetText(RD3_Glb.RemoveTags(this.Caption));b.SetObj(this.FLBox);b.SetAnchor(RD3_Glb.GetScreenLeft(this.FLBox)+8,RD3_Glb.GetScreenTop(this.FLBox));return true}}}}if(a){b.SetAnchor(RD3_Glb.GetScreenLeft(c)+((c.offsetWidth+4)/2),RD3_Glb.GetScreenTop(c));b.SetPosition(0);return true}return false};WebForm.prototype.GetDropList=function(){return null};WebForm.prototype.ComputeDropList=function(f,b){if(!this.Realized){return}var h=null;if(b.GetParentFrame){h=b.GetParentFrame();if(h){h=h.WebForm}}if(this.Modal&&!this.IsModalPopup()){f.push(this);var g=this.FormBox;this.AbsLeft=RD3_Glb.GetScreenLeft(g,true);this.AbsTop=RD3_Glb.GetScreenTop(g,true);this.AbsRight=this.AbsLeft+g.offsetWidth-1;this.AbsBottom=this.AbsTop+g.offsetHeight-1}var a=this.Frames.length;for(var d=0;d<a;d++){var c=this.Frames[d];var e=c.CanDrop||h==c.WebForm;if(c.ComputeDropList&&e){c.ComputeDropList(f,b)}}};WebForm.prototype.OnMouseDownForm=function(a){if(RD3_DesktopManager.WebEntryPoint.ActiveForm!=this&&!this.Docked){this.OnFLClick(a)}};WebForm.prototype.RealizeToolbar=function(){switch(this.ToolbarPosition){case RD3_Glb.FORMTOOL_NONE:if(this.ImgIcon){this.CaptionBox.appendChild(this.ImgIcon)}if(this.CaptionTxt){this.CaptionBox.appendChild(this.CaptionTxt)}break;case RD3_Glb.FORMTOOL_LEFT:if(this.ConfirmBtn){this.CaptionBox.appendChild(this.ConfirmBtn)}if(this.CloseBtn){this.CaptionBox.appendChild(this.CloseBtn)}if(this.MaxBtn){this.CaptionBox.appendChild(this.MaxBtn)}if(this.MinBtn){this.CaptionBox.appendChild(this.MinBtn)}if(this.HelpBtn){this.CaptionBox.appendChild(this.HelpBtn)}if(this.DebugBtn){this.CaptionBox.appendChild(this.DebugBtn)}if(this.ImgIcon){this.CaptionBox.appendChild(this.ImgIcon)}if(this.CaptionTxt){this.CaptionBox.appendChild(this.CaptionTxt)}break;case RD3_Glb.FORMTOOL_RIGHT:case RD3_Glb.FORMTOOL_DISTRIB:if(RD3_Glb.IsMobile()){if(this.CloseBtn){this.CaptionBox.appendChild(this.CloseBtn)}if(this.CaptionTxt){this.CaptionBox.appendChild(this.CaptionTxt)}if(this.ConfirmBtn){this.CaptionBox.appendChild(this.ConfirmBtn)}}else{if(this.ImgIcon){this.CaptionBox.appendChild(this.ImgIcon)}if(this.CaptionTxt){this.CaptionBox.appendChild(this.CaptionTxt)}if(this.DebugBtn){this.CaptionBox.appendChild(this.DebugBtn)}if(this.HelpBtn){this.CaptionBox.appendChild(this.HelpBtn)}if(this.MinBtn){this.CaptionBox.appendChild(this.MinBtn)}if(this.MaxBtn){this.CaptionBox.appendChild(this.MaxBtn)}if(this.CloseBtn){this.CaptionBox.appendChild(this.CloseBtn)}if(this.ConfirmBtn){this.CaptionBox.appendChild(this.ConfirmBtn)}}break}};WebForm.prototype.OnTouchStart=function(a){this.TouchStartX=a.targetTouches[0].clientX;this.TouchStartY=a.targetTouches[0].clientY;this.TouchOrgX=a.targetTouches[0].clientX;this.TouchOrgY=a.targetTouches[0].clientY;this.TouchTimes=new Array();this.TouchPosY=new Array();this.TouchPosX=new Array();this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);this.ClearTouchScrollTimer()};WebForm.prototype.OnTouchMove=function(c){var b=c.targetTouches[0].clientX-this.TouchStartX;var d=c.targetTouches[0].clientY-this.TouchStartY;var a=new Date();this.TouchStartX=c.targetTouches[0].clientX;this.TouchStartY=c.targetTouches[0].clientY;if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}this.TouchTimes.push(new Date());this.TouchPosY.push(this.TouchStartY);this.TouchPosX.push(this.TouchStartX);if(this.TouchTimes.length>3){this.TouchTimes.shift();this.TouchPosY.shift();this.TouchPosX.shift()}this.FramesBox.scrollLeft-=b;this.FramesBox.scrollTop-=d;return false};WebForm.prototype.OnTouchEnd=function(g){if(RD3_DDManager.IsDragging||RD3_DDManager.IsResizing){return false}if(this.TouchTimes.length==3){var f=this.TouchTimes[2]-this.TouchTimes[0];var b=this.TouchPosX[0]-this.TouchPosX[2];var a=this.TouchPosY[0]-this.TouchPosY[2];if(new Date()-this.TouchTimes[2]<100&&f>0){var c=a/f;var d=b/f;if(Math.abs(d)>0.3||Math.abs(c)>0.3){this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+d+","+c+",0])",10)}}}this.TouchStartX=-1;this.TouchStartY=-1;return false};WebForm.prototype.TouchScrollTimer=function(d,b){if(b.length==3){var c=b[0];var a=b[1];var e=b[2];this.FramesBox.scrollLeft+=c*10;this.FramesBox.scrollTop+=a*10;if(e<40){c=c*0.97;a=a*0.97;this.TouchScrollTimerId=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'TouchScrollTimer', null, ["+c+","+a+","+(e+1)+"])",10)}}};WebForm.prototype.ClearTouchScrollTimer=function(){if(this.TouchScrollTimerId>0){window.clearTimeout(this.TouchScrollTimerId);this.TouchScrollTimerId=0;this.TouchScroll=0}};WebForm.prototype.CanResizeW=function(){if(this.Docked&&(this.DockType==RD3_Glb.FORMDOCK_TOP||this.DockType==RD3_Glb.FORMDOCK_BOTTOM)){return false}else{return true}};WebForm.prototype.CanResizeH=function(){if(this.Docked&&(this.DockType==RD3_Glb.FORMDOCK_LEFT||this.DockType==RD3_Glb.FORMDOCK_RIGHT)){return false}else{return true}};WebForm.prototype.CanResizeL=function(){if(this.Docked&&this.DockType!=RD3_Glb.FORMDOCK_RIGHT){return false}else{return true}};WebForm.prototype.CanResizeR=function(){if(this.Docked&&this.DockType!=RD3_Glb.FORMDOCK_LEFT){return false}else{return true}};WebForm.prototype.CanResizeT=function(){if(this.Docked&&this.DockType!=RD3_Glb.FORMDOCK_BOTTOM){return false}else{return true}};WebForm.prototype.CanResizeD=function(){if(this.Docked&&this.DockType!=RD3_Glb.FORMDOCK_TOP){return false}else{return true}};WebForm.prototype.SetPage=function(a,b){if(!this.WelcomeBox){this.WelcomeBox=document.createElement("iframe");this.WelcomeBox.className="welcome-container";this.WelcomeBox.frameBorder=0;this.MessagesBox.style.display="none";this.FormBox.appendChild(this.WelcomeBox);this.SetActive(true)}this.WelcomeBox.src=a;this.SetWebCaption(b)};WebForm.prototype.Host=function(a,b){this.HostPage=true;if(this.CaptionBox&&this.CaptionBox.parentNode){this.CaptionBox.parentNode.removeChild(this.CaptionBox)}this.CaptionBox=b;this.FormBox.appendChild(b);this.FormBox.appendChild(a);this.SetActive(true);this.ContentObj=a};WebForm.prototype.GetFirstToolbar=function(c){if(this.HasCaption()){return this.CaptionBox}for(var b=0;b<this.Frames.length;b++){var a=this.Frames[b];if(a instanceof TabbedView){if(a.SelectedPage>=0&&!a.Tabs[a.SelectedPage].Content.OnlyContent){var d=a.Tabs[a.SelectedPage].Content;if(c&&d instanceof IDPanel&&d.Realized){d.RefreshToolbar=true}return d.ToolbarBox}}else{if(!a.ChildFrame1&&!a.OnlyContent){if(c&&a instanceof IDPanel&&a.Realized){a.RefreshToolbar=true}return a.ToolbarBox}}}};WebForm.prototype.OnAutoClosePopup=function(a){this.OnClose(window.event);return false};WebForm.prototype.GetCustomToolbar=function(){if(!this.CaptionBox){return}var a=this.CaptionBox.firstChild;while(a){if(RD3_Glb.HasClass(a,"toolbar-form-container")){return a}a=a.nextSibling}};WebForm.prototype.MessageBarOpen=function(){return this.MessageBarIsOpen};WebForm.prototype.OpenMessageBar=function(b){this.MessageBarIsOpen=false;if(b<0){b=0;var a=this.Messages.length;this.RemoveTemporaryMessages();if(a!=this.Messages.length){var d=0;for(var c=0;c<this.Messages.length;c++){d+=(this.Messages[c].Realized?this.Messages[c].MyBox.offsetHeight:0)}if(d==0){var f="var m = document.getElementById('"+this.Identifier+":msg');";f+=" if (m) { m.style.visibility = 'hidden'; }";window.setTimeout(f,500)}else{this.MessagesBox.style.visibility="";this.MessagesBox.style.height=d+"px"}}}var e=-this.MessagesBox.offsetHeight+(this.Messages.length==0?0:b*32+8);if(e>0){e=0}if(b>0&&this.Messages.length>0){this.MessageBarIsOpen=true}var f="var m = document.getElementById('"+this.Identifier+":msg');";f+=" if (m) { RD3_Glb.SetTransform(m, 'translate3d(0px,"+e+"px,0px)'); }";window.setTimeout(f,50);this.OnMessageBarMouseUp()};WebForm.prototype.OnMessageBarMouseMove=function(a){if(this.MessageBarStartPos>0){var c=RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)?a.targetTouches[0].clientY:a.clientY;var b=c-this.MessageBarStartPos;if(b>2){this.OpenMessageBar(100)}if(b<-2){this.OpenMessageBar(-1)}}};WebForm.prototype.OnMessageBarMouseDown=function(a){this.MessageBarStartPos=RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)?a.targetTouches[0].clientY:a.clientY;if(this.MessageBarTimerId!=0){window.clearTimeout(this.MessageBarTimerId);this.MessageBarTimerId=0}};WebForm.prototype.OnMessageBarMouseUp=function(a){this.MessageBarStartPos=null};WebForm.prototype.RemoveTemporaryMessages=function(){for(var b=this.Messages.length-1;b>=0;b--){if(this.Messages[b].Temporary){if(this.Messages[b].Request!=RD3_DesktopManager.CurrentRequest){if(b==0){var a=this.Messages.length;if(a==1&&this.HasInfoMessages()&&!RD3_Glb.IsMobile()){var c=new GFX("lastmessage",true,this.Messages[b],this.Animating,null,this.LastMessageAnimDef);RD3_GFXManager.AddEffect(c);this.Messages.splice(b,1)}else{this.Messages[b].Unrealize();this.Messages.splice(b,1)}}else{this.Messages[b].Unrealize();this.Messages.splice(b,1)}}}}};WebForm.prototype.OnCaptionClick=function(d){if(this.Messages.length>0){this.OpenMessageBar(100)}else{var c;for(var b=0;b<this.Frames.length;b++){var a=this.Frames[b];if(a instanceof TabbedView){if(a.SelectedPage>=0&&a.Tabs[a.SelectedPage].Content.IDScroll){c=a.Tabs[a.SelectedPage].Content.IDScroll;break}}else{if(!a.ChildFrame1&&a.IDScroll){c=a.IDScroll;break}}}if(c){c.GoTop()}}};WebForm.prototype.GetMasterForm=function(){if(this.SubFormObj==null){return this}if(this.SubFormObj instanceof BookBox){return this.SubFormObj.ParentPage.ParentBook.WebForm.GetMasterForm()}if(this.SubFormObj instanceof SubForm){return this.SubFormObj.WebForm.GetMasterForm()}return this};WebForm.prototype.EnableIDScroll=function(c){for(var b=0;b<this.Frames.length;b++){var a=this.Frames[b];if(a instanceof TabbedView){if(a.SelectedPage>=0&&a.Tabs[a.SelectedPage].Content.IDScroll){a.Tabs[a.SelectedPage].Content.IDScroll.Enabled=c}}else{if(!a.ChildFrame1&&a.IDScroll){a.IDScroll.Enabled=c}}}};WebForm.prototype.OnBackButton=function(){if(this.HasCaption()==0){var d=this.GetFirstToolbar(false);for(var c=0;c<this.Frames.length;c++){var b=this.Frames[c];if(b instanceof TabbedView){if(b.SelectedPage>=0&&!b.Tabs[b.SelectedPage].Content.OnlyContent){b=b.Tabs[b.SelectedPage].Content}}if(b instanceof IDPanel){if(b.FormListButtonCnt&&b.FormListButtonCnt.style.display==""&&b.HasList){b.OnToolbarClick({},"list");return true}if(b.PanelMode==RD3_Glb.PANEL_FORM&&!b.Locked&&b.Lockable){return true}}if(b instanceof Tree){if(b.ActiveNode&&b.ActiveNode.BackImg&&b.ActiveNode.BackImg.style.display==""){b.ActiveNode.OnBack({});return true}}if(this.HasBackButton()&&d==b.ToolbarBox){var a=RD3_DesktopManager.WebEntryPoint.CmdObj.MenuButton;var e=this.BackButtonCnt;if(e&&e.parentNode==b.ToolbarBox&&e.style.display==""){this.OnClose({});return true}else{if(RD3_Glb.IsSmartPhone()&&a&&a.parentNode==b.ToolbarBox&&a.style.display==""){RD3_DesktopManager.WebEntryPoint.CmdObj.OnMenuButton();return true}}}}}if(this.HasBackButton()&&this.BackButtonTxt&&this.BackButtonTxt.length>0){this.OnClose({});return true}if(this.Modal!=0&&this.HasCloseButton()&&this.CloseBtn&&this.CloseBtn.style.display==""){this.OnClose({});return true}};WebForm.prototype.OnAdaptRetina=function(a,c,b){if(this.ImgIcon){this.ImgIcon.width=a;this.ImgIcon.height=c;this.ImgIcon.style.display=""}if(this.FLImg&&this.FLImg.tagName=="IMG"){this.FLImg.width=a;this.FLImg.height=c;this.FLImg.style.display=""}};function WebFrame(a){this.Identifier="";this.Collapsible=true;this.Collapsed=false;this.Lockable=false;this.Locked=false;this.Visible=true;this.Enabled=true;this.Image="";this.Caption="";this.OrgWidth=0;this.OrgHeight=0;this.Width=0;this.Height=0;this.MinWidth=0;this.MinHeight=0;this.MaxWidth=9999;this.MaxHeight=9999;this.Vertical=false;this.ShowToolbar=true;this.ShowStatusBar=true;this.Scrollbar=3;this.SmallIcons=false;this.OnlyContent=false;this.CanDrag=false;this.CanDrop=false;this.HandledKeys=0;this.FrameBorder=false;this.ChildFrame1=null;this.ChildFrame2=null;this.WebForm=a;this.ParentFrame=null;this.ParentTab=null;this.IsPreview=false;if(RD3_Glb){this.CollapseEventDef=RD3_Glb.EVENT_ACTIVE;this.MouseClickEventDef=RD3_Glb.EVENT_CLIENTSIDE;this.MouseDoubleClickEventDef=RD3_Glb.EVENT_CLIENTSIDE}this.Realized=false;this.RecalcLayout=false;this.RecalcResize=false;this.SendResize=false;this.DeltaW=0;this.DeltaH=0;this.TBScrollTimer=0;this.TBScrollDir=0;this.Collapsing=false;this.CollapsingHeight=0;this.FrameBox=null;this.ToolbarBox=null;this.TBScrollDx=null;this.TBScrollSx=null;this.ContentBox=null;this.CollapseButton=null;this.LockButton=null;this.SearchBox=null;this.IconImg=null;this.CaptionTxt=null;this.ChildBox1=null;this.ChildBox2=null;this.InResponse=false;this.MD_XPos=0;this.MD_YPos=0;this.MD_Time=0;this.MD_Button=0;this.MD_Target=null;this.MD_Clicked=false;this.IDScroll=null;this.ParentFrameIdentifier=""}WebFrame.prototype.LoadFromXml=function(a){this.LoadProperties(a)};WebFrame.prototype.ChangeProperties=function(a){this.LoadProperties(a)};WebFrame.prototype.LoadProperties=function(e){this.InResponse=true;var b=e.attributes;var g=b.length;for(var d=0;d<g;d++){var f=b.item(d);var c=f.nodeName;var a=f.nodeValue;switch(c){case"clp":this.SetCollapsible(a=="1");break;case"col":this.SetCollapsed(a=="1");break;case"lkb":this.SetLockable(a=="1");break;case"lok":this.SetLocked(a=="1");break;case"vis":this.SetVisible(a=="1");break;case"ena":this.SetEnabled(a=="1");break;case"img":this.SetImage(a);break;case"cap":this.SetCaption(a);break;case"wid":this.SetWidth(parseInt(a));break;case"hei":this.SetHeight(parseInt(a));break;case"miw":this.SetMinWidth(parseInt(a));break;case"mih":this.SetMinHeight(parseInt(a));break;case"maw":this.SetMaxWidth(parseInt(a));break;case"mah":this.SetMaxHeight(parseInt(a));break;case"orw":this.SetOrgWidth(parseInt(a));break;case"orh":this.SetOrgHeight(parseInt(a));break;case"ver":this.SetVertical(a=="1");break;case"stb":this.SetShowToolbar(a=="1");break;case"ssb":this.SetShowStatusBar(a=="1");break;case"scr":this.SetScrollbar(parseInt(a));break;case"smi":this.SetSmallIcon(a=="1");break;case"ocn":this.SetOnlyContent(a=="1");break;case"fr1":this.SetChildFrame1(a);break;case"fr2":this.SetChildFrame2(a);break;case"dra":this.SetCanDrag(a=="1");break;case"dro":this.SetCanDrop(a=="1");break;case"hks":this.SetHandledKeys(parseInt(a));break;case"dcl":this.DeleteFrame(a);break;case"frb":this.SetFrameBorder(a=="1");break;case"cln":this.SetClassName(a);break;case"clc":this.CollapseEventDef=parseInt(a);break;case"mck":this.MouseClickEventDef=parseInt(a);break;case"mdk":this.MouseDoubleClickEventDef=parseInt(a);break;case"cla":this.CollapseAnimDef=a;break;case"id":this.Identifier=a;RD3_DesktopManager.ObjectMap.add(a,this);break}}this.InResponse=false};WebFrame.prototype.SetCollapsible=function(b){if(b!=undefined){this.Collapsible=b}if(this.Realized){var a=this.Collapsible;if(this.ParentFrame&&this.ParentFrame instanceof TabbedView){a=false}if(a){this.CollapseButton.style.display=""}else{this.CollapseButton.style.display="none"}}};WebFrame.prototype.SetCollapsed=function(d,b){var a=this.Collapsed;if(d!=undefined){this.Collapsed=d}if(this.Realized&&(a!=this.Collapsed||d==undefined)){if(!this.ChildBox1&&!this.ChildBox2){var c=new GFX("frame",this.Collapsed,this,(d==undefined)||(this.WebForm.Animating)||this.IsPreview,null,this.CollapseAnimDef);c.Immediate=b?true:false;c.OldValue=(d==undefined)?!this.Collapsed:a;RD3_GFXManager.AddEffect(c)}}};WebFrame.prototype.SetLockable=function(a){if(a!=undefined){this.Lockable=a}if(this.Realized&&this.LockButton){if(this.Lockable&&!this.Collapsed){this.LockButton.style.display=""}else{this.LockButton.style.display="none"}}};WebFrame.prototype.SetLocked=function(b){if(b!=undefined){this.Locked=b}if(this.Realized&&this.LockButton){var a=(this.SmallIcons?"_sm":"")+(RD3_Glb.IsMobile()?".png":".gif");var c=!(RD3_Glb.IsAndroid()||RD3_Glb.IsIE()||RD3_Glb.IsEdge())||RD3_Glb.IsAndroid(4,4,0);if(!c&&RD3_Glb.IsMobile7()){a="-i"+a}if(this.Locked){if(RD3_Glb.IsMobile7()&&c){this.LockButton.style.webkitMaskImage="url('"+RD3_Glb.GetImgSrc("images/lock"+a)+"')";this.LockButton.style.webkitMaskRepeat="no-repeat";this.LockButton.style.webkitMaskSize="25px 25px"}else{this.LockButton.src=RD3_Glb.GetImgSrc("images/lock"+a)}RD3_TooltipManager.SetObjTitle(this.LockButton,RD3_ServerParams.TooltipUnlock+RD3_KBManager.GetFKTip(RD3_ClientParams.FKLocked))}else{if(!RD3_Glb.IsMobile()){this.LockButton.src=RD3_Glb.GetImgSrc("images/unlk"+a)}RD3_TooltipManager.SetObjTitle(this.LockButton,RD3_ServerParams.TooltipLock+RD3_KBManager.GetFKTip(RD3_ClientParams.FKLocked))}}};WebFrame.prototype.SetVisible=function(b){var a=this.Visible;if(b!=undefined){this.Visible=b}if(this.Realized){if(this.Visible){this.FrameBox.style.display="";this.RecalcLayout=true;if(!a){this.WebForm.RecalcCommands=true}}else{this.FrameBox.style.display="none"}if(this.WebForm.Realized&&a!=this.Visible){this.WebForm.RecalcLayout=true}this.RecalcResize=true}if(this.ParentTab&&this.ParentTab.Realized){this.ParentTab.SetVisible(this.Visible)}};WebFrame.prototype.SetEnabled=function(a){if(a!=undefined){this.Enabled=a}};WebFrame.prototype.SetImage=function(a){if(a!=undefined){this.Image=a}if(this.Realized){if(!this.ChildBox1&&!this.ChildBox2){if(this.Image==""){this.IconImg.style.display="none"}else{this.IconImg.src=RD3_Glb.GetImgSrc("images/"+this.Image);if(!this.Collapsed){if(RD3_Glb.Adapt4Retina(this.Identifier,this.Image,43)){this.IconImg.style.display="none"}else{this.IconImg.style.display=""}}}}}};WebFrame.prototype.SetCaption=function(a){if(a!=undefined){this.Caption=a}if(this.Realized){if(!this.ChildBox1&&!this.ChildBox2){this.CaptionTxt.innerHTML=this.Caption;if(this.Caption!=""&&this.Caption.substr(this.Caption.length-1,1)!=":"&&!this.Collapsed&&this.ShowStatusBar&&!(this instanceof Tree)){this.CaptionTxt.innerHTML+=":"}if(RD3_Glb.IsChrome()){this.CaptionTxt.style.display=(this.Caption==""?"none":"")}if(RD3_Glb.IsMobile()){RD3_Glb.AdjustCaptionPosition(this.ToolbarBox,this.CaptionTxt);if(this.ShowStatusBar){this.CaptionTxt.style.width=""}}}}};WebFrame.prototype.SetWidth=function(a){if(a!=undefined){this.Width=(a<0)?0:a}if(this.Realized){if(this.FrameBox){this.FrameBox.style.width=this.Width+"px"}if(this.InResponse&&this.WebForm){this.WebForm.RecalcLayout=true}}};WebFrame.prototype.SetHeight=function(c){if(c!=undefined){this.Height=(c<0)?0:c}if(this.Realized){var a=(this.ToolbarBox&&this.Collapsed)?this.ToolbarBox.offsetHeight:this.Height;var b=(RD3_Glb.IsTouch()&&this.WebForm.Modal&&!RD3_Glb.IsMobile())?8:0;if(this.FrameBox){if(!this.Collapsed){this.FrameBox.style.height=(this.Height+b)+"px"}else{if(this.FrameBox.offsetHeight!=a&&a>0){this.FrameBox.style.height=(a+b)+"px"}}}if(this.InResponse&&this.WebForm){this.WebForm.RecalcLayout=true}}};WebFrame.prototype.SetOrgHeight=function(a){this.OrgHeight=a};WebFrame.prototype.SetOrgWidth=function(a){this.OrgWidth=a};WebFrame.prototype.SetMinWidth=function(a){if(a!=undefined){this.MinWidth=a}if(this.Realized){this.WebForm.RecalcLayout=true}};WebFrame.prototype.SetMaxWidth=function(a){if(a!=undefined){this.MaxWidth=a}if(this.Realized){this.WebForm.RecalcLayout=true}};WebFrame.prototype.SetMinHeight=function(a){if(a!=undefined){this.MinHeight=a}if(this.Realized){this.WebForm.RecalcLayout=true}};WebFrame.prototype.SetMaxHeight=function(a){if(a!=undefined){this.MaxHeight=a}if(this.Realized){this.WebForm.RecalcLayout=true}};WebFrame.prototype.SetVertical=function(a){if(a!=undefined){this.Vertical=a}};WebFrame.prototype.SetShowToolbar=function(a){if(a!=undefined){this.ShowToolbar=a}};WebFrame.prototype.SetShowStatusBar=function(a){if(a!=undefined){this.ShowStatusBar=a}};WebFrame.prototype.SetScrollbar=function(c){if(c!=undefined){this.Scrollbar=c}if(this.Realized){if(this.ContentBox){var b="";var a="";switch(this.Scrollbar){case RD3_Glb.FORMSCROLL_NONE:b="hidden";a="hidden";break;case RD3_Glb.FORMSCROLL_HORIZ:b="auto";a="hidden";break;case RD3_Glb.FORMSCROLL_VERT:b="hidden";a="auto";break;case RD3_Glb.FORMSCROLL_BOTH:b="auto";a="auto";break}if(this instanceof SubForm||RD3_Glb.IsMobile()){b="hidden";a="hidden"}this.ContentBox.style.overflowX=b;this.ContentBox.style.overflowY=a}if(this.IDScroll){this.IDScroll.AllowXScroll=this instanceof Book&&(this.Scrollbar==RD3_Glb.FORMSCROLL_HORIZ||this.Scrollbar==RD3_Glb.FORMSCROLL_BOTH);this.IDScroll.AllowYScroll=(this.Scrollbar==RD3_Glb.FORMSCROLL_VERT||this.Scrollbar==RD3_Glb.FORMSCROLL_BOTH);if(this.IDScroll.AllowXScroll){this.IDScroll.CreateScrollObj(0)}if(this.IDScroll.AllowYScroll){this.IDScroll.CreateScrollObj(1)}}}};WebFrame.prototype.SetSmallIcon=function(b){if(b!=undefined){this.SmallIcons=b}if(this.Realized){if(!RD3_Glb.IsMobile()&&!this.ChildBox1&&!this.ChildBox2){var a=(this.SmallIcons?"_sm":"");if(this.Collapsed){this.CollapseButton.src=RD3_Glb.GetImgSrc("images/expand"+a+".gif")}else{this.CollapseButton.src=RD3_Glb.GetImgSrc("images/collapse"+a+".gif")}if(this.Locked){this.LockButton.src=RD3_Glb.GetImgSrc("images/unlk"+a+".gif")}else{this.LockButton.src=RD3_Glb.GetImgSrc("images/lock"+a+".gif")}}}};WebFrame.prototype.SetOnlyContent=function(a){if(a!=undefined){this.OnlyContent=a}if(this.Realized){if(!this.ChildBox1&&!this.ChildBox2){if(this.OnlyContent){this.ToolbarBox.style.display="none"}else{this.ToolbarBox.style.display=""}}}};WebFrame.prototype.SetChildFrame1=function(a){if(a!=undefined){this.ChildFrame1=a}};WebFrame.prototype.SetChildFrame2=function(a){if(a!=undefined){this.ChildFrame2=a}};WebFrame.prototype.SetCanDrag=function(a){if(a!=undefined){this.CanDrag=a}};WebFrame.prototype.SetCanDrop=function(a){if(a!=undefined){this.CanDrop=a}};WebFrame.prototype.SetHandledKeys=function(a){if(a!=undefined){this.HandledKeys=a}};WebFrame.prototype.SetFrameBorder=function(a){if(a!=undefined){this.FrameBorder=a}if(this.FrameBorder&&this.WebForm&&this.WebForm.SubFormObj){this.WebForm.SubFormObj.FrameBorder=true}};WebFrame.prototype.GetFrameBorder=function(){if(this.ChildFrame1&&this.ChildFrame2){return this.ChildFrame1.GetFrameBorder()||this.ChildFrame2.GetFrameBorder()}else{return this.FrameBorder}};WebFrame.prototype.SetClassName=function(b){var a=this.ClassName;if(b!=undefined){this.ClassName=b}if(this.Realized&&this.FrameBox){if(a){RD3_Glb.RemoveClass(this.FrameBox,a)}if(this.ClassName){RD3_Glb.AddClass(this.FrameBox,this.ClassName)}}};WebFrame.prototype.Realize=function(a){if(this.ChildFrame1&&this.ChildFrame2){this.ChildBox1=document.createElement("div");this.ChildBox1.setAttribute("id",this.Identifier+":f1");this.ChildBox1.className="frame-container-"+(this.Vertical?"top":"left");this.ChildBox2=document.createElement("div");this.ChildBox2.setAttribute("id",this.Identifier+":f2");this.ChildBox2.className="frame-container-"+(this.Vertical?"bottom":"rigth");if(this.ChildFrame1.GetFrameBorder()||this.ChildFrame2.GetFrameBorder()){RD3_Glb.AddClass(this.ChildBox2,"frame-border-"+(this.Vertical?"top":"left"))}a.appendChild(this.ChildBox1);a.appendChild(this.ChildBox2);this.ChildFrame1.Realize(this.ChildBox1);this.ChildFrame2.Realize(this.ChildBox2);this.ChildFrame1.ParentFrame=this;this.ChildFrame2.ParentFrame=this;this.Realized=true}else{this.FrameBox=document.createElement("div");this.FrameBox.setAttribute("id",this.Identifier);this.FrameBox.className="frame-container";if(RD3_Glb.IsChrome()&&RD3_Glb.IsMobile()){this.FrameBox.style.webkitTransformStyle="flat"}this.FrameBox.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseDown', ev)");this.FrameBox.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnMouseUp', ev)");this.RealizeToolbar();this.ContentBox=document.createElement("div");this.ContentBox.setAttribute("id",this.Identifier+":cnt");this.ContentBox.className="frame-content-container";if(!(this instanceof SubForm)){this.ContentBox.style.margin=RD3_ClientParams.StandardPadding+"px"}if(RD3_Glb.IsMobile()){window.setTimeout("document.getElementById('"+this.ContentBox.id+"').scrollTop='0px'",50)}if(RD3_Glb.IsTouch()&&!RD3_Glb.IsMobile()&&!RD3_Glb.IsIE(10,true)){this.ContentBox.addEventListener("touchstart",new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTouchStart', ev)"),false);this.ContentBox.addEventListener("touchmove",new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTouchMove', ev)"),false);this.ContentBox.addEventListener("touchend",new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTouchEnd', ev)"),false);this.TouchStartX=-1;this.TouchStartY=-1}this.FrameBox.appendChild(this.ToolbarBox);this.FrameBox.appendChild(this.ContentBox);a.appendChild(this.FrameBox);this.Realized=true;this.SetSmallIcon();this.SetCollapsible();this.SetCollapsed();this.SetLockable();this.SetLocked();this.SetVisible();this.SetEnabled();this.SetImage();this.SetCaption();this.SetShowToolbar();this.SetShowStatusBar();this.SetScrollbar();this.SetOnlyContent();this.SetClassName();if(this.SetSearchValue&&this.SearchBox){this.SetSearchBoxValue(this.SetSearchValue);this.SetSearchValue=null}}};WebFrame.prototype.RealizeToolbar=function(){this.ToolbarBox=document.createElement("div");this.ToolbarBox.setAttribute("id","tl:"+this.Identifier);this.ToolbarBox.className=(this.SmallIcons)?"frame-toolbarsmall-container":"frame-toolbar-container";this.TBScrollDx=document.createElement("div");this.TBScrollDx.setAttribute("id","tbsbdx:"+this.Identifier);this.TBScrollDx.className=(this.SmallIcons)?"frame-toolbarsmall-scrollbox-dx":"frame-toolbar-scrollbox-dx";this.TBScrollSx=document.createElement("div");this.TBScrollSx.setAttribute("id","tbsbsx:"+this.Identifier);this.TBScrollSx.className=(this.SmallIcons)?"frame-toolbarsmall-scrollbox-sx":"frame-toolbar-scrollbox-sx";if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.ToolbarBox.addEventListener("touchstart",new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTouchStartTb', ev)"),false);this.ToolbarBox.addEventListener("touchmove",new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTouchMoveTb', ev)"),false);this.ToolbarBox.addEventListener("touchend",new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnTouchEndTb', ev)"),false);this.TbTouchStartX=-1;this.TbTouchStartY=-1}else{if(!RD3_Glb.IsMobile()){this.ToolbarBox.onmousemove=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollToolbar', ev)");this.TBScrollDx.onmousemove=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollToolbar', ev)");this.TBScrollSx.onmousemove=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnScrollToolbar', ev)")}}this.CollapseButton=document.createElement("img");this.CollapseButton.setAttribute("id",this.Identifier+":collapse");this.CollapseButton.className="frame-toolbar-button"+((this.SmallIcons)?"-small":"")+" frame-collapse-button";this.CollapseButton.style.marginLeft="4px";this.LockButton=document.createElement("img");this.LockButton.setAttribute("id",this.Identifier+":lock");this.LockButton.className="frame-toolbar-button"+((this.SmallIcons)?"-small":"")+" frame-lock-button";if(RD3_Glb.IsMobile()&&this instanceof IDPanel){this.SearchBox=document.createElement("input");this.SearchBox.setAttribute("id",this.Identifier+":se");this.SearchBox.placeholder=ClientMessages.MOB_SEARCH_HINT;this.SearchBox.className="frame-search-box"+((this.SmallIcons)?"-small":"");this.SearchBox.onchange=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnSearchChange', ev)");if(RD3_Glb.IsIE(10,true)){this.SearchBox.onkeypress=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnSearchKeyPress', ev)")}var c=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnSearchKeyUp', ev)");var b=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnSearchMouseDown', ev)");var a=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnSearchBlur', ev)");if(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true)){this.SearchBox.addEventListener("touchstart",b,false);this.SearchBox.addEventListener("keyup",c,true);this.SearchBox.addEventListener("blur",a,true)}else{if(document.addEventListener){this.SearchBox.addEventListener("mousedown",b,false);this.SearchBox.addEventListener("keyup",c,true);this.SearchBox.addEventListener("blur",a,true)}else{this.SearchBox.attachEvent("onmousedown",b);this.SearchBox.attachEvent("onkeyup",c,true);this.SearchBox.addEventListener("onblur",a,true)}}}this.IconImg=document.createElement("img");this.IconImg.className="frame-toolbar-icon";this.CaptionTxt=document.createElement("span");this.CaptionTxt.setAttribute("id",this.Identifier+":caption");this.CaptionTxt.className=(this.SmallIcons)?"frame-toolbarsmall-caption":"frame-toolbar-caption";if(!RD3_Glb.IsTouch()){this.CaptionTxt.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCaptionClick', ev)")}this.CollapseButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnCollapseClick', ev)");this.CollapseButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.CollapseButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.CollapseButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.CollapseButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.LockButton.onclick=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnLockClick', ev)");this.LockButton.onmouseover=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.LockButton.onmousedown=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'down')");this.LockButton.onmouseout=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, '')");this.LockButton.onmouseup=new Function("ev","return RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnToolMouseUse', ev, 'hover')");this.ToolbarBox.appendChild(this.CollapseButton);this.ToolbarBox.appendChild(this.LockButton);if(RD3_Glb.IsMobile()&&this instanceof IDPanel){this.ToolbarBox.appendChild(this.SearchBox)}this.ToolbarBox.appendChild(this.IconImg);this.ToolbarBox.appendChild(this.CaptionTxt);this.FrameBox.appendChild(this.ToolbarBox);this.FrameBox.appendChild(this.TBScrollDx);this.FrameBox.appendChild(this.TBScrollSx)};WebFrame.prototype.OnToolMouseUse=function(d,b){var a=(window.event)?window.event:d;var c=(window.event)?window.event.srcElement:d.target;if(c){if(!RD3_Glb.IsMobile()){c.className="frame-toolbar-button"+((this.SmallIcons)?"-small":"")+((b=="")?"":"-"+b)}}};WebFrame.prototype.OnScrollToolbar=function(c){if(!this.ToolbarBox){return}var a=window.event?window.event.offsetX:c.layerX;var b=(window.event)?window.event.srcElement:c.explicitOriginalTarget;if(b==this.ToolbarBox){a-=this.ToolbarBox.scrollLeft}if(b==this.TBScrollDx){a=this.ToolbarBox.clientWidth;b=this.ToolbarBox}if(b==this.TBScrollSx){a=0;b=this.ToolbarBox}if(b&&b!=this.ToolbarBox&&b.offsetLeft>0){a-=this.ToolbarBox.scrollLeft;if(b.className=="panel-toolbar-button"){a+=b.offsetLeft;b=this.ToolbarBox}}if(b==this.ToolbarBox&&this.ToolbarBox.scrollWidth>this.ToolbarBox.clientWidth+4){if(a>this.ToolbarBox.clientWidth-24){this.ScrollToolbar(1)}else{if(a<24){this.ScrollToolbar(-1)}else{this.ScrollToolbar(0)}}}};WebFrame.prototype.ScrollingToolbar=function(){var a=this.ToolbarBox.scrollLeft;this.ToolbarBox.scrollLeft+=this.TBScrollDir*(RD3_Glb.IsIE()?2:1);if(this.ToolbarBox.scrollLeft==a){this.ScrollToolbar(0)}};WebFrame.prototype.ScrollToolbar=function(a){if(this.TBScrollTimer&&this.TBScrollDir!=a){window.clearInterval(this.TBScrollTimer);this.TBScrollTimer=0;this.TBScrollDir=0}if(!this.TBScrollTimer&&a){this.TBScrollDir=a;this.TBScrollTimer=window.setInterval("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'ScrollingToolbar')",10)}if(!a){this.AdaptScrollBox()}};WebFrame.prototype.AdaptLayout=function(){if(this.ChildFrame1&&this.ChildFrame2){this.SetChildLayout();this.ChildFrame1.AdaptLayout();this.ChildFrame2.AdaptLayout()}else{if(this.ParentTab){RD3_Glb.AdaptToParent(this.FrameBox,0,0);this.Width=this.FrameBox.clientWidth;this.Height=this.FrameBox.clientHeight}var c=0;if(!this instanceof TabbedView){c=2*RD3_ClientParams.StandardPadding}RD3_Glb.AdaptToParent(this.ToolbarBox,0,-1);RD3_Glb.AdaptToParent(this.ContentBox,this.GetHContentOffset()+c,this.GetContentOffset()+c);this.ContentBoxOffsetWidth=this.ContentBox.offsetWidth;this.ContentBoxOffsetHeight=this.ContentBox.offsetHeight;this.ContentBoxClientWidth=this.ContentBox.clientWidth;this.ContentBoxClientHeight=this.ContentBox.clientHeight;this.AdaptScrollBox();if(this.SendResize){var b=this.IsResizeImmediate()?RD3_Glb.EVENT_ACTIVE:RD3_Glb.EVENT_SERVERSIDE;if(this instanceof Graph||this instanceof Book){var a=new IDEvent("resize",this.Identifier,null,b,null,this.ContentBox.clientWidth,this.ContentBox.clientHeight)}else{var a=new IDEvent("resize",this.Identifier,null,b,null,this.FrameBox.clientWidth,this.FrameBox.clientHeight)}}}this.RecalcLayout=false;this.SendResize=false};WebFrame.prototype.AdaptScrollBox=function(){if(!this.ToolbarBox||RD3_Glb.IsMobile()){return}if(this.TBScrollDx){if(this.ToolbarBox.scrollWidth-this.ToolbarBox.scrollLeft>this.ToolbarBox.clientWidth+4){this.TBScrollDx.style.display="block";this.TBScrollDx.style.left=(this.ToolbarBox.offsetWidth-this.TBScrollDx.offsetWidth)+"px"}else{this.TBScrollDx.style.display="none"}}if(this.TBScrollSx){if(this.ToolbarBox.scrollLeft>0){this.TBScrollSx.style.display="block"}else{this.TBScrollSx.style.display="none"}}};WebFrame.prototype.IsResizeImmediate=function(){return false};WebFrame.prototype.Unrealize=function(){if(this.FrameBox){this.FrameBox.parentNode.removeChild(this.FrameBox)}if(this.ChildFrame1&&this.ChildFrame2){this.ChildFrame1.Unrealize();this.ChildFrame2.Unrealize()}RD3_DesktopManager.ObjectMap.remove(this.Identifier);this.ScrollToolbar(0);if(this.IDScroll){this.IDScroll.Unrealize()}this.FrameBox=null;this.ToolbarBox=null;this.ContentBox=null;this.CollapseButton=null;this.IconImg=null;this.CaptionTxt=null;this.ChildBox1=null;this.ChildBox2=null;this.Realized=false;this.RealizeDone=false};WebFrame.prototype.OnCollapseMouseOver=function(a){};WebFrame.prototype.OnCollapseMouseOut=function(a){};WebFrame.prototype.OnCollapseClick=function(b){var a=new IDEvent("col",this.Identifier,b,this.CollapseEventDef,this.Collapsed?"exp":"col");if(a.ClientSide){this.CollapseButton.focus();this.SetCollapsed(!this.Collapsed,true)}};WebFrame.prototype.AfterProcessResponse=function(){if(this.RecalcLayout&&!this.WebForm.PopupResAnimating){this.AdaptLayout();this.RecalcLayout=false}};WebFrame.prototype.Focus=function(){return false};WebFrame.prototype.HandlesTabFocus=function(){return true};WebFrame.prototype.RequestResize=function(){if(this.ChildFrame1&&this.ChildFrame2){return(this.ChildFrame1.RequestResize()||this.ChildFrame2.RequestResize())}else{return this.RecalcResize}};WebFrame.prototype.ClearRequestResize=function(){if(this.ChildFrame1&&this.ChildFrame2){this.ChildFrame1.ClearRequestResize();this.ChildFrame2.ClearRequestResize()}else{this.RecalcResize=false}};WebFrame.prototype.Resize=function(l,g){if(!this.Realized||!this.Visible){return}var c=false;if(this.AlreadyResized==undefined){c=true;this.AlreadyResized=true}if(this.ChildFrame1&&this.ChildFrame2&&this.RequestResize()){c=true}var k=this.CalcWidth();var d=this.CalcHeight();if(c&&this.Collapsed&&this.ChildFrame1==null){k=this.Width;d=this.Height}if(this.WebForm.ResModeW==RD3_Glb.FRESMODE_EXTEND){k=(l>this.OrgWidth)?l:this.OrgWidth}if(this.WebForm.ResModeW==RD3_Glb.FRESMODE_STRETCH){k=l}if(k<this.MinWidth){k=this.MinWidth}if(k>this.MaxWidth&&this.MaxWidth>0){k=this.MaxWidth}if(k<32){k=32}if(this.WebForm.ResModeH==RD3_Glb.FRESMODE_EXTEND){d=(g>this.OrgHeight)?g:this.OrgHeight}if(this.WebForm.ResModeH==RD3_Glb.FRESMODE_STRETCH){d=g}if(d<this.MinHeight){d=this.MinHeight}if(d>this.MaxHeight&&this.MaxHeight>0){d=this.MaxHeight}if(d<32&&!this.Collapsed){d=32}if(c||k!=this.CalcWidth()||d!=this.CalcHeight()){if(this.ChildFrame1&&this.ChildFrame2){if(this.Vertical){var j=(this.ChildFrame1.OrgHeight)?this.ChildFrame1.OrgHeight:this.ChildFrame1.Height;var i=(this.ChildFrame2.OrgHeight)?this.ChildFrame2.OrgHeight:this.ChildFrame2.Height;var a=0.5;if(j+i!=0){a=j/(j+i)}if(this.Height!=d){j=Math.floor(d*a)}var b=!this.ChildFrame2.Visible||this.ChildFrame2.Collapsed;if(this.ChildFrame2.ChildFrame1&&this.ChildFrame2.ChildFrame2){b=(!this.ChildFrame2.ChildFrame1.Visible&&!this.ChildFrame2.ChildFrame2.Visible)||(this.ChildFrame2.ChildFrame1.Collapsed&&this.ChildFrame2.ChildFrame2.Collapsed)}if(b){j=d-this.ChildFrame2.CalcHeight()}if(!RD3_Glb.IsMobile()){j-=(j%4)}this.ChildFrame1.Resize(k,j);if(this.ChildFrame1.Visible||this.ChildFrame2.Visible){i=d-this.ChildFrame1.CalcHeight()-((this.ChildFrame1.FrameBorder||this.ChildFrame2.FrameBorder)?RD3_ClientParams.FrameBorderTop:0)}this.ChildFrame2.Resize(k,i);if(this.ChildFrame2.CalcHeight()!=i&&!b){this.ChildFrame1.Resize(k,d-this.ChildFrame2.CalcHeight())}}else{var f=(this.ChildFrame1.OrgWidth)?this.ChildFrame1.OrgWidth:this.ChildFrame1.Width;var e=(this.ChildFrame2.OrgWidth)?this.ChildFrame2.OrgWidth:this.ChildFrame2.Width;var a=f/(f+e);if(this.Width!=k){f=Math.floor(k*a)}if(!this.ChildFrame2.Visible||this.ChildFrame2.CalcWidth()==0){f=k}if(!RD3_Glb.IsMobile()){f-=(f%4)}this.ChildFrame1.Resize(f,d);if(this.ChildFrame1.Visible||this.ChildFrame2.Visible){e=k-this.ChildFrame1.CalcWidth()-((this.ChildFrame1.FrameBorder||this.ChildFrame2.FrameBorder)?RD3_ClientParams.FrameBorderLeft:1)}this.ChildFrame2.Resize(e,d);if(this.ChildFrame2.CalcWidth()!=e){this.ChildFrame1.Resize(k-this.ChildFrame2.CalcWidth(),d)}}this.SetChildLayout()}else{if(k!=this.Width||d!=this.Height){this.SendResize=true;this.DeltaW+=k-this.Width;this.DeltaH+=d-this.Height}this.SetWidth(k);this.SetHeight(d)}if(this.ChildFrame1&&this.ChildFrame2&&this.RequestResize()){this.ClearRequestResize()}}};WebFrame.prototype.CalcWidth=function(){if(!this.Realized||!this.Visible){return 0}if(this.ChildFrame1&&this.ChildFrame2){if(!this.Vertical){return this.ChildFrame1.CalcWidth()+this.ChildFrame2.CalcWidth()}else{var b=this.ChildFrame1.CalcWidth();var a=this.ChildFrame2.CalcWidth();return(b>a)?b:a}}else{return this.Width}};WebFrame.prototype.CalcHeight=function(){if(!this.Realized||!this.Visible){return 0}if(this.ChildFrame1&&this.ChildFrame2){if(this.Vertical){return this.ChildFrame1.CalcHeight()+this.ChildFrame2.CalcHeight()}else{var b=this.ChildFrame1.CalcHeight();var a=this.ChildFrame2.CalcHeight();return(b>a)?b:a}}else{if(this.Collapsing){return this.CollapsingHeight}else{return(this.Collapsed&&this.ToolbarBox)?this.ToolbarBox.offsetHeight:this.Height}}};WebFrame.prototype.SetChildLayout=function(){var b=this.ChildFrame1.CalcWidth();var a=this.ChildFrame2.CalcWidth();this.ChildBox1.style.width=b+"px";this.ChildBox2.style.width=a+"px";var d=this.ChildFrame1.CalcHeight();this.ChildBox1.style.height=d+"px";var c=this.ChildFrame2.CalcHeight();this.ChildBox2.style.height=c+"px";if(this.Vertical){this.ChildBox2.style.top=d+"px"}else{this.ChildBox2.style.left=b+"px"}};WebFrame.prototype.GetContentOffset=function(){return this.ToolbarBox.offsetHeight};WebFrame.prototype.GetHContentOffset=function(){return 0};WebFrame.prototype.HandleFunctionKeys=function(b){var c=(b.charCode)?b.charCode:b.keyCode;var a=false;if(!a){a=this.WebForm.HandleFunctionKeys(b)}return a};WebFrame.prototype.HasFocus=function(){var a=RD3_KBManager.ActiveObject;if(a&&a.GetParentFrame){a=a.GetParentFrame()}return a==this};WebFrame.prototype.CanHaveFocus=function(){if(this.Collapsed){return false}if((typeof(this)=="IDPanel")||(typeof(this)=="Book")){return true}return false};WebFrame.prototype.SaveSize=function(){this.SavedWidth=this.Width;this.SavedHeight=this.Height;this.SavedDeltaW=this.DeltaW;this.SavedDeltaH=this.DeltaH};WebFrame.prototype.ResetSize=function(){if(this.ChildFrame1&&this.ChildFrame2){this.Width=this.SavedWidth;this.Height=this.SavedHeight}else{var a=this.WebForm.RecalcLayout;this.SetWidth(this.SavedWidth);this.SetHeight(this.SavedHeight);this.WebForm.RecalcLayout=a}this.ResetDelta()};WebFrame.prototype.ResetDelta=function(){if(this.ChildFrame1&&this.ChildFrame2){this.ChildFrame1.ResetDelta();this.ChildFrame2.ResetDelta()}else{this.DeltaW=this.SavedDeltaW;this.DeltaH=this.SavedDeltaH}};WebFrame.prototype.SetCollapsingChildLayout=function(){if(this.ChildFrame1&&this.ChildFrame2){var b=this.ChildFrame1.CalcWidth();var a=this.ChildFrame2.CalcWidth();this.ChildBox1.style.width=b+"px";this.ChildBox2.style.width=a+"px";this.ChildBox1.scrollTop="0px";this.ChildBox2.scrollTop="0px";var d=this.ChildFrame1.CalcHeight();this.ChildBox1.style.height=d+"px";var c=this.ChildFrame2.CalcHeight();this.ChildBox2.style.height=c+"px";if(this.Vertical){this.ChildBox2.style.top=d+"px"}else{this.ChildBox2.style.left=b+"px"}this.ChildFrame1.SetCollapsingChildLayout();this.ChildFrame2.SetCollapsingChildLayout()}};WebFrame.prototype.Tick=function(){if(this.ChildFrame1&&this.ChildFrame2){this.ChildFrame1.Tick();this.ChildFrame2.Tick()}else{}};WebFrame.prototype.OnMouseDown=function(b){var a=b.clientX;var f=b.clientY;if(RD3_Glb.IsTouch()&&b.targetTouches&&b.targetTouches.length>0){a=b.targetTouches[0].clientX;f=b.targetTouches[0].clientY}var e=RD3_Glb.IsTouch()?24:4;var c=new Date();if(c-this.MD_Time<400&&Math.abs(a-this.MD_XPos)<e&&Math.abs(f-this.MD_YPos)<e){return}this.MD_XPos=a;this.MD_YPos=f;this.MD_Time=c;this.MD_Button=RD3_Glb.IsTouch()?0:b.button;this.MD_Target=b.target?b.target:b.srcElement;this.MD_Clicked=false};WebFrame.prototype.OnMouseUp=function(c){if(this.RawTouchTimer){window.clearTimeout(this.RawTouchTimer);this.RawTouchTimer=null}var l=c.clientX;var j=c.clientY;if(RD3_Glb.IsTouch()&&c.changedTouches&&c.changedTouches.length>0){l=c.changedTouches[0].clientX;j=c.changedTouches[0].clientY}var m=RD3_Glb.IsTouch()?24:4;var k=c.button?c.button:0;var o=c.target?c.target:c.srcElement;var h=new Date();var e=(k==this.MD_Button||k==999);if(k==999){k=2}if(Math.abs(l-this.MD_XPos)<m&&Math.abs(j-this.MD_YPos)<m&&e&&o==this.MD_Target){var n=false;if(this.MD_Clicked&&h-this.MD_Time<400){n=true}if(RD3_Glb.IsIE()){if(k&1){k=0}else{if(k&2){k=2}else{if(k&4){k=1}}}}var f=l-RD3_Glb.GetScreenLeft(this.FrameBox);var a=j-RD3_Glb.GetScreenTop(this.FrameBox);var i=true;var g=o;while(g){if(RD3_Glb.HasClass(g,"frame-container")){i=(g==this.FrameBox);break}g=g.parentNode}if(i){this.OnFrameClick(c,n,k,f,a,l,j,o)}this.MD_Clicked=!n}};WebFrame.prototype.OnTouchDown=function(a){this.OnMouseDown(a);this.RawTouchTimer=window.setTimeout("RD3_DesktopManager.CallEventHandler('"+this.Identifier+"', 'OnRawRightClick')",750);return true};WebFrame.prototype.OnTouchUp=function(b,a){if(a){if(this.RawTouchTimer!=null){this.OnMouseUp(b)}}else{if(this.RawTouchTimer){window.clearTimeout(this.RawTouchTimer);this.RawTouchTimer=null}}return true};WebFrame.prototype.OnRawRightClick=function(){this.RawTouchTimer=null;var a=new Object();a.clientX=this.MD_XPos;a.clientY=this.MD_YPos;a.button=999;a.target=this.MD_Target;this.OnMouseUp(a)};WebFrame.prototype.OnFrameClick=function(f,d,c,b,h,g,a,e){};WebFrame.prototype.GetTooltip=function(b,c){var a=false;if(c==this.LockButton){if(this.Locked){b.SetTitle(ClientMessages.TIP_TITLE_TooltipUnlock);b.SetText(RD3_ServerParams.TooltipUnlock+RD3_KBManager.GetFKTip(RD3_ClientParams.FKLocked))}else{b.SetTitle(ClientMessages.TIP_TITLE_TooltipLock);b.SetText(RD3_ServerParams.TooltipLock+RD3_KBManager.GetFKTip(RD3_ClientParams.FKLocked))}a=true}else{if(c==this.CollapseButton){if(this.Collapsed){b.SetTitle(ClientMessages.TIP_TITLE_MostraRiquadro);b.SetText(RD3_ServerParams.MostraRiquadro)}else{b.SetTitle(ClientMessages.TIP_TITLE_NascondiRiquadro);b.SetText(RD3_ServerParams.NascondiRiquadro)}a=true}}if(a){b.SetAnchor(RD3_Glb.GetScreenLeft(c)+((c.offsetWidth-4)/2),RD3_Glb.GetScreenTop(c));b.SetPosition(0);return true}return false};WebFrame.prototype.GetDOMObj=function(){return this.ContentBox};WebFrame.prototype.DeleteFrame=function(b){var c=this.WebForm.Frames.length;for(var a=0;a<c;a++){if(this.WebForm.Frames[a]==this){this.WebForm.Frames.splice(a,1);this.Unrealize();break}}};WebFrame.prototype.OnTouchStartTb=function(d){if(d.targetTouches.length!=1){return false}var b=RD3_Glb.ElementFromPoint(d.targetTouches[0].clientX,d.targetTouches[0].clientY);if(b&&((b.tagName=="INPUT"&&b.type!="button")||b.tagName=="TEXTAREA"||RD3_Glb.isInsideEditor(b))){return false}if(RD3_Glb.IsMobile()&&this.SearchBox){this.SearchBox.blur()}d.preventDefault();var c=RD3_Glb.ElementFromPoint(d.targetTouches[0].clientX,d.targetTouches[0].clientY);var a=RD3_Glb.HasClass(c,"panel-formlist-button")||RD3_Glb.HasClass(c,"panel-formlist-arrow");if(a){RD3_Glb.AddClass(this.FormListButton,"panel-toolbar-active");RD3_Glb.AddClass(this.FormListButtonImg,"panel-toolbar-active")}this.TbTouchStartX=d.targetTouches[0].clientX;this.TbTouchStartY=d.targetTouches[0].clientY;this.TbTouchOrgX=this.TbTouchStartX;this.TbTouchOrgY=this.TbTouchStartY;this.TbMoved=false;return false};WebFrame.prototype.OnTouchMoveTb=function(b){if(this.TbTouchStartX==-1){return false}b.preventDefault();if(b.targetTouches.length!=1){return false}var a=b.targetTouches[0].clientX-this.TbTouchStartX;var c=b.targetTouches[0].clientY-this.TbTouchStartY;if(!RD3_Glb.IsMobile()){this.ToolbarBox.scrollLeft-=a;this.AdaptScrollBox()}this.TbTouchStartX=b.targetTouches[0].clientX;this.TbTouchStartY=b.targetTouches[0].clientY;if(Math.abs(this.TbTouchStartX-this.TbTouchOrgX)>RD3_ClientParams.TouchMoveLimit||Math.abs(this.TbTouchStartY-this.TbTouchOrgY)>RD3_ClientParams.TouchMoveLimit){this.TbMoved=true}return false};WebFrame.prototype.OnTouchEndTb=function(f){if(this.TbTouchStartX==-1){return false}f.preventDefault();if(f.targetTouches.length!=0){return false}if(f.changedTouches.length==1){var d=RD3_Glb.ElementFromPoint(f.changedTouches[0].clientX,f.changedTouches[0].clientY);var a=RD3_Glb.GetParentFrame(d);var c=d.tagName=="IMG"||d.tagName=="INPUT";var b=RD3_Glb.HasClass(d,"panel-formlist-button")||RD3_Glb.HasClass(d,"panel-formlist-arrow");if(RD3_Glb.HasClass(d,"toolbar-command-showcaption")){c=true}if(d&&a==this&&(c||b)&&!this.TbMoved){var g=document.createEvent("MouseEvents");g.initMouseEvent("click",true,true,window,1,this.TbTouchStartX,this.TbTouchStartY,this.TbTouchStartX,this.TbTouchStartY);d.dispatchEvent(g);if(!RD3_Glb.IsMobile()){if(RD3_Glb.HasClass(d,"toolbar-frame-image")){RD3_Glb.TouchHL(d)}else{if(d.tagName=="INPUT"||RD3_Glb.HasClass(d,"toolbar-command-showcaption")){RD3_Glb.TouchHL(d)}else{d.className="frame-toolbar-button"+((this.SmallIcons)?"-small":"")+"-down";window.setTimeout("document.getElementById('"+d.id+"').className = 'frame-toolbar-button"+((this.SmallIcons)?"-small":"")+"'",300)}}}}if(d==this.CaptionTxt&&this.IDScroll&&!this.TbMoved){this.IDScroll.GoTop()}if(d==this.CaptionTxt&&this.WebForm.Messages.length>0){this.WebForm.OpenMessageBar(100)}if(b){RD3_Glb.RemoveClass(this.FormListButton,"panel-toolbar-active");RD3_Glb.RemoveClass(this.FormListButtonImg,"panel-toolbar-active")}}this.TbTouchStartX=-1;this.TbTouchStartY=-1;this.TbTouchOrgX=-1;this.TbTouchOrgY=-1;this.TbMoved=false;return false};WebFrame.prototype.OnTouchStart=function(a){if(RD3_DesktopManager.WebEntryPoint.CalPopup.style.display!="none"){RD3_DesktopManager.WebEntryPoint.CalPopup.style.display="none"}if(RD3_DDManager.OpenCombo){RD3_DDManager.OpenCombo.Close()}RD3_DesktopManager.WebEntryPoint.OnClick(a);this.WebForm.OpenMessageBar(-1);this.FormScroll=true;this.WebForm.OnTouchStart(a)};WebFrame.prototype.OnTouchMove=function(a){if(this.FormScroll){this.WebForm.OnTouchMove(a)}};WebFrame.prototype.OnTouchEnd=function(a){if(this.FormScroll){this.WebForm.OnTouchEnd(a)}RD3_TooltipManager.DeactivateAll()};WebFrame.prototype.IsTransformable=function(a){if(this.ChildFrame1&&this.ChildFrame2){if(this.Vertical){return !((this.ChildFrame1.MinHeight==this.ChildFrame1.MaxHeight&&this.ChildFrame1.MinHeight!=0)||(this.ChildFrame2.MinHeight==this.ChildFrame2.MaxHeight&&this.ChildFrame2.MinHeight!=0)||RD3_ServerParams.EnableFrameResize==false)}else{return !((this.ChildFrame1.MinWidth==this.ChildFrame1.MaxWidth&&this.ChildFrame1.MinWidth!=0)||(this.ChildFrame2.MinWidth==this.ChildFrame2.MaxWidth&&this.ChildFrame2.MinWidth!=0)||RD3_ServerParams.EnableFrameResize==false)}}else{if(this.ParentFrame){return this.ParentFrame.IsTransformable(a)}else{return false}}};WebFrame.prototype.IsMoveable=function(){return false};WebFrame.prototype.DragObj=function(g,d,a,f){if(!this.ParentFrame){return null}var c=a-RD3_Glb.GetScreenLeft(d);var b=f-RD3_Glb.GetScreenTop(d);var e=0;if(c<=10){e=1}else{if(c>=(d.offsetWidth-10)){e=2}else{if(b<=10){e=3}else{if(b>=(d.offsetHeight-10)){e=4}}}}if(e==0){return this}if(e==1&&!(!this.ParentFrame.Vertical&&this.ParentFrame.ChildFrame2==this)){return this.ParentFrame.DragObj(g,d,a,f)}if(e==2&&!(!this.ParentFrame.Vertical&&this.ParentFrame.ChildFrame1==this)){return this.ParentFrame.DragObj(g,d,a,f)}if(e==3&&!(this.ParentFrame.Vertical&&this.ParentFrame.ChildFrame2==this)){return this.ParentFrame.DragObj(g,d,a,f)}if(e==4&&!(this.ParentFrame.Vertical&&this.ParentFrame.ChildFrame1==this)){return this.ParentFrame.DragObj(g,d,a,f)}return this};WebFrame.prototype.DropElement=function(){if(this.FrameBox){return this.FrameBox}else{if(this.ParentFrame&&this.ParentFrame.ChildFrame1==this){return this.ParentFrame.ChildBox1}else{if(this.ParentFrame&&this.ParentFrame.ChildFrame2==this){return this.ParentFrame.ChildBox2}}}};WebFrame.prototype.ApplyCursor=function(a){if(this.ChildFrame1&&this.ChildFrame2){this.ChildFrame1.ApplyCursor(a);this.ChildFrame2.ApplyCursor(a)}else{if(this.FrameBox){this.FrameBox.style.cursor=a}}};WebFrame.prototype.CanResizeW=function(){if(this.ParentFrame){return !this.ParentFrame.Vertical}else{return false}};WebFrame.prototype.CanResizeH=function(){if(this.ParentFrame){return this.ParentFrame.Vertical}else{return false}};WebFrame.prototype.CanResizeL=function(){if(this.ParentFrame){if(this.ParentFrame.ChildFrame2==this){return !this.ParentFrame.Vertical}else{return this.ParentFrame.CanResizeL()}}else{return false}};WebFrame.prototype.CanResizeR=function(){if(this.ParentFrame){if(this.ParentFrame.ChildFrame1==this){return !this.ParentFrame.Vertical}else{return this.ParentFrame.CanResizeR()}}else{return false}};WebFrame.prototype.CanResizeT=function(){if(this.ParentFrame){if(this.ParentFrame.ChildFrame2==this){return this.ParentFrame.Vertical}else{return this.ParentFrame.CanResizeT()}}else{return false}};WebFrame.prototype.CanResizeD=function(){if(this.ParentFrame){if(this.ParentFrame.ChildFrame1==this){return this.ParentFrame.Vertical}else{return this.ParentFrame.CanResizeD()}}else{return false}};WebFrame.prototype.OnTransform=function(l,j,m,g,b){if(!this.ParentFrame){return}var n=this.ParentFrame.ChildFrame1==this?this.ParentFrame.ChildFrame2:this.ParentFrame.ChildFrame1;if(this.ParentFrame.Vertical){var p=RD3_ClientParams.FrameMinimumSize>this.MinHeight?RD3_ClientParams.FrameMinimumSize:this.MinHeight;if(g<p){g=p}p=RD3_ClientParams.FrameMinimumSize>n.MinHeight?RD3_ClientParams.FrameMinimumSize:n.MinHeight;if(g>this.ParentFrame.CalcHeight()-p){g=this.ParentFrame.CalcHeight()-p}if(this.MaxHeight>0&&g>this.MaxHeight){g=this.MaxHeight}if(n.MaxHeight>0&&this.ParentFrame.CalcHeight()-g>n.MaxHeight){g=this.ParentFrame.CalcHeight()-n.MaxHeight}var o=g-this.CalcHeight();var a=this.WebForm.ResModeH;var f=this.WebForm.ResModeW;if(a!=RD3_Glb.FRESMODE_STRETCH){this.WebForm.ResModeH=RD3_Glb.FRESMODE_STRETCH}if(f!=RD3_Glb.FRESMODE_STRETCH){this.WebForm.ResModeW=RD3_Glb.FRESMODE_STRETCH}this.Resize(this.CalcWidth(),g);this.OrgHeight=this.Height;n.Resize(n.CalcWidth(),n.CalcHeight()-o);n.OrgHeight=n.Height;this.WebForm.ResModeH=a;this.WebForm.ResModeW=f;this.ParentFrame.SetChildLayout();this.AdaptLayout();n.AdaptLayout()}else{var d=RD3_ClientParams.FrameMinimumSize>this.MinWidth?RD3_ClientParams.FrameMinimumSize:this.MinWidth;if(m<d){m=d}d=RD3_ClientParams.FrameMinimumSize>n.MinWidth?RD3_ClientParams.FrameMinimumSize:n.MinWidth;if(m>this.ParentFrame.CalcWidth()-d){m=this.ParentFrame.CalcWidth()-d}if(this.MaxWidth>0&&m>this.MaxWidth){m=this.MaxWidth}if(n.MaxWidth>0&&this.ParentFrame.CalcWidth()-m>n.MaxWidth){m=this.ParentFrame.CalcWidth()-n.MaxWidth}var c=m-this.CalcWidth();var a=this.WebForm.ResModeH;var f=this.WebForm.ResModeW;if(a!=RD3_Glb.FRESMODE_STRETCH){this.WebForm.ResModeH=RD3_Glb.FRESMODE_STRETCH}if(f!=RD3_Glb.FRESMODE_STRETCH){this.WebForm.ResModeW=RD3_Glb.FRESMODE_STRETCH}this.Resize(m,this.CalcHeight());this.OrgWidth=this.Width;n.Resize(n.CalcWidth()-c,n.CalcHeight());n.OrgWidth=n.Width;this.WebForm.ResModeH=a;this.WebForm.ResModeW=f;this.ParentFrame.SetChildLayout();this.AdaptLayout();n.AdaptLayout()}var k=this.WebForm.PopupFrame?this.WebForm.PopupFrame.PopupBox.clientWidth:this.WebForm.FramesBox.clientWidth;var e=this.WebForm.PopupFrame?this.WebForm.PopupFrame.PopupBox.clientHeight:this.WebForm.FramesBox.clientHeight;var i=new IDEvent("resize",this.WebForm.Identifier,null,this.WebForm.ResizeEventDef,null,k,e)};WebFrame.prototype.OnSearchChange=function(c,b){if(this.SearchBox.value!=""){RD3_Glb.AddClass(this.SearchBox,"frame-search-box-deletable")}else{RD3_Glb.RemoveClass(this.SearchBox,"frame-search-box-deletable")}if(this.lastSearchSent!=this.SearchBox.value){var a=new IDEvent("srcbox",this.Identifier,c,RD3_Glb.EVENT_ACTIVE,this.SearchBox.value);this.lastSearchSent=this.SearchBox.value}if(b){return}this.SearchBox.blur()};WebFrame.prototype.OnSearchKeyPress=function(a){if(a.keyCode==13){this.OnSearchChange(a)}};WebFrame.prototype.OnSearchKeyUp=function(a){if(this.SearchBox.value!=""){RD3_Glb.AddClass(this.SearchBox,"frame-search-box-deletable")}else{RD3_Glb.RemoveClass(this.SearchBox,"frame-search-box-deletable")}if(!RD3_Glb.IsSmartPhone()){if(this.searchTimer!=null){window.clearTimeout(this.searchTimer);this.searchTimer=null}var b=this;this.searchTimer=window.setTimeout(function(){if(b.lastSearchSent!=b.SearchBox.value){var c=new IDEvent("srcbox",b.Identifier,a,RD3_Glb.EVENT_ACTIVE,b.SearchBox.value);b.lastSearchSent=b.SearchBox.value}},300)}};WebFrame.prototype.OnSearchMouseDown=function(c){if(!RD3_Glb.IsSmartPhone()&&!RD3_Glb.IsQuadro()){var b=this.CaptionTxt.offsetLeft-this.SearchBox.offsetLeft-4;b=(b>200?200:(b<102?102:b));this.SearchBox.style.width=b+"px"}if(!RD3_Glb.HasClass(this.SearchBox,"frame-search-box-deletable")){return}var a=(RD3_Glb.IsTouch()&&!RD3_Glb.IsIE(10,true))?c.targetTouches[0].clientX:c.clientX;var d=a-(RD3_Glb.GetScreenLeft(this.SearchBox,true)+this.SearchBox.offsetWidth);if(d<0&&d>=-40){this.SearchBox.value="";this.OnSearchChange(c,RD3_Glb.IsAndroid());if(!RD3_Glb.IsAndroid()){this.OnSearchBlur()}delete this.lastSearchSent;c.preventDefault();RD3_Glb.StopEvent(c);return false}};WebFrame.prototype.OnSearchBlur=function(a){this.SearchBox.style.width="";if((RD3_Glb.IsIphone(7)||RD3_Glb.IsIpad(7))&&RD3_Glb.IsMobile()){window.setTimeout("document.body.scrollTop = 0;",50)}};WebFrame.prototype.SetSearchBoxValue=function(a){if(!this.Realized||!this.SearchBox){this.SetSearchValue=a;return}this.SearchBox.value=a;delete this.lastSearchSent;if(a!=""){RD3_Glb.AddClass(this.SearchBox,"frame-search-box-deletable")}else{RD3_Glb.RemoveClass(this.SearchBox,"frame-search-box-deletable")}};WebFrame.prototype.OnCaptionClick=function(a){if(this.WebForm.Messages.length>0){this.WebForm.OpenMessageBar(100)}else{if(this.IDScroll){this.IDScroll.GoTop()}}};WebFrame.prototype.GetCustomToolbar=function(){if(!this.ToolbarBox){return}var a=this.ToolbarBox.firstChild;while(a){if(RD3_Glb.HasClass(a,"toolbar-frame-container")){return a}a=a.nextSibling}};WebFrame.prototype.OnReflectMouseDown=function(d,c,e){if(c&&(!this.IsSubObj()||!this.MustReflectScrollToParent(e))){return -1}if(c||(this.IsSubObj()&&this.MustReflectScrollToParent(e))){var b=this.WebForm.SubFormObj;if(b instanceof SubForm){b=RD3_DesktopManager.ObjectMap[b.ParentFrameIdentifier]}else{if(b==null){b=RD3_DesktopManager.ObjectMap[this.ParentFrameIdentifier]}}if(!b){return -1}var a=-1;if(b instanceof BookBox){a=b.ParentPage.ParentBook.OnReflectMouseDown(d,false,e)}else{if(b instanceof PField){a=b.ParentPanel.OnReflectMouseDown(d,false,e)}}return a}else{if(!c&&this.IDScroll){this.IDScroll.OnMouseDown(d,true);return 1}}return -1};WebFrame.prototype.OnReflectMouseMove=function(c,b){if(b&&!this.IsSubObj()){return}if(b||this.IsSubObj()){var a=this.WebForm.SubFormObj;if(a instanceof SubForm){a=RD3_DesktopManager.ObjectMap[a.ParentFrameIdentifier]}else{if(a==null){a=RD3_DesktopManager.ObjectMap[this.ParentFrameIdentifier]}}if(a instanceof BookBox){a.ParentPage.ParentBook.OnReflectMouseMove(c,false)}else{if(a instanceof PField){a.ParentPanel.OnReflectMouseMove(c,false)}}}else{if(!b&&this.IDScroll){this.IDScroll.OnMouseMove(c,true)}}};WebFrame.prototype.OnReflectMouseUp=function(c,b){if(b&&!this.IsSubObj()){return}if(b||this.IsSubObj()){var a=this.WebForm.SubFormObj;if(a instanceof SubForm){a=RD3_DesktopManager.ObjectMap[a.ParentFrameIdentifier]}else{if(a==null){a=RD3_DesktopManager.ObjectMap[this.ParentFrameIdentifier]}}if(a instanceof BookBox){a.ParentPage.ParentBook.OnReflectMouseUp(c,false)}else{if(a instanceof PField){a.ParentPanel.OnReflectMouseUp(c,false)}}}else{if(!b&&this.IDScroll){this.IDScroll.OnMouseUp(c,true)}}};WebFrame.prototype.IsSubObj=function(){return((this.WebForm.SubFormObj||this.ParentFrameIdentifier!="")?true:false)};WebFrame.prototype.MustReflectScrollToParent=function(a){if(a==0){return(this.Scrollbar==RD3_Glb.FORMSCROLL_NONE||this.Scrollbar==RD3_Glb.FORMSCROLL_VERT)}else{if(a==1){return(this.Scrollbar==RD3_Glb.FORMSCROLL_NONE||this.Scrollbar==RD3_Glb.FORMSCROLL_HORIZ)}}return false};WebFrame.prototype.ChangeExpose=function(a){if(a){this.SetCaption();this.WebForm.AdaptToolbar=true}};WebFrame.prototype.AccentColorChanged=function(a,b){};WebFrame.prototype.OnAdaptRetina=function(a,c,b){if(this.IconImg){this.IconImg.width=a;this.IconImg.height=c;this.IconImg.style.display=""}};var glbDecSep=",";var glbThoSep=".";var glbPrompt="_";var glbMask="";var glbMaskType="";var glbObjInput;var glbInitValue;var glbVirtualPos=-1;function cleardebug(){}function debug(a){}function getCursorPos(e){if(glbVirtualPos>-1){return glbVirtualPos}if(typeof(e.selectionStart)!="undefined"){return e.selectionStart}else{try{var d=document.selection.createRange();var b=e.createTextRange();var c=0;while(b.compareEndPoints("StartToStart",d)){c++;b.moveStart("character")}return c}catch(a){return -1}}}function setCursorPos(d,c){if(glbVirtualPos>-1){if(c<0){c=0}glbVirtualPos=c;return}try{if(typeof(d.selectionStart)!="undefined"){d.select();d.selectionStart=c;d.selectionEnd=c}else{var b=d.createTextRange();b.move("character",c);b.select()}}catch(a){}}function setToken(b,a,d,f){var e=f.toString();while(e.length<d.length){e="0"+e}e=e.substring(0,d.length);var c=a.indexOf(d);if(c>-1){b=b.substr(0,c)+e+b.substr(c+d.length)}return b}function getToken(b,a,d){var c=a.indexOf(d);var e;if(c==-1){return c}else{e=b.substr(c,d.length);while(e.length>0&&e.charAt(0)=="0"){e=e.substr(1)}return parseInt(e)}}function unmask(b){var d,a,e;a=0;d="";while(a<b.length){e=b.charAt(a);if((e>="0"&&e<="9")||(e>="A"&&e<="Z")||(e>="a"&&e<="z")||e=="-"||e==glbDecSep){d+=e}a++}return d}function formatNumber(i,j){var b,g,h;var f,a;h="";if(i.length>0&&i.charAt(0)=="-"){h="-";i=i.substr(1)}var d=i.length-1;f=i.indexOf(glbDecSep);if(f>-1){d=f-1}f=0;while(f<d&&i.charAt(f)=="0"){f++}if(f>0){i=i.substr(f)}f=j.indexOf(glbDecSep);a=i.indexOf(glbDecSep);b="";g="";while(f>-1&&f<j.length){var e=j.charAt(f);if(e=="0"||e=="#"){if(a>-1&&a<i.length-1){b+=i.charAt(++a)}else{if(e=="0"){b+=e}else{break}}}else{b+=e}f++}f=j.indexOf(glbDecSep);a=i.indexOf(glbDecSep);if(f==-1){f=j.length}f--;if(a==-1){a=i.length}a--;while(f>=0){e=j.charAt(f);if(e=="0"||e=="#"){if(a>=0){g=i.charAt(a--)+g}else{if(e=="0"){g=e+g}else{break}}}else{g=e+g}f--}if(g.length>0&&g.charAt(0)==glbThoSep){g=g.substr(1)}if(b.length==1){b=""}return h+g+b}function isMaskToken(b,a){switch(a){case"D":if(b=="g"||b=="m"||b=="a"||b=="y"||b=="d"||b=="h"||b=="n"||b=="s"){return true}break;case"A":if(b=="a"||b=="A"||b=="#"||b=="&"){return true}break;case"N":if(b=="#"||b=="0"){return true}break}return false}function skipMaskChars(a,e,b){var d;if(b!="N"){while(e<a.length){d=a.charAt(e);if(isMaskToken(d,b)){return e}e++}}return e}function isNumber(a){return(a>=48&&a<=57)}function isAlfa(a){return(a>=65&&a<=90)}function checkValue(b,a,j,h){var f,e,d,i,g;f=j.charAt(a);e=a;d=a;while(e>=0){if(j.charAt(e)!=f){e++;break}e--}while(d<j.length){if(j.charAt(d)!=f){d--;break}d++}i=parseInt(b.substring(e,d+1));g=true;switch(h){case"D":if(f=="g"||f=="d"){if(i>31){i=31;g=false}}if(f=="m"){if(i>12){i=12;g=false}}if(f=="h"){if(i>23){i=23;g=false}}if(f=="n"||f=="s"){if(i>59){i=59;g=false}}break}if(!g){b=b.substr(0,e)+i.toString()+b.substr(d+1)}return b}function nextDay(c,b,e){var a=new Date();var d;cleardebug();d=getToken(c,b,"yyyy");if(d>0){a.setFullYear(d);debug("FullYear = "+d.toString())}else{d=getToken(c,b,"yy");if(d>0){a.setFullYear(d)%100;debug("Year = "+d.toString())}}d=getToken(c,b,"aaaa");if(d>0){a.setFullYear(d);debug("FullYear = "+d.toString())}else{d=getToken(c,b,"aa");if(d>0){a.setFullYear(d)%100;debug("Year = "+d.toString())}}d=getToken(c,b,"mm");if(d>0){a.setMonth(d-1);debug("Month = "+d.toString())}d=getToken(c,b,"dd");if(d>0){a.setDate(d+e);debug("Day = "+d.toString())}d=getToken(c,b,"gg");if(d>0){a.setDate(d+e);debug("Day = "+d.toString())}d=getToken(c,b,"hh");if(d>=0){a.setHours(d)}d=getToken(c,b,"nn");if(d>=0){a.setMinutes(d)}d=getToken(c,b,"ss");if(d>=0){a.setSeconds(d)}c=setToken(c,b,"yyyy",a.getFullYear());if(getToken(c,b,"yyyy")==0){c=setToken(c,b,"yy",a.getFullYear()%100)}c=setToken(c,b,"aaaa",a.getFullYear());if(getToken(c,b,"aaaa")==0){c=setToken(c,b,"aa",a.getFullYear()%100)}c=setToken(c,b,"mm",a.getMonth()+1);c=setToken(c,b,"dd",a.getDate());c=setToken(c,b,"gg",a.getDate());c=setToken(c,b,"hh",a.getHours());c=setToken(c,b,"nn",a.getMinutes());c=setToken(c,b,"ss",a.getSeconds());return c}function insertChar(h,a,m,l){var e,b,j,k,g,d,f,i;if(isNumber(a)||isAlfa(a)){if(typeof(h.selectionStart)!="undefined"){if(h.selectionStart!=h.selectionEnd){deleteChars(0)}}else{i=document.selection.createRange();if(i.text.length>0){deleteChars(0)}}}e=h.value;b=getCursorPos(h);b=skipMaskChars(m,b,l);k=false;if(b<m.length||(b==m.length&&e.length>0&&e.charAt(0)=="-")){j=m.charAt(b);switch(l){case"D":if(isMaskToken(j,l)){if(isNumber(a)){e=e.substr(0,b)+String.fromCharCode(a)+e.substr(b+1);e=checkValue(e,b,m,l);k=true}if(a==187||a==61){e=nextDay(e,m,1)}if(a==189){e=nextDay(e,m,-1)}}break;case"A":if(j=="&"){if(isAlfa(a)||isNumber(a)){e=e.substr(0,b)+String.fromCharCode(a).toUpperCase()+e.substr(b+1);k=true}}if(j=="a"){if(isAlfa(a)){e=e.substr(0,b)+String.fromCharCode(a).toLowerCase()+e.substr(b+1);k=true}}if(j=="A"){if(isAlfa(a)){e=e.substr(0,b)+String.fromCharCode(a).toUpperCase()+e.substr(b+1);k=true}}if(j=="#"){if(isNumber(a)){e=e.substr(0,b)+String.fromCharCode(a)+e.substr(b+1);k=true}}break;case"N":if(isNumber(a)){f=e.indexOf(glbDecSep);if(b>f&&f!=-1){e=e.substr(0,b)+String.fromCharCode(a)+e.substr(b+1)}else{if(e.length<m.length||(e.length==m.length&&e.charAt(0)=="-")){e=e.substr(0,b)+String.fromCharCode(a)+e.substr(b)}else{if(e.length==m.length&&f!==b){e=e.substr(0,b)+String.fromCharCode(a)+e.substr(b+1)}}}g=e.length;e=formatNumber(unmask(e),m);d=e.length;b+=d-g+1}if(a==188||a==190){f=e.indexOf(glbDecSep);if(f>-1){b=f+1}else{if(m.indexOf(glbDecSep)>-1){e+=glbDecSep;b=e.length}}}if(a==189||(a==187&&RD3_Glb&&RD3_Glb.IsIphone())){if(e.substr(0,1)=="-"){b--;e=e.substr(1)}else{b++;e="-"+e}}break}}if(k){b++;b=skipMaskChars(m,b,l)}h.value=e;setCursorPos(h,b);return false}function deleteChar(g,b,i,l,j){var d,k,f,c,e,h;d=g.value;if(b>=0&&b<d.length){k=l.substr(b,1);switch(j){case"A":if(isMaskToken(k,j)){k=glbPrompt}break;case"N":var a=d.charAt(b);e=d.indexOf(glbDecSep);if(e==-1){e=d.length}h=l.indexOf(glbDecSep);if(h==-1){h=l.length}k=l.substr(h+(b-e),1);if(b<e||e==-1){i=0}else{if(i==-1&&k=="#"){i=1}}f=d.length;if(isMaskToken(k,j)||a=="-"){d=unmask(d.substr(0,b)+d.substr(b+1))}else{d=unmask(d)}break}if(j!="N"){d=d.substr(0,b)+k+d.substr(b+1)}else{d=formatNumber(d,l);c=d.length;b+=c-f+1+i;if(b<0){b=0}if(b>c){b=c}}}g.value=d;return b}function deleteChars(h){var c,g,a,e,d,j,f,b;g=getCursorPos(glbObjInput);if(typeof(glbObjInput.selectionEnd)!="undefined"){a=glbObjInput.selectionEnd}else{e=document.selection.createRange();a=g+e.text.length}if(glbVirtualPos>=0){a=glbVirtualPos}if(glbMaskType=="N"){f=0;c=glbObjInput.value;for(d=a-1;d>=g;d--){if(c.charAt(d)==glbThoSep){f++}}g+=f}if(a>g){b=a-1;for(d=a-1;d>=g;d--){if(glbMaskType=="N"){j=deleteChar(glbObjInput,b,-1,glbMask,glbMaskType);b=j-1}else{j=deleteChar(glbObjInput,d,h,glbMask,glbMaskType)}}}else{g+=h;j=deleteChar(glbObjInput,g,h,glbMask,glbMaskType)}setCursorPos(glbObjInput,j)}function hk(g,f){var a,c;var e;var d;var h;if(g!=null){e=window.event?g.keyCode:g.which;d=g.altKey;h=g.ctrlKey}a=false;c=e;if(f!=undefined){c=f;d=false;h=false}else{glbVirtualPos=-1}if(RD3_Glb&&RD3_Glb.IsIphone()){if(c>=44&&c<=47){c+=144}if(c==127){c=8}}if(RD3_Glb&&RD3_Glb.IsFirefox()){if(c==173){c=109}if(c==171){c=107}}if(c>=96&&c<=105){c-=48}if(c>=107&&c<=110){c+=80}if(c==17||c==18||(d&&!h)){return true}if(h&&c>=64&&c<=95){var b=String.fromCharCode(c);if(b=="C"||b=="X"||b=="V"){if(document.all){glbObjInput.createTextRange().select()}else{glbObjInput.selectionStart=0;glbObjInput.selectionEnd=glbObjInput.value.length}}if(glbMaskType=="N"&&b=="V"){window.setTimeout(function(){if(!glbObjInput){return}if(glbObjInput.value){glbObjInput.value=glbObjInput.value.trim()}var i=glbObjInput.value;if(glbDecSep===","){i=i.replace(/\./g,"");i=i.replace(",",".")}try{if(!((i-parseFloat(i)+1)>=0)){glbObjInput.value=""}}catch(j){glbObjInput.value=""}},0)}return true}if(c==8){deleteChars(-1)}else{if(c==46){deleteChars(0)}else{if(c>=33&&c<=40){a=true}else{if(c==9||c==13){a=true}else{insertChar(glbObjInput,c,glbMask,glbMaskType)}}}}return a}function GetInitValue(c,e){var b,a,d;a="";for(d=0;d<c.length;d++){b=c.charAt(d);switch(e){case"N":if(b==glbDecSep||b=="0"){a+=b}break;case"A":if(isMaskToken(b,e)){a+=glbPrompt}else{a+=b}break;case"D":a+=b;break}}if(e=="N"&&a.length>0&&a.substr(a.length-1)==glbDecSep){a=a.substr(0,a.length-1)}return a}function mc(j,h,b,e,c){var d,i;var g=e;if(!g){g=window.event?event.srcElement:b.target}glbObjInput=g;glbMask=j;glbMaskType=h;i=glbObjInput.value;glbInitValue=i;glbVirtualPos=c?0:-1;if(i==""){i=GetInitValue(j,h);glbObjInput.value=i;if(h=="N"){d=i.indexOf(glbDecSep);if(d>-1){setTimeout("setCursorPos(glbObjInput, "+d+");",10);if(c){glbVirtualPos=d}}else{setTimeout("setCursorPos(glbObjInput, "+i.length+");",10);if(c){glbVirtualPos=i.length}}}else{setTimeout("setCursorPos(glbObjInput,0);",10);if(c){glbVirtualPos=0}}}else{if(h=="A"&&j.length>i.length){i+=GetInitValue(j,h).substr(i.length);glbObjInput.value=i;setTimeout("setCursorPos(glbObjInput,0);",10);if(c){glbVirtualPos=0}}else{if(h=="N"){if(getCursorPos(glbObjInput)==0){if(c){d=i.indexOf(glbDecSep);if(d>-1){glbVirtualPos=d}else{glbVirtualPos=i.length}}else{var a=0;while(a<i.length&&i.substr(a,1)=="0"){a++}if(a>0){setTimeout("setCursorPos(glbObjInput,"+a+");",10)}}}}}}try{FocusHandler(b)}catch(f){}}function umc(b){if(!glbObjInput){return}try{if(glbMaskType=="N"&&glbObjInput.value.length>0&&glbObjInput.value.substr(glbObjInput.value.length-1)==glbDecSep){glbObjInput.value=glbObjInput.value.substr(0,glbObjInput.value.length-1)}}catch(g){}var h=GetInitValue(glbMask,glbMaskType);if(glbObjInput.value==h&&glbMaskType!="A"){glbObjInput.value=""}if(glbMaskType=="A"){h=glbObjInput.value;for(var e=Math.min(h.length-1,glbMask.length-1);e>=0;e--){var i=h.substr(e,1);if(i==glbPrompt){continue}var d=glbMask.substr(e,1);if(i==d){if(d!="A"&&d!="a"){h=h.substr(0,e)+glbPrompt+h.substr(e+1)}}else{if(i!=glbPrompt){break}}}for(var e=h.length-1;e>=0;e--){if(h.substr(e,1)==glbPrompt){h=h.substring(0,e)}}glbObjInput.value=h}if(glbMaskType=="D"&&glbObjInput.value.length>0){var c=new Date();if(!isNaN(getToken(glbObjInput.value,glbMask,"dd"))){if(isNaN(getToken(glbObjInput.value,glbMask,"mm"))){glbObjInput.value=setToken(glbObjInput.value,glbMask,"mm",c.getMonth()+1)}var f=getToken(glbObjInput.value,glbMask,"yyyy");if(f==-1){f=getToken(glbObjInput.value,glbMask,"yy");if(isNaN(f)){glbObjInput.value=setToken(glbObjInput.value,glbMask,"yy",c.getFullYear().toString().substr(2,2))}}else{if(isNaN(f)){glbObjInput.value=setToken(glbObjInput.value,glbMask,"yyyy",c.getFullYear().toString().substr(0,4))}}}}if(glbObjInput.value!=glbInitValue){var a=true;try{if(b){RD3_KBManager.IDRO_OnChange(b)}}catch(g){a=false}if(!a){try{glbObjInput.onchange(b)}catch(g){}}}try{BlurHandler()}catch(g){}}var glbDay=0;var glbMonth=0;var glbYear=0;var glbHour=-1;var glbMinute=-1;var glbSourceField=null;var glbSourceFieldValue="";var glbCalMask;var glbStartDate;var DayNames=new Array("lu","ma","me","gi","ve","sa","do");var MonthNames=new Array("gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre");var DATE=0;var DATETIME=1;var TIME=2;var isDateTime=DATE;var OriginalWidth=-1;var OriginalHeight=-1;function setToken(b,a,d,f){var e=f.toString();while(e.length<d.length){e="0"+e}e=e.substring(0,d.length);var c=a.indexOf(d);if(c>-1){b=b.substr(0,c)+e+b.substr(c+d.length)}return b}function getToken(b,a,d){var c=a.indexOf(d);var e;if(c==-1||b.length<c+d.length){return -1}else{e=b.substr(c,d.length);return parseInt(e)}}function StrToNum(a){var e="0";for(var b=0;b<a.length;b++){var d=a.charAt(b);if(IsDigit(d)){e+=""+d}}return(parseInt(e,10))}function IsDigit(a){return(a>="0"&&a<="9")}function DaysInMonth(d,b){var a=new Array(31,28,31,30,31,30,31,31,30,31,30,31);var c=a[d-1];if(d==2){if((b%4)==0){c++}}return c}function GetNameOfMonth(a){return(MonthNames[a-1])}function IsDate(c,d,b,a,e){if(b>2100||b<1900){return false}if(d>12||d<1){return false}if(c<1){return false}if(c>DaysInMonth(d,b)){return false}if(a&&(a<0||a>23)){return false}if(e&&(e<0||e>59)){return false}return true}function ParseInputValue(e){var d=0;var f=0;var c=0;var b=0;var g=0;if(e.length<glbCalMask.length){e+=glbCalMask.substring(e.length,glbCalMask.length)}d=getToken(e,glbCalMask,"dd");f=getToken(e,glbCalMask,"mm");c=getToken(e,glbCalMask,"yyyy");b=getToken(e,glbCalMask,"hh");g=getToken(e,glbCalMask,"nn");if(c==-1){c=getToken(e,glbCalMask,"yy")}if(c<100&&c>=0){if(c>=50){c+=1900}else{c+=2000}}if(b>0&&g>0){if(IsDate(d,f,c,b,g)&&c>0&&f>0&&d>0){glbDay=d;glbMonth=f;glbYear=c;glbHour=b;glbMinute=g}}else{if(IsDate(d,f,c)&&c>0&&f>0&&d>0){glbDay=d;glbMonth=f;glbYear=c;glbHour=b;glbMinute=g}else{var a=new Date();glbDay=a.getDate();glbMonth=a.getMonth()+1;glbYear=a.getFullYear();if(glbCalMask.indexOf("hh:nn")>-1){glbHour=a.getHours();glbMinute=a.getMinutes()}else{glbHour=-1;glbMinute=-1}}}return true}function GetCaretPosition(a){var c=0;if(document.selection){a.focus();var b=document.selection.createRange();b.moveStart("character",-a.value.length);c=b.text.length}else{if(a.selectionStart||a.selectionStart=="0"){c=a.selectionStart}}return(c)}function ShowCalendar(InputField,mask){var CalObj=document.getElementById("calpopup");OriginalWidth=OriginalWidth==-1?CalObj.style.width:OriginalWidth;OriginalHeight=OriginalHeight==-1?CalObj.style.height:OriginalHeight;var CalFrame=GetFrame(window.frames,"calpopup");if(IsUndefined(CalFrame)||CalFrame==window){CalFrame=CalObj.contentWindow}if(CalFrame.glbLoaded==null||CalFrame.glbLoaded==false){return}glbCalMask=mask;if(glbCalMask==""&&RD3_ServerParams){glbCalMask=RD3_ServerParams.DateMask}var b=Math.max(GetCaretPosition(InputField)-glbCalMask.length,0);var m=glbCalMask.replace(/d/g,"\\d");m=m.replace(/m/g,"\\d");m=m.replace(/y/g,"\\d");m=m.replace(/a/g,"\\d");m=m.replace(/h/g,"\\d");m=m.replace(/n/g,"\\d");m=m.replace(/s/g,"\\d");m=m.replace(/\//g,"\\/");eval("glbStartDate = b + InputField.value.substr(b, glbCalMask.length*2).search(/"+m+"/)");var FieldValueDate=InputField.value.substr(glbStartDate,glbCalMask.length);if(InputField==glbSourceField&&CalObj.style.display=="block"){if(glbSourceFieldValue!=InputField.value&&ParseInputValue(FieldValueDate)){glbSourceFieldValue=InputField.value;CalFrame.SetInputDate(glbDay,glbMonth,glbYear);CalFrame.SetDate(glbDay,glbMonth,glbYear)}else{CalObj.style.display="none"}}else{try{if(GetFrame(window.parent.frames,"Main").document.body.style.cursor=="progress"){return}}catch(ex){}glbSourceField=InputField;glbSourceFieldValue=InputField.value;if(ParseInputValue(FieldValueDate)){var idx=glbCalMask.indexOf("hh");if(idx>-1){if(glbCalMask.length>5){isDateTime=DATETIME}else{isDateTime=TIME}}else{isDateTime=DATE}SetDate2(glbDay,glbMonth,glbYear,false,glbHour,glbMinute);CalFrame.SetInputDate(glbDay,glbMonth,glbYear,glbHour,glbMinute);CalFrame.SetDate(glbDay,glbMonth,glbYear,glbHour,glbMinute)}var CalLeft=0;var CalTop=0;for(var p=InputField;p&&p.tagName!="BODY";p=p.offsetParent){CalLeft+=p.offsetLeft-p.scrollLeft;CalTop+=p.offsetTop-p.scrollTop}var FldHeight=InputField.offsetHeight;var CalHeight=(CalObj.offsetHeight)?CalObj.offsetHeight:parseInt(CalObj.style.height);var CalWidth=(CalObj.offsetWidth)?CalObj.offsetWidth:parseInt(CalObj.style.width);var ScrollTop=document.body.scrollTop;var tt=CalTop+FldHeight;if((CalTop-CalHeight>=ScrollTop)&&(CalTop+FldHeight+CalHeight>document.body.clientHeight+ScrollTop)){tt=CalTop-CalHeight}if(RD3_Glb){if(tt+CalHeight>document.body.clientHeight){tt=document.body.clientHeight-CalHeight}if(tt<0){tt=0}if(CalLeft+CalWidth>document.body.clientWidth){CalLeft=document.body.clientWidth-CalWidth}if(CalLeft<0){CalLeft=0}}CalObj.style.left=CalLeft+"px";CalObj.style.top=tt+"px";CalObj.style.display="block";var innerDoc=CalObj.contentDocument||CalObj.contentWindow.document;var calHeader=innerDoc.getElementsByClassName("CalHeader")[0];var calArrowDx=innerDoc.getElementsByClassName("CalHeaderArrowDX")[0];var tp=innerDoc.getElementById("timepicker");var dp=innerDoc.getElementById("datepicker");if(isDateTime==DATE){if(tp){tp.style.display="none";tp.className="timepicker"}dp.style.display="inline-block";CalObj.style.width=OriginalWidth;CalObj.style.height=OriginalHeight;calArrowDx.className="CalHeaderArrowDX"}else{if(isDateTime==DATETIME){if(tp){tp.style.display="inline-block";tp.className="timepicker"}dp.style.display="inline-block";CalObj.style.width=OriginalWidth=="220px"?"360px":"270px";CalObj.style.height=OriginalHeight;calArrowDx.className="CalHeaderArrowDX CalHeaderArrowDX-TimePicker"}else{if(isDateTime==TIME){tp.style.display="inline-block";tp.className="timepicker TimeOnly";dp.style.display="none";CalObj.style.width="114px";CalObj.style.height="162px"}}}}}function SetDate(c,d,b,a,e){SetDate2(c,d,b,true,a,e)}function SetDate2(i,e,h,g,d,c){if(glbSourceField&&glbSourceField.name!=""){try{glbSourceField=GetFrame(window.parent.frames,"Main").document.getElementByName(glbSourceField.name)[0]}catch(f){glbSourceField=window.document.getElementsByName(glbSourceField.name)[0]}}if(i>0||e>0||h>0){var a=glbSourceFieldValue.substr(glbStartDate,glbCalMask.length);if(a.length<glbCalMask.length){a+=glbCalMask.substring(a.length,glbCalMask.length)}a=setToken(a,glbCalMask,"dd",i);a=setToken(a,glbCalMask,"mm",e);a=setToken(a,glbCalMask,"yyyy",h);if(getToken(a,glbCalMask,"yyyy")==-1){a=setToken(a,glbCalMask,"yy",h%100)}if(d>-1){a=setToken(a,glbCalMask,"hh",d)}if(c>-1){a=setToken(a,glbCalMask,"nn",c)}if(glbSourceField.value!=glbSourceFieldValue.substr(0,glbStartDate)+a+glbSourceFieldValue.substr(glbStartDate+a.length)){if(glbStartDate>=0){glbSourceField.value=glbSourceFieldValue.substr(0,glbStartDate)+a+glbSourceFieldValue.substr(glbStartDate+a.length)}else{glbSourceField.value=a}try{var b=GetFrame(window.parent.frames,"Main");b.RegChgObj(glbSourceField)}catch(f){try{window.setTimeout("RD3_KBManager.IDRO_OnChange(glbSourceField);",50)}catch(f){}if(glbSourceField.onchange!=null){glbSourceField.onchange(glbSourceField)}}}}if(!RD3_Glb||!RD3_Glb.IsTouch()){if(g){glbSourceField.focus()}}};